diff --git a/dist/esm/index.dev.mjs b/dist/esm/index.dev.mjs
index 85c1a4a472b2ca754328659c1eadb2613402e3a3..40b6e235ab5940196f03561a52d71ee85353808d 100644
--- a/dist/esm/index.dev.mjs
+++ b/dist/esm/index.dev.mjs
@@ -1,1404 +1,12 @@
-import * as React from 'react';
-import { useWindowSize } from '@react-hook/window-size';
-import memoizeOne from '@essentials/memoize-one';
-import OneKeyMap from '@essentials/one-key-map';
-import useLatest from '@react-hook/latest';
-import trieMemoize from 'trie-memoize';
-import { requestTimeout, clearRequestTimeout } from '@essentials/request-timeout';
-import useScrollPosition from '@react-hook/window-scroll';
-import useLayoutEffect from '@react-hook/passive-layout-effect';
-import rafSchd from 'raf-schd';
-import useEvent from '@react-hook/event';
-import { useThrottleCallback } from '@react-hook/throttle';
-
-var RED = 0;
-var BLACK = 1;
-var NIL = 2;
-var DELETE = 0;
-var KEEP = 1;
-
-function addInterval(treeNode, high, index) {
-  var node = treeNode.list;
-  var prevNode;
-
-  while (node) {
-    if (node.index === index) return false;
-    if (high > node.high) break;
-    prevNode = node;
-    node = node.next;
-  }
-
-  if (!prevNode) treeNode.list = {
-    index,
-    high,
-    next: node
-  };
-  if (prevNode) prevNode.next = {
-    index,
-    high,
-    next: prevNode.next
-  };
-  return true;
-}
-
-function removeInterval(treeNode, index) {
-  var node = treeNode.list;
-
-  if (node.index === index) {
-    if (node.next === null) return DELETE;
-    treeNode.list = node.next;
-    return KEEP;
-  }
-
-  var prevNode = node;
-  node = node.next;
-
-  while (node !== null) {
-    if (node.index === index) {
-      prevNode.next = node.next;
-      return KEEP;
-    }
-
-    prevNode = node;
-    node = node.next;
-  }
-}
-
-var NULL_NODE = {
-  low: 0,
-  max: 0,
-  high: 0,
-  C: NIL,
-  // @ts-expect-error
-  P: undefined,
-  // @ts-expect-error
-  R: undefined,
-  // @ts-expect-error
-  L: undefined,
-  // @ts-expect-error
-  list: undefined
-};
-NULL_NODE.P = NULL_NODE;
-NULL_NODE.L = NULL_NODE;
-NULL_NODE.R = NULL_NODE;
-
-function updateMax(node) {
-  var max = node.high;
-  if (node.L === NULL_NODE && node.R === NULL_NODE) node.max = max;else if (node.L === NULL_NODE) node.max = Math.max(node.R.max, max);else if (node.R === NULL_NODE) node.max = Math.max(node.L.max, max);else node.max = Math.max(Math.max(node.L.max, node.R.max), max);
-}
-
-function updateMaxUp(node) {
-  var x = node;
-
-  while (x.P !== NULL_NODE) {
-    updateMax(x.P);
-    x = x.P;
-  }
-}
-
-function rotateLeft(tree, x) {
-  if (x.R === NULL_NODE) return;
-  var y = x.R;
-  x.R = y.L;
-  if (y.L !== NULL_NODE) y.L.P = x;
-  y.P = x.P;
-  if (x.P === NULL_NODE) tree.root = y;else if (x === x.P.L) x.P.L = y;else x.P.R = y;
-  y.L = x;
-  x.P = y;
-  updateMax(x);
-  updateMax(y);
-}
-
-function rotateRight(tree, x) {
-  if (x.L === NULL_NODE) return;
-  var y = x.L;
-  x.L = y.R;
-  if (y.R !== NULL_NODE) y.R.P = x;
-  y.P = x.P;
-  if (x.P === NULL_NODE) tree.root = y;else if (x === x.P.R) x.P.R = y;else x.P.L = y;
-  y.R = x;
-  x.P = y;
-  updateMax(x);
-  updateMax(y);
-}
-
-function replaceNode(tree, x, y) {
-  if (x.P === NULL_NODE) tree.root = y;else if (x === x.P.L) x.P.L = y;else x.P.R = y;
-  y.P = x.P;
-}
-
-function fixRemove(tree, x) {
-  var w;
-
-  while (x !== NULL_NODE && x.C === BLACK) {
-    if (x === x.P.L) {
-      w = x.P.R;
-
-      if (w.C === RED) {
-        w.C = BLACK;
-        x.P.C = RED;
-        rotateLeft(tree, x.P);
-        w = x.P.R;
-      }
-
-      if (w.L.C === BLACK && w.R.C === BLACK) {
-        w.C = RED;
-        x = x.P;
-      } else {
-        if (w.R.C === BLACK) {
-          w.L.C = BLACK;
-          w.C = RED;
-          rotateRight(tree, w);
-          w = x.P.R;
-        }
-
-        w.C = x.P.C;
-        x.P.C = BLACK;
-        w.R.C = BLACK;
-        rotateLeft(tree, x.P);
-        x = tree.root;
-      }
-    } else {
-      w = x.P.L;
-
-      if (w.C === RED) {
-        w.C = BLACK;
-        x.P.C = RED;
-        rotateRight(tree, x.P);
-        w = x.P.L;
-      }
-
-      if (w.R.C === BLACK && w.L.C === BLACK) {
-        w.C = RED;
-        x = x.P;
-      } else {
-        if (w.L.C === BLACK) {
-          w.R.C = BLACK;
-          w.C = RED;
-          rotateLeft(tree, w);
-          w = x.P.L;
-        }
-
-        w.C = x.P.C;
-        x.P.C = BLACK;
-        w.L.C = BLACK;
-        rotateRight(tree, x.P);
-        x = tree.root;
-      }
-    }
-  }
-
-  x.C = BLACK;
-}
-
-function minimumTree(x) {
-  while (x.L !== NULL_NODE) x = x.L;
-
-  return x;
-}
-
-function fixInsert(tree, z) {
-  var y;
-
-  while (z.P.C === RED) {
-    if (z.P === z.P.P.L) {
-      y = z.P.P.R;
-
-      if (y.C === RED) {
-        z.P.C = BLACK;
-        y.C = BLACK;
-        z.P.P.C = RED;
-        z = z.P.P;
-      } else {
-        if (z === z.P.R) {
-          z = z.P;
-          rotateLeft(tree, z);
-        }
-
-        z.P.C = BLACK;
-        z.P.P.C = RED;
-        rotateRight(tree, z.P.P);
-      }
-    } else {
-      y = z.P.P.L;
-
-      if (y.C === RED) {
-        z.P.C = BLACK;
-        y.C = BLACK;
-        z.P.P.C = RED;
-        z = z.P.P;
-      } else {
-        if (z === z.P.L) {
-          z = z.P;
-          rotateRight(tree, z);
-        }
-
-        z.P.C = BLACK;
-        z.P.P.C = RED;
-        rotateLeft(tree, z.P.P);
-      }
-    }
-  }
-
-  tree.root.C = BLACK;
-}
-
-function createIntervalTree() {
-  var tree = {
-    root: NULL_NODE,
-    size: 0
-  }; // we know these indexes are a consistent, safe way to make look ups
-  // for our case so it's a solid O(1) alternative to
-  // the O(log n) searchNode() in typical interval trees
-
-  var indexMap = {};
-  return {
-    insert(low, high, index) {
-      var x = tree.root;
-      var y = NULL_NODE;
-
-      while (x !== NULL_NODE) {
-        y = x;
-        if (low === y.low) break;
-        if (low < x.low) x = x.L;else x = x.R;
-      }
-
-      if (low === y.low && y !== NULL_NODE) {
-        if (!addInterval(y, high, index)) return;
-        y.high = Math.max(y.high, high);
-        updateMax(y);
-        updateMaxUp(y);
-        indexMap[index] = y;
-        tree.size++;
-        return;
-      }
-
-      var z = {
-        low,
-        high,
-        max: high,
-        C: RED,
-        P: y,
-        L: NULL_NODE,
-        R: NULL_NODE,
-        list: {
-          index,
-          high,
-          next: null
-        }
-      };
-
-      if (y === NULL_NODE) {
-        tree.root = z;
-      } else {
-        if (z.low < y.low) y.L = z;else y.R = z;
-        updateMaxUp(z);
-      }
-
-      fixInsert(tree, z);
-      indexMap[index] = z;
-      tree.size++;
-    },
-
-    remove(index) {
-      var z = indexMap[index];
-      if (z === void 0) return;
-      delete indexMap[index];
-      var intervalResult = removeInterval(z, index);
-      if (intervalResult === void 0) return;
-
-      if (intervalResult === KEEP) {
-        z.high = z.list.high;
-        updateMax(z);
-        updateMaxUp(z);
-        tree.size--;
-        return;
-      }
-
-      var y = z;
-      var originalYColor = y.C;
-      var x;
-
-      if (z.L === NULL_NODE) {
-        x = z.R;
-        replaceNode(tree, z, z.R);
-      } else if (z.R === NULL_NODE) {
-        x = z.L;
-        replaceNode(tree, z, z.L);
-      } else {
-        y = minimumTree(z.R);
-        originalYColor = y.C;
-        x = y.R;
-
-        if (y.P === z) {
-          x.P = y;
-        } else {
-          replaceNode(tree, y, y.R);
-          y.R = z.R;
-          y.R.P = y;
-        }
-
-        replaceNode(tree, z, y);
-        y.L = z.L;
-        y.L.P = y;
-        y.C = z.C;
-      }
-
-      updateMax(x);
-      updateMaxUp(x);
-      if (originalYColor === BLACK) fixRemove(tree, x);
-      tree.size--;
-    },
-
-    search(low, high, callback) {
-      var stack = [tree.root];
-
-      while (stack.length !== 0) {
-        var node = stack.pop();
-        if (node === NULL_NODE || low > node.max) continue;
-        if (node.L !== NULL_NODE) stack.push(node.L);
-        if (node.R !== NULL_NODE) stack.push(node.R);
-
-        if (node.low <= high && node.high >= low) {
-          var curr = node.list;
-
-          while (curr !== null) {
-            if (curr.high >= low) callback(curr.index, node.low);
-            curr = curr.next;
-          }
-        }
-      }
-    },
-
-    get size() {
-      return tree.size;
-    }
-
-  };
-}
-
-function _extends() {
-  _extends = Object.assign || function (target) {
-    for (var i = 1; i < arguments.length; i++) {
-      var source = arguments[i];
-
-      for (var key in source) {
-        if (Object.prototype.hasOwnProperty.call(source, key)) {
-          target[key] = source[key];
-        }
-      }
-    }
-
-    return target;
-  };
-
-  return _extends.apply(this, arguments);
-}
-
-var elementsCache = /*#__PURE__*/new WeakMap();
-
-function useForceUpdate() {
-  var setState = React.useState(emptyObj$1)[1];
-  return React.useRef(() => setState({})).current;
-}
-var emptyObj$1 = {};
-
-var __reactCreateElement__$2 = React.createElement;
-
-/**
- * This hook handles the render phases of the masonry layout and returns the grid as a React element.
- *
- * @param options - Options for configuring the masonry layout renderer. See `UseMasonryOptions`.
- * @param options.positioner
- * @param options.resizeObserver
- * @param options.items
- * @param options.as
- * @param options.id
- * @param options.className
- * @param options.style
- * @param options.role
- * @param options.tabIndex
- * @param options.containerRef
- * @param options.itemAs
- * @param options.itemStyle
- * @param options.itemHeightEstimate
- * @param options.itemKey
- * @param options.overscanBy
- * @param options.scrollTop
- * @param options.isScrolling
- * @param options.height
- * @param options.render
- * @param options.onRender
- */
-function useMasonry(_ref) {
-  var {
-    // Measurement and layout
-    positioner,
-    resizeObserver,
-    // Grid items
-    items,
-    // Container props
-    as: ContainerComponent = "div",
-    id,
-    className,
-    style,
-    role = "grid",
-    tabIndex = 0,
-    containerRef,
-    // Item props
-    itemAs: ItemComponent = "div",
-    itemStyle,
-    itemHeightEstimate = 300,
-    itemKey = defaultGetItemKey,
-    // Rendering props
-    overscanBy = 2,
-    scrollTop,
-    isScrolling,
-    height,
-    render: RenderComponent,
-    onRender
-  } = _ref;
-  var startIndex = 0;
-  var stopIndex;
-  var forceUpdate = useForceUpdate();
-  var setItemRef = getRefSetter(positioner, resizeObserver);
-  var itemCount = items.length;
-  var {
-    columnWidth,
-    columnCount,
-    range,
-    estimateHeight,
-    size,
-    shortestColumn
-  } = positioner;
-  var measuredCount = size();
-  var shortestColumnSize = shortestColumn();
-  var children = [];
-  var itemRole = role === "list" ? "listitem" : role === "grid" ? "gridcell" : undefined;
-  var storedOnRender = useLatest(onRender);
-  overscanBy = height * overscanBy;
-  var rangeEnd = scrollTop + overscanBy;
-  var needsFreshBatch = shortestColumnSize < rangeEnd && measuredCount < itemCount;
-  range( // We overscan in both directions because users scroll both ways,
-  // though one must admit scrolling down is more common and thus
-  // we only overscan by half the downward overscan amount
-  Math.max(0, scrollTop - overscanBy / 2), rangeEnd, (index, left, top) => {
-    var data = items[index];
-    var key = itemKey(data, index);
-    var phaseTwoStyle = {
-      top,
-      left,
-      width: columnWidth,
-      writingMode: "horizontal-tb",
-      position: "absolute"
-    };
-    /* istanbul ignore next */
-
-    if (typeof process !== "undefined" && "production" !== "production") {
-      throwWithoutData(data, index);
-    }
-
-    children.push( /*#__PURE__*/__reactCreateElement__$2(ItemComponent, {
-      key: key,
-      ref: setItemRef(index),
-      role: itemRole,
-      style: typeof itemStyle === "object" && itemStyle !== null ? Object.assign({}, phaseTwoStyle, itemStyle) : phaseTwoStyle
-    }, createRenderElement(RenderComponent, index, data, columnWidth)));
-
-    if (stopIndex === void 0) {
-      startIndex = index;
-      stopIndex = index;
-    } else {
-      startIndex = Math.min(startIndex, index);
-      stopIndex = Math.max(stopIndex, index);
-    }
-  });
-
-  if (needsFreshBatch) {
-    var batchSize = Math.min(itemCount - measuredCount, Math.ceil((scrollTop + overscanBy - shortestColumnSize) / itemHeightEstimate * columnCount));
-    var _index = measuredCount;
-    var phaseOneStyle = getCachedSize(columnWidth);
-
-    for (; _index < measuredCount + batchSize; _index++) {
-      var _data = items[_index];
-      var key = itemKey(_data, _index);
-      /* istanbul ignore next */
-
-      if (typeof process !== "undefined" && "production" !== "production") {
-        throwWithoutData(_data, _index);
-      }
-
-      children.push( /*#__PURE__*/__reactCreateElement__$2(ItemComponent, {
-        key: key,
-        ref: setItemRef(_index),
-        role: itemRole,
-        style: typeof itemStyle === "object" ? Object.assign({}, phaseOneStyle, itemStyle) : phaseOneStyle
-      }, createRenderElement(RenderComponent, _index, _data, columnWidth)));
-    }
-  } // Calls the onRender callback if the rendered indices changed
-
-
-  React.useEffect(() => {
-    if (typeof storedOnRender.current === "function" && stopIndex !== void 0) storedOnRender.current(startIndex, stopIndex, items);
-    didEverMount = "1";
-  }, [startIndex, stopIndex, items, storedOnRender]); // If we needed a fresh batch we should reload our components with the measured
-  // sizes
-
-  React.useEffect(() => {
-    if (needsFreshBatch) forceUpdate(); // eslint-disable-next-line
-  }, [needsFreshBatch, positioner]); // gets the container style object based upon the estimated height and whether or not
-  // the page is being scrolled
-
-  var containerStyle = getContainerStyle(isScrolling, estimateHeight(itemCount, itemHeightEstimate));
-  return /*#__PURE__*/__reactCreateElement__$2(ContainerComponent, {
-    ref: containerRef,
-    key: didEverMount,
-    id: id,
-    role: role,
-    className: className,
-    tabIndex: tabIndex,
-    style: typeof style === "object" ? assignUserStyle(containerStyle, style) : containerStyle,
-    children: children
-  });
-}
-/* istanbul ignore next */
-
-function throwWithoutData(data, index) {
-  if (!data) {
-    throw new Error("No data was found at index: " + index + "\n\n" + "This usually happens when you've mutated or changed the \"items\" array in a " + "way that makes it shorter than the previous \"items\" array. Masonic knows nothing " + "about your underlying data and when it caches cell positions, it assumes you aren't " + "mutating the underlying \"items\".\n\n" + "See https://codesandbox.io/s/masonic-w-react-router-example-2b5f9?file=/src/index.js for " + "an example that gets around this limitations. For advanced implementations, see " + "https://codesandbox.io/s/masonic-w-react-router-and-advanced-config-example-8em42?file=/src/index.js\n\n" + "If this was the result of your removing an item from your \"items\", see this issue: " + "https://github.com/jaredLunde/masonic/issues/12");
-  }
-} // This is for triggering a remount after SSR has loaded in the client w/ hydrate()
-
-
-var didEverMount = "0";
-//
-// Render-phase utilities
-// ~5.5x faster than createElement without the memo
-var createRenderElement = /*#__PURE__*/trieMemoize([OneKeyMap, {}, WeakMap, OneKeyMap], (RenderComponent, index, data, columnWidth) => /*#__PURE__*/__reactCreateElement__$2(RenderComponent, {
-  index: index,
-  data: data,
-  width: columnWidth
-}));
-var getContainerStyle = /*#__PURE__*/memoizeOne((isScrolling, estimateHeight) => ({
-  position: "relative",
-  width: "100%",
-  maxWidth: "100%",
-  height: Math.ceil(estimateHeight),
-  maxHeight: Math.ceil(estimateHeight),
-  willChange: isScrolling ? "contents" : void 0,
-  pointerEvents: isScrolling ? "none" : void 0
-}));
-
-var cmp2 = (args, pargs) => args[0] === pargs[0] && args[1] === pargs[1];
-
-var assignUserStyle = /*#__PURE__*/memoizeOne((containerStyle, userStyle) => Object.assign({}, containerStyle, userStyle), // @ts-expect-error
-cmp2);
-
-function defaultGetItemKey(_, i) {
-  return i;
-} // the below memoizations for for ensuring shallow equal is reliable for pure
-// component children
-
-
-var getCachedSize = /*#__PURE__*/memoizeOne(width => ({
-  width,
-  zIndex: -1000,
-  visibility: "hidden",
-  position: "absolute",
-  writingMode: "horizontal-tb"
-}), (args, pargs) => args[0] === pargs[0]);
-var getRefSetter = /*#__PURE__*/memoizeOne((positioner, resizeObserver) => index => el => {
-  if (el === null) return;
-
-  if (resizeObserver) {
-    resizeObserver.observe(el);
-    elementsCache.set(el, index);
-  }
-
-  if (positioner.get(index) === void 0) positioner.set(index, el.offsetHeight);
-}, // @ts-expect-error
-cmp2);
-
-/**
- * A hook for tracking whether the `window` is currently being scrolled and it's scroll position on
- * the y-axis. These values are used for determining which grid cells to render and when
- * to add styles to the masonry container that maximize scroll performance.
- *
- * @param offset - The vertical space in pixels between the top of the grid container and the top
- *  of the browser `document.documentElement`.
- * @param fps - This determines how often (in frames per second) to update the scroll position of the
- *  browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.
- *  The default value of `12` has been very reasonable in my own testing, but if you have particularly
- *  heavy `render` components it may be prudent to reduce this number.
- */
-
-function useScroller(offset, fps) {
-  if (offset === void 0) {
-    offset = 0;
-  }
-
-  if (fps === void 0) {
-    fps = 12;
-  }
-
-  var scrollTop = useScrollPosition(fps);
-  var [isScrolling, setIsScrolling] = React.useState(false);
-  var didMount = React.useRef(0);
-  React.useEffect(() => {
-    if (didMount.current === 1) setIsScrolling(true);
-    var didUnsubscribe = false;
-    var to = requestTimeout(() => {
-      if (didUnsubscribe) return; // This is here to prevent premature bail outs while maintaining high resolution
-      // unsets. Without it there will always bee a lot of unnecessary DOM writes to style.
-
-      setIsScrolling(false);
-    }, 40 + 1000 / fps);
-    didMount.current = 1;
-    return () => {
-      didUnsubscribe = true;
-      clearRequestTimeout(to);
-    };
-  }, [fps, scrollTop]);
-  return {
-    scrollTop: Math.max(0, scrollTop - offset),
-    isScrolling
-  };
-}
-
-/**
- * A heavily-optimized component that updates `useMasonry()` when the scroll position of the browser `window`
- * changes. This bare-metal component is used by `<Masonry>` under the hood.
- *
- * @param props
- */
-
-function MasonryScroller(props) {
-  // We put this in its own layer because it's the thing that will trigger the most updates
-  // and we don't want to slower ourselves by cycling through all the functions, objects, and effects
-  // of other hooks
-  var {
-    scrollTop,
-    isScrolling
-  } = useScroller(props.offset, props.scrollFps); // This is an update-heavy phase and while we could just Object.assign here,
-  // it is way faster to inline and there's a relatively low hit to he bundle
-  // size.
-
-  return useMasonry({
-    scrollTop,
-    isScrolling,
-    positioner: props.positioner,
-    resizeObserver: props.resizeObserver,
-    items: props.items,
-    onRender: props.onRender,
-    as: props.as,
-    id: props.id,
-    className: props.className,
-    style: props.style,
-    role: props.role,
-    tabIndex: props.tabIndex,
-    containerRef: props.containerRef,
-    itemAs: props.itemAs,
-    itemStyle: props.itemStyle,
-    itemHeightEstimate: props.itemHeightEstimate,
-    itemKey: props.itemKey,
-    overscanBy: props.overscanBy,
-    height: props.height,
-    render: props.render
-  });
-}
-
-if (typeof process !== "undefined" && "production" !== "production") {
-  MasonryScroller.displayName = "MasonryScroller";
-}
-
-/**
- * A hook for measuring the width of the grid container, as well as its distance
- * from the top of the document. These values are necessary to correctly calculate the number/width
- * of columns to render, as well as the number of rows to render.
- *
- * @param elementRef - A `ref` object created by `React.useRef()`. That ref should be provided to the
- *   `containerRef` property in `useMasonry()`.
- * @param deps - You can force this hook to recalculate the `offset` and `width` whenever this
- *   dependencies list changes. A common dependencies list might look like `[windowWidth, windowHeight]`,
- *   which would force the hook to recalculate any time the size of the browser `window` changed.
- */
-
-function useContainerPosition(elementRef, deps) {
-  if (deps === void 0) {
-    deps = emptyArr$1;
-  }
-
-  var [containerPosition, setContainerPosition] = React.useState({
-    offset: 0,
-    width: 0
-  });
-  useLayoutEffect(() => {
-    var {
-      current
-    } = elementRef;
-
-    if (current !== null) {
-      var offset = 0;
-      var el = current;
-
-      do {
-        offset += el.offsetTop || 0;
-        el = el.offsetParent;
-      } while (el);
-
-      if (offset !== containerPosition.offset || current.offsetWidth !== containerPosition.width) {
-        setContainerPosition({
-          offset,
-          width: current.offsetWidth
-        });
-      }
-    } // eslint-disable-next-line react-hooks/exhaustive-deps
-
-  }, deps);
-  return containerPosition;
-}
-var emptyArr$1 = [];
-
-/**
- * This hook creates the grid cell positioner and cache required by `useMasonry()`. This is
- * the meat of the grid's layout algorithm, determining which cells to render at a given scroll
- * position, as well as where to place new items in the grid.
- *
- * @param options - Properties that determine the number of columns in the grid, as well
- *  as their widths.
- * @param options.columnWidth
- * @param options.width
- * @param deps - This hook will create a new positioner, clearing all existing cached positions,
- *  whenever the dependencies in this list change.
- * @param options.columnGutter
- * @param options.rowGutter
- * @param options.columnCount
- * @param options.maxColumnCount
- * @param options.maxColumnWidth
- */
-
-function usePositioner(_ref, deps) {
-  var {
-    width,
-    columnWidth = 200,
-    columnGutter = 0,
-    rowGutter,
-    columnCount,
-    maxColumnCount,
-    maxColumnWidth
-  } = _ref;
-
-  if (deps === void 0) {
-    deps = emptyArr;
-  }
-
-  var initPositioner = () => {
-    var [computedColumnWidth, computedColumnCount] = getColumns(width, columnWidth, columnGutter, columnCount, maxColumnCount, maxColumnWidth);
-    return createPositioner(computedColumnCount, computedColumnWidth, columnGutter, rowGutter !== null && rowGutter !== void 0 ? rowGutter : columnGutter);
-  };
-
-  var positionerRef = React.useRef();
-  if (positionerRef.current === undefined) positionerRef.current = initPositioner();
-  var prevDeps = React.useRef(deps);
-  var opts = [width, columnWidth, columnGutter, rowGutter, columnCount, maxColumnCount, maxColumnWidth];
-  var prevOpts = React.useRef(opts);
-  var optsChanged = !opts.every((item, i) => prevOpts.current[i] === item);
-
-  if (typeof process !== "undefined" && "production" !== "production") {
-    if (deps.length !== prevDeps.current.length) {
-      throw new Error("usePositioner(): The length of your dependencies array changed.");
-    }
-  } // Create a new positioner when the dependencies or sizes change
-  // Thanks to https://github.com/khmm12 for pointing this out
-  // https://github.com/jaredLunde/masonic/pull/41
-
-
-  if (optsChanged || !deps.every((item, i) => prevDeps.current[i] === item)) {
-    var prevPositioner = positionerRef.current;
-    var positioner = initPositioner();
-    prevDeps.current = deps;
-    prevOpts.current = opts;
-
-    if (optsChanged) {
-      var cacheSize = prevPositioner.size();
-
-      for (var _index2 = 0; _index2 < cacheSize; _index2++) {
-        var pos = prevPositioner.get(_index2);
-        positioner.set(_index2, pos !== void 0 ? pos.height : 0);
-      }
-    }
-
-    positionerRef.current = positioner;
-  }
-
-  return positionerRef.current;
-}
-
-/**
- * Creates a cell positioner for the `useMasonry()` hook. The `usePositioner()` hook uses
- * this utility under the hood.
- *
- * @param columnCount - The number of columns in the grid
- * @param columnWidth - The width of each column in the grid
- * @param columnGutter - The amount of horizontal space between columns in pixels.
- * @param rowGutter - The amount of vertical space between cells within a column in pixels (falls back
- * to `columnGutter`).
- */
-var createPositioner = function createPositioner(columnCount, columnWidth, columnGutter, rowGutter) {
-  if (columnGutter === void 0) {
-    columnGutter = 0;
-  }
-
-  if (rowGutter === void 0) {
-    rowGutter = columnGutter;
-  }
-
-  // O(log(n)) lookup of cells to render for a given viewport size
-  // Store tops and bottoms of each cell for fast intersection lookup.
-  var intervalTree = createIntervalTree(); // Track the height of each column.
-  // Layout algorithm below always inserts into the shortest column.
-
-  var columnHeights = new Array(columnCount); // Used for O(1) item access
-
-  var items = []; // Tracks the item indexes within an individual column
-
-  var columnItems = new Array(columnCount);
-
-  for (var i = 0; i < columnCount; i++) {
-    columnHeights[i] = 0;
-    columnItems[i] = [];
-  }
-
-  return {
-    columnCount,
-    columnWidth,
-    set: function set(index, height) {
-      if (height === void 0) {
-        height = 0;
-      }
-
-      var column = 0; // finds the shortest column and uses it
-
-      for (var _i2 = 1; _i2 < columnHeights.length; _i2++) {
-        if (columnHeights[_i2] < columnHeights[column]) column = _i2;
-      }
-
-      var top = columnHeights[column] || 0;
-      columnHeights[column] = top + height + rowGutter;
-      columnItems[column].push(index);
-      items[index] = {
-        left: column * (columnWidth + columnGutter),
-        top,
-        height,
-        column
-      };
-      intervalTree.insert(top, top + height, index);
-    },
-    get: index => items[index],
-    // This only updates items in the specific columns that have changed, on and after the
-    // specific items that have changed
-    update: updates => {
-      var columns = new Array(columnCount);
-      var i = 0,
-          j = 0; // determines which columns have items that changed, as well as the minimum index
-      // changed in that column, as all items after that index will have their positions
-      // affected by the change
-
-      for (; i < updates.length - 1; i++) {
-        var _index3 = updates[i];
-        var item = items[_index3];
-        item.height = updates[++i];
-        intervalTree.remove(_index3);
-        intervalTree.insert(item.top, item.top + item.height, _index3);
-        columns[item.column] = columns[item.column] === void 0 ? _index3 : Math.min(_index3, columns[item.column]);
-      }
-
-      for (i = 0; i < columns.length; i++) {
-        // bails out if the column didn't change
-        if (columns[i] === void 0) continue;
-        var itemsInColumn = columnItems[i]; // the index order is sorted with certainty so binary search is a great solution
-        // here as opposed to Array.indexOf()
-
-        var startIndex = binarySearch(itemsInColumn, columns[i]);
-        var _index4 = columnItems[i][startIndex];
-        var startItem = items[_index4];
-        columnHeights[i] = startItem.top + startItem.height + rowGutter;
-
-        for (j = startIndex + 1; j < itemsInColumn.length; j++) {
-          var _index5 = itemsInColumn[j];
-          var _item = items[_index5];
-          _item.top = columnHeights[i];
-          columnHeights[i] = _item.top + _item.height + rowGutter;
-          intervalTree.remove(_index5);
-          intervalTree.insert(_item.top, _item.top + _item.height, _index5);
-        }
-      }
-    },
-    // Render all cells visible within the viewport range defined.
-    range: (lo, hi, renderCallback) => intervalTree.search(lo, hi, (index, top) => renderCallback(index, items[index].left, top)),
-    estimateHeight: (itemCount, defaultItemHeight) => {
-      var tallestColumn = Math.max(0, Math.max.apply(null, columnHeights));
-      return itemCount === intervalTree.size ? tallestColumn : tallestColumn + Math.ceil((itemCount - intervalTree.size) / columnCount) * defaultItemHeight;
-    },
-    shortestColumn: () => {
-      if (columnHeights.length > 1) return Math.min.apply(null, columnHeights);
-      return columnHeights[0] || 0;
-    },
-
-    size() {
-      return intervalTree.size;
-    },
-
-    all() {
-      return items;
-    }
-
-  };
-};
-
-/* istanbul ignore next */
-var binarySearch = (a, y) => {
-  var l = 0;
-  var h = a.length - 1;
-
-  while (l <= h) {
-    var m = l + h >>> 1;
-    var x = a[m];
-    if (x === y) return m;else if (x <= y) l = m + 1;else h = m - 1;
-  }
-
-  return -1;
-};
-
-var getColumns = function getColumns(width, minimumWidth, gutter, columnCount, maxColumnCount, maxColumnWidth) {
-  if (width === void 0) {
-    width = 0;
-  }
-
-  if (minimumWidth === void 0) {
-    minimumWidth = 0;
-  }
-
-  if (gutter === void 0) {
-    gutter = 8;
-  }
-
-  columnCount = columnCount || Math.min(Math.floor((width + gutter) / (minimumWidth + gutter)), maxColumnCount || Infinity) || 1;
-  var columnWidth = Math.floor((width - gutter * (columnCount - 1)) / columnCount); // Cap the column width if maxColumnWidth is specified
-
-  if (maxColumnWidth !== undefined && columnWidth > maxColumnWidth) {
-    columnWidth = maxColumnWidth;
-  }
-
-  return [columnWidth, columnCount];
-};
-
-var emptyArr = [];
-
-/**
- * Creates a resize observer that forces updates to the grid cell positions when mutations are
- * made to cells affecting their height.
- *
- * @param positioner - The masonry cell positioner created by the `usePositioner()` hook.
- */
-function useResizeObserver(positioner) {
-  var forceUpdate = useForceUpdate();
-  var resizeObserver = createResizeObserver(positioner, forceUpdate); // Cleans up the resize observers when they change or the
-  // component unmounts
-
-  function _ref() {
-    return resizeObserver.disconnect();
-  }
-
-  React.useEffect(() => _ref, [resizeObserver]);
-  return resizeObserver;
-}
-
-function _ref2(handler) {
-  handler.cancel();
-}
-
-/**
- * Creates a resize observer that fires an `updater` callback whenever the height of
- * one or many cells change. The `useResizeObserver()` hook is using this under the hood.
- *
- * @param positioner - A cell positioner created by the `usePositioner()` hook or the `createPositioner()` utility
- * @param updater - A callback that fires whenever one or many cell heights change.
- */
-var createResizeObserver = /*#__PURE__*/trieMemoize([WeakMap], // TODO: figure out a way to test this
-
-/* istanbul ignore next */
-(positioner, updater) => {
-  var updates = [];
-  var update = rafSchd(() => {
-    if (updates.length > 0) {
-      // Updates the size/positions of the cell with the resize
-      // observer updates
-      positioner.update(updates);
-      updater(updates);
-    }
-
-    updates.length = 0;
-  });
-
-  var commonHandler = target => {
-    var height = target.offsetHeight;
-
-    if (height > 0) {
-      var index = elementsCache.get(target);
-
-      if (index !== void 0) {
-        var position = positioner.get(index);
-        if (position !== void 0 && height !== position.height) updates.push(index, height);
-      }
-    }
-
-    update();
-  };
-
-  var handlers = new Map();
-
-  var handleEntries = entries => {
-    var i = 0;
-
-    for (; i < entries.length; i++) {
-      var entry = entries[i];
-      var index = elementsCache.get(entry.target);
-      if (index === void 0) continue;
-      var handler = handlers.get(index);
-
-      if (!handler) {
-        handler = rafSchd(commonHandler);
-        handlers.set(index, handler);
-      }
-
-      handler(entry.target);
-    }
-  };
-
-  var ro = new ResizeObserver(handleEntries); // Overrides the original disconnect to include cancelling handling the entries.
-  // Ideally this would be its own method but that would result in a breaking
-  // change.
-
-  var disconnect = ro.disconnect.bind(ro);
-
-  ro.disconnect = () => {
-    disconnect();
-    handlers.forEach(_ref2);
-  };
-
-  return ro;
-});
-
-/**
- * A hook that creates a callback for scrolling to a specific index in
- * the "items" array.
- *
- * @param positioner - A positioner created by the `usePositioner()` hook
- * @param options - Configuration options
- */
-function useScrollToIndex(positioner, options) {
-  var _latestOptions$curren;
-
-  var {
-    align = "top",
-    element = typeof window !== "undefined" && window,
-    offset = 0,
-    height = typeof window !== "undefined" ? window.innerHeight : 0
-  } = options;
-  var latestOptions = useLatest({
-    positioner,
-    element,
-    align,
-    offset,
-    height
-  });
-  var getTarget = React.useRef(() => {
-    var latestElement = latestOptions.current.element;
-    return latestElement && "current" in latestElement ? latestElement.current : latestElement;
-  }).current;
-  var [state, dispatch] = React.useReducer((state, action) => {
-    var nextState = {
-      position: state.position,
-      index: state.index,
-      prevTop: state.prevTop
-    };
-    /* istanbul ignore next */
-
-    if (action.type === "scrollToIndex") {
-      var _action$value;
-
-      return {
-        position: latestOptions.current.positioner.get((_action$value = action.value) !== null && _action$value !== void 0 ? _action$value : -1),
-        index: action.value,
-        prevTop: void 0
-      };
-    } else if (action.type === "setPosition") {
-      nextState.position = action.value;
-    } else if (action.type === "setPrevTop") {
-      nextState.prevTop = action.value;
-    } else if (action.type === "reset") {
-      return defaultState;
-    }
-
-    return nextState;
-  }, defaultState);
-  var throttledDispatch = useThrottleCallback(dispatch, 15); // If we find the position along the way we can immediately take off
-  // to the correct spot.
-
-  useEvent(getTarget(), "scroll", () => {
-    if (!state.position && state.index) {
-      var position = latestOptions.current.positioner.get(state.index);
-
-      if (position) {
-        dispatch({
-          type: "setPosition",
-          value: position
-        });
-      }
-    }
-  }); // If the top changes out from under us in the case of dynamic cells, we
-  // want to keep following it.
-
-  var currentTop = state.index !== void 0 && ((_latestOptions$curren = latestOptions.current.positioner.get(state.index)) === null || _latestOptions$curren === void 0 ? void 0 : _latestOptions$curren.top);
-  React.useEffect(() => {
-    var target = getTarget();
-    if (!target) return;
-    var {
-      height,
-      align,
-      offset,
-      positioner
-    } = latestOptions.current;
-
-    function _ref() {
-      return !didUnsubscribe && dispatch({
-        type: "reset"
-      });
-    }
-
-    function _ref2() {
-      didUnsubscribe = true;
-      clearTimeout(timeout);
-    }
-
-    if (state.position) {
-      var scrollTop = state.position.top;
-
-      if (align === "bottom") {
-        scrollTop = scrollTop - height + state.position.height;
-      } else if (align === "center") {
-        scrollTop -= (height - state.position.height) / 2;
-      }
-
-      target.scrollTo(0, Math.max(0, scrollTop += offset)); // Resets state after 400ms, an arbitrary time I determined to be
-      // still visually pleasing if there is a slow network reply in dynamic
-      // cells
-
-      var didUnsubscribe = false;
-      var timeout = setTimeout(_ref, 400);
-      return _ref2;
-    } else if (state.index !== void 0) {
-      // Estimates the top based upon the average height of current cells
-      var estimatedTop = positioner.shortestColumn() / positioner.size() * state.index;
-      if (state.prevTop) estimatedTop = Math.max(estimatedTop, state.prevTop + height);
-      target.scrollTo(0, estimatedTop);
-      throttledDispatch({
-        type: "setPrevTop",
-        value: estimatedTop
-      });
-    }
-  }, [currentTop, state, latestOptions, getTarget, throttledDispatch]);
-  return React.useRef(index => {
-    dispatch({
-      type: "scrollToIndex",
-      value: index
-    });
-  }).current;
-}
-var defaultState = {
-  index: void 0,
-  position: void 0,
-  prevTop: void 0
-};
-
-var __reactCreateElement__$1 = React.createElement;
-
-/**
- * A "batteries included" masonry grid which includes all of the implementation details below. This component is the
- * easiest way to get off and running in your app, before switching to more advanced implementations, if necessary.
- * It will change its column count to fit its container's width and will decide how many rows to render based upon
- * the height of the browser `window`.
- *
- * @param props
- */
-function Masonry(props) {
-  var containerRef = React.useRef(null);
-  var windowSize = useWindowSize({
-    initialWidth: props.ssrWidth,
-    initialHeight: props.ssrHeight
-  });
-  var containerPos = useContainerPosition(containerRef, windowSize);
-  var nextProps = Object.assign({
-    offset: containerPos.offset,
-    width: containerPos.width || windowSize[0],
-    height: windowSize[1],
-    containerRef
-  }, props);
-  nextProps.positioner = usePositioner(nextProps);
-  nextProps.resizeObserver = useResizeObserver(nextProps.positioner);
-  var scrollToIndex = useScrollToIndex(nextProps.positioner, {
-    height: nextProps.height,
-    offset: containerPos.offset,
-    align: typeof props.scrollToIndex === "object" ? props.scrollToIndex.align : void 0
-  });
-  var index = props.scrollToIndex && (typeof props.scrollToIndex === "number" ? props.scrollToIndex : props.scrollToIndex.index);
-  React.useEffect(() => {
-    if (index !== void 0) scrollToIndex(index);
-  }, [index, scrollToIndex]);
-  return __reactCreateElement__$1(MasonryScroller, nextProps);
-}
-
-if (typeof process !== "undefined" && "production" !== "production") {
-  Masonry.displayName = "Masonry";
-}
-
-var __reactCreateElement__ = React.createElement;
-
-/**
- * This is just a single-column `<Masonry>` component without column-specific props.
- *
- * @param props
- */
-function List(props) {
-  return /*#__PURE__*/__reactCreateElement__(Masonry, _extends({
-    role: "list",
-    rowGutter: props.rowGutter,
-    columnCount: 1,
-    columnWidth: 1
-  }, props));
-}
-
-if (typeof process !== "undefined" && "production" !== "production") {
-  List.displayName = "List";
-}
-
-/**
- * A utility hook for seamlessly adding infinite scroll behavior to the `useMasonry()` hook. This
- * hook invokes a callback each time the last rendered index surpasses the total number of items
- * in your items array or the number defined in the `totalItems` option.
- *
- * @param loadMoreItems - This callback is invoked when more rows must be loaded. It will be used to
- *  determine when to refresh the list with the newly-loaded data. This callback may be called multiple
- *  times in reaction to a single scroll event, so it's important to memoize its arguments. If you're
- *  creating this callback inside of a functional component, make sure you wrap it in `React.useCallback()`,
- *  as well.
- * @param options
- */
-
-function useInfiniteLoader(loadMoreItems, options) {
-  if (options === void 0) {
-    options = emptyObj;
-  }
-
-  var {
-    isItemLoaded,
-    minimumBatchSize = 16,
-    threshold = 16,
-    totalItems = 9e9
-  } = options;
-  var storedLoadMoreItems = useLatest(loadMoreItems);
-  var storedIsItemLoaded = useLatest(isItemLoaded);
-  return React.useCallback((startIndex, stopIndex, items) => {
-    var unloadedRanges = scanForUnloadedRanges(storedIsItemLoaded.current, minimumBatchSize, items, totalItems, Math.max(0, startIndex - threshold), Math.min(totalItems - 1, (stopIndex || 0) + threshold)); // The user is responsible for memoizing their loadMoreItems() function
-    // because we don't want to make assumptions about how they want to deal
-    // with `items`
-
-    for (var i = 0; i < unloadedRanges.length - 1; ++i) storedLoadMoreItems.current(unloadedRanges[i], unloadedRanges[++i], items);
-  }, [totalItems, minimumBatchSize, threshold, storedLoadMoreItems, storedIsItemLoaded]);
-}
-/**
- * Returns all of the ranges within a larger range that contain unloaded rows.
- *
- * @param isItemLoaded
- * @param minimumBatchSize
- * @param items
- * @param totalItems
- * @param startIndex
- * @param stopIndex
- */
-
-function scanForUnloadedRanges(isItemLoaded, minimumBatchSize, items, totalItems, startIndex, stopIndex) {
-  if (isItemLoaded === void 0) {
-    isItemLoaded = defaultIsItemLoaded;
-  }
-
-  if (minimumBatchSize === void 0) {
-    minimumBatchSize = 16;
-  }
-
-  if (totalItems === void 0) {
-    totalItems = 9e9;
-  }
-
-  var unloadedRanges = [];
-  var rangeStartIndex,
-      rangeStopIndex,
-      index = startIndex;
-  /* istanbul ignore next */
-
-  for (; index <= stopIndex; index++) {
-    if (!isItemLoaded(index, items)) {
-      rangeStopIndex = index;
-      if (rangeStartIndex === void 0) rangeStartIndex = index;
-    } else if (rangeStartIndex !== void 0 && rangeStopIndex !== void 0) {
-      unloadedRanges.push(rangeStartIndex, rangeStopIndex);
-      rangeStartIndex = rangeStopIndex = void 0;
-    }
-  } // If :rangeStopIndex is not null it means we haven't run out of unloaded rows.
-  // Scan forward to try filling our :minimumBatchSize.
-
-
-  if (rangeStartIndex !== void 0 && rangeStopIndex !== void 0) {
-    var potentialStopIndex = Math.min(Math.max(rangeStopIndex, rangeStartIndex + minimumBatchSize - 1), totalItems - 1);
-    /* istanbul ignore next */
-
-    for (index = rangeStopIndex + 1; index <= potentialStopIndex; index++) {
-      if (!isItemLoaded(index, items)) {
-        rangeStopIndex = index;
-      } else {
-        break;
-      }
-    }
-
-    unloadedRanges.push(rangeStartIndex, rangeStopIndex);
-  } // Check to see if our first range ended prematurely.
-  // In this case we should scan backwards to try filling our :minimumBatchSize.
-
-  /* istanbul ignore next */
-
-
-  if (unloadedRanges.length) {
-    var firstUnloadedStart = unloadedRanges[0];
-    var firstUnloadedStop = unloadedRanges[1];
-
-    while (firstUnloadedStop - firstUnloadedStart + 1 < minimumBatchSize && firstUnloadedStart > 0) {
-      var _index = firstUnloadedStart - 1;
-
-      if (!isItemLoaded(_index, items)) {
-        unloadedRanges[0] = firstUnloadedStart = _index;
-      } else {
-        break;
-      }
-    }
-  }
-
-  return unloadedRanges;
-}
-
-var defaultIsItemLoaded = (index, items) => items[index] !== void 0;
-
-var emptyObj = {};
-
-export { List, Masonry, MasonryScroller, createIntervalTree, createPositioner, createResizeObserver, useContainerPosition, useInfiniteLoader, useMasonry, usePositioner, useResizeObserver, useScrollToIndex, useScroller };
+export * from './interval-tree.ts';
+export * from './list.tsx';
+export * from './masonry.tsx';
+export * from './masonry-scroller.tsx';
+export * from './use-container-position.ts';
+export * from './use-infinite-loader.ts';
+export * from './use-masonry.tsx';
+export * from './use-positioner.ts';
+export * from './use-resize-observer.ts';
+export * from './use-scroll-to-index.ts';
+export * from './use-scroller.ts';
 //# sourceMappingURL=index.dev.mjs.map
diff --git a/dist/esm/index.dev.mjs.map b/dist/esm/index.dev.mjs.map
index fb0006a135e23cb4b2039c03e3208b84998653a9..c135660225181a3495c619b29fceb230306b8106 100644
--- a/dist/esm/index.dev.mjs.map
+++ b/dist/esm/index.dev.mjs.map
@@ -1 +1 @@
-{"version":3,"file":"index.dev.mjs","sources":["../../src/interval-tree.ts","../../src/elements-cache.ts","../../src/use-force-update.ts","../../src/use-masonry.tsx","../../src/use-scroller.ts","../../src/masonry-scroller.tsx","../../src/use-container-position.ts","../../src/use-positioner.ts","../../src/use-resize-observer.ts","../../src/use-scroll-to-index.ts","../../src/masonry.tsx","../../src/list.tsx","../../src/use-infinite-loader.ts"],"sourcesContent":["type Color = 0 | 1 | 2;\nconst RED = 0;\nconst BLACK = 1;\nconst NIL = 2;\n\nconst DELETE = 0;\nconst KEEP = 1;\n\ntype ListNode = {\n  index: number;\n  high: number;\n  next: ListNode | null;\n};\n\ninterface TreeNode {\n  max: number;\n  low: number;\n  high: number;\n  // color\n  C: Color;\n  // P\n  P: TreeNode;\n  // right\n  R: TreeNode;\n  // left\n  L: TreeNode;\n  list: ListNode;\n}\n\ninterface Tree {\n  root: TreeNode;\n  size: number;\n}\n\nfunction addInterval(treeNode: TreeNode, high: number, index: number): boolean {\n  let node: ListNode | null = treeNode.list;\n  let prevNode: ListNode | undefined;\n\n  while (node) {\n    if (node.index === index) return false;\n    if (high > node.high) break;\n    prevNode = node;\n    node = node.next;\n  }\n\n  if (!prevNode) treeNode.list = { index, high, next: node };\n  if (prevNode) prevNode.next = { index, high, next: prevNode.next };\n\n  return true;\n}\n\nfunction removeInterval(treeNode: TreeNode, index: number) {\n  let node: ListNode | null = treeNode.list;\n  if (node.index === index) {\n    if (node.next === null) return DELETE;\n    treeNode.list = node.next;\n    return KEEP;\n  }\n\n  let prevNode: ListNode | undefined = node;\n  node = node.next;\n\n  while (node !== null) {\n    if (node.index === index) {\n      prevNode.next = node.next;\n      return KEEP;\n    }\n    prevNode = node;\n    node = node.next;\n  }\n}\n\nconst NULL_NODE: TreeNode = {\n  low: 0,\n  max: 0,\n  high: 0,\n  C: NIL,\n  // @ts-expect-error\n  P: undefined,\n  // @ts-expect-error\n  R: undefined,\n  // @ts-expect-error\n  L: undefined,\n  // @ts-expect-error\n  list: undefined,\n};\n\nNULL_NODE.P = NULL_NODE;\nNULL_NODE.L = NULL_NODE;\nNULL_NODE.R = NULL_NODE;\n\nfunction updateMax(node: TreeNode) {\n  const max = node.high;\n  if (node.L === NULL_NODE && node.R === NULL_NODE) node.max = max;\n  else if (node.L === NULL_NODE) node.max = Math.max(node.R.max, max);\n  else if (node.R === NULL_NODE) node.max = Math.max(node.L.max, max);\n  else node.max = Math.max(Math.max(node.L.max, node.R.max), max);\n}\n\nfunction updateMaxUp(node: TreeNode) {\n  let x = node;\n\n  while (x.P !== NULL_NODE) {\n    updateMax(x.P);\n    x = x.P;\n  }\n}\n\nfunction rotateLeft(tree: Tree, x: TreeNode) {\n  if (x.R === NULL_NODE) return;\n  const y = x.R;\n  x.R = y.L;\n  if (y.L !== NULL_NODE) y.L.P = x;\n  y.P = x.P;\n\n  if (x.P === NULL_NODE) tree.root = y;\n  else if (x === x.P.L) x.P.L = y;\n  else x.P.R = y;\n\n  y.L = x;\n  x.P = y;\n\n  updateMax(x);\n  updateMax(y);\n}\n\nfunction rotateRight(tree: Tree, x: TreeNode) {\n  if (x.L === NULL_NODE) return;\n  const y = x.L;\n  x.L = y.R;\n  if (y.R !== NULL_NODE) y.R.P = x;\n  y.P = x.P;\n\n  if (x.P === NULL_NODE) tree.root = y;\n  else if (x === x.P.R) x.P.R = y;\n  else x.P.L = y;\n\n  y.R = x;\n  x.P = y;\n\n  updateMax(x);\n  updateMax(y);\n}\n\nfunction replaceNode(tree: Tree, x: TreeNode, y: TreeNode) {\n  if (x.P === NULL_NODE) tree.root = y;\n  else if (x === x.P.L) x.P.L = y;\n  else x.P.R = y;\n  y.P = x.P;\n}\n\nfunction fixRemove(tree: Tree, x: TreeNode) {\n  let w;\n\n  while (x !== NULL_NODE && x.C === BLACK) {\n    if (x === x.P.L) {\n      w = x.P.R;\n\n      if (w.C === RED) {\n        w.C = BLACK;\n        x.P.C = RED;\n        rotateLeft(tree, x.P);\n        w = x.P.R;\n      }\n\n      if (w.L.C === BLACK && w.R.C === BLACK) {\n        w.C = RED;\n        x = x.P;\n      } else {\n        if (w.R.C === BLACK) {\n          w.L.C = BLACK;\n          w.C = RED;\n          rotateRight(tree, w);\n          w = x.P.R;\n        }\n\n        w.C = x.P.C;\n        x.P.C = BLACK;\n        w.R.C = BLACK;\n        rotateLeft(tree, x.P);\n        x = tree.root;\n      }\n    } else {\n      w = x.P.L;\n\n      if (w.C === RED) {\n        w.C = BLACK;\n        x.P.C = RED;\n        rotateRight(tree, x.P);\n        w = x.P.L;\n      }\n\n      if (w.R.C === BLACK && w.L.C === BLACK) {\n        w.C = RED;\n        x = x.P;\n      } else {\n        if (w.L.C === BLACK) {\n          w.R.C = BLACK;\n          w.C = RED;\n          rotateLeft(tree, w);\n          w = x.P.L;\n        }\n\n        w.C = x.P.C;\n        x.P.C = BLACK;\n        w.L.C = BLACK;\n        rotateRight(tree, x.P);\n        x = tree.root;\n      }\n    }\n  }\n\n  x.C = BLACK;\n}\n\nfunction minimumTree(x: TreeNode) {\n  while (x.L !== NULL_NODE) x = x.L;\n  return x;\n}\n\nfunction fixInsert(tree: Tree, z: TreeNode) {\n  let y: TreeNode;\n  while (z.P.C === RED) {\n    if (z.P === z.P.P.L) {\n      y = z.P.P.R;\n\n      if (y.C === RED) {\n        z.P.C = BLACK;\n        y.C = BLACK;\n        z.P.P.C = RED;\n        z = z.P.P;\n      } else {\n        if (z === z.P.R) {\n          z = z.P;\n          rotateLeft(tree, z);\n        }\n\n        z.P.C = BLACK;\n        z.P.P.C = RED;\n        rotateRight(tree, z.P.P);\n      }\n    } else {\n      y = z.P.P.L;\n\n      if (y.C === RED) {\n        z.P.C = BLACK;\n        y.C = BLACK;\n        z.P.P.C = RED;\n        z = z.P.P;\n      } else {\n        if (z === z.P.L) {\n          z = z.P;\n          rotateRight(tree, z);\n        }\n\n        z.P.C = BLACK;\n        z.P.P.C = RED;\n        rotateLeft(tree, z.P.P);\n      }\n    }\n  }\n  tree.root.C = BLACK;\n}\n\nexport interface IIntervalTree {\n  insert(low: number, high: number, index: number): void;\n  remove(index: number): void;\n  search(\n    low: number,\n    high: number,\n    callback: (index: number, low: number) => any\n  ): void;\n  size: number;\n}\n\nexport function createIntervalTree(): IIntervalTree {\n  const tree = {\n    root: NULL_NODE,\n    size: 0,\n  };\n  // we know these indexes are a consistent, safe way to make look ups\n  // for our case so it's a solid O(1) alternative to\n  // the O(log n) searchNode() in typical interval trees\n  const indexMap: Record<number, TreeNode> = {};\n\n  return {\n    insert(low, high, index) {\n      let x: TreeNode = tree.root;\n      let y: TreeNode = NULL_NODE;\n\n      while (x !== NULL_NODE) {\n        y = x;\n        if (low === y.low) break;\n        if (low < x.low) x = x.L;\n        else x = x.R;\n      }\n\n      if (low === y.low && y !== NULL_NODE) {\n        if (!addInterval(y, high, index)) return;\n        y.high = Math.max(y.high, high);\n        updateMax(y);\n        updateMaxUp(y);\n        indexMap[index] = y;\n        tree.size++;\n        return;\n      }\n\n      const z: TreeNode = {\n        low,\n        high,\n        max: high,\n        C: RED,\n        P: y,\n        L: NULL_NODE,\n        R: NULL_NODE,\n        list: { index, high, next: null },\n      };\n\n      if (y === NULL_NODE) {\n        tree.root = z;\n      } else {\n        if (z.low < y.low) y.L = z;\n        else y.R = z;\n        updateMaxUp(z);\n      }\n\n      fixInsert(tree, z);\n      indexMap[index] = z;\n      tree.size++;\n    },\n\n    remove(index) {\n      const z = indexMap[index];\n      if (z === void 0) return;\n      delete indexMap[index];\n\n      const intervalResult = removeInterval(z, index);\n      if (intervalResult === void 0) return;\n      if (intervalResult === KEEP) {\n        z.high = z.list.high;\n        updateMax(z);\n        updateMaxUp(z);\n        tree.size--;\n        return;\n      }\n\n      let y = z;\n      let originalYColor = y.C;\n      let x: TreeNode;\n\n      if (z.L === NULL_NODE) {\n        x = z.R;\n        replaceNode(tree, z, z.R);\n      } else if (z.R === NULL_NODE) {\n        x = z.L;\n        replaceNode(tree, z, z.L);\n      } else {\n        y = minimumTree(z.R);\n        originalYColor = y.C;\n        x = y.R;\n\n        if (y.P === z) {\n          x.P = y;\n        } else {\n          replaceNode(tree, y, y.R);\n          y.R = z.R;\n          y.R.P = y;\n        }\n\n        replaceNode(tree, z, y);\n        y.L = z.L;\n        y.L.P = y;\n        y.C = z.C;\n      }\n\n      updateMax(x);\n      updateMaxUp(x);\n\n      if (originalYColor === BLACK) fixRemove(tree, x);\n      tree.size--;\n    },\n\n    search(low, high, callback) {\n      const stack = [tree.root];\n      while (stack.length !== 0) {\n        const node = stack.pop() as TreeNode;\n        if (node === NULL_NODE || low > node.max) continue;\n        if (node.L !== NULL_NODE) stack.push(node.L);\n        if (node.R !== NULL_NODE) stack.push(node.R);\n        if (node.low <= high && node.high >= low) {\n          let curr: ListNode | null = node.list;\n          while (curr !== null) {\n            if (curr.high >= low) callback(curr.index, node.low);\n            curr = curr.next;\n          }\n        }\n      }\n    },\n\n    get size() {\n      return tree.size;\n    },\n  };\n}\n","export const elementsCache: WeakMap<Element, number> = new WeakMap();\n","import * as React from \"react\";\n\nexport function useForceUpdate() {\n  const setState = React.useState(emptyObj)[1];\n  return React.useRef(() => setState({})).current;\n}\n\nconst emptyObj = {};\n","import memoizeOne from \"@essentials/memoize-one\";\nimport OneKeyMap from \"@essentials/one-key-map\";\nimport useLatest from \"@react-hook/latest\";\nimport * as React from \"react\";\nimport trieMemoize from \"trie-memoize\";\nimport { elementsCache } from \"./elements-cache\";\nimport { useForceUpdate } from \"./use-force-update\";\nimport type { Positioner } from \"./use-positioner\";\n\n/**\n * This hook handles the render phases of the masonry layout and returns the grid as a React element.\n *\n * @param options - Options for configuring the masonry layout renderer. See `UseMasonryOptions`.\n * @param options.positioner\n * @param options.resizeObserver\n * @param options.items\n * @param options.as\n * @param options.id\n * @param options.className\n * @param options.style\n * @param options.role\n * @param options.tabIndex\n * @param options.containerRef\n * @param options.itemAs\n * @param options.itemStyle\n * @param options.itemHeightEstimate\n * @param options.itemKey\n * @param options.overscanBy\n * @param options.scrollTop\n * @param options.isScrolling\n * @param options.height\n * @param options.render\n * @param options.onRender\n */\nexport function useMasonry<Item>({\n  // Measurement and layout\n  positioner,\n  resizeObserver,\n  // Grid items\n  items,\n  // Container props\n  as: ContainerComponent = \"div\",\n  id,\n  className,\n  style,\n  role = \"grid\",\n  tabIndex = 0,\n  containerRef,\n  // Item props\n  itemAs: ItemComponent = \"div\",\n  itemStyle,\n  itemHeightEstimate = 300,\n  itemKey = defaultGetItemKey,\n  // Rendering props\n  overscanBy = 2,\n  scrollTop,\n  isScrolling,\n  height,\n  render: RenderComponent,\n  onRender,\n}: UseMasonryOptions<Item>) {\n  let startIndex = 0;\n  let stopIndex: number | undefined;\n  const forceUpdate = useForceUpdate();\n  const setItemRef = getRefSetter(positioner, resizeObserver);\n  const itemCount = items.length;\n  const {\n    columnWidth,\n    columnCount,\n    range,\n    estimateHeight,\n    size,\n    shortestColumn,\n  } = positioner;\n  const measuredCount = size();\n  const shortestColumnSize = shortestColumn();\n  const children: React.ReactElement[] = [];\n  const itemRole =\n    role === \"list\" ? \"listitem\" : role === \"grid\" ? \"gridcell\" : undefined;\n  const storedOnRender = useLatest(onRender);\n\n  overscanBy = height * overscanBy;\n  const rangeEnd = scrollTop + overscanBy;\n  const needsFreshBatch =\n    shortestColumnSize < rangeEnd && measuredCount < itemCount;\n\n  range(\n    // We overscan in both directions because users scroll both ways,\n    // though one must admit scrolling down is more common and thus\n    // we only overscan by half the downward overscan amount\n    Math.max(0, scrollTop - overscanBy / 2),\n    rangeEnd,\n    (index, left, top) => {\n      const data = items[index];\n      const key = itemKey(data, index);\n      const phaseTwoStyle: React.CSSProperties = {\n        top,\n        left,\n        width: columnWidth,\n        writingMode: \"horizontal-tb\",\n        position: \"absolute\",\n      };\n\n      /* istanbul ignore next */\n      if (\n        typeof process !== \"undefined\" &&\n        process.env.NODE_ENV !== \"production\"\n      ) {\n        throwWithoutData(data, index);\n      }\n\n      children.push(\n        <ItemComponent\n          key={key}\n          ref={setItemRef(index)}\n          role={itemRole}\n          style={\n            typeof itemStyle === \"object\" && itemStyle !== null\n              ? Object.assign({}, phaseTwoStyle, itemStyle)\n              : phaseTwoStyle\n          }\n        >\n          {createRenderElement(RenderComponent, index, data, columnWidth)}\n        </ItemComponent>\n      );\n\n      if (stopIndex === void 0) {\n        startIndex = index;\n        stopIndex = index;\n      } else {\n        startIndex = Math.min(startIndex, index);\n        stopIndex = Math.max(stopIndex, index);\n      }\n    }\n  );\n\n  if (needsFreshBatch) {\n    const batchSize = Math.min(\n      itemCount - measuredCount,\n      Math.ceil(\n        ((scrollTop + overscanBy - shortestColumnSize) / itemHeightEstimate) *\n          columnCount\n      )\n    );\n\n    let index = measuredCount;\n    const phaseOneStyle = getCachedSize(columnWidth);\n\n    for (; index < measuredCount + batchSize; index++) {\n      const data = items[index];\n      const key = itemKey(data, index);\n\n      /* istanbul ignore next */\n      if (\n        typeof process !== \"undefined\" &&\n        process.env.NODE_ENV !== \"production\"\n      ) {\n        throwWithoutData(data, index);\n      }\n\n      children.push(\n        <ItemComponent\n          key={key}\n          ref={setItemRef(index)}\n          role={itemRole}\n          style={\n            typeof itemStyle === \"object\"\n              ? Object.assign({}, phaseOneStyle, itemStyle)\n              : phaseOneStyle\n          }\n        >\n          {createRenderElement(RenderComponent, index, data, columnWidth)}\n        </ItemComponent>\n      );\n    }\n  }\n\n  // Calls the onRender callback if the rendered indices changed\n  React.useEffect(() => {\n    if (typeof storedOnRender.current === \"function\" && stopIndex !== void 0)\n      storedOnRender.current(startIndex, stopIndex, items);\n\n    didEverMount = \"1\";\n  }, [startIndex, stopIndex, items, storedOnRender]);\n  // If we needed a fresh batch we should reload our components with the measured\n  // sizes\n  React.useEffect(() => {\n    if (needsFreshBatch) forceUpdate();\n    // eslint-disable-next-line\n  }, [needsFreshBatch, positioner]);\n\n  // gets the container style object based upon the estimated height and whether or not\n  // the page is being scrolled\n  const containerStyle = getContainerStyle(\n    isScrolling,\n    estimateHeight(itemCount, itemHeightEstimate)\n  );\n\n  return (\n    <ContainerComponent\n      ref={containerRef}\n      key={didEverMount}\n      id={id}\n      role={role}\n      className={className}\n      tabIndex={tabIndex}\n      style={\n        typeof style === \"object\"\n          ? assignUserStyle(containerStyle, style)\n          : containerStyle\n      }\n      children={children}\n    />\n  );\n}\n\n/* istanbul ignore next */\nfunction throwWithoutData(data: any, index: number) {\n  if (!data) {\n    throw new Error(\n      `No data was found at index: ${index}\\n\\n` +\n        `This usually happens when you've mutated or changed the \"items\" array in a ` +\n        `way that makes it shorter than the previous \"items\" array. Masonic knows nothing ` +\n        `about your underlying data and when it caches cell positions, it assumes you aren't ` +\n        `mutating the underlying \"items\".\\n\\n` +\n        `See https://codesandbox.io/s/masonic-w-react-router-example-2b5f9?file=/src/index.js for ` +\n        `an example that gets around this limitations. For advanced implementations, see ` +\n        `https://codesandbox.io/s/masonic-w-react-router-and-advanced-config-example-8em42?file=/src/index.js\\n\\n` +\n        `If this was the result of your removing an item from your \"items\", see this issue: ` +\n        `https://github.com/jaredLunde/masonic/issues/12`\n    );\n  }\n}\n\n// This is for triggering a remount after SSR has loaded in the client w/ hydrate()\nlet didEverMount = \"0\";\n\nexport interface UseMasonryOptions<Item> {\n  /**\n   * An array containing the data used by the grid items.\n   */\n  items: Item[];\n  /**\n   * A grid cell positioner and cache created by the `usePositioner()` hook or\n   * the `createPositioner` utility.\n   */\n  positioner: Positioner;\n  /**\n   * A resize observer that tracks mutations to the grid cells and forces the\n   * Masonry grid to recalculate its layout if any cells affect column heights\n   * change. Check out the `useResizeObserver()` hook.\n   */\n  resizeObserver?: {\n    observe: ResizeObserver[\"observe\"];\n    disconnect: ResizeObserver[\"observe\"];\n    unobserve: ResizeObserver[\"unobserve\"];\n  };\n  /**\n   * This is the type of element the grid container will be rendered as.\n   *\n   * @default \"div\"`\n   */\n  as?: keyof JSX.IntrinsicElements | React.ComponentType<any>;\n  /**\n   * Optionally gives the grid container an `id` prop.\n   */\n  id?: string;\n  /**\n   * Optionally gives the grid container a `className` prop.\n   */\n  className?: string;\n  /**\n   * Adds extra `style` attributes to the container in addition to those\n   * created by the `useMasonry()` hook.\n   */\n  style?: React.CSSProperties;\n  /**\n   * Optionally swap out the accessibility `role` prop of the container and its items.\n   *\n   * @default \"grid\"\n   */\n  role?: \"grid\" | \"list\";\n  /**\n   * Change the `tabIndex` of the grid container.\n   *\n   * @default 0\n   */\n  tabIndex?: number;\n  /**\n   * Forwards a React ref to the grid container.\n   */\n  containerRef?:\n    | ((element: HTMLElement) => void)\n    | React.MutableRefObject<HTMLElement | null>;\n  /**\n   * This is the type of element the grid items will be rendered as.\n   *\n   * @default \"div\"\n   */\n  itemAs?: keyof JSX.IntrinsicElements | React.ComponentType<any>;\n  /**\n   * Adds extra `style` attributes to the grid items in addition to those\n   * created by the `useMasonry()` hook.\n   */\n  itemStyle?: React.CSSProperties;\n  /**\n   * This value is used for estimating the initial height of the masonry grid. It is important for\n   * the UX of the scrolling behavior and in determining how many `items` to render in a batch, so it's\n   * wise to set this value with some level accuracy, though it doesn't need to be perfect.\n   *\n   * @default 300\n   */\n  itemHeightEstimate?: number;\n  /**\n   * The value returned here must be unique to the item. By default, the key is the item's index. This is ok\n   * if your collection of items is never modified. Setting this property ensures that the component in `render`\n   * is reused each time the masonry grid is reflowed. A common pattern would be to return the item's database\n   * ID here if there is one, e.g. `data => data.id`\n   *\n   * @default (data, index) => index`\n   */\n  itemKey?: (data: Item, index: number) => string | number;\n  /**\n   * This number is used for determining the number of grid cells outside of the visible window to render.\n   * The default value is `2` which means \"render 2 windows worth (2 * `height`) of content before and after\n   * the items in the visible window\". A value of `3` would be 3 windows worth of grid cells, so it's a\n   * linear relationship.\n   *\n   * Overscanning is important for preventing tearing when scrolling through items in the grid, but setting\n   * too high of a vaimport { useForceUpdate } from './use-force-update';\nlue may create too much work for React to handle, so it's best that you tune this\n   * value accordingly.\n   *\n   * @default 2\n   */\n  overscanBy?: number;\n\n  /**\n   * This is the height of the window. If you're rendering the grid relative to the browser `window`,\n   * the current `document.documentElement.clientHeight` is the value you'll want to set here. If you're\n   * rendering the grid inside of another HTML element, you'll want to provide the current `element.offsetHeight`\n   * here.\n   */\n  height: number;\n  /**\n   * The current scroll progress in pixel of the window the grid is rendered in. If you're rendering\n   * the grid relative to the browser `window`, you'll want the most current `window.scrollY` here.\n   * If you're rendering the grid inside of another HTML element, you'll want the current `element.scrollTop`\n   * value here. The `useScroller()` hook and `<MasonryScroller>` components will help you if you're\n   * rendering the grid relative to the browser `window`.\n   */\n  scrollTop: number;\n  /**\n   * This property is used for determining whether or not the grid container should add styles that\n   * dramatically increase scroll performance. That is, turning off `pointer-events` and adding a\n   * `will-change: contents;` value to the style string. You can forgo using this prop, but I would\n   * not recommend that. The `useScroller()` hook and `<MasonryScroller>` components will help you if\n   * you're rendering the grid relative to the browser `window`.\n   *\n   * @default false\n   */\n  isScrolling?: boolean;\n  /**\n   * This component is rendered for each item of your `items` prop array. It should accept three props:\n   * `index`, `width`, and `data`. See RenderComponentProps.\n   */\n  render: React.ComponentType<RenderComponentProps<Item>>;\n  /**\n   * This callback is invoked any time the items currently being rendered by the grid change.\n   */\n  onRender?: (startIndex: number, stopIndex: number, items: Item[]) => void;\n}\n\nexport interface RenderComponentProps<Item> {\n  /**\n   * The index of the cell in the `items` prop array.\n   */\n  index: number;\n  /**\n   * The rendered width of the cell's column.\n   */\n  width: number;\n  /**\n   * The data at `items[index]` of your `items` prop array.\n   */\n  data: Item;\n}\n\n//\n// Render-phase utilities\n\n// ~5.5x faster than createElement without the memo\nconst createRenderElement = trieMemoize(\n  [OneKeyMap, {}, WeakMap, OneKeyMap],\n  (RenderComponent, index, data, columnWidth) => (\n    <RenderComponent index={index} data={data} width={columnWidth} />\n  )\n);\n\nconst getContainerStyle = memoizeOne(\n  (isScrolling: boolean | undefined, estimateHeight: number) => ({\n    position: \"relative\",\n    width: \"100%\",\n    maxWidth: \"100%\",\n    height: Math.ceil(estimateHeight),\n    maxHeight: Math.ceil(estimateHeight),\n    willChange: isScrolling ? \"contents\" : void 0,\n    pointerEvents: isScrolling ? \"none\" : void 0,\n  })\n);\n\nconst cmp2 = (args: IArguments, pargs: IArguments | any[]): boolean =>\n  args[0] === pargs[0] && args[1] === pargs[1];\n\nconst assignUserStyle = memoizeOne(\n  (containerStyle, userStyle) => Object.assign({}, containerStyle, userStyle),\n  // @ts-expect-error\n  cmp2\n);\n\nfunction defaultGetItemKey<Item>(_: Item, i: number) {\n  return i;\n}\n\n// the below memoizations for for ensuring shallow equal is reliable for pure\n// component children\nconst getCachedSize = memoizeOne(\n  (width: number): React.CSSProperties => ({\n    width,\n    zIndex: -1000,\n    visibility: \"hidden\",\n    position: \"absolute\",\n    writingMode: \"horizontal-tb\",\n  }),\n  (args, pargs) => args[0] === pargs[0]\n);\n\nconst getRefSetter = memoizeOne(\n  (\n      positioner: Positioner,\n      resizeObserver?: UseMasonryOptions<any>[\"resizeObserver\"]\n    ) =>\n    (index: number) =>\n    (el: HTMLElement | null): void => {\n      if (el === null) return;\n      if (resizeObserver) {\n        resizeObserver.observe(el);\n        elementsCache.set(el, index);\n      }\n      if (positioner.get(index) === void 0)\n        positioner.set(index, el.offsetHeight);\n    },\n  // @ts-expect-error\n  cmp2\n);\n","import {\n  clearRequestTimeout,\n  requestTimeout,\n} from \"@essentials/request-timeout\";\nimport useScrollPosition from \"@react-hook/window-scroll\";\nimport * as React from \"react\";\n\n/**\n * A hook for tracking whether the `window` is currently being scrolled and it's scroll position on\n * the y-axis. These values are used for determining which grid cells to render and when\n * to add styles to the masonry container that maximize scroll performance.\n *\n * @param offset - The vertical space in pixels between the top of the grid container and the top\n *  of the browser `document.documentElement`.\n * @param fps - This determines how often (in frames per second) to update the scroll position of the\n *  browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\n *  The default value of `12` has been very reasonable in my own testing, but if you have particularly\n *  heavy `render` components it may be prudent to reduce this number.\n */\nexport function useScroller(\n  offset = 0,\n  fps = 12\n): { scrollTop: number; isScrolling: boolean } {\n  const scrollTop = useScrollPosition(fps);\n  const [isScrolling, setIsScrolling] = React.useState(false);\n  const didMount = React.useRef(0);\n\n  React.useEffect(() => {\n    if (didMount.current === 1) setIsScrolling(true);\n    let didUnsubscribe = false;\n    const to = requestTimeout(() => {\n      if (didUnsubscribe) return;\n      // This is here to prevent premature bail outs while maintaining high resolution\n      // unsets. Without it there will always bee a lot of unnecessary DOM writes to style.\n      setIsScrolling(false);\n    }, 40 + 1000 / fps);\n    didMount.current = 1;\n    return () => {\n      didUnsubscribe = true;\n      clearRequestTimeout(to);\n    };\n  }, [fps, scrollTop]);\n\n  return { scrollTop: Math.max(0, scrollTop - offset), isScrolling };\n}\n","import { useMasonry } from \"./use-masonry\";\nimport type { UseMasonryOptions } from \"./use-masonry\";\nimport { useScroller } from \"./use-scroller\";\n/**\n * A heavily-optimized component that updates `useMasonry()` when the scroll position of the browser `window`\n * changes. This bare-metal component is used by `<Masonry>` under the hood.\n *\n * @param props\n */\nexport function MasonryScroller<Item>(props: MasonryScrollerProps<Item>) {\n  // We put this in its own layer because it's the thing that will trigger the most updates\n  // and we don't want to slower ourselves by cycling through all the functions, objects, and effects\n  // of other hooks\n  const { scrollTop, isScrolling } = useScroller(props.offset, props.scrollFps);\n  // This is an update-heavy phase and while we could just Object.assign here,\n  // it is way faster to inline and there's a relatively low hit to he bundle\n  // size.\n  return useMasonry<Item>({\n    scrollTop,\n    isScrolling,\n    positioner: props.positioner,\n    resizeObserver: props.resizeObserver,\n    items: props.items,\n    onRender: props.onRender,\n    as: props.as,\n    id: props.id,\n    className: props.className,\n    style: props.style,\n    role: props.role,\n    tabIndex: props.tabIndex,\n    containerRef: props.containerRef,\n    itemAs: props.itemAs,\n    itemStyle: props.itemStyle,\n    itemHeightEstimate: props.itemHeightEstimate,\n    itemKey: props.itemKey,\n    overscanBy: props.overscanBy,\n    height: props.height,\n    render: props.render,\n  });\n}\n\nexport interface MasonryScrollerProps<Item>\n  extends Omit<UseMasonryOptions<Item>, \"scrollTop\" | \"isScrolling\"> {\n  /**\n   * This determines how often (in frames per second) to update the scroll position of the\n   * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\n   * The default value of `12` has been very reasonable in my own testing, but if you have particularly\n   * heavy `render` components it may be prudent to reduce this number.\n   *\n   * @default 12\n   */\n  scrollFps?: number;\n  /**\n   * The vertical space in pixels between the top of the grid container and the top\n   * of the browser `document.documentElement`.\n   *\n   * @default 0\n   */\n  offset?: number;\n}\n\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n  MasonryScroller.displayName = \"MasonryScroller\";\n}\n","import useLayoutEffect from \"@react-hook/passive-layout-effect\";\nimport * as React from \"react\";\n\n/**\n * A hook for measuring the width of the grid container, as well as its distance\n * from the top of the document. These values are necessary to correctly calculate the number/width\n * of columns to render, as well as the number of rows to render.\n *\n * @param elementRef - A `ref` object created by `React.useRef()`. That ref should be provided to the\n *   `containerRef` property in `useMasonry()`.\n * @param deps - You can force this hook to recalculate the `offset` and `width` whenever this\n *   dependencies list changes. A common dependencies list might look like `[windowWidth, windowHeight]`,\n *   which would force the hook to recalculate any time the size of the browser `window` changed.\n */\nexport function useContainerPosition(\n  elementRef: React.MutableRefObject<HTMLElement | null>,\n  deps: React.DependencyList = emptyArr\n): ContainerPosition {\n  const [containerPosition, setContainerPosition] =\n    React.useState<ContainerPosition>({ offset: 0, width: 0 });\n\n  useLayoutEffect(() => {\n    const { current } = elementRef;\n    if (current !== null) {\n      let offset = 0;\n      let el = current;\n\n      do {\n        offset += el.offsetTop || 0;\n        el = el.offsetParent as HTMLElement;\n      } while (el);\n\n      if (\n        offset !== containerPosition.offset ||\n        current.offsetWidth !== containerPosition.width\n      ) {\n        setContainerPosition({\n          offset,\n          width: current.offsetWidth,\n        });\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, deps);\n\n  return containerPosition;\n}\n\nexport interface ContainerPosition {\n  /**\n   * The distance in pixels between the top of the element in `elementRef` and the top of\n   * the `document.documentElement`.\n   */\n  offset: number;\n  /**\n   * The `offsetWidth` of the element in `elementRef`.\n   */\n  width: number;\n}\n\nconst emptyArr: [] = [];\n","import * as React from \"react\";\nimport { createIntervalTree } from \"./interval-tree\";\n\n/**\n * This hook creates the grid cell positioner and cache required by `useMasonry()`. This is\n * the meat of the grid's layout algorithm, determining which cells to render at a given scroll\n * position, as well as where to place new items in the grid.\n *\n * @param options - Properties that determine the number of columns in the grid, as well\n *  as their widths.\n * @param options.columnWidth\n * @param options.width\n * @param deps - This hook will create a new positioner, clearing all existing cached positions,\n *  whenever the dependencies in this list change.\n * @param options.columnGutter\n * @param options.rowGutter\n * @param options.columnCount\n * @param options.maxColumnCount\n * @param options.maxColumnWidth\n */\nexport function usePositioner(\n  {\n    width,\n    columnWidth = 200,\n    columnGutter = 0,\n    rowGutter,\n    columnCount,\n    maxColumnCount,\n    maxColumnWidth,\n  }: UsePositionerOptions,\n  deps: React.DependencyList = emptyArr\n): Positioner {\n  const initPositioner = (): Positioner => {\n    const [computedColumnWidth, computedColumnCount] = getColumns(\n      width,\n      columnWidth,\n      columnGutter,\n      columnCount,\n      maxColumnCount,\n      maxColumnWidth\n    );\n    return createPositioner(\n      computedColumnCount,\n      computedColumnWidth,\n      columnGutter,\n      rowGutter ?? columnGutter\n    );\n  };\n  const positionerRef = React.useRef<Positioner>();\n  if (positionerRef.current === undefined)\n    positionerRef.current = initPositioner();\n\n  const prevDeps = React.useRef(deps);\n  const opts = [\n    width,\n    columnWidth,\n    columnGutter,\n    rowGutter,\n    columnCount,\n    maxColumnCount,\n    maxColumnWidth,\n  ];\n  const prevOpts = React.useRef(opts);\n  const optsChanged = !opts.every((item, i) => prevOpts.current[i] === item);\n\n  if (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n    if (deps.length !== prevDeps.current.length) {\n      throw new Error(\n        \"usePositioner(): The length of your dependencies array changed.\"\n      );\n    }\n  }\n\n  // Create a new positioner when the dependencies or sizes change\n  // Thanks to https://github.com/khmm12 for pointing this out\n  // https://github.com/jaredLunde/masonic/pull/41\n  if (optsChanged || !deps.every((item, i) => prevDeps.current[i] === item)) {\n    const prevPositioner = positionerRef.current;\n    const positioner = initPositioner();\n    prevDeps.current = deps;\n    prevOpts.current = opts;\n\n    if (optsChanged) {\n      const cacheSize = prevPositioner.size();\n      for (let index = 0; index < cacheSize; index++) {\n        const pos = prevPositioner.get(index);\n        positioner.set(index, pos !== void 0 ? pos.height : 0);\n      }\n    }\n\n    positionerRef.current = positioner;\n  }\n\n  return positionerRef.current;\n}\n\nexport interface UsePositionerOptions {\n  /**\n   * The width of the container you're rendering the grid within, i.e. the container\n   * element's `element.offsetWidth`\n   */\n  width: number;\n  /**\n   * The minimum column width. The `usePositioner()` hook will automatically size the\n   * columns to fill their container based upon the `columnWidth` and `columnGutter` values.\n   * It will never render anything smaller than this width unless its container itself is\n   * smaller than its value. This property is optional if you're using a static `columnCount`.\n   *\n   * @default 200\n   */\n  columnWidth?: number;\n  /**\n   * The maximum column width. Calculated column widths will be capped at this value.\n   */\n  maxColumnWidth?: number;\n  /**\n   * This sets the horizontal space between grid columns in pixels. If `rowGutter` is not set, this\n   * also sets the vertical space between cells within a column in pixels.\n   *\n   * @default 0\n   */\n  columnGutter?: number;\n  /**\n   * This sets the vertical space between cells within a column in pixels. If not set, the value of\n   * `columnGutter` is used instead.\n   */\n  rowGutter?: number;\n  /**\n   * By default, `usePositioner()` derives the column count from the `columnWidth`, `columnGutter`,\n   * and `width` props. However, in some situations it is nice to be able to override that behavior\n   * (e.g. creating a `List` component).\n   */\n  columnCount?: number;\n  /**\n   * The upper bound of column count. This property won't work if `columnCount` is set.\n   */\n  maxColumnCount?: number;\n}\n\n/**\n * Creates a cell positioner for the `useMasonry()` hook. The `usePositioner()` hook uses\n * this utility under the hood.\n *\n * @param columnCount - The number of columns in the grid\n * @param columnWidth - The width of each column in the grid\n * @param columnGutter - The amount of horizontal space between columns in pixels.\n * @param rowGutter - The amount of vertical space between cells within a column in pixels (falls back\n * to `columnGutter`).\n */\nexport const createPositioner = (\n  columnCount: number,\n  columnWidth: number,\n  columnGutter = 0,\n  rowGutter = columnGutter\n): Positioner => {\n  // O(log(n)) lookup of cells to render for a given viewport size\n  // Store tops and bottoms of each cell for fast intersection lookup.\n  const intervalTree = createIntervalTree();\n  // Track the height of each column.\n  // Layout algorithm below always inserts into the shortest column.\n  const columnHeights: number[] = new Array(columnCount);\n  // Used for O(1) item access\n  const items: PositionerItem[] = [];\n  // Tracks the item indexes within an individual column\n  const columnItems: number[][] = new Array(columnCount);\n\n  for (let i = 0; i < columnCount; i++) {\n    columnHeights[i] = 0;\n    columnItems[i] = [];\n  }\n\n  return {\n    columnCount,\n    columnWidth,\n    set: (index, height = 0) => {\n      let column = 0;\n\n      // finds the shortest column and uses it\n      for (let i = 1; i < columnHeights.length; i++) {\n        if (columnHeights[i] < columnHeights[column]) column = i;\n      }\n\n      const top = columnHeights[column] || 0;\n      columnHeights[column] = top + height + rowGutter;\n      columnItems[column].push(index);\n      items[index] = {\n        left: column * (columnWidth + columnGutter),\n        top,\n        height,\n        column,\n      };\n      intervalTree.insert(top, top + height, index);\n    },\n    get: (index) => items[index],\n    // This only updates items in the specific columns that have changed, on and after the\n    // specific items that have changed\n    update: (updates) => {\n      const columns: number[] = new Array(columnCount);\n      let i = 0,\n        j = 0;\n\n      // determines which columns have items that changed, as well as the minimum index\n      // changed in that column, as all items after that index will have their positions\n      // affected by the change\n      for (; i < updates.length - 1; i++) {\n        const index = updates[i];\n        const item = items[index];\n        item.height = updates[++i];\n        intervalTree.remove(index);\n        intervalTree.insert(item.top, item.top + item.height, index);\n        columns[item.column] =\n          columns[item.column] === void 0\n            ? index\n            : Math.min(index, columns[item.column]);\n      }\n\n      for (i = 0; i < columns.length; i++) {\n        // bails out if the column didn't change\n        if (columns[i] === void 0) continue;\n        const itemsInColumn = columnItems[i];\n        // the index order is sorted with certainty so binary search is a great solution\n        // here as opposed to Array.indexOf()\n        const startIndex = binarySearch(itemsInColumn, columns[i]);\n        const index = columnItems[i][startIndex];\n        const startItem = items[index];\n        columnHeights[i] = startItem.top + startItem.height + rowGutter;\n\n        for (j = startIndex + 1; j < itemsInColumn.length; j++) {\n          const index = itemsInColumn[j];\n          const item = items[index];\n          item.top = columnHeights[i];\n          columnHeights[i] = item.top + item.height + rowGutter;\n          intervalTree.remove(index);\n          intervalTree.insert(item.top, item.top + item.height, index);\n        }\n      }\n    },\n    // Render all cells visible within the viewport range defined.\n    range: (lo, hi, renderCallback) =>\n      intervalTree.search(lo, hi, (index, top) =>\n        renderCallback(index, items[index].left, top)\n      ),\n    estimateHeight: (itemCount, defaultItemHeight): number => {\n      const tallestColumn = Math.max(0, Math.max.apply(null, columnHeights));\n\n      return itemCount === intervalTree.size\n        ? tallestColumn\n        : tallestColumn +\n            Math.ceil((itemCount - intervalTree.size) / columnCount) *\n              defaultItemHeight;\n    },\n    shortestColumn: () => {\n      if (columnHeights.length > 1) return Math.min.apply(null, columnHeights);\n      return columnHeights[0] || 0;\n    },\n    size(): number {\n      return intervalTree.size;\n    },\n    all(): PositionerItem[] {\n      return items;\n    },\n  };\n};\n\nexport interface Positioner {\n  /**\n   * The number of columns in the grid\n   */\n  columnCount: number;\n  /**\n   * The width of each column in the grid\n   */\n  columnWidth: number;\n  /**\n   * Sets the position for the cell at `index` based upon the cell's height\n   */\n  set: (index: number, height: number) => void;\n  /**\n   * Gets the `PositionerItem` for the cell at `index`\n   */\n  get: (index: number) => PositionerItem | undefined;\n  /**\n   * Updates cells based on their indexes and heights\n   * positioner.update([index, height, index, height, index, height...])\n   */\n  update: (updates: number[]) => void;\n  /**\n   * Searches the interval tree for grid cells with a `top` value in\n   * betwen `lo` and `hi` and invokes the callback for each item that\n   * is discovered\n   */\n  range: (\n    lo: number,\n    hi: number,\n    renderCallback: (index: number, left: number, top: number) => void\n  ) => void;\n  /**\n   * Returns the number of grid cells in the cache\n   */\n\n  size: () => number;\n  /**\n   * Estimates the total height of the grid\n   */\n\n  estimateHeight: (itemCount: number, defaultItemHeight: number) => number;\n  /**\n   * Returns the height of the shortest column in the grid\n   */\n\n  shortestColumn: () => number;\n  /**\n   * Returns all `PositionerItem` items\n   */\n  all: () => PositionerItem[];\n}\n\nexport interface PositionerItem {\n  /**\n   * This is how far from the top edge of the grid container in pixels the\n   * item is placed\n   */\n  top: number;\n  /**\n   * This is how far from the left edge of the grid container in pixels the\n   * item is placed\n   */\n  left: number;\n  /**\n   * This is the height of the grid cell\n   */\n  height: number;\n  /**\n   * This is the column number containing the grid cell\n   */\n  column: number;\n}\n\n/* istanbul ignore next */\nconst binarySearch = (a: number[], y: number): number => {\n  let l = 0;\n  let h = a.length - 1;\n\n  while (l <= h) {\n    const m = (l + h) >>> 1;\n    const x = a[m];\n    if (x === y) return m;\n    else if (x <= y) l = m + 1;\n    else h = m - 1;\n  }\n\n  return -1;\n};\n\nconst getColumns = (\n  width = 0,\n  minimumWidth = 0,\n  gutter = 8,\n  columnCount?: number,\n  maxColumnCount?: number,\n  maxColumnWidth?: number\n): [number, number] => {\n  columnCount =\n    columnCount ||\n    Math.min(\n      Math.floor((width + gutter) / (minimumWidth + gutter)),\n      maxColumnCount || Infinity\n    ) ||\n    1;\n  let columnWidth = Math.floor(\n    (width - gutter * (columnCount - 1)) / columnCount\n  );\n\n  // Cap the column width if maxColumnWidth is specified\n  if (maxColumnWidth !== undefined && columnWidth > maxColumnWidth) {\n    columnWidth = maxColumnWidth;\n  }\n\n  return [columnWidth, columnCount];\n};\n\nconst emptyArr: [] = [];\n","import rafSchd from \"raf-schd\";\nimport * as React from \"react\";\nimport trieMemoize from \"trie-memoize\";\nimport { elementsCache } from \"./elements-cache\";\nimport { useForceUpdate } from \"./use-force-update\";\nimport type { Positioner } from \"./use-positioner\";\n\n/**\n * Creates a resize observer that forces updates to the grid cell positions when mutations are\n * made to cells affecting their height.\n *\n * @param positioner - The masonry cell positioner created by the `usePositioner()` hook.\n */\nexport function useResizeObserver(positioner: Positioner) {\n  const forceUpdate = useForceUpdate();\n  const resizeObserver = createResizeObserver(positioner, forceUpdate);\n  // Cleans up the resize observers when they change or the\n  // component unmounts\n  React.useEffect(() => () => resizeObserver.disconnect(), [resizeObserver]);\n  return resizeObserver;\n}\n\nconst _handlerForType = rafSchd((target: HTMLElement) => {});\n\ntype IHandler = typeof _handlerForType;\n\n/**\n * Creates a resize observer that fires an `updater` callback whenever the height of\n * one or many cells change. The `useResizeObserver()` hook is using this under the hood.\n *\n * @param positioner - A cell positioner created by the `usePositioner()` hook or the `createPositioner()` utility\n * @param updater - A callback that fires whenever one or many cell heights change.\n */\nexport const createResizeObserver = trieMemoize(\n  [WeakMap],\n  // TODO: figure out a way to test this\n  /* istanbul ignore next */\n  (positioner: Positioner, updater: (updates: number[]) => void) => {\n    const updates: number[] = [];\n\n    const update = rafSchd(() => {\n      if (updates.length > 0) {\n        // Updates the size/positions of the cell with the resize\n        // observer updates\n        positioner.update(updates);\n        updater(updates);\n      }\n      updates.length = 0;\n    });\n\n    const commonHandler = (target: HTMLElement) => {\n      const height = target.offsetHeight;\n      if (height > 0) {\n        const index = elementsCache.get(target);\n        if (index !== void 0) {\n          const position = positioner.get(index);\n          if (position !== void 0 && height !== position.height)\n            updates.push(index, height);\n        }\n      }\n      update();\n    };\n\n    const handlers = new Map<number, IHandler>();\n    const handleEntries: ResizeObserverCallback = (entries) => {\n      let i = 0;\n\n      for (; i < entries.length; i++) {\n        const entry = entries[i];\n        const index = elementsCache.get(entry.target);\n\n        if (index === void 0) continue;\n        let handler = handlers.get(index);\n        if (!handler) {\n          handler = rafSchd(commonHandler);\n          handlers.set(index, handler);\n        }\n        handler(entry.target as HTMLElement);\n      }\n    };\n\n    const ro = new ResizeObserver(handleEntries);\n    // Overrides the original disconnect to include cancelling handling the entries.\n    // Ideally this would be its own method but that would result in a breaking\n    // change.\n    const disconnect = ro.disconnect.bind(ro);\n    ro.disconnect = () => {\n      disconnect();\n      handlers.forEach((handler) => {\n        handler.cancel();\n      });\n    };\n\n    return ro;\n  }\n);\n","import useEvent from \"@react-hook/event\";\nimport useLatest from \"@react-hook/latest\";\nimport { useThrottleCallback } from \"@react-hook/throttle\";\nimport * as React from \"react\";\nimport type { Positioner, PositionerItem } from \"./use-positioner\";\n\n/**\n * A hook that creates a callback for scrolling to a specific index in\n * the \"items\" array.\n *\n * @param positioner - A positioner created by the `usePositioner()` hook\n * @param options - Configuration options\n */\nexport function useScrollToIndex(\n  positioner: Positioner,\n  options: UseScrollToIndexOptions\n) {\n  const {\n    align = \"top\",\n    element = typeof window !== \"undefined\" && window,\n    offset = 0,\n    height = typeof window !== \"undefined\" ? window.innerHeight : 0,\n  } = options;\n  const latestOptions = useLatest({\n    positioner,\n    element,\n    align,\n    offset,\n    height,\n  } as const);\n  const getTarget = React.useRef(() => {\n    const latestElement = latestOptions.current.element;\n    return latestElement && \"current\" in latestElement\n      ? latestElement.current\n      : latestElement;\n  }).current;\n  const [state, dispatch] = React.useReducer(\n    (\n      state: {\n        position: PositionerItem | undefined;\n        index: number | undefined;\n        prevTop: number | undefined;\n      },\n      action:\n        | { type: \"scrollToIndex\"; value: number | undefined }\n        | { type: \"setPosition\"; value: PositionerItem | undefined }\n        | { type: \"setPrevTop\"; value: number | undefined }\n        | { type: \"reset\" }\n    ) => {\n      const nextState = {\n        position: state.position,\n        index: state.index,\n        prevTop: state.prevTop,\n      };\n\n      /* istanbul ignore next */\n      if (action.type === \"scrollToIndex\") {\n        return {\n          position: latestOptions.current.positioner.get(action.value ?? -1),\n          index: action.value,\n          prevTop: void 0,\n        };\n      } else if (action.type === \"setPosition\") {\n        nextState.position = action.value;\n      } else if (action.type === \"setPrevTop\") {\n        nextState.prevTop = action.value;\n      } else if (action.type === \"reset\") {\n        return defaultState;\n      }\n\n      return nextState;\n    },\n    defaultState\n  );\n  const throttledDispatch = useThrottleCallback(dispatch, 15);\n\n  // If we find the position along the way we can immediately take off\n  // to the correct spot.\n  useEvent(getTarget() as Window, \"scroll\", () => {\n    if (!state.position && state.index) {\n      const position = latestOptions.current.positioner.get(state.index);\n\n      if (position) {\n        dispatch({ type: \"setPosition\", value: position });\n      }\n    }\n  });\n\n  // If the top changes out from under us in the case of dynamic cells, we\n  // want to keep following it.\n  const currentTop =\n    state.index !== void 0 &&\n    latestOptions.current.positioner.get(state.index)?.top;\n\n  React.useEffect(() => {\n    const target = getTarget();\n    if (!target) return;\n    const { height, align, offset, positioner } = latestOptions.current;\n\n    if (state.position) {\n      let scrollTop = state.position.top;\n\n      if (align === \"bottom\") {\n        scrollTop = scrollTop - height + state.position.height;\n      } else if (align === \"center\") {\n        scrollTop -= (height - state.position.height) / 2;\n      }\n\n      target.scrollTo(0, Math.max(0, (scrollTop += offset)));\n      // Resets state after 400ms, an arbitrary time I determined to be\n      // still visually pleasing if there is a slow network reply in dynamic\n      // cells\n      let didUnsubscribe = false;\n      const timeout = setTimeout(\n        () => !didUnsubscribe && dispatch({ type: \"reset\" }),\n        400\n      );\n      return () => {\n        didUnsubscribe = true;\n        clearTimeout(timeout);\n      };\n    } else if (state.index !== void 0) {\n      // Estimates the top based upon the average height of current cells\n      let estimatedTop =\n        (positioner.shortestColumn() / positioner.size()) * state.index;\n      if (state.prevTop)\n        estimatedTop = Math.max(estimatedTop, state.prevTop + height);\n      target.scrollTo(0, estimatedTop);\n      throttledDispatch({ type: \"setPrevTop\", value: estimatedTop });\n    }\n  }, [currentTop, state, latestOptions, getTarget, throttledDispatch]);\n\n  return React.useRef((index: number) => {\n    dispatch({ type: \"scrollToIndex\", value: index });\n  }).current;\n}\n\nconst defaultState = {\n  index: void 0,\n  position: void 0,\n  prevTop: void 0,\n} as const;\n\nexport type UseScrollToIndexOptions = {\n  /**\n   * The window element or a React ref for the window element. That is,\n   * this is the grid container.\n   *\n   * @default window\n   */\n  element?: Window | HTMLElement | React.RefObject<HTMLElement> | null;\n  /**\n   * Sets the vertical alignment of the cell within the grid container.\n   *\n   * @default \"top\"\n   */\n  align?: \"center\" | \"top\" | \"bottom\";\n  /**\n   * The height of the grid.\n   *\n   * @default window.innerHeight\n   */\n  height?: number;\n  /**\n   * The vertical space in pixels between the top of the grid container and the top\n   * of the window.\n   *\n   * @default 0\n   */\n  offset?: number;\n};\n","import { useWindowSize } from \"@react-hook/window-size\";\nimport * as React from \"react\";\nimport { MasonryScroller } from \"./masonry-scroller\";\nimport type { MasonryScrollerProps } from \"./masonry-scroller\";\nimport { useContainerPosition } from \"./use-container-position\";\nimport { usePositioner } from \"./use-positioner\";\nimport type { UsePositionerOptions } from \"./use-positioner\";\nimport { useResizeObserver } from \"./use-resize-observer\";\nimport { useScrollToIndex } from \"./use-scroll-to-index\";\nimport type { UseScrollToIndexOptions } from \"./use-scroll-to-index\";\n\n/**\n * A \"batteries included\" masonry grid which includes all of the implementation details below. This component is the\n * easiest way to get off and running in your app, before switching to more advanced implementations, if necessary.\n * It will change its column count to fit its container's width and will decide how many rows to render based upon\n * the height of the browser `window`.\n *\n * @param props\n */\nexport function Masonry<Item>(props: MasonryProps<Item>) {\n  const containerRef = React.useRef<null | HTMLElement>(null);\n  const windowSize = useWindowSize({\n    initialWidth: props.ssrWidth,\n    initialHeight: props.ssrHeight,\n  });\n  const containerPos = useContainerPosition(containerRef, windowSize);\n  const nextProps = Object.assign(\n    {\n      offset: containerPos.offset,\n      width: containerPos.width || windowSize[0],\n      height: windowSize[1],\n      containerRef,\n    },\n    props\n  ) as any;\n  nextProps.positioner = usePositioner(nextProps);\n  nextProps.resizeObserver = useResizeObserver(nextProps.positioner);\n  const scrollToIndex = useScrollToIndex(nextProps.positioner, {\n    height: nextProps.height,\n    offset: containerPos.offset,\n    align:\n      typeof props.scrollToIndex === \"object\"\n        ? props.scrollToIndex.align\n        : void 0,\n  });\n  const index =\n    props.scrollToIndex &&\n    (typeof props.scrollToIndex === \"number\"\n      ? props.scrollToIndex\n      : props.scrollToIndex.index);\n\n  React.useEffect(() => {\n    if (index !== void 0) scrollToIndex(index);\n  }, [index, scrollToIndex]);\n\n  return React.createElement(MasonryScroller, nextProps);\n}\n\nexport interface MasonryProps<Item>\n  extends Omit<\n      MasonryScrollerProps<Item>,\n      \"offset\" | \"width\" | \"height\" | \"containerRef\" | \"positioner\"\n    >,\n    Pick<\n      UsePositionerOptions,\n      | \"columnWidth\"\n      | \"columnGutter\"\n      | \"rowGutter\"\n      | \"columnCount\"\n      | \"maxColumnCount\"\n      | \"maxColumnWidth\"\n    > {\n  /**\n   * Scrolls to a given index within the grid. The grid will re-scroll\n   * any time the index changes.\n   */\n  scrollToIndex?:\n    | number\n    | {\n        index: number;\n        align: UseScrollToIndexOptions[\"align\"];\n      };\n  /**\n   * This is the width that will be used for the browser `window` when rendering this component in SSR.\n   * This prop isn't relevant for client-side only apps.\n   */\n  ssrWidth?: number;\n  /**\n   * This is the height that will be used for the browser `window` when rendering this component in SSR.\n   * This prop isn't relevant for client-side only apps.\n   */\n  ssrHeight?: number;\n  /**\n   * This determines how often (in frames per second) to update the scroll position of the\n   * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\n   * The default value of `12` has been very reasonable in my own testing, but if you have particularly\n   * heavy `render` components it may be prudent to reduce this number.\n   *\n   * @default 12\n   */\n  scrollFps?: number;\n}\n\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n  Masonry.displayName = \"Masonry\";\n}\n","import * as React from \"react\";\nimport { Masonry } from \"./masonry\";\nimport type { MasonryProps } from \"./masonry\";\n\n/**\n * This is just a single-column `<Masonry>` component without column-specific props.\n *\n * @param props\n */\nexport function List<Item>(props: ListProps<Item>) {\n  return (\n    <Masonry<Item>\n      role=\"list\"\n      rowGutter={props.rowGutter}\n      columnCount={1}\n      columnWidth={1}\n      {...props}\n    />\n  );\n}\n\nexport interface ListProps<Item>\n  extends Omit<\n    MasonryProps<Item>,\n    \"columGutter\" | \"columnCount\" | \"columnWidth\"\n  > {\n  /**\n   * The amount of vertical space in pixels to add between the list cells.\n   *\n   * @default 0\n   */\n  rowGutter?: number;\n}\n\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n  List.displayName = \"List\";\n}\n","import useLatest from \"@react-hook/latest\";\nimport * as React from \"react\";\n\n/**\n * A utility hook for seamlessly adding infinite scroll behavior to the `useMasonry()` hook. This\n * hook invokes a callback each time the last rendered index surpasses the total number of items\n * in your items array or the number defined in the `totalItems` option.\n *\n * @param loadMoreItems - This callback is invoked when more rows must be loaded. It will be used to\n *  determine when to refresh the list with the newly-loaded data. This callback may be called multiple\n *  times in reaction to a single scroll event, so it's important to memoize its arguments. If you're\n *  creating this callback inside of a functional component, make sure you wrap it in `React.useCallback()`,\n *  as well.\n * @param options\n */\nexport function useInfiniteLoader<Item, T extends LoadMoreItemsCallback<Item>>(\n  loadMoreItems: T,\n  options: UseInfiniteLoaderOptions<Item> = emptyObj\n): LoadMoreItemsCallback<Item> {\n  const {\n    isItemLoaded,\n    minimumBatchSize = 16,\n    threshold = 16,\n    totalItems = 9e9,\n  } = options;\n  const storedLoadMoreItems = useLatest(loadMoreItems);\n  const storedIsItemLoaded = useLatest(isItemLoaded);\n\n  return React.useCallback(\n    (startIndex, stopIndex, items) => {\n      const unloadedRanges = scanForUnloadedRanges(\n        storedIsItemLoaded.current,\n        minimumBatchSize,\n        items,\n        totalItems,\n        Math.max(0, startIndex - threshold),\n        Math.min(totalItems - 1, (stopIndex || 0) + threshold)\n      );\n      // The user is responsible for memoizing their loadMoreItems() function\n      // because we don't want to make assumptions about how they want to deal\n      // with `items`\n      for (let i = 0; i < unloadedRanges.length - 1; ++i)\n        storedLoadMoreItems.current(\n          unloadedRanges[i],\n          unloadedRanges[++i],\n          items\n        );\n    },\n    [\n      totalItems,\n      minimumBatchSize,\n      threshold,\n      storedLoadMoreItems,\n      storedIsItemLoaded,\n    ]\n  );\n}\n\n/**\n * Returns all of the ranges within a larger range that contain unloaded rows.\n *\n * @param isItemLoaded\n * @param minimumBatchSize\n * @param items\n * @param totalItems\n * @param startIndex\n * @param stopIndex\n */\nfunction scanForUnloadedRanges<Item>(\n  isItemLoaded: UseInfiniteLoaderOptions<Item>[\"isItemLoaded\"] = defaultIsItemLoaded,\n  minimumBatchSize: UseInfiniteLoaderOptions<Item>[\"minimumBatchSize\"] = 16,\n  items: any[],\n  totalItems: UseInfiniteLoaderOptions<Item>[\"totalItems\"] = 9e9,\n  startIndex: number,\n  stopIndex: number\n): number[] {\n  const unloadedRanges: number[] = [];\n  let rangeStartIndex: number | undefined,\n    rangeStopIndex: number | undefined,\n    index = startIndex;\n\n  /* istanbul ignore next */\n  for (; index <= stopIndex; index++) {\n    if (!isItemLoaded(index, items)) {\n      rangeStopIndex = index;\n      if (rangeStartIndex === void 0) rangeStartIndex = index;\n    } else if (rangeStartIndex !== void 0 && rangeStopIndex !== void 0) {\n      unloadedRanges.push(rangeStartIndex, rangeStopIndex);\n      rangeStartIndex = rangeStopIndex = void 0;\n    }\n  }\n\n  // If :rangeStopIndex is not null it means we haven't run out of unloaded rows.\n  // Scan forward to try filling our :minimumBatchSize.\n  if (rangeStartIndex !== void 0 && rangeStopIndex !== void 0) {\n    const potentialStopIndex = Math.min(\n      Math.max(rangeStopIndex, rangeStartIndex + minimumBatchSize - 1),\n      totalItems - 1\n    );\n\n    /* istanbul ignore next */\n    for (index = rangeStopIndex + 1; index <= potentialStopIndex; index++) {\n      if (!isItemLoaded(index, items)) {\n        rangeStopIndex = index;\n      } else {\n        break;\n      }\n    }\n\n    unloadedRanges.push(rangeStartIndex, rangeStopIndex);\n  }\n\n  // Check to see if our first range ended prematurely.\n  // In this case we should scan backwards to try filling our :minimumBatchSize.\n  /* istanbul ignore next */\n  if (unloadedRanges.length) {\n    let firstUnloadedStart = unloadedRanges[0];\n    const firstUnloadedStop = unloadedRanges[1];\n\n    while (\n      firstUnloadedStop - firstUnloadedStart + 1 < minimumBatchSize &&\n      firstUnloadedStart > 0\n    ) {\n      const index = firstUnloadedStart - 1;\n\n      if (!isItemLoaded(index, items)) {\n        unloadedRanges[0] = firstUnloadedStart = index;\n      } else {\n        break;\n      }\n    }\n  }\n\n  return unloadedRanges;\n}\n\nconst defaultIsItemLoaded = <Item>(index: number, items: Item[]): boolean =>\n  items[index] !== void 0;\n\nexport interface UseInfiniteLoaderOptions<Item> {\n  /**\n   *  A callback responsible for determining the loaded state of each item. Should return `true`\n   * if the item has already been loaded and `false` if not.\n   *\n   * @default (index: number, items: any[]) => boolean\n   */\n  isItemLoaded?: (index: number, items: Item[]) => boolean;\n  /**\n   * The minimum number of new items to be loaded at a time.  This property can be used to\n   * batch requests and reduce HTTP requests.\n   *\n   * @default 16\n   */\n  minimumBatchSize?: number;\n  /**\n   * The threshold at which to pre-fetch data. A threshold X means that new data should start\n   * loading when a user scrolls within X cells of the end of your `items` array.\n   *\n   * @default 16\n   */\n  threshold?: number;\n  /**\n   * The total number of items you'll need to eventually load (if known). This can\n   * be arbitrarily high if not known.\n   *\n   * @default 9e9\n   */\n  totalItems?: number;\n}\n\nexport type LoadMoreItemsCallback<Item> = (\n  startIndex: number,\n  stopIndex: number,\n  items: Item[]\n) => any;\n\nconst emptyObj = {};\n"],"names":["RED","BLACK","NIL","DELETE","KEEP","addInterval","treeNode","high","index","node","list","prevNode","next","removeInterval","NULL_NODE","low","max","C","P","undefined","R","L","updateMax","Math","updateMaxUp","x","rotateLeft","tree","y","root","rotateRight","replaceNode","fixRemove","w","minimumTree","fixInsert","z","createIntervalTree","size","indexMap","insert","remove","intervalResult","originalYColor","search","callback","stack","length","pop","push","curr","elementsCache","WeakMap","useForceUpdate","setState","React","useState","emptyObj","useRef","current","useMasonry","positioner","resizeObserver","items","as","ContainerComponent","id","className","style","role","tabIndex","containerRef","itemAs","ItemComponent","itemStyle","itemHeightEstimate","itemKey","defaultGetItemKey","overscanBy","scrollTop","isScrolling","height","render","RenderComponent","onRender","startIndex","stopIndex","forceUpdate","setItemRef","getRefSetter","itemCount","columnWidth","columnCount","range","estimateHeight","shortestColumn","measuredCount","shortestColumnSize","children","itemRole","storedOnRender","useLatest","rangeEnd","needsFreshBatch","left","top","data","key","phaseTwoStyle","width","writingMode","position","process","throwWithoutData","__reactCreateElement__","Object","assign","createRenderElement","min","batchSize","ceil","phaseOneStyle","getCachedSize","useEffect","didEverMount","containerStyle","getContainerStyle","assignUserStyle","Error","trieMemoize","OneKeyMap","memoizeOne","maxWidth","maxHeight","willChange","pointerEvents","cmp2","args","pargs","userStyle","_","i","zIndex","visibility","el","observe","set","get","offsetHeight","useScroller","offset","fps","useScrollPosition","setIsScrolling","didMount","didUnsubscribe","to","requestTimeout","clearRequestTimeout","MasonryScroller","props","scrollFps","displayName","useContainerPosition","elementRef","deps","emptyArr","containerPosition","setContainerPosition","useLayoutEffect","offsetTop","offsetParent","offsetWidth","usePositioner","columnGutter","rowGutter","maxColumnCount","maxColumnWidth","initPositioner","computedColumnWidth","computedColumnCount","getColumns","createPositioner","positionerRef","prevDeps","opts","prevOpts","optsChanged","every","item","prevPositioner","cacheSize","pos","intervalTree","columnHeights","Array","columnItems","column","update","updates","columns","j","itemsInColumn","binarySearch","startItem","lo","hi","renderCallback","defaultItemHeight","tallestColumn","apply","all","a","l","h","m","minimumWidth","gutter","floor","Infinity","useResizeObserver","createResizeObserver","disconnect","handler","cancel","updater","rafSchd","commonHandler","target","handlers","Map","handleEntries","entries","entry","ro","ResizeObserver","bind","forEach","useScrollToIndex","options","align","element","window","innerHeight","latestOptions","getTarget","latestElement","state","dispatch","useReducer","action","nextState","prevTop","type","value","defaultState","throttledDispatch","useThrottleCallback","useEvent","currentTop","clearTimeout","timeout","scrollTo","setTimeout","estimatedTop","Masonry","windowSize","useWindowSize","initialWidth","ssrWidth","initialHeight","ssrHeight","containerPos","nextProps","scrollToIndex","List","useInfiniteLoader","loadMoreItems","isItemLoaded","minimumBatchSize","threshold","totalItems","storedLoadMoreItems","storedIsItemLoaded","useCallback","unloadedRanges","scanForUnloadedRanges","defaultIsItemLoaded","rangeStartIndex","rangeStopIndex","potentialStopIndex","firstUnloadedStart","firstUnloadedStop"],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"index.dev.mjs","sources":[],"sourcesContent":[],"names":[],"mappings":";;;;;;;;;;"}
\ No newline at end of file
diff --git a/dist/esm/index.mjs b/dist/esm/index.mjs
index 847caa038335fd0a2267e4a93a3d3c2297aff6b7..5dd4aff66fe0bf4ba74727f5a681711ba3deaf06 100644
--- a/dist/esm/index.mjs
+++ b/dist/esm/index.mjs
@@ -1,2 +1,2 @@
-function e(e){var t=e.high;e.L===O&&e.R===O?e.max=t:e.L===O?e.max=Math.max(e.R.max,t):e.R===O?e.max=Math.max(e.L.max,t):e.max=Math.max(Math.max(e.L.max,e.R.max),t)}function t(t){for(var r=t;r.P!==O;)e(r.P),r=r.P}function r(t,r){if(r.R!==O){var i=r.R;r.R=i.L,i.L!==O&&(i.L.P=r),i.P=r.P,r.P===O?t.root=i:r===r.P.L?r.P.L=i:r.P.R=i,i.L=r,r.P=i,e(r),e(i)}}function i(t,r){if(r.L!==O){var i=r.L;r.L=i.R,i.R!==O&&(i.R.P=r),i.P=r.P,r.P===O?t.root=i:r===r.P.R?r.P.R=i:r.P.L=i,i.R=r,r.P=i,e(r),e(i)}}function o(e,t,r){t.P===O?e.root=r:t===t.P.L?t.P.L=r:t.P.R=r,r.P=t.P}function n(){var n={root:O,size:0},a={};return{insert(o,s,l){for(var u=n.root,f=O;u!==O&&o!==(f=u).low;)u=o<u.low?u.L:u.R;if(o===f.low&&f!==O){if(!function(e,t,r){for(var i,o=e.list;o;){if(o.index===r)return 0;if(t>o.high)break;i=o,o=o.next}return i||(e.list={index:r,high:t,next:o}),i&&(i.next={index:r,high:t,next:i.next}),1}(f,s,l))return;return f.high=Math.max(f.high,s),e(f),t(f),a[l]=f,void n.size++}var h={low:o,high:s,max:s,C:0,P:f,L:O,R:O,list:{index:l,high:s,next:null}};f===O?n.root=h:(h.low<f.low?f.L=h:f.R=h,t(h)),function(e,t){for(var o;0===t.P.C;)t.P===t.P.P.L?0===(o=t.P.P.R).C?(t.P.C=1,o.C=1,t.P.P.C=0,t=t.P.P):(t===t.P.R&&r(e,t=t.P),t.P.C=1,t.P.P.C=0,i(e,t.P.P)):0===(o=t.P.P.L).C?(t.P.C=1,o.C=1,t.P.P.C=0,t=t.P.P):(t===t.P.L&&i(e,t=t.P),t.P.C=1,t.P.P.C=0,r(e,t.P.P));e.root.C=1}(n,h),a[l]=h,n.size++},remove(s){var l=a[s];if(void 0!==l){delete a[s];var u=function(e,t){var r=e.list;if(r.index===t)return null===r.next?0:(e.list=r.next,1);var i=r;for(r=r.next;null!==r;){if(r.index===t)return i.next=r.next,1;i=r,r=r.next}}(l,s);if(void 0!==u){if(1===u)return l.high=l.list.high,e(l),t(l),void n.size--;var f,h=l,v=h.C;l.L===O?(f=l.R,o(n,l,l.R)):l.R===O?(f=l.L,o(n,l,l.L)):(v=(h=function(e){for(;e.L!==O;)e=e.L;return e}(l.R)).C,f=h.R,h.P===l?f.P=h:(o(n,h,h.R),h.R=l.R,h.R.P=h),o(n,l,h),h.L=l.L,h.L.P=h,h.C=l.C),e(f),t(f),1===v&&function(e,t){for(var o;t!==O&&1===t.C;)t===t.P.L?(0===(o=t.P.R).C&&(o.C=1,t.P.C=0,r(e,t.P),o=t.P.R),1===o.L.C&&1===o.R.C?(o.C=0,t=t.P):(1===o.R.C&&(o.L.C=1,o.C=0,i(e,o),o=t.P.R),o.C=t.P.C,t.P.C=1,o.R.C=1,r(e,t.P),t=e.root)):(0===(o=t.P.L).C&&(o.C=1,t.P.C=0,i(e,t.P),o=t.P.L),1===o.R.C&&1===o.L.C?(o.C=0,t=t.P):(1===o.L.C&&(o.R.C=1,o.C=0,r(e,o),o=t.P.L),o.C=t.P.C,t.P.C=1,o.L.C=1,i(e,t.P),t=e.root));t.C=1}(n,f),n.size--}}},search(e,t,r){for(var i=[n.root];0!==i.length;){var o=i.pop();if(o!==O&&e<=o.max&&(o.L!==O&&i.push(o.L),o.R!==O&&i.push(o.R),o.low<=t&&o.high>=e))for(var a=o.list;null!==a;)a.high<e||r(a.index,o.low),a=a.next}},get size(){return n.size}}}function a(){return(a=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function s(){var e=C.useState(S)[1];return C.useRef(()=>e({})).current}function l(e){var t,{positioner:r,resizeObserver:i,items:o,as:n="div",id:a,className:l,style:f,role:h="grid",tabIndex:v=0,containerRef:c,itemAs:d="div",itemStyle:m,itemHeightEstimate:p=300,itemKey:g=u,overscanBy:P=2,scrollTop:x,isScrolling:R,height:y,render:w,onRender:M}=e,b=0,z=s(),T=F(r,i),k=o.length,{columnWidth:I,columnCount:E,range:W,estimateHeight:O,size:H,shortestColumn:S}=r,N=H(),D=S(),J=[],Q="list"===h?"listitem":"grid"===h?"gridcell":void 0,U=L(M),V=x+(P*=y),X=V>D&&k>N;if(W(Math.max(0,x-P/2),V,(e,r,i)=>{var n=o[e],a=g(n,e),s={top:i,left:r,width:I,writingMode:"horizontal-tb",position:"absolute"};J.push(j(d,{key:a,ref:T(e),role:Q,style:"object"==typeof m&&null!==m?Object.assign({},s,m):s},B(w,e,n,I))),void 0===t?(b=e,t=e):(b=Math.min(b,e),t=Math.max(t,e))}),X)for(var Y=Math.min(k-N,Math.ceil((x+P-D)/p*E)),Z=N,$=q(I);N+Y>Z;Z++){var _=o[Z],ee=g(_,Z);J.push(j(d,{key:ee,ref:T(Z),role:Q,style:"object"==typeof m?Object.assign({},$,m):$},B(w,Z,_,I)))}C.useEffect(()=>{"function"==typeof U.current&&void 0!==t&&U.current(b,t,o),A="1"},[b,t,o,U]),C.useEffect(()=>{X&&z()},[X,r]);var te=G(R,O(k,p));return j(n,{ref:c,key:A,id:a,role:h,className:l,tabIndex:v,style:"object"==typeof f?K(te,f):te,children:J})}function u(e,t){return t}function f(e,t){void 0===e&&(e=0),void 0===t&&(t=12);var r=T(t),[i,o]=C.useState(0),n=C.useRef(0);return C.useEffect(()=>{1===n.current&&o(1);var e=0,r=b(()=>{e||o(0)},40+1e3/t);return n.current=1,()=>{e=1,z(r)}},[t,r]),{scrollTop:Math.max(0,r-e),isScrolling:i}}function h(e){var{scrollTop:t,isScrolling:r}=f(e.offset,e.scrollFps);return l({scrollTop:t,isScrolling:r,positioner:e.positioner,resizeObserver:e.resizeObserver,items:e.items,onRender:e.onRender,as:e.as,id:e.id,className:e.className,style:e.style,role:e.role,tabIndex:e.tabIndex,containerRef:e.containerRef,itemAs:e.itemAs,itemStyle:e.itemStyle,itemHeightEstimate:e.itemHeightEstimate,itemKey:e.itemKey,overscanBy:e.overscanBy,height:e.height,render:e.render})}function v(e,t){void 0===t&&(t=D);var[r,i]=C.useState({offset:0,width:0});return k(()=>{var{current:t}=e;if(null!==t){var o=0,n=t;do{o+=n.offsetTop||0,n=n.offsetParent}while(n);o===r.offset&&t.offsetWidth===r.width||i({offset:o,width:t.offsetWidth})}},t),r}function c(e,t){var{width:r,columnWidth:i=200,columnGutter:o=0,rowGutter:n,columnCount:a,maxColumnCount:s,maxColumnWidth:l}=e;void 0===t&&(t=V);var u=()=>{var[e,t]=U(r,i,o,a,s,l);return J(t,e,o,null!=n?n:o)},f=C.useRef();void 0===f.current&&(f.current=u());var h=C.useRef(t),v=[r,i,o,n,a,s,l],c=C.useRef(v),d=!v.every((e,t)=>c.current[t]===e);if(d||!t.every((e,t)=>h.current[t]===e)){var m=f.current,p=u();if(h.current=t,c.current=v,d)for(var g=m.size(),P=0;g>P;P++){var x=m.get(P);p.set(P,void 0!==x?x.height:0)}f.current=p}return f.current}function d(e){function t(){return i.disconnect()}var r=s(),i=X(e,r);return C.useEffect(()=>t,[i]),i}function m(e){e.cancel()}function p(e,t){var r,{align:i="top",element:o="undefined"!=typeof window&&window,offset:n=0,height:a=("undefined"!=typeof window?window.innerHeight:0)}=t,s=L({positioner:e,element:o,align:i,offset:n,height:a}),l=C.useRef(()=>{var e=s.current.element;return e&&"current"in e?e.current:e}).current,[u,f]=C.useReducer((e,t)=>{var r,i={position:e.position,index:e.index,prevTop:e.prevTop};if("scrollToIndex"===t.type)return{position:s.current.positioner.get(null!==(r=t.value)&&void 0!==r?r:-1),index:t.value,prevTop:void 0};if("setPosition"===t.type)i.position=t.value;else if("setPrevTop"===t.type)i.prevTop=t.value;else if("reset"===t.type)return Y;return i},Y),h=W(f,15);E(l(),"scroll",()=>{if(!u.position&&u.index){var e=s.current.positioner.get(u.index);e&&f({type:"setPosition",value:e})}});var v=void 0!==u.index&&(null===(r=s.current.positioner.get(u.index))||void 0===r?void 0:r.top);return C.useEffect(()=>{var e=l();if(e){var{height:t,align:r,offset:i,positioner:o}=s.current;if(u.position){var n=u.position.top;"bottom"===r?n=n-t+u.position.height:"center"===r&&(n-=(t-u.position.height)/2),e.scrollTo(0,Math.max(0,n+=i));var a=0,v=setTimeout((function(){return!a&&f({type:"reset"})}),400);return function(){a=1,clearTimeout(v)}}if(void 0!==u.index){var c=o.shortestColumn()/o.size()*u.index;u.prevTop&&(c=Math.max(c,u.prevTop+t)),e.scrollTo(0,c),h({type:"setPrevTop",value:c})}}},[v,u,s,l,h]),C.useRef(e=>{f({type:"scrollToIndex",value:e})}).current}function g(e){var t=C.useRef(null),r=R({initialWidth:e.ssrWidth,initialHeight:e.ssrHeight}),i=v(t,r),o=Object.assign({offset:i.offset,width:i.width||r[0],height:r[1],containerRef:t},e);o.positioner=c(o),o.resizeObserver=d(o.positioner);var n=p(o.positioner,{height:o.height,offset:i.offset,align:"object"==typeof e.scrollToIndex?e.scrollToIndex.align:void 0}),a=e.scrollToIndex&&("number"==typeof e.scrollToIndex?e.scrollToIndex:e.scrollToIndex.index);return C.useEffect(()=>{void 0!==a&&n(a)},[a,n]),Z(h,o)}function P(e){return $(g,a({role:"list",rowGutter:e.rowGutter,columnCount:1,columnWidth:1},e))}function x(e,t){void 0===t&&(t=ee);var{isItemLoaded:r,minimumBatchSize:i=16,threshold:o=16,totalItems:n=9e9}=t,a=L(e),s=L(r);return C.useCallback((e,t,r)=>{for(var l=function(e,t,r,i,o,n){void 0===e&&(e=_),void 0===t&&(t=16),void 0===i&&(i=9e9);for(var a,s,l=[],u=o;n>=u;u++)e(u,r)?void 0!==a&&void 0!==s&&(l.push(a,s),a=s=void 0):(s=u,void 0===a&&(a=u));if(void 0!==a&&void 0!==s){var f=Math.min(Math.max(s,a+t-1),i-1);for(u=s+1;f>=u&&!e(u,r);u++)s=u;l.push(a,s)}if(l.length)for(var h=l[0],v=l[1];t>v-h+1&&h>0;){var c=h-1;if(e(c,r))break;l[0]=h=c}return l}(s.current,i,r,n,Math.max(0,e-o),Math.min(n-1,(t||0)+o)),u=0;u<l.length-1;++u)a.current(l[u],l[++u],r)},[n,i,o,a,s])}import*as C from"react";import{useWindowSize as R}from"@react-hook/window-size";import y from"@essentials/memoize-one";import w from"@essentials/one-key-map";import L from"@react-hook/latest";import M from"trie-memoize";import{requestTimeout as b,clearRequestTimeout as z}from"@essentials/request-timeout";import T from"@react-hook/window-scroll";import k from"@react-hook/passive-layout-effect";import I from"raf-schd";import E from"@react-hook/event";import{useThrottleCallback as W}from"@react-hook/throttle";var O={low:0,max:0,high:0,C:2,P:void 0,R:void 0,L:void 0,list:void 0};O.P=O,O.L=O,O.R=O;var H=new WeakMap,S={},j=C.createElement,A="0",B=M([w,{},WeakMap,w],(e,t,r,i)=>j(e,{index:t,data:r,width:i})),G=y((e,t)=>({position:"relative",width:"100%",maxWidth:"100%",height:Math.ceil(t),maxHeight:Math.ceil(t),willChange:e?"contents":void 0,pointerEvents:e?"none":void 0})),N=(e,t)=>e[0]===t[0]&&e[1]===t[1],K=y((e,t)=>Object.assign({},e,t),N),q=y(e=>({width:e,zIndex:-1e3,visibility:"hidden",position:"absolute",writingMode:"horizontal-tb"}),(e,t)=>e[0]===t[0]),F=y((e,t)=>r=>i=>{null!==i&&(t&&(t.observe(i),H.set(i,r)),void 0===e.get(r)&&e.set(r,i.offsetHeight))},N),D=[],J=function(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=r);for(var o=n(),a=new Array(e),s=[],l=new Array(e),u=0;e>u;u++)a[u]=0,l[u]=[];return{columnCount:e,columnWidth:t,set:function(e,n){void 0===n&&(n=0);for(var u=0,f=1;f<a.length;f++)a[f]<a[u]&&(u=f);var h=a[u]||0;a[u]=h+n+i,l[u].push(e),s[e]={left:u*(t+r),top:h,height:n,column:u},o.insert(h,h+n,e)},get:e=>s[e],update:t=>{for(var r=new Array(e),n=0,u=0;n<t.length-1;n++){var f=t[n],h=s[f];h.height=t[++n],o.remove(f),o.insert(h.top,h.top+h.height,f),r[h.column]=void 0===r[h.column]?f:Math.min(f,r[h.column])}for(n=0;n<r.length;n++)if(void 0!==r[n]){var v=l[n],c=Q(v,r[n]),d=l[n][c],m=s[d];for(a[n]=m.top+m.height+i,u=c+1;u<v.length;u++){var p=v[u],g=s[p];g.top=a[n],a[n]=g.top+g.height+i,o.remove(p),o.insert(g.top,g.top+g.height,p)}}},range:(e,t,r)=>o.search(e,t,(e,t)=>r(e,s[e].left,t)),estimateHeight:(t,r)=>{var i=Math.max(0,Math.max.apply(null,a));return t===o.size?i:i+Math.ceil((t-o.size)/e)*r},shortestColumn:()=>a.length>1?Math.min.apply(null,a):a[0]||0,size:()=>o.size,all:()=>s}},Q=(e,t)=>{for(var r=0,i=e.length-1;i>=r;){var o=r+i>>>1,n=e[o];if(n===t)return o;n>t?i=o-1:r=o+1}return-1},U=function(e,t,r,i,o,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=8),i=i||Math.min(Math.floor((e+r)/(t+r)),o||1/0)||1;var a=Math.floor((e-r*(i-1))/i);return void 0!==n&&a>n&&(a=n),[a,i]},V=[],X=M([WeakMap],(e,t)=>{var r=[],i=I(()=>{r.length>0&&(e.update(r),t(r)),r.length=0}),o=t=>{var o=t.offsetHeight;if(o>0){var n=H.get(t);if(void 0!==n){var a=e.get(n);void 0!==a&&o!==a.height&&r.push(n,o)}}i()},n=new Map,a=new ResizeObserver(e=>{for(var t=0;t<e.length;t++){var r=e[t],i=H.get(r.target);if(void 0!==i){var a=n.get(i);a||(a=I(o),n.set(i,a)),a(r.target)}}}),s=a.disconnect.bind(a);return a.disconnect=()=>{s(),n.forEach(m)},a}),Y={index:void 0,position:void 0,prevTop:void 0},Z=C.createElement,$=C.createElement,_=(e,t)=>void 0!==t[e],ee={};export{P as List,g as Masonry,h as MasonryScroller,n as createIntervalTree,J as createPositioner,X as createResizeObserver,v as useContainerPosition,x as useInfiniteLoader,l as useMasonry,c as usePositioner,d as useResizeObserver,p as useScrollToIndex,f as useScroller};
+export*from"./interval-tree.ts";export*from"./list.tsx";export*from"./masonry.tsx";export*from"./masonry-scroller.tsx";export*from"./use-container-position.ts";export*from"./use-infinite-loader.ts";export*from"./use-masonry.tsx";export*from"./use-positioner.ts";export*from"./use-resize-observer.ts";export*from"./use-scroll-to-index.ts";export*from"./use-scroller.ts";
 //# sourceMappingURL=index.mjs.map
diff --git a/dist/esm/index.mjs.map b/dist/esm/index.mjs.map
index 8f4247cf220c0d5da103ed3a463a2c487d937c5b..1dfa0dd11148f68c7f0138cf78b5707d945d8ba0 100644
--- a/dist/esm/index.mjs.map
+++ b/dist/esm/index.mjs.map
@@ -1 +1 @@
-{"version":3,"file":"index.mjs","sources":["../../src/interval-tree.ts","../../src/use-force-update.ts","../../src/use-masonry.tsx","../../src/use-scroller.ts","../../src/masonry-scroller.tsx","../../src/use-container-position.ts","../../src/use-positioner.ts","../../src/use-resize-observer.ts","../../src/use-scroll-to-index.ts","../../src/masonry.tsx","../../src/list.tsx","../../src/use-infinite-loader.ts","../../src/elements-cache.ts"],"sourcesContent":["type Color = 0 | 1 | 2;\nconst RED = 0;\nconst BLACK = 1;\nconst NIL = 2;\n\nconst DELETE = 0;\nconst KEEP = 1;\n\ntype ListNode = {\n  index: number;\n  high: number;\n  next: ListNode | null;\n};\n\ninterface TreeNode {\n  max: number;\n  low: number;\n  high: number;\n  // color\n  C: Color;\n  // P\n  P: TreeNode;\n  // right\n  R: TreeNode;\n  // left\n  L: TreeNode;\n  list: ListNode;\n}\n\ninterface Tree {\n  root: TreeNode;\n  size: number;\n}\n\nfunction addInterval(treeNode: TreeNode, high: number, index: number): boolean {\n  let node: ListNode | null = treeNode.list;\n  let prevNode: ListNode | undefined;\n\n  while (node) {\n    if (node.index === index) return false;\n    if (high > node.high) break;\n    prevNode = node;\n    node = node.next;\n  }\n\n  if (!prevNode) treeNode.list = { index, high, next: node };\n  if (prevNode) prevNode.next = { index, high, next: prevNode.next };\n\n  return true;\n}\n\nfunction removeInterval(treeNode: TreeNode, index: number) {\n  let node: ListNode | null = treeNode.list;\n  if (node.index === index) {\n    if (node.next === null) return DELETE;\n    treeNode.list = node.next;\n    return KEEP;\n  }\n\n  let prevNode: ListNode | undefined = node;\n  node = node.next;\n\n  while (node !== null) {\n    if (node.index === index) {\n      prevNode.next = node.next;\n      return KEEP;\n    }\n    prevNode = node;\n    node = node.next;\n  }\n}\n\nconst NULL_NODE: TreeNode = {\n  low: 0,\n  max: 0,\n  high: 0,\n  C: NIL,\n  // @ts-expect-error\n  P: undefined,\n  // @ts-expect-error\n  R: undefined,\n  // @ts-expect-error\n  L: undefined,\n  // @ts-expect-error\n  list: undefined,\n};\n\nNULL_NODE.P = NULL_NODE;\nNULL_NODE.L = NULL_NODE;\nNULL_NODE.R = NULL_NODE;\n\nfunction updateMax(node: TreeNode) {\n  const max = node.high;\n  if (node.L === NULL_NODE && node.R === NULL_NODE) node.max = max;\n  else if (node.L === NULL_NODE) node.max = Math.max(node.R.max, max);\n  else if (node.R === NULL_NODE) node.max = Math.max(node.L.max, max);\n  else node.max = Math.max(Math.max(node.L.max, node.R.max), max);\n}\n\nfunction updateMaxUp(node: TreeNode) {\n  let x = node;\n\n  while (x.P !== NULL_NODE) {\n    updateMax(x.P);\n    x = x.P;\n  }\n}\n\nfunction rotateLeft(tree: Tree, x: TreeNode) {\n  if (x.R === NULL_NODE) return;\n  const y = x.R;\n  x.R = y.L;\n  if (y.L !== NULL_NODE) y.L.P = x;\n  y.P = x.P;\n\n  if (x.P === NULL_NODE) tree.root = y;\n  else if (x === x.P.L) x.P.L = y;\n  else x.P.R = y;\n\n  y.L = x;\n  x.P = y;\n\n  updateMax(x);\n  updateMax(y);\n}\n\nfunction rotateRight(tree: Tree, x: TreeNode) {\n  if (x.L === NULL_NODE) return;\n  const y = x.L;\n  x.L = y.R;\n  if (y.R !== NULL_NODE) y.R.P = x;\n  y.P = x.P;\n\n  if (x.P === NULL_NODE) tree.root = y;\n  else if (x === x.P.R) x.P.R = y;\n  else x.P.L = y;\n\n  y.R = x;\n  x.P = y;\n\n  updateMax(x);\n  updateMax(y);\n}\n\nfunction replaceNode(tree: Tree, x: TreeNode, y: TreeNode) {\n  if (x.P === NULL_NODE) tree.root = y;\n  else if (x === x.P.L) x.P.L = y;\n  else x.P.R = y;\n  y.P = x.P;\n}\n\nfunction fixRemove(tree: Tree, x: TreeNode) {\n  let w;\n\n  while (x !== NULL_NODE && x.C === BLACK) {\n    if (x === x.P.L) {\n      w = x.P.R;\n\n      if (w.C === RED) {\n        w.C = BLACK;\n        x.P.C = RED;\n        rotateLeft(tree, x.P);\n        w = x.P.R;\n      }\n\n      if (w.L.C === BLACK && w.R.C === BLACK) {\n        w.C = RED;\n        x = x.P;\n      } else {\n        if (w.R.C === BLACK) {\n          w.L.C = BLACK;\n          w.C = RED;\n          rotateRight(tree, w);\n          w = x.P.R;\n        }\n\n        w.C = x.P.C;\n        x.P.C = BLACK;\n        w.R.C = BLACK;\n        rotateLeft(tree, x.P);\n        x = tree.root;\n      }\n    } else {\n      w = x.P.L;\n\n      if (w.C === RED) {\n        w.C = BLACK;\n        x.P.C = RED;\n        rotateRight(tree, x.P);\n        w = x.P.L;\n      }\n\n      if (w.R.C === BLACK && w.L.C === BLACK) {\n        w.C = RED;\n        x = x.P;\n      } else {\n        if (w.L.C === BLACK) {\n          w.R.C = BLACK;\n          w.C = RED;\n          rotateLeft(tree, w);\n          w = x.P.L;\n        }\n\n        w.C = x.P.C;\n        x.P.C = BLACK;\n        w.L.C = BLACK;\n        rotateRight(tree, x.P);\n        x = tree.root;\n      }\n    }\n  }\n\n  x.C = BLACK;\n}\n\nfunction minimumTree(x: TreeNode) {\n  while (x.L !== NULL_NODE) x = x.L;\n  return x;\n}\n\nfunction fixInsert(tree: Tree, z: TreeNode) {\n  let y: TreeNode;\n  while (z.P.C === RED) {\n    if (z.P === z.P.P.L) {\n      y = z.P.P.R;\n\n      if (y.C === RED) {\n        z.P.C = BLACK;\n        y.C = BLACK;\n        z.P.P.C = RED;\n        z = z.P.P;\n      } else {\n        if (z === z.P.R) {\n          z = z.P;\n          rotateLeft(tree, z);\n        }\n\n        z.P.C = BLACK;\n        z.P.P.C = RED;\n        rotateRight(tree, z.P.P);\n      }\n    } else {\n      y = z.P.P.L;\n\n      if (y.C === RED) {\n        z.P.C = BLACK;\n        y.C = BLACK;\n        z.P.P.C = RED;\n        z = z.P.P;\n      } else {\n        if (z === z.P.L) {\n          z = z.P;\n          rotateRight(tree, z);\n        }\n\n        z.P.C = BLACK;\n        z.P.P.C = RED;\n        rotateLeft(tree, z.P.P);\n      }\n    }\n  }\n  tree.root.C = BLACK;\n}\n\nexport interface IIntervalTree {\n  insert(low: number, high: number, index: number): void;\n  remove(index: number): void;\n  search(\n    low: number,\n    high: number,\n    callback: (index: number, low: number) => any\n  ): void;\n  size: number;\n}\n\nexport function createIntervalTree(): IIntervalTree {\n  const tree = {\n    root: NULL_NODE,\n    size: 0,\n  };\n  // we know these indexes are a consistent, safe way to make look ups\n  // for our case so it's a solid O(1) alternative to\n  // the O(log n) searchNode() in typical interval trees\n  const indexMap: Record<number, TreeNode> = {};\n\n  return {\n    insert(low, high, index) {\n      let x: TreeNode = tree.root;\n      let y: TreeNode = NULL_NODE;\n\n      while (x !== NULL_NODE) {\n        y = x;\n        if (low === y.low) break;\n        if (low < x.low) x = x.L;\n        else x = x.R;\n      }\n\n      if (low === y.low && y !== NULL_NODE) {\n        if (!addInterval(y, high, index)) return;\n        y.high = Math.max(y.high, high);\n        updateMax(y);\n        updateMaxUp(y);\n        indexMap[index] = y;\n        tree.size++;\n        return;\n      }\n\n      const z: TreeNode = {\n        low,\n        high,\n        max: high,\n        C: RED,\n        P: y,\n        L: NULL_NODE,\n        R: NULL_NODE,\n        list: { index, high, next: null },\n      };\n\n      if (y === NULL_NODE) {\n        tree.root = z;\n      } else {\n        if (z.low < y.low) y.L = z;\n        else y.R = z;\n        updateMaxUp(z);\n      }\n\n      fixInsert(tree, z);\n      indexMap[index] = z;\n      tree.size++;\n    },\n\n    remove(index) {\n      const z = indexMap[index];\n      if (z === void 0) return;\n      delete indexMap[index];\n\n      const intervalResult = removeInterval(z, index);\n      if (intervalResult === void 0) return;\n      if (intervalResult === KEEP) {\n        z.high = z.list.high;\n        updateMax(z);\n        updateMaxUp(z);\n        tree.size--;\n        return;\n      }\n\n      let y = z;\n      let originalYColor = y.C;\n      let x: TreeNode;\n\n      if (z.L === NULL_NODE) {\n        x = z.R;\n        replaceNode(tree, z, z.R);\n      } else if (z.R === NULL_NODE) {\n        x = z.L;\n        replaceNode(tree, z, z.L);\n      } else {\n        y = minimumTree(z.R);\n        originalYColor = y.C;\n        x = y.R;\n\n        if (y.P === z) {\n          x.P = y;\n        } else {\n          replaceNode(tree, y, y.R);\n          y.R = z.R;\n          y.R.P = y;\n        }\n\n        replaceNode(tree, z, y);\n        y.L = z.L;\n        y.L.P = y;\n        y.C = z.C;\n      }\n\n      updateMax(x);\n      updateMaxUp(x);\n\n      if (originalYColor === BLACK) fixRemove(tree, x);\n      tree.size--;\n    },\n\n    search(low, high, callback) {\n      const stack = [tree.root];\n      while (stack.length !== 0) {\n        const node = stack.pop() as TreeNode;\n        if (node === NULL_NODE || low > node.max) continue;\n        if (node.L !== NULL_NODE) stack.push(node.L);\n        if (node.R !== NULL_NODE) stack.push(node.R);\n        if (node.low <= high && node.high >= low) {\n          let curr: ListNode | null = node.list;\n          while (curr !== null) {\n            if (curr.high >= low) callback(curr.index, node.low);\n            curr = curr.next;\n          }\n        }\n      }\n    },\n\n    get size() {\n      return tree.size;\n    },\n  };\n}\n","import * as React from \"react\";\n\nexport function useForceUpdate() {\n  const setState = React.useState(emptyObj)[1];\n  return React.useRef(() => setState({})).current;\n}\n\nconst emptyObj = {};\n","import memoizeOne from \"@essentials/memoize-one\";\nimport OneKeyMap from \"@essentials/one-key-map\";\nimport useLatest from \"@react-hook/latest\";\nimport * as React from \"react\";\nimport trieMemoize from \"trie-memoize\";\nimport { elementsCache } from \"./elements-cache\";\nimport { useForceUpdate } from \"./use-force-update\";\nimport type { Positioner } from \"./use-positioner\";\n\n/**\n * This hook handles the render phases of the masonry layout and returns the grid as a React element.\n *\n * @param options - Options for configuring the masonry layout renderer. See `UseMasonryOptions`.\n * @param options.positioner\n * @param options.resizeObserver\n * @param options.items\n * @param options.as\n * @param options.id\n * @param options.className\n * @param options.style\n * @param options.role\n * @param options.tabIndex\n * @param options.containerRef\n * @param options.itemAs\n * @param options.itemStyle\n * @param options.itemHeightEstimate\n * @param options.itemKey\n * @param options.overscanBy\n * @param options.scrollTop\n * @param options.isScrolling\n * @param options.height\n * @param options.render\n * @param options.onRender\n */\nexport function useMasonry<Item>({\n  // Measurement and layout\n  positioner,\n  resizeObserver,\n  // Grid items\n  items,\n  // Container props\n  as: ContainerComponent = \"div\",\n  id,\n  className,\n  style,\n  role = \"grid\",\n  tabIndex = 0,\n  containerRef,\n  // Item props\n  itemAs: ItemComponent = \"div\",\n  itemStyle,\n  itemHeightEstimate = 300,\n  itemKey = defaultGetItemKey,\n  // Rendering props\n  overscanBy = 2,\n  scrollTop,\n  isScrolling,\n  height,\n  render: RenderComponent,\n  onRender,\n}: UseMasonryOptions<Item>) {\n  let startIndex = 0;\n  let stopIndex: number | undefined;\n  const forceUpdate = useForceUpdate();\n  const setItemRef = getRefSetter(positioner, resizeObserver);\n  const itemCount = items.length;\n  const {\n    columnWidth,\n    columnCount,\n    range,\n    estimateHeight,\n    size,\n    shortestColumn,\n  } = positioner;\n  const measuredCount = size();\n  const shortestColumnSize = shortestColumn();\n  const children: React.ReactElement[] = [];\n  const itemRole =\n    role === \"list\" ? \"listitem\" : role === \"grid\" ? \"gridcell\" : undefined;\n  const storedOnRender = useLatest(onRender);\n\n  overscanBy = height * overscanBy;\n  const rangeEnd = scrollTop + overscanBy;\n  const needsFreshBatch =\n    shortestColumnSize < rangeEnd && measuredCount < itemCount;\n\n  range(\n    // We overscan in both directions because users scroll both ways,\n    // though one must admit scrolling down is more common and thus\n    // we only overscan by half the downward overscan amount\n    Math.max(0, scrollTop - overscanBy / 2),\n    rangeEnd,\n    (index, left, top) => {\n      const data = items[index];\n      const key = itemKey(data, index);\n      const phaseTwoStyle: React.CSSProperties = {\n        top,\n        left,\n        width: columnWidth,\n        writingMode: \"horizontal-tb\",\n        position: \"absolute\",\n      };\n\n      /* istanbul ignore next */\n      if (\n        typeof process !== \"undefined\" &&\n        process.env.NODE_ENV !== \"production\"\n      ) {\n        throwWithoutData(data, index);\n      }\n\n      children.push(\n        <ItemComponent\n          key={key}\n          ref={setItemRef(index)}\n          role={itemRole}\n          style={\n            typeof itemStyle === \"object\" && itemStyle !== null\n              ? Object.assign({}, phaseTwoStyle, itemStyle)\n              : phaseTwoStyle\n          }\n        >\n          {createRenderElement(RenderComponent, index, data, columnWidth)}\n        </ItemComponent>\n      );\n\n      if (stopIndex === void 0) {\n        startIndex = index;\n        stopIndex = index;\n      } else {\n        startIndex = Math.min(startIndex, index);\n        stopIndex = Math.max(stopIndex, index);\n      }\n    }\n  );\n\n  if (needsFreshBatch) {\n    const batchSize = Math.min(\n      itemCount - measuredCount,\n      Math.ceil(\n        ((scrollTop + overscanBy - shortestColumnSize) / itemHeightEstimate) *\n          columnCount\n      )\n    );\n\n    let index = measuredCount;\n    const phaseOneStyle = getCachedSize(columnWidth);\n\n    for (; index < measuredCount + batchSize; index++) {\n      const data = items[index];\n      const key = itemKey(data, index);\n\n      /* istanbul ignore next */\n      if (\n        typeof process !== \"undefined\" &&\n        process.env.NODE_ENV !== \"production\"\n      ) {\n        throwWithoutData(data, index);\n      }\n\n      children.push(\n        <ItemComponent\n          key={key}\n          ref={setItemRef(index)}\n          role={itemRole}\n          style={\n            typeof itemStyle === \"object\"\n              ? Object.assign({}, phaseOneStyle, itemStyle)\n              : phaseOneStyle\n          }\n        >\n          {createRenderElement(RenderComponent, index, data, columnWidth)}\n        </ItemComponent>\n      );\n    }\n  }\n\n  // Calls the onRender callback if the rendered indices changed\n  React.useEffect(() => {\n    if (typeof storedOnRender.current === \"function\" && stopIndex !== void 0)\n      storedOnRender.current(startIndex, stopIndex, items);\n\n    didEverMount = \"1\";\n  }, [startIndex, stopIndex, items, storedOnRender]);\n  // If we needed a fresh batch we should reload our components with the measured\n  // sizes\n  React.useEffect(() => {\n    if (needsFreshBatch) forceUpdate();\n    // eslint-disable-next-line\n  }, [needsFreshBatch, positioner]);\n\n  // gets the container style object based upon the estimated height and whether or not\n  // the page is being scrolled\n  const containerStyle = getContainerStyle(\n    isScrolling,\n    estimateHeight(itemCount, itemHeightEstimate)\n  );\n\n  return (\n    <ContainerComponent\n      ref={containerRef}\n      key={didEverMount}\n      id={id}\n      role={role}\n      className={className}\n      tabIndex={tabIndex}\n      style={\n        typeof style === \"object\"\n          ? assignUserStyle(containerStyle, style)\n          : containerStyle\n      }\n      children={children}\n    />\n  );\n}\n\n/* istanbul ignore next */\nfunction throwWithoutData(data: any, index: number) {\n  if (!data) {\n    throw new Error(\n      `No data was found at index: ${index}\\n\\n` +\n        `This usually happens when you've mutated or changed the \"items\" array in a ` +\n        `way that makes it shorter than the previous \"items\" array. Masonic knows nothing ` +\n        `about your underlying data and when it caches cell positions, it assumes you aren't ` +\n        `mutating the underlying \"items\".\\n\\n` +\n        `See https://codesandbox.io/s/masonic-w-react-router-example-2b5f9?file=/src/index.js for ` +\n        `an example that gets around this limitations. For advanced implementations, see ` +\n        `https://codesandbox.io/s/masonic-w-react-router-and-advanced-config-example-8em42?file=/src/index.js\\n\\n` +\n        `If this was the result of your removing an item from your \"items\", see this issue: ` +\n        `https://github.com/jaredLunde/masonic/issues/12`\n    );\n  }\n}\n\n// This is for triggering a remount after SSR has loaded in the client w/ hydrate()\nlet didEverMount = \"0\";\n\nexport interface UseMasonryOptions<Item> {\n  /**\n   * An array containing the data used by the grid items.\n   */\n  items: Item[];\n  /**\n   * A grid cell positioner and cache created by the `usePositioner()` hook or\n   * the `createPositioner` utility.\n   */\n  positioner: Positioner;\n  /**\n   * A resize observer that tracks mutations to the grid cells and forces the\n   * Masonry grid to recalculate its layout if any cells affect column heights\n   * change. Check out the `useResizeObserver()` hook.\n   */\n  resizeObserver?: {\n    observe: ResizeObserver[\"observe\"];\n    disconnect: ResizeObserver[\"observe\"];\n    unobserve: ResizeObserver[\"unobserve\"];\n  };\n  /**\n   * This is the type of element the grid container will be rendered as.\n   *\n   * @default \"div\"`\n   */\n  as?: keyof JSX.IntrinsicElements | React.ComponentType<any>;\n  /**\n   * Optionally gives the grid container an `id` prop.\n   */\n  id?: string;\n  /**\n   * Optionally gives the grid container a `className` prop.\n   */\n  className?: string;\n  /**\n   * Adds extra `style` attributes to the container in addition to those\n   * created by the `useMasonry()` hook.\n   */\n  style?: React.CSSProperties;\n  /**\n   * Optionally swap out the accessibility `role` prop of the container and its items.\n   *\n   * @default \"grid\"\n   */\n  role?: \"grid\" | \"list\";\n  /**\n   * Change the `tabIndex` of the grid container.\n   *\n   * @default 0\n   */\n  tabIndex?: number;\n  /**\n   * Forwards a React ref to the grid container.\n   */\n  containerRef?:\n    | ((element: HTMLElement) => void)\n    | React.MutableRefObject<HTMLElement | null>;\n  /**\n   * This is the type of element the grid items will be rendered as.\n   *\n   * @default \"div\"\n   */\n  itemAs?: keyof JSX.IntrinsicElements | React.ComponentType<any>;\n  /**\n   * Adds extra `style` attributes to the grid items in addition to those\n   * created by the `useMasonry()` hook.\n   */\n  itemStyle?: React.CSSProperties;\n  /**\n   * This value is used for estimating the initial height of the masonry grid. It is important for\n   * the UX of the scrolling behavior and in determining how many `items` to render in a batch, so it's\n   * wise to set this value with some level accuracy, though it doesn't need to be perfect.\n   *\n   * @default 300\n   */\n  itemHeightEstimate?: number;\n  /**\n   * The value returned here must be unique to the item. By default, the key is the item's index. This is ok\n   * if your collection of items is never modified. Setting this property ensures that the component in `render`\n   * is reused each time the masonry grid is reflowed. A common pattern would be to return the item's database\n   * ID here if there is one, e.g. `data => data.id`\n   *\n   * @default (data, index) => index`\n   */\n  itemKey?: (data: Item, index: number) => string | number;\n  /**\n   * This number is used for determining the number of grid cells outside of the visible window to render.\n   * The default value is `2` which means \"render 2 windows worth (2 * `height`) of content before and after\n   * the items in the visible window\". A value of `3` would be 3 windows worth of grid cells, so it's a\n   * linear relationship.\n   *\n   * Overscanning is important for preventing tearing when scrolling through items in the grid, but setting\n   * too high of a vaimport { useForceUpdate } from './use-force-update';\nlue may create too much work for React to handle, so it's best that you tune this\n   * value accordingly.\n   *\n   * @default 2\n   */\n  overscanBy?: number;\n\n  /**\n   * This is the height of the window. If you're rendering the grid relative to the browser `window`,\n   * the current `document.documentElement.clientHeight` is the value you'll want to set here. If you're\n   * rendering the grid inside of another HTML element, you'll want to provide the current `element.offsetHeight`\n   * here.\n   */\n  height: number;\n  /**\n   * The current scroll progress in pixel of the window the grid is rendered in. If you're rendering\n   * the grid relative to the browser `window`, you'll want the most current `window.scrollY` here.\n   * If you're rendering the grid inside of another HTML element, you'll want the current `element.scrollTop`\n   * value here. The `useScroller()` hook and `<MasonryScroller>` components will help you if you're\n   * rendering the grid relative to the browser `window`.\n   */\n  scrollTop: number;\n  /**\n   * This property is used for determining whether or not the grid container should add styles that\n   * dramatically increase scroll performance. That is, turning off `pointer-events` and adding a\n   * `will-change: contents;` value to the style string. You can forgo using this prop, but I would\n   * not recommend that. The `useScroller()` hook and `<MasonryScroller>` components will help you if\n   * you're rendering the grid relative to the browser `window`.\n   *\n   * @default false\n   */\n  isScrolling?: boolean;\n  /**\n   * This component is rendered for each item of your `items` prop array. It should accept three props:\n   * `index`, `width`, and `data`. See RenderComponentProps.\n   */\n  render: React.ComponentType<RenderComponentProps<Item>>;\n  /**\n   * This callback is invoked any time the items currently being rendered by the grid change.\n   */\n  onRender?: (startIndex: number, stopIndex: number, items: Item[]) => void;\n}\n\nexport interface RenderComponentProps<Item> {\n  /**\n   * The index of the cell in the `items` prop array.\n   */\n  index: number;\n  /**\n   * The rendered width of the cell's column.\n   */\n  width: number;\n  /**\n   * The data at `items[index]` of your `items` prop array.\n   */\n  data: Item;\n}\n\n//\n// Render-phase utilities\n\n// ~5.5x faster than createElement without the memo\nconst createRenderElement = trieMemoize(\n  [OneKeyMap, {}, WeakMap, OneKeyMap],\n  (RenderComponent, index, data, columnWidth) => (\n    <RenderComponent index={index} data={data} width={columnWidth} />\n  )\n);\n\nconst getContainerStyle = memoizeOne(\n  (isScrolling: boolean | undefined, estimateHeight: number) => ({\n    position: \"relative\",\n    width: \"100%\",\n    maxWidth: \"100%\",\n    height: Math.ceil(estimateHeight),\n    maxHeight: Math.ceil(estimateHeight),\n    willChange: isScrolling ? \"contents\" : void 0,\n    pointerEvents: isScrolling ? \"none\" : void 0,\n  })\n);\n\nconst cmp2 = (args: IArguments, pargs: IArguments | any[]): boolean =>\n  args[0] === pargs[0] && args[1] === pargs[1];\n\nconst assignUserStyle = memoizeOne(\n  (containerStyle, userStyle) => Object.assign({}, containerStyle, userStyle),\n  // @ts-expect-error\n  cmp2\n);\n\nfunction defaultGetItemKey<Item>(_: Item, i: number) {\n  return i;\n}\n\n// the below memoizations for for ensuring shallow equal is reliable for pure\n// component children\nconst getCachedSize = memoizeOne(\n  (width: number): React.CSSProperties => ({\n    width,\n    zIndex: -1000,\n    visibility: \"hidden\",\n    position: \"absolute\",\n    writingMode: \"horizontal-tb\",\n  }),\n  (args, pargs) => args[0] === pargs[0]\n);\n\nconst getRefSetter = memoizeOne(\n  (\n      positioner: Positioner,\n      resizeObserver?: UseMasonryOptions<any>[\"resizeObserver\"]\n    ) =>\n    (index: number) =>\n    (el: HTMLElement | null): void => {\n      if (el === null) return;\n      if (resizeObserver) {\n        resizeObserver.observe(el);\n        elementsCache.set(el, index);\n      }\n      if (positioner.get(index) === void 0)\n        positioner.set(index, el.offsetHeight);\n    },\n  // @ts-expect-error\n  cmp2\n);\n","import {\n  clearRequestTimeout,\n  requestTimeout,\n} from \"@essentials/request-timeout\";\nimport useScrollPosition from \"@react-hook/window-scroll\";\nimport * as React from \"react\";\n\n/**\n * A hook for tracking whether the `window` is currently being scrolled and it's scroll position on\n * the y-axis. These values are used for determining which grid cells to render and when\n * to add styles to the masonry container that maximize scroll performance.\n *\n * @param offset - The vertical space in pixels between the top of the grid container and the top\n *  of the browser `document.documentElement`.\n * @param fps - This determines how often (in frames per second) to update the scroll position of the\n *  browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\n *  The default value of `12` has been very reasonable in my own testing, but if you have particularly\n *  heavy `render` components it may be prudent to reduce this number.\n */\nexport function useScroller(\n  offset = 0,\n  fps = 12\n): { scrollTop: number; isScrolling: boolean } {\n  const scrollTop = useScrollPosition(fps);\n  const [isScrolling, setIsScrolling] = React.useState(false);\n  const didMount = React.useRef(0);\n\n  React.useEffect(() => {\n    if (didMount.current === 1) setIsScrolling(true);\n    let didUnsubscribe = false;\n    const to = requestTimeout(() => {\n      if (didUnsubscribe) return;\n      // This is here to prevent premature bail outs while maintaining high resolution\n      // unsets. Without it there will always bee a lot of unnecessary DOM writes to style.\n      setIsScrolling(false);\n    }, 40 + 1000 / fps);\n    didMount.current = 1;\n    return () => {\n      didUnsubscribe = true;\n      clearRequestTimeout(to);\n    };\n  }, [fps, scrollTop]);\n\n  return { scrollTop: Math.max(0, scrollTop - offset), isScrolling };\n}\n","import { useMasonry } from \"./use-masonry\";\nimport type { UseMasonryOptions } from \"./use-masonry\";\nimport { useScroller } from \"./use-scroller\";\n/**\n * A heavily-optimized component that updates `useMasonry()` when the scroll position of the browser `window`\n * changes. This bare-metal component is used by `<Masonry>` under the hood.\n *\n * @param props\n */\nexport function MasonryScroller<Item>(props: MasonryScrollerProps<Item>) {\n  // We put this in its own layer because it's the thing that will trigger the most updates\n  // and we don't want to slower ourselves by cycling through all the functions, objects, and effects\n  // of other hooks\n  const { scrollTop, isScrolling } = useScroller(props.offset, props.scrollFps);\n  // This is an update-heavy phase and while we could just Object.assign here,\n  // it is way faster to inline and there's a relatively low hit to he bundle\n  // size.\n  return useMasonry<Item>({\n    scrollTop,\n    isScrolling,\n    positioner: props.positioner,\n    resizeObserver: props.resizeObserver,\n    items: props.items,\n    onRender: props.onRender,\n    as: props.as,\n    id: props.id,\n    className: props.className,\n    style: props.style,\n    role: props.role,\n    tabIndex: props.tabIndex,\n    containerRef: props.containerRef,\n    itemAs: props.itemAs,\n    itemStyle: props.itemStyle,\n    itemHeightEstimate: props.itemHeightEstimate,\n    itemKey: props.itemKey,\n    overscanBy: props.overscanBy,\n    height: props.height,\n    render: props.render,\n  });\n}\n\nexport interface MasonryScrollerProps<Item>\n  extends Omit<UseMasonryOptions<Item>, \"scrollTop\" | \"isScrolling\"> {\n  /**\n   * This determines how often (in frames per second) to update the scroll position of the\n   * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\n   * The default value of `12` has been very reasonable in my own testing, but if you have particularly\n   * heavy `render` components it may be prudent to reduce this number.\n   *\n   * @default 12\n   */\n  scrollFps?: number;\n  /**\n   * The vertical space in pixels between the top of the grid container and the top\n   * of the browser `document.documentElement`.\n   *\n   * @default 0\n   */\n  offset?: number;\n}\n\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n  MasonryScroller.displayName = \"MasonryScroller\";\n}\n","import useLayoutEffect from \"@react-hook/passive-layout-effect\";\nimport * as React from \"react\";\n\n/**\n * A hook for measuring the width of the grid container, as well as its distance\n * from the top of the document. These values are necessary to correctly calculate the number/width\n * of columns to render, as well as the number of rows to render.\n *\n * @param elementRef - A `ref` object created by `React.useRef()`. That ref should be provided to the\n *   `containerRef` property in `useMasonry()`.\n * @param deps - You can force this hook to recalculate the `offset` and `width` whenever this\n *   dependencies list changes. A common dependencies list might look like `[windowWidth, windowHeight]`,\n *   which would force the hook to recalculate any time the size of the browser `window` changed.\n */\nexport function useContainerPosition(\n  elementRef: React.MutableRefObject<HTMLElement | null>,\n  deps: React.DependencyList = emptyArr\n): ContainerPosition {\n  const [containerPosition, setContainerPosition] =\n    React.useState<ContainerPosition>({ offset: 0, width: 0 });\n\n  useLayoutEffect(() => {\n    const { current } = elementRef;\n    if (current !== null) {\n      let offset = 0;\n      let el = current;\n\n      do {\n        offset += el.offsetTop || 0;\n        el = el.offsetParent as HTMLElement;\n      } while (el);\n\n      if (\n        offset !== containerPosition.offset ||\n        current.offsetWidth !== containerPosition.width\n      ) {\n        setContainerPosition({\n          offset,\n          width: current.offsetWidth,\n        });\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, deps);\n\n  return containerPosition;\n}\n\nexport interface ContainerPosition {\n  /**\n   * The distance in pixels between the top of the element in `elementRef` and the top of\n   * the `document.documentElement`.\n   */\n  offset: number;\n  /**\n   * The `offsetWidth` of the element in `elementRef`.\n   */\n  width: number;\n}\n\nconst emptyArr: [] = [];\n","import * as React from \"react\";\nimport { createIntervalTree } from \"./interval-tree\";\n\n/**\n * This hook creates the grid cell positioner and cache required by `useMasonry()`. This is\n * the meat of the grid's layout algorithm, determining which cells to render at a given scroll\n * position, as well as where to place new items in the grid.\n *\n * @param options - Properties that determine the number of columns in the grid, as well\n *  as their widths.\n * @param options.columnWidth\n * @param options.width\n * @param deps - This hook will create a new positioner, clearing all existing cached positions,\n *  whenever the dependencies in this list change.\n * @param options.columnGutter\n * @param options.rowGutter\n * @param options.columnCount\n * @param options.maxColumnCount\n * @param options.maxColumnWidth\n */\nexport function usePositioner(\n  {\n    width,\n    columnWidth = 200,\n    columnGutter = 0,\n    rowGutter,\n    columnCount,\n    maxColumnCount,\n    maxColumnWidth,\n  }: UsePositionerOptions,\n  deps: React.DependencyList = emptyArr\n): Positioner {\n  const initPositioner = (): Positioner => {\n    const [computedColumnWidth, computedColumnCount] = getColumns(\n      width,\n      columnWidth,\n      columnGutter,\n      columnCount,\n      maxColumnCount,\n      maxColumnWidth\n    );\n    return createPositioner(\n      computedColumnCount,\n      computedColumnWidth,\n      columnGutter,\n      rowGutter ?? columnGutter\n    );\n  };\n  const positionerRef = React.useRef<Positioner>();\n  if (positionerRef.current === undefined)\n    positionerRef.current = initPositioner();\n\n  const prevDeps = React.useRef(deps);\n  const opts = [\n    width,\n    columnWidth,\n    columnGutter,\n    rowGutter,\n    columnCount,\n    maxColumnCount,\n    maxColumnWidth,\n  ];\n  const prevOpts = React.useRef(opts);\n  const optsChanged = !opts.every((item, i) => prevOpts.current[i] === item);\n\n  if (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n    if (deps.length !== prevDeps.current.length) {\n      throw new Error(\n        \"usePositioner(): The length of your dependencies array changed.\"\n      );\n    }\n  }\n\n  // Create a new positioner when the dependencies or sizes change\n  // Thanks to https://github.com/khmm12 for pointing this out\n  // https://github.com/jaredLunde/masonic/pull/41\n  if (optsChanged || !deps.every((item, i) => prevDeps.current[i] === item)) {\n    const prevPositioner = positionerRef.current;\n    const positioner = initPositioner();\n    prevDeps.current = deps;\n    prevOpts.current = opts;\n\n    if (optsChanged) {\n      const cacheSize = prevPositioner.size();\n      for (let index = 0; index < cacheSize; index++) {\n        const pos = prevPositioner.get(index);\n        positioner.set(index, pos !== void 0 ? pos.height : 0);\n      }\n    }\n\n    positionerRef.current = positioner;\n  }\n\n  return positionerRef.current;\n}\n\nexport interface UsePositionerOptions {\n  /**\n   * The width of the container you're rendering the grid within, i.e. the container\n   * element's `element.offsetWidth`\n   */\n  width: number;\n  /**\n   * The minimum column width. The `usePositioner()` hook will automatically size the\n   * columns to fill their container based upon the `columnWidth` and `columnGutter` values.\n   * It will never render anything smaller than this width unless its container itself is\n   * smaller than its value. This property is optional if you're using a static `columnCount`.\n   *\n   * @default 200\n   */\n  columnWidth?: number;\n  /**\n   * The maximum column width. Calculated column widths will be capped at this value.\n   */\n  maxColumnWidth?: number;\n  /**\n   * This sets the horizontal space between grid columns in pixels. If `rowGutter` is not set, this\n   * also sets the vertical space between cells within a column in pixels.\n   *\n   * @default 0\n   */\n  columnGutter?: number;\n  /**\n   * This sets the vertical space between cells within a column in pixels. If not set, the value of\n   * `columnGutter` is used instead.\n   */\n  rowGutter?: number;\n  /**\n   * By default, `usePositioner()` derives the column count from the `columnWidth`, `columnGutter`,\n   * and `width` props. However, in some situations it is nice to be able to override that behavior\n   * (e.g. creating a `List` component).\n   */\n  columnCount?: number;\n  /**\n   * The upper bound of column count. This property won't work if `columnCount` is set.\n   */\n  maxColumnCount?: number;\n}\n\n/**\n * Creates a cell positioner for the `useMasonry()` hook. The `usePositioner()` hook uses\n * this utility under the hood.\n *\n * @param columnCount - The number of columns in the grid\n * @param columnWidth - The width of each column in the grid\n * @param columnGutter - The amount of horizontal space between columns in pixels.\n * @param rowGutter - The amount of vertical space between cells within a column in pixels (falls back\n * to `columnGutter`).\n */\nexport const createPositioner = (\n  columnCount: number,\n  columnWidth: number,\n  columnGutter = 0,\n  rowGutter = columnGutter\n): Positioner => {\n  // O(log(n)) lookup of cells to render for a given viewport size\n  // Store tops and bottoms of each cell for fast intersection lookup.\n  const intervalTree = createIntervalTree();\n  // Track the height of each column.\n  // Layout algorithm below always inserts into the shortest column.\n  const columnHeights: number[] = new Array(columnCount);\n  // Used for O(1) item access\n  const items: PositionerItem[] = [];\n  // Tracks the item indexes within an individual column\n  const columnItems: number[][] = new Array(columnCount);\n\n  for (let i = 0; i < columnCount; i++) {\n    columnHeights[i] = 0;\n    columnItems[i] = [];\n  }\n\n  return {\n    columnCount,\n    columnWidth,\n    set: (index, height = 0) => {\n      let column = 0;\n\n      // finds the shortest column and uses it\n      for (let i = 1; i < columnHeights.length; i++) {\n        if (columnHeights[i] < columnHeights[column]) column = i;\n      }\n\n      const top = columnHeights[column] || 0;\n      columnHeights[column] = top + height + rowGutter;\n      columnItems[column].push(index);\n      items[index] = {\n        left: column * (columnWidth + columnGutter),\n        top,\n        height,\n        column,\n      };\n      intervalTree.insert(top, top + height, index);\n    },\n    get: (index) => items[index],\n    // This only updates items in the specific columns that have changed, on and after the\n    // specific items that have changed\n    update: (updates) => {\n      const columns: number[] = new Array(columnCount);\n      let i = 0,\n        j = 0;\n\n      // determines which columns have items that changed, as well as the minimum index\n      // changed in that column, as all items after that index will have their positions\n      // affected by the change\n      for (; i < updates.length - 1; i++) {\n        const index = updates[i];\n        const item = items[index];\n        item.height = updates[++i];\n        intervalTree.remove(index);\n        intervalTree.insert(item.top, item.top + item.height, index);\n        columns[item.column] =\n          columns[item.column] === void 0\n            ? index\n            : Math.min(index, columns[item.column]);\n      }\n\n      for (i = 0; i < columns.length; i++) {\n        // bails out if the column didn't change\n        if (columns[i] === void 0) continue;\n        const itemsInColumn = columnItems[i];\n        // the index order is sorted with certainty so binary search is a great solution\n        // here as opposed to Array.indexOf()\n        const startIndex = binarySearch(itemsInColumn, columns[i]);\n        const index = columnItems[i][startIndex];\n        const startItem = items[index];\n        columnHeights[i] = startItem.top + startItem.height + rowGutter;\n\n        for (j = startIndex + 1; j < itemsInColumn.length; j++) {\n          const index = itemsInColumn[j];\n          const item = items[index];\n          item.top = columnHeights[i];\n          columnHeights[i] = item.top + item.height + rowGutter;\n          intervalTree.remove(index);\n          intervalTree.insert(item.top, item.top + item.height, index);\n        }\n      }\n    },\n    // Render all cells visible within the viewport range defined.\n    range: (lo, hi, renderCallback) =>\n      intervalTree.search(lo, hi, (index, top) =>\n        renderCallback(index, items[index].left, top)\n      ),\n    estimateHeight: (itemCount, defaultItemHeight): number => {\n      const tallestColumn = Math.max(0, Math.max.apply(null, columnHeights));\n\n      return itemCount === intervalTree.size\n        ? tallestColumn\n        : tallestColumn +\n            Math.ceil((itemCount - intervalTree.size) / columnCount) *\n              defaultItemHeight;\n    },\n    shortestColumn: () => {\n      if (columnHeights.length > 1) return Math.min.apply(null, columnHeights);\n      return columnHeights[0] || 0;\n    },\n    size(): number {\n      return intervalTree.size;\n    },\n    all(): PositionerItem[] {\n      return items;\n    },\n  };\n};\n\nexport interface Positioner {\n  /**\n   * The number of columns in the grid\n   */\n  columnCount: number;\n  /**\n   * The width of each column in the grid\n   */\n  columnWidth: number;\n  /**\n   * Sets the position for the cell at `index` based upon the cell's height\n   */\n  set: (index: number, height: number) => void;\n  /**\n   * Gets the `PositionerItem` for the cell at `index`\n   */\n  get: (index: number) => PositionerItem | undefined;\n  /**\n   * Updates cells based on their indexes and heights\n   * positioner.update([index, height, index, height, index, height...])\n   */\n  update: (updates: number[]) => void;\n  /**\n   * Searches the interval tree for grid cells with a `top` value in\n   * betwen `lo` and `hi` and invokes the callback for each item that\n   * is discovered\n   */\n  range: (\n    lo: number,\n    hi: number,\n    renderCallback: (index: number, left: number, top: number) => void\n  ) => void;\n  /**\n   * Returns the number of grid cells in the cache\n   */\n\n  size: () => number;\n  /**\n   * Estimates the total height of the grid\n   */\n\n  estimateHeight: (itemCount: number, defaultItemHeight: number) => number;\n  /**\n   * Returns the height of the shortest column in the grid\n   */\n\n  shortestColumn: () => number;\n  /**\n   * Returns all `PositionerItem` items\n   */\n  all: () => PositionerItem[];\n}\n\nexport interface PositionerItem {\n  /**\n   * This is how far from the top edge of the grid container in pixels the\n   * item is placed\n   */\n  top: number;\n  /**\n   * This is how far from the left edge of the grid container in pixels the\n   * item is placed\n   */\n  left: number;\n  /**\n   * This is the height of the grid cell\n   */\n  height: number;\n  /**\n   * This is the column number containing the grid cell\n   */\n  column: number;\n}\n\n/* istanbul ignore next */\nconst binarySearch = (a: number[], y: number): number => {\n  let l = 0;\n  let h = a.length - 1;\n\n  while (l <= h) {\n    const m = (l + h) >>> 1;\n    const x = a[m];\n    if (x === y) return m;\n    else if (x <= y) l = m + 1;\n    else h = m - 1;\n  }\n\n  return -1;\n};\n\nconst getColumns = (\n  width = 0,\n  minimumWidth = 0,\n  gutter = 8,\n  columnCount?: number,\n  maxColumnCount?: number,\n  maxColumnWidth?: number\n): [number, number] => {\n  columnCount =\n    columnCount ||\n    Math.min(\n      Math.floor((width + gutter) / (minimumWidth + gutter)),\n      maxColumnCount || Infinity\n    ) ||\n    1;\n  let columnWidth = Math.floor(\n    (width - gutter * (columnCount - 1)) / columnCount\n  );\n\n  // Cap the column width if maxColumnWidth is specified\n  if (maxColumnWidth !== undefined && columnWidth > maxColumnWidth) {\n    columnWidth = maxColumnWidth;\n  }\n\n  return [columnWidth, columnCount];\n};\n\nconst emptyArr: [] = [];\n","import rafSchd from \"raf-schd\";\nimport * as React from \"react\";\nimport trieMemoize from \"trie-memoize\";\nimport { elementsCache } from \"./elements-cache\";\nimport { useForceUpdate } from \"./use-force-update\";\nimport type { Positioner } from \"./use-positioner\";\n\n/**\n * Creates a resize observer that forces updates to the grid cell positions when mutations are\n * made to cells affecting their height.\n *\n * @param positioner - The masonry cell positioner created by the `usePositioner()` hook.\n */\nexport function useResizeObserver(positioner: Positioner) {\n  const forceUpdate = useForceUpdate();\n  const resizeObserver = createResizeObserver(positioner, forceUpdate);\n  // Cleans up the resize observers when they change or the\n  // component unmounts\n  React.useEffect(() => () => resizeObserver.disconnect(), [resizeObserver]);\n  return resizeObserver;\n}\n\nconst _handlerForType = rafSchd((target: HTMLElement) => {});\n\ntype IHandler = typeof _handlerForType;\n\n/**\n * Creates a resize observer that fires an `updater` callback whenever the height of\n * one or many cells change. The `useResizeObserver()` hook is using this under the hood.\n *\n * @param positioner - A cell positioner created by the `usePositioner()` hook or the `createPositioner()` utility\n * @param updater - A callback that fires whenever one or many cell heights change.\n */\nexport const createResizeObserver = trieMemoize(\n  [WeakMap],\n  // TODO: figure out a way to test this\n  /* istanbul ignore next */\n  (positioner: Positioner, updater: (updates: number[]) => void) => {\n    const updates: number[] = [];\n\n    const update = rafSchd(() => {\n      if (updates.length > 0) {\n        // Updates the size/positions of the cell with the resize\n        // observer updates\n        positioner.update(updates);\n        updater(updates);\n      }\n      updates.length = 0;\n    });\n\n    const commonHandler = (target: HTMLElement) => {\n      const height = target.offsetHeight;\n      if (height > 0) {\n        const index = elementsCache.get(target);\n        if (index !== void 0) {\n          const position = positioner.get(index);\n          if (position !== void 0 && height !== position.height)\n            updates.push(index, height);\n        }\n      }\n      update();\n    };\n\n    const handlers = new Map<number, IHandler>();\n    const handleEntries: ResizeObserverCallback = (entries) => {\n      let i = 0;\n\n      for (; i < entries.length; i++) {\n        const entry = entries[i];\n        const index = elementsCache.get(entry.target);\n\n        if (index === void 0) continue;\n        let handler = handlers.get(index);\n        if (!handler) {\n          handler = rafSchd(commonHandler);\n          handlers.set(index, handler);\n        }\n        handler(entry.target as HTMLElement);\n      }\n    };\n\n    const ro = new ResizeObserver(handleEntries);\n    // Overrides the original disconnect to include cancelling handling the entries.\n    // Ideally this would be its own method but that would result in a breaking\n    // change.\n    const disconnect = ro.disconnect.bind(ro);\n    ro.disconnect = () => {\n      disconnect();\n      handlers.forEach((handler) => {\n        handler.cancel();\n      });\n    };\n\n    return ro;\n  }\n);\n","import useEvent from \"@react-hook/event\";\nimport useLatest from \"@react-hook/latest\";\nimport { useThrottleCallback } from \"@react-hook/throttle\";\nimport * as React from \"react\";\nimport type { Positioner, PositionerItem } from \"./use-positioner\";\n\n/**\n * A hook that creates a callback for scrolling to a specific index in\n * the \"items\" array.\n *\n * @param positioner - A positioner created by the `usePositioner()` hook\n * @param options - Configuration options\n */\nexport function useScrollToIndex(\n  positioner: Positioner,\n  options: UseScrollToIndexOptions\n) {\n  const {\n    align = \"top\",\n    element = typeof window !== \"undefined\" && window,\n    offset = 0,\n    height = typeof window !== \"undefined\" ? window.innerHeight : 0,\n  } = options;\n  const latestOptions = useLatest({\n    positioner,\n    element,\n    align,\n    offset,\n    height,\n  } as const);\n  const getTarget = React.useRef(() => {\n    const latestElement = latestOptions.current.element;\n    return latestElement && \"current\" in latestElement\n      ? latestElement.current\n      : latestElement;\n  }).current;\n  const [state, dispatch] = React.useReducer(\n    (\n      state: {\n        position: PositionerItem | undefined;\n        index: number | undefined;\n        prevTop: number | undefined;\n      },\n      action:\n        | { type: \"scrollToIndex\"; value: number | undefined }\n        | { type: \"setPosition\"; value: PositionerItem | undefined }\n        | { type: \"setPrevTop\"; value: number | undefined }\n        | { type: \"reset\" }\n    ) => {\n      const nextState = {\n        position: state.position,\n        index: state.index,\n        prevTop: state.prevTop,\n      };\n\n      /* istanbul ignore next */\n      if (action.type === \"scrollToIndex\") {\n        return {\n          position: latestOptions.current.positioner.get(action.value ?? -1),\n          index: action.value,\n          prevTop: void 0,\n        };\n      } else if (action.type === \"setPosition\") {\n        nextState.position = action.value;\n      } else if (action.type === \"setPrevTop\") {\n        nextState.prevTop = action.value;\n      } else if (action.type === \"reset\") {\n        return defaultState;\n      }\n\n      return nextState;\n    },\n    defaultState\n  );\n  const throttledDispatch = useThrottleCallback(dispatch, 15);\n\n  // If we find the position along the way we can immediately take off\n  // to the correct spot.\n  useEvent(getTarget() as Window, \"scroll\", () => {\n    if (!state.position && state.index) {\n      const position = latestOptions.current.positioner.get(state.index);\n\n      if (position) {\n        dispatch({ type: \"setPosition\", value: position });\n      }\n    }\n  });\n\n  // If the top changes out from under us in the case of dynamic cells, we\n  // want to keep following it.\n  const currentTop =\n    state.index !== void 0 &&\n    latestOptions.current.positioner.get(state.index)?.top;\n\n  React.useEffect(() => {\n    const target = getTarget();\n    if (!target) return;\n    const { height, align, offset, positioner } = latestOptions.current;\n\n    if (state.position) {\n      let scrollTop = state.position.top;\n\n      if (align === \"bottom\") {\n        scrollTop = scrollTop - height + state.position.height;\n      } else if (align === \"center\") {\n        scrollTop -= (height - state.position.height) / 2;\n      }\n\n      target.scrollTo(0, Math.max(0, (scrollTop += offset)));\n      // Resets state after 400ms, an arbitrary time I determined to be\n      // still visually pleasing if there is a slow network reply in dynamic\n      // cells\n      let didUnsubscribe = false;\n      const timeout = setTimeout(\n        () => !didUnsubscribe && dispatch({ type: \"reset\" }),\n        400\n      );\n      return () => {\n        didUnsubscribe = true;\n        clearTimeout(timeout);\n      };\n    } else if (state.index !== void 0) {\n      // Estimates the top based upon the average height of current cells\n      let estimatedTop =\n        (positioner.shortestColumn() / positioner.size()) * state.index;\n      if (state.prevTop)\n        estimatedTop = Math.max(estimatedTop, state.prevTop + height);\n      target.scrollTo(0, estimatedTop);\n      throttledDispatch({ type: \"setPrevTop\", value: estimatedTop });\n    }\n  }, [currentTop, state, latestOptions, getTarget, throttledDispatch]);\n\n  return React.useRef((index: number) => {\n    dispatch({ type: \"scrollToIndex\", value: index });\n  }).current;\n}\n\nconst defaultState = {\n  index: void 0,\n  position: void 0,\n  prevTop: void 0,\n} as const;\n\nexport type UseScrollToIndexOptions = {\n  /**\n   * The window element or a React ref for the window element. That is,\n   * this is the grid container.\n   *\n   * @default window\n   */\n  element?: Window | HTMLElement | React.RefObject<HTMLElement> | null;\n  /**\n   * Sets the vertical alignment of the cell within the grid container.\n   *\n   * @default \"top\"\n   */\n  align?: \"center\" | \"top\" | \"bottom\";\n  /**\n   * The height of the grid.\n   *\n   * @default window.innerHeight\n   */\n  height?: number;\n  /**\n   * The vertical space in pixels between the top of the grid container and the top\n   * of the window.\n   *\n   * @default 0\n   */\n  offset?: number;\n};\n","import { useWindowSize } from \"@react-hook/window-size\";\nimport * as React from \"react\";\nimport { MasonryScroller } from \"./masonry-scroller\";\nimport type { MasonryScrollerProps } from \"./masonry-scroller\";\nimport { useContainerPosition } from \"./use-container-position\";\nimport { usePositioner } from \"./use-positioner\";\nimport type { UsePositionerOptions } from \"./use-positioner\";\nimport { useResizeObserver } from \"./use-resize-observer\";\nimport { useScrollToIndex } from \"./use-scroll-to-index\";\nimport type { UseScrollToIndexOptions } from \"./use-scroll-to-index\";\n\n/**\n * A \"batteries included\" masonry grid which includes all of the implementation details below. This component is the\n * easiest way to get off and running in your app, before switching to more advanced implementations, if necessary.\n * It will change its column count to fit its container's width and will decide how many rows to render based upon\n * the height of the browser `window`.\n *\n * @param props\n */\nexport function Masonry<Item>(props: MasonryProps<Item>) {\n  const containerRef = React.useRef<null | HTMLElement>(null);\n  const windowSize = useWindowSize({\n    initialWidth: props.ssrWidth,\n    initialHeight: props.ssrHeight,\n  });\n  const containerPos = useContainerPosition(containerRef, windowSize);\n  const nextProps = Object.assign(\n    {\n      offset: containerPos.offset,\n      width: containerPos.width || windowSize[0],\n      height: windowSize[1],\n      containerRef,\n    },\n    props\n  ) as any;\n  nextProps.positioner = usePositioner(nextProps);\n  nextProps.resizeObserver = useResizeObserver(nextProps.positioner);\n  const scrollToIndex = useScrollToIndex(nextProps.positioner, {\n    height: nextProps.height,\n    offset: containerPos.offset,\n    align:\n      typeof props.scrollToIndex === \"object\"\n        ? props.scrollToIndex.align\n        : void 0,\n  });\n  const index =\n    props.scrollToIndex &&\n    (typeof props.scrollToIndex === \"number\"\n      ? props.scrollToIndex\n      : props.scrollToIndex.index);\n\n  React.useEffect(() => {\n    if (index !== void 0) scrollToIndex(index);\n  }, [index, scrollToIndex]);\n\n  return React.createElement(MasonryScroller, nextProps);\n}\n\nexport interface MasonryProps<Item>\n  extends Omit<\n      MasonryScrollerProps<Item>,\n      \"offset\" | \"width\" | \"height\" | \"containerRef\" | \"positioner\"\n    >,\n    Pick<\n      UsePositionerOptions,\n      | \"columnWidth\"\n      | \"columnGutter\"\n      | \"rowGutter\"\n      | \"columnCount\"\n      | \"maxColumnCount\"\n      | \"maxColumnWidth\"\n    > {\n  /**\n   * Scrolls to a given index within the grid. The grid will re-scroll\n   * any time the index changes.\n   */\n  scrollToIndex?:\n    | number\n    | {\n        index: number;\n        align: UseScrollToIndexOptions[\"align\"];\n      };\n  /**\n   * This is the width that will be used for the browser `window` when rendering this component in SSR.\n   * This prop isn't relevant for client-side only apps.\n   */\n  ssrWidth?: number;\n  /**\n   * This is the height that will be used for the browser `window` when rendering this component in SSR.\n   * This prop isn't relevant for client-side only apps.\n   */\n  ssrHeight?: number;\n  /**\n   * This determines how often (in frames per second) to update the scroll position of the\n   * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\n   * The default value of `12` has been very reasonable in my own testing, but if you have particularly\n   * heavy `render` components it may be prudent to reduce this number.\n   *\n   * @default 12\n   */\n  scrollFps?: number;\n}\n\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n  Masonry.displayName = \"Masonry\";\n}\n","import * as React from \"react\";\nimport { Masonry } from \"./masonry\";\nimport type { MasonryProps } from \"./masonry\";\n\n/**\n * This is just a single-column `<Masonry>` component without column-specific props.\n *\n * @param props\n */\nexport function List<Item>(props: ListProps<Item>) {\n  return (\n    <Masonry<Item>\n      role=\"list\"\n      rowGutter={props.rowGutter}\n      columnCount={1}\n      columnWidth={1}\n      {...props}\n    />\n  );\n}\n\nexport interface ListProps<Item>\n  extends Omit<\n    MasonryProps<Item>,\n    \"columGutter\" | \"columnCount\" | \"columnWidth\"\n  > {\n  /**\n   * The amount of vertical space in pixels to add between the list cells.\n   *\n   * @default 0\n   */\n  rowGutter?: number;\n}\n\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n  List.displayName = \"List\";\n}\n","import useLatest from \"@react-hook/latest\";\nimport * as React from \"react\";\n\n/**\n * A utility hook for seamlessly adding infinite scroll behavior to the `useMasonry()` hook. This\n * hook invokes a callback each time the last rendered index surpasses the total number of items\n * in your items array or the number defined in the `totalItems` option.\n *\n * @param loadMoreItems - This callback is invoked when more rows must be loaded. It will be used to\n *  determine when to refresh the list with the newly-loaded data. This callback may be called multiple\n *  times in reaction to a single scroll event, so it's important to memoize its arguments. If you're\n *  creating this callback inside of a functional component, make sure you wrap it in `React.useCallback()`,\n *  as well.\n * @param options\n */\nexport function useInfiniteLoader<Item, T extends LoadMoreItemsCallback<Item>>(\n  loadMoreItems: T,\n  options: UseInfiniteLoaderOptions<Item> = emptyObj\n): LoadMoreItemsCallback<Item> {\n  const {\n    isItemLoaded,\n    minimumBatchSize = 16,\n    threshold = 16,\n    totalItems = 9e9,\n  } = options;\n  const storedLoadMoreItems = useLatest(loadMoreItems);\n  const storedIsItemLoaded = useLatest(isItemLoaded);\n\n  return React.useCallback(\n    (startIndex, stopIndex, items) => {\n      const unloadedRanges = scanForUnloadedRanges(\n        storedIsItemLoaded.current,\n        minimumBatchSize,\n        items,\n        totalItems,\n        Math.max(0, startIndex - threshold),\n        Math.min(totalItems - 1, (stopIndex || 0) + threshold)\n      );\n      // The user is responsible for memoizing their loadMoreItems() function\n      // because we don't want to make assumptions about how they want to deal\n      // with `items`\n      for (let i = 0; i < unloadedRanges.length - 1; ++i)\n        storedLoadMoreItems.current(\n          unloadedRanges[i],\n          unloadedRanges[++i],\n          items\n        );\n    },\n    [\n      totalItems,\n      minimumBatchSize,\n      threshold,\n      storedLoadMoreItems,\n      storedIsItemLoaded,\n    ]\n  );\n}\n\n/**\n * Returns all of the ranges within a larger range that contain unloaded rows.\n *\n * @param isItemLoaded\n * @param minimumBatchSize\n * @param items\n * @param totalItems\n * @param startIndex\n * @param stopIndex\n */\nfunction scanForUnloadedRanges<Item>(\n  isItemLoaded: UseInfiniteLoaderOptions<Item>[\"isItemLoaded\"] = defaultIsItemLoaded,\n  minimumBatchSize: UseInfiniteLoaderOptions<Item>[\"minimumBatchSize\"] = 16,\n  items: any[],\n  totalItems: UseInfiniteLoaderOptions<Item>[\"totalItems\"] = 9e9,\n  startIndex: number,\n  stopIndex: number\n): number[] {\n  const unloadedRanges: number[] = [];\n  let rangeStartIndex: number | undefined,\n    rangeStopIndex: number | undefined,\n    index = startIndex;\n\n  /* istanbul ignore next */\n  for (; index <= stopIndex; index++) {\n    if (!isItemLoaded(index, items)) {\n      rangeStopIndex = index;\n      if (rangeStartIndex === void 0) rangeStartIndex = index;\n    } else if (rangeStartIndex !== void 0 && rangeStopIndex !== void 0) {\n      unloadedRanges.push(rangeStartIndex, rangeStopIndex);\n      rangeStartIndex = rangeStopIndex = void 0;\n    }\n  }\n\n  // If :rangeStopIndex is not null it means we haven't run out of unloaded rows.\n  // Scan forward to try filling our :minimumBatchSize.\n  if (rangeStartIndex !== void 0 && rangeStopIndex !== void 0) {\n    const potentialStopIndex = Math.min(\n      Math.max(rangeStopIndex, rangeStartIndex + minimumBatchSize - 1),\n      totalItems - 1\n    );\n\n    /* istanbul ignore next */\n    for (index = rangeStopIndex + 1; index <= potentialStopIndex; index++) {\n      if (!isItemLoaded(index, items)) {\n        rangeStopIndex = index;\n      } else {\n        break;\n      }\n    }\n\n    unloadedRanges.push(rangeStartIndex, rangeStopIndex);\n  }\n\n  // Check to see if our first range ended prematurely.\n  // In this case we should scan backwards to try filling our :minimumBatchSize.\n  /* istanbul ignore next */\n  if (unloadedRanges.length) {\n    let firstUnloadedStart = unloadedRanges[0];\n    const firstUnloadedStop = unloadedRanges[1];\n\n    while (\n      firstUnloadedStop - firstUnloadedStart + 1 < minimumBatchSize &&\n      firstUnloadedStart > 0\n    ) {\n      const index = firstUnloadedStart - 1;\n\n      if (!isItemLoaded(index, items)) {\n        unloadedRanges[0] = firstUnloadedStart = index;\n      } else {\n        break;\n      }\n    }\n  }\n\n  return unloadedRanges;\n}\n\nconst defaultIsItemLoaded = <Item>(index: number, items: Item[]): boolean =>\n  items[index] !== void 0;\n\nexport interface UseInfiniteLoaderOptions<Item> {\n  /**\n   *  A callback responsible for determining the loaded state of each item. Should return `true`\n   * if the item has already been loaded and `false` if not.\n   *\n   * @default (index: number, items: any[]) => boolean\n   */\n  isItemLoaded?: (index: number, items: Item[]) => boolean;\n  /**\n   * The minimum number of new items to be loaded at a time.  This property can be used to\n   * batch requests and reduce HTTP requests.\n   *\n   * @default 16\n   */\n  minimumBatchSize?: number;\n  /**\n   * The threshold at which to pre-fetch data. A threshold X means that new data should start\n   * loading when a user scrolls within X cells of the end of your `items` array.\n   *\n   * @default 16\n   */\n  threshold?: number;\n  /**\n   * The total number of items you'll need to eventually load (if known). This can\n   * be arbitrarily high if not known.\n   *\n   * @default 9e9\n   */\n  totalItems?: number;\n}\n\nexport type LoadMoreItemsCallback<Item> = (\n  startIndex: number,\n  stopIndex: number,\n  items: Item[]\n) => any;\n\nconst emptyObj = {};\n","export const elementsCache: WeakMap<Element, number> = new WeakMap();\n"],"names":["updateMax","node","max","high","L","NULL_NODE","R","Math","updateMaxUp","x","P","rotateLeft","tree","y","root","rotateRight","replaceNode","createIntervalTree","size","indexMap","insert","low","index","treeNode","prevNode","list","next","addInterval","z","C","fixInsert","remove","intervalResult","removeInterval","originalYColor","minimumTree","w","fixRemove","search","callback","stack","length","pop","push","curr","useForceUpdate","setState","React","useState","emptyObj","useRef","current","useMasonry","stopIndex","positioner","resizeObserver","items","as","ContainerComponent","id","className","style","role","tabIndex","containerRef","itemAs","ItemComponent","itemStyle","itemHeightEstimate","itemKey","defaultGetItemKey","overscanBy","scrollTop","isScrolling","height","render","RenderComponent","onRender","startIndex","forceUpdate","setItemRef","getRefSetter","itemCount","columnWidth","columnCount","range","estimateHeight","shortestColumn","measuredCount","shortestColumnSize","children","itemRole","undefined","storedOnRender","useLatest","rangeEnd","needsFreshBatch","left","top","data","key","phaseTwoStyle","width","writingMode","position","__reactCreateElement__","ref","Object","assign","createRenderElement","min","batchSize","ceil","phaseOneStyle","getCachedSize","useEffect","didEverMount","containerStyle","getContainerStyle","assignUserStyle","_","i","useScroller","offset","fps","useScrollPosition","setIsScrolling","didMount","didUnsubscribe","to","requestTimeout","clearRequestTimeout","MasonryScroller","props","scrollFps","useContainerPosition","elementRef","deps","emptyArr","containerPosition","setContainerPosition","useLayoutEffect","el","offsetTop","offsetParent","offsetWidth","usePositioner","columnGutter","rowGutter","maxColumnCount","maxColumnWidth","initPositioner","computedColumnWidth","computedColumnCount","getColumns","createPositioner","positionerRef","prevDeps","opts","prevOpts","optsChanged","every","item","prevPositioner","cacheSize","pos","get","set","useResizeObserver","disconnect","createResizeObserver","handler","cancel","useScrollToIndex","options","align","element","window","innerHeight","latestOptions","getTarget","latestElement","state","dispatch","useReducer","action","nextState","prevTop","type","value","defaultState","throttledDispatch","useThrottleCallback","useEvent","currentTop","_latestOptions$curren","target","scrollTo","timeout","setTimeout","clearTimeout","estimatedTop","Masonry","windowSize","useWindowSize","initialWidth","ssrWidth","initialHeight","ssrHeight","containerPos","nextProps","scrollToIndex","List","useInfiniteLoader","loadMoreItems","isItemLoaded","minimumBatchSize","threshold","totalItems","storedLoadMoreItems","storedIsItemLoaded","useCallback","unloadedRanges","defaultIsItemLoaded","rangeStartIndex","rangeStopIndex","potentialStopIndex","firstUnloadedStart","firstUnloadedStop","scanForUnloadedRanges","elementsCache","WeakMap","trieMemoize","OneKeyMap","memoizeOne","maxWidth","maxHeight","willChange","pointerEvents","cmp2","args","pargs","userStyle","zIndex","visibility","observe","offsetHeight","intervalTree","columnHeights","Array","columnItems","column","update","updates","columns","j","itemsInColumn","binarySearch","startItem","lo","hi","renderCallback","defaultItemHeight","tallestColumn","apply","all","a","l","h","m","minimumWidth","gutter","floor","Infinity","updater","rafSchd","commonHandler","handlers","Map","ro","ResizeObserver","entries","entry","bind","forEach"],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"index.mjs","sources":[],"sourcesContent":[],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/dist/main/use-positioner.js b/dist/main/use-positioner.js
index 503f67646024eeedc04b40c60cbe8e490e838c94..d9d991b0a548977106802e8eab05ff8bca8f4fa3 100644
--- a/dist/main/use-positioner.js
+++ b/dist/main/use-positioner.js
@@ -111,12 +111,7 @@ const createPositioner = (columnCount, columnWidth, columnGutter = 0, rowGutter
     columnCount,
     columnWidth,
     set: (index, height = 0) => {
-      let column = 0; // finds the shortest column and uses it
-
-      for (let i = 1; i < columnHeights.length; i++) {
-        if (columnHeights[i] < columnHeights[column]) column = i;
-      }
-
+      const column = index % columnCount;
       const top = columnHeights[column] || 0;
       columnHeights[column] = top + height + rowGutter;
       columnItems[column].push(index);
diff --git a/dist/module/use-container-position.js b/dist/module/use-container-position.js
index f341a66e16c83fee461ee8280e143cb09f18992a..f2ee4db1e5048275ebce2d461e1fc0b9cd6a165b 100644
--- a/dist/module/use-container-position.js
+++ b/dist/module/use-container-position.js
@@ -12,11 +12,7 @@ import * as React from "react";
  *   which would force the hook to recalculate any time the size of the browser `window` changed.
  */
 
-export function useContainerPosition(elementRef, deps) {
-  if (deps === void 0) {
-    deps = emptyArr;
-  }
-
+export function useContainerPosition(elementRef, deps = emptyArr) {
   const [containerPosition, setContainerPosition] = React.useState({
     offset: 0,
     width: 0
diff --git a/dist/module/use-infinite-loader.js b/dist/module/use-infinite-loader.js
index f5942494159659fe47733eaddeae2003a08c5d8b..e49a20b13ee024caba4b17faf2c42a2b2fe6d341 100644
--- a/dist/module/use-infinite-loader.js
+++ b/dist/module/use-infinite-loader.js
@@ -13,11 +13,7 @@ import * as React from "react";
  * @param options
  */
 
-export function useInfiniteLoader(loadMoreItems, options) {
-  if (options === void 0) {
-    options = emptyObj;
-  }
-
+export function useInfiniteLoader(loadMoreItems, options = emptyObj) {
   const {
     isItemLoaded,
     minimumBatchSize = 16,
@@ -45,19 +41,7 @@ export function useInfiniteLoader(loadMoreItems, options) {
  * @param stopIndex
  */
 
-function scanForUnloadedRanges(isItemLoaded, minimumBatchSize, items, totalItems, startIndex, stopIndex) {
-  if (isItemLoaded === void 0) {
-    isItemLoaded = defaultIsItemLoaded;
-  }
-
-  if (minimumBatchSize === void 0) {
-    minimumBatchSize = 16;
-  }
-
-  if (totalItems === void 0) {
-    totalItems = 9e9;
-  }
-
+function scanForUnloadedRanges(isItemLoaded = defaultIsItemLoaded, minimumBatchSize = 16, items, totalItems = 9e9, startIndex, stopIndex) {
   const unloadedRanges = [];
   let rangeStartIndex,
       rangeStopIndex,
diff --git a/dist/module/use-masonry.js b/dist/module/use-masonry.js
index 06c9e5a085a41c7dfc45cbbf6efaeeae80870b2a..469982e90beadc153a106d9149cb7696a97138ef 100644
--- a/dist/module/use-masonry.js
+++ b/dist/module/use-masonry.js
@@ -32,34 +32,33 @@ import { useForceUpdate } from "./use-force-update";
  * @param options.render
  * @param options.onRender
  */
-export function useMasonry(_ref) {
-  let {
-    // Measurement and layout
-    positioner,
-    resizeObserver,
-    // Grid items
-    items,
-    // Container props
-    as: ContainerComponent = "div",
-    id,
-    className,
-    style,
-    role = "grid",
-    tabIndex = 0,
-    containerRef,
-    // Item props
-    itemAs: ItemComponent = "div",
-    itemStyle,
-    itemHeightEstimate = 300,
-    itemKey = defaultGetItemKey,
-    // Rendering props
-    overscanBy = 2,
-    scrollTop,
-    isScrolling,
-    height,
-    render: RenderComponent,
-    onRender
-  } = _ref;
+export function useMasonry({
+  // Measurement and layout
+  positioner,
+  resizeObserver,
+  // Grid items
+  items,
+  // Container props
+  as: ContainerComponent = "div",
+  id,
+  className,
+  style,
+  role = "grid",
+  tabIndex = 0,
+  containerRef,
+  // Item props
+  itemAs: ItemComponent = "div",
+  itemStyle,
+  itemHeightEstimate = 300,
+  itemKey = defaultGetItemKey,
+  // Rendering props
+  overscanBy = 2,
+  scrollTop,
+  isScrolling,
+  height,
+  render: RenderComponent,
+  onRender
+}) {
   let startIndex = 0;
   let stopIndex;
   const forceUpdate = useForceUpdate();
diff --git a/dist/module/use-positioner.js b/dist/module/use-positioner.js
index 8b0410965474e932e7fc6624bd13f44d542e2acd..c539082a7d08e79a886a762ab9951237fa54537c 100644
--- a/dist/module/use-positioner.js
+++ b/dist/module/use-positioner.js
@@ -18,21 +18,15 @@ import { createIntervalTree } from "./interval-tree";
  * @param options.maxColumnWidth
  */
 
-export function usePositioner(_ref, deps) {
-  let {
-    width,
-    columnWidth = 200,
-    columnGutter = 0,
-    rowGutter,
-    columnCount,
-    maxColumnCount,
-    maxColumnWidth
-  } = _ref;
-
-  if (deps === void 0) {
-    deps = emptyArr;
-  }
-
+export function usePositioner({
+  width,
+  columnWidth = 200,
+  columnGutter = 0,
+  rowGutter,
+  columnCount,
+  maxColumnCount,
+  maxColumnWidth
+}, deps = emptyArr) {
   const initPositioner = () => {
     const [computedColumnWidth, computedColumnCount] = getColumns(width, columnWidth, columnGutter, columnCount, maxColumnCount, maxColumnWidth);
     return createPositioner(computedColumnCount, computedColumnWidth, columnGutter, rowGutter !== null && rowGutter !== void 0 ? rowGutter : columnGutter);
@@ -85,15 +79,7 @@ export function usePositioner(_ref, deps) {
  * @param rowGutter - The amount of vertical space between cells within a column in pixels (falls back
  * to `columnGutter`).
  */
-export const createPositioner = function (columnCount, columnWidth, columnGutter, rowGutter) {
-  if (columnGutter === void 0) {
-    columnGutter = 0;
-  }
-
-  if (rowGutter === void 0) {
-    rowGutter = columnGutter;
-  }
-
+export const createPositioner = (columnCount, columnWidth, columnGutter = 0, rowGutter = columnGutter) => {
   // O(log(n)) lookup of cells to render for a given viewport size
   // Store tops and bottoms of each cell for fast intersection lookup.
   const intervalTree = createIntervalTree(); // Track the height of each column.
@@ -113,17 +99,8 @@ export const createPositioner = function (columnCount, columnWidth, columnGutter
   return {
     columnCount,
     columnWidth,
-    set: function (index, height) {
-      if (height === void 0) {
-        height = 0;
-      }
-
-      let column = 0; // finds the shortest column and uses it
-
-      for (let i = 1; i < columnHeights.length; i++) {
-        if (columnHeights[i] < columnHeights[column]) column = i;
-      }
-
+    set: (index, height = 0) => {
+      const column = index % columnCount;
       const top = columnHeights[column] || 0;
       columnHeights[column] = top + height + rowGutter;
       columnItems[column].push(index);
@@ -211,19 +188,7 @@ const binarySearch = (a, y) => {
   return -1;
 };
 
-const getColumns = function (width, minimumWidth, gutter, columnCount, maxColumnCount, maxColumnWidth) {
-  if (width === void 0) {
-    width = 0;
-  }
-
-  if (minimumWidth === void 0) {
-    minimumWidth = 0;
-  }
-
-  if (gutter === void 0) {
-    gutter = 8;
-  }
-
+const getColumns = (width = 0, minimumWidth = 0, gutter = 8, columnCount, maxColumnCount, maxColumnWidth) => {
   columnCount = columnCount || Math.min(Math.floor((width + gutter) / (minimumWidth + gutter)), maxColumnCount || Infinity) || 1;
   let columnWidth = Math.floor((width - gutter * (columnCount - 1)) / columnCount); // Cap the column width if maxColumnWidth is specified
 
diff --git a/dist/module/use-scroller.js b/dist/module/use-scroller.js
index b4f5d276139d4272d2483bcb67ba91f41540ab30..157a8a6add677585000529de12a0a46c1d21b92e 100644
--- a/dist/module/use-scroller.js
+++ b/dist/module/use-scroller.js
@@ -14,15 +14,7 @@ import * as React from "react";
  *  heavy `render` components it may be prudent to reduce this number.
  */
 
-export function useScroller(offset, fps) {
-  if (offset === void 0) {
-    offset = 0;
-  }
-
-  if (fps === void 0) {
-    fps = 12;
-  }
-
+export function useScroller(offset = 0, fps = 12) {
   const scrollTop = useScrollPosition(fps);
   const [isScrolling, setIsScrolling] = React.useState(false);
   const didMount = React.useRef(0);
diff --git a/dist/umd/masonic.dev.js b/dist/umd/masonic.dev.js
index 9f2e923f1d80746bcf01009de24fe45102ef22ae..0969a64163609977af08588f256a37c54b010c0c 100644
--- a/dist/umd/masonic.dev.js
+++ b/dist/umd/masonic.dev.js
@@ -948,11 +948,11 @@
     var start = now$1(),
         handle = {};
 
-    var loop = function loop() {
-      now$1() - start >= ms ? fn.call(null) : handle.v = raf(loop);
+    var _loop = function loop() {
+      now$1() - start >= ms ? fn.call(null) : handle.v = raf(_loop);
     };
 
-    handle.v = raf(loop);
+    handle.v = raf(_loop);
     return handle;
   };
 
@@ -1315,12 +1315,7 @@
           height = 0;
         }
 
-        var column = 0; // finds the shortest column and uses it
-
-        for (var _i2 = 1; _i2 < columnHeights.length; _i2++) {
-          if (columnHeights[_i2] < columnHeights[column]) column = _i2;
-        }
-
+        var column = index % columnCount;
         var top = columnHeights[column] || 0;
         columnHeights[column] = top + height + rowGutter;
         columnItems[column].push(index);
diff --git a/dist/umd/masonic.dev.js.map b/dist/umd/masonic.dev.js.map
index bc3a714d63891de48b4fcc074fc4fe19ca2c87ca..7aff1c0556f796bff001baa0f09fc5cfdc33602e 100644
--- a/dist/umd/masonic.dev.js.map
+++ b/dist/umd/masonic.dev.js.map
@@ -1 +1 @@
-{"version":3,"file":"masonic.dev.js","sources":["../../src/interval-tree.ts","../../node_modules/.pnpm/@react-hook+latest@1.0.3_react@17.0.2/node_modules/@react-hook/latest/src/index.tsx","../../node_modules/.pnpm/@react-hook+debounce@3.0.0_react@17.0.2/node_modules/@react-hook/debounce/src/index.tsx","../../node_modules/.pnpm/@react-hook+event@1.2.6_react@17.0.2/node_modules/@react-hook/event/src/index.tsx","../../node_modules/.pnpm/@react-hook+window-size@3.1.1_react@17.0.2/node_modules/@react-hook/window-size/src/index.tsx","../../node_modules/.pnpm/@essentials+memoize-one@1.1.0/node_modules/@essentials/memoize-one/src/index.ts","../../node_modules/.pnpm/@essentials+one-key-map@1.2.0/node_modules/@essentials/one-key-map/src/index.ts","../../node_modules/.pnpm/trie-memoize@1.2.0/node_modules/trie-memoize/src/index.ts","../../src/elements-cache.ts","../../src/use-force-update.ts","../../src/use-masonry.tsx","../../node_modules/.pnpm/@essentials+raf@1.2.0/node_modules/@essentials/raf/src/index.ts","../../node_modules/.pnpm/@essentials+request-timeout@1.3.0/node_modules/@essentials/request-timeout/src/index.ts","../../node_modules/.pnpm/@react-hook+throttle@2.2.0_react@17.0.2/node_modules/@react-hook/throttle/src/index.tsx","../../node_modules/.pnpm/@react-hook+window-scroll@1.3.0_react@17.0.2/node_modules/@react-hook/window-scroll/src/index.tsx","../../src/use-scroller.ts","../../src/masonry-scroller.tsx","../../node_modules/.pnpm/@react-hook+passive-layout-effect@1.2.1_react@17.0.2/node_modules/@react-hook/passive-layout-effect/src/index.tsx","../../src/use-container-position.ts","../../src/use-positioner.ts","../../node_modules/.pnpm/raf-schd@4.0.3/node_modules/raf-schd/dist/raf-schd.esm.js","../../src/use-resize-observer.ts","../../src/use-scroll-to-index.ts","../../src/masonry.tsx","../../src/list.tsx","../../src/use-infinite-loader.ts"],"sourcesContent":["type Color = 0 | 1 | 2;\nconst RED = 0;\nconst BLACK = 1;\nconst NIL = 2;\n\nconst DELETE = 0;\nconst KEEP = 1;\n\ntype ListNode = {\n  index: number;\n  high: number;\n  next: ListNode | null;\n};\n\ninterface TreeNode {\n  max: number;\n  low: number;\n  high: number;\n  // color\n  C: Color;\n  // P\n  P: TreeNode;\n  // right\n  R: TreeNode;\n  // left\n  L: TreeNode;\n  list: ListNode;\n}\n\ninterface Tree {\n  root: TreeNode;\n  size: number;\n}\n\nfunction addInterval(treeNode: TreeNode, high: number, index: number): boolean {\n  let node: ListNode | null = treeNode.list;\n  let prevNode: ListNode | undefined;\n\n  while (node) {\n    if (node.index === index) return false;\n    if (high > node.high) break;\n    prevNode = node;\n    node = node.next;\n  }\n\n  if (!prevNode) treeNode.list = { index, high, next: node };\n  if (prevNode) prevNode.next = { index, high, next: prevNode.next };\n\n  return true;\n}\n\nfunction removeInterval(treeNode: TreeNode, index: number) {\n  let node: ListNode | null = treeNode.list;\n  if (node.index === index) {\n    if (node.next === null) return DELETE;\n    treeNode.list = node.next;\n    return KEEP;\n  }\n\n  let prevNode: ListNode | undefined = node;\n  node = node.next;\n\n  while (node !== null) {\n    if (node.index === index) {\n      prevNode.next = node.next;\n      return KEEP;\n    }\n    prevNode = node;\n    node = node.next;\n  }\n}\n\nconst NULL_NODE: TreeNode = {\n  low: 0,\n  max: 0,\n  high: 0,\n  C: NIL,\n  // @ts-expect-error\n  P: undefined,\n  // @ts-expect-error\n  R: undefined,\n  // @ts-expect-error\n  L: undefined,\n  // @ts-expect-error\n  list: undefined,\n};\n\nNULL_NODE.P = NULL_NODE;\nNULL_NODE.L = NULL_NODE;\nNULL_NODE.R = NULL_NODE;\n\nfunction updateMax(node: TreeNode) {\n  const max = node.high;\n  if (node.L === NULL_NODE && node.R === NULL_NODE) node.max = max;\n  else if (node.L === NULL_NODE) node.max = Math.max(node.R.max, max);\n  else if (node.R === NULL_NODE) node.max = Math.max(node.L.max, max);\n  else node.max = Math.max(Math.max(node.L.max, node.R.max), max);\n}\n\nfunction updateMaxUp(node: TreeNode) {\n  let x = node;\n\n  while (x.P !== NULL_NODE) {\n    updateMax(x.P);\n    x = x.P;\n  }\n}\n\nfunction rotateLeft(tree: Tree, x: TreeNode) {\n  if (x.R === NULL_NODE) return;\n  const y = x.R;\n  x.R = y.L;\n  if (y.L !== NULL_NODE) y.L.P = x;\n  y.P = x.P;\n\n  if (x.P === NULL_NODE) tree.root = y;\n  else if (x === x.P.L) x.P.L = y;\n  else x.P.R = y;\n\n  y.L = x;\n  x.P = y;\n\n  updateMax(x);\n  updateMax(y);\n}\n\nfunction rotateRight(tree: Tree, x: TreeNode) {\n  if (x.L === NULL_NODE) return;\n  const y = x.L;\n  x.L = y.R;\n  if (y.R !== NULL_NODE) y.R.P = x;\n  y.P = x.P;\n\n  if (x.P === NULL_NODE) tree.root = y;\n  else if (x === x.P.R) x.P.R = y;\n  else x.P.L = y;\n\n  y.R = x;\n  x.P = y;\n\n  updateMax(x);\n  updateMax(y);\n}\n\nfunction replaceNode(tree: Tree, x: TreeNode, y: TreeNode) {\n  if (x.P === NULL_NODE) tree.root = y;\n  else if (x === x.P.L) x.P.L = y;\n  else x.P.R = y;\n  y.P = x.P;\n}\n\nfunction fixRemove(tree: Tree, x: TreeNode) {\n  let w;\n\n  while (x !== NULL_NODE && x.C === BLACK) {\n    if (x === x.P.L) {\n      w = x.P.R;\n\n      if (w.C === RED) {\n        w.C = BLACK;\n        x.P.C = RED;\n        rotateLeft(tree, x.P);\n        w = x.P.R;\n      }\n\n      if (w.L.C === BLACK && w.R.C === BLACK) {\n        w.C = RED;\n        x = x.P;\n      } else {\n        if (w.R.C === BLACK) {\n          w.L.C = BLACK;\n          w.C = RED;\n          rotateRight(tree, w);\n          w = x.P.R;\n        }\n\n        w.C = x.P.C;\n        x.P.C = BLACK;\n        w.R.C = BLACK;\n        rotateLeft(tree, x.P);\n        x = tree.root;\n      }\n    } else {\n      w = x.P.L;\n\n      if (w.C === RED) {\n        w.C = BLACK;\n        x.P.C = RED;\n        rotateRight(tree, x.P);\n        w = x.P.L;\n      }\n\n      if (w.R.C === BLACK && w.L.C === BLACK) {\n        w.C = RED;\n        x = x.P;\n      } else {\n        if (w.L.C === BLACK) {\n          w.R.C = BLACK;\n          w.C = RED;\n          rotateLeft(tree, w);\n          w = x.P.L;\n        }\n\n        w.C = x.P.C;\n        x.P.C = BLACK;\n        w.L.C = BLACK;\n        rotateRight(tree, x.P);\n        x = tree.root;\n      }\n    }\n  }\n\n  x.C = BLACK;\n}\n\nfunction minimumTree(x: TreeNode) {\n  while (x.L !== NULL_NODE) x = x.L;\n  return x;\n}\n\nfunction fixInsert(tree: Tree, z: TreeNode) {\n  let y: TreeNode;\n  while (z.P.C === RED) {\n    if (z.P === z.P.P.L) {\n      y = z.P.P.R;\n\n      if (y.C === RED) {\n        z.P.C = BLACK;\n        y.C = BLACK;\n        z.P.P.C = RED;\n        z = z.P.P;\n      } else {\n        if (z === z.P.R) {\n          z = z.P;\n          rotateLeft(tree, z);\n        }\n\n        z.P.C = BLACK;\n        z.P.P.C = RED;\n        rotateRight(tree, z.P.P);\n      }\n    } else {\n      y = z.P.P.L;\n\n      if (y.C === RED) {\n        z.P.C = BLACK;\n        y.C = BLACK;\n        z.P.P.C = RED;\n        z = z.P.P;\n      } else {\n        if (z === z.P.L) {\n          z = z.P;\n          rotateRight(tree, z);\n        }\n\n        z.P.C = BLACK;\n        z.P.P.C = RED;\n        rotateLeft(tree, z.P.P);\n      }\n    }\n  }\n  tree.root.C = BLACK;\n}\n\nexport interface IIntervalTree {\n  insert(low: number, high: number, index: number): void;\n  remove(index: number): void;\n  search(\n    low: number,\n    high: number,\n    callback: (index: number, low: number) => any\n  ): void;\n  size: number;\n}\n\nexport function createIntervalTree(): IIntervalTree {\n  const tree = {\n    root: NULL_NODE,\n    size: 0,\n  };\n  // we know these indexes are a consistent, safe way to make look ups\n  // for our case so it's a solid O(1) alternative to\n  // the O(log n) searchNode() in typical interval trees\n  const indexMap: Record<number, TreeNode> = {};\n\n  return {\n    insert(low, high, index) {\n      let x: TreeNode = tree.root;\n      let y: TreeNode = NULL_NODE;\n\n      while (x !== NULL_NODE) {\n        y = x;\n        if (low === y.low) break;\n        if (low < x.low) x = x.L;\n        else x = x.R;\n      }\n\n      if (low === y.low && y !== NULL_NODE) {\n        if (!addInterval(y, high, index)) return;\n        y.high = Math.max(y.high, high);\n        updateMax(y);\n        updateMaxUp(y);\n        indexMap[index] = y;\n        tree.size++;\n        return;\n      }\n\n      const z: TreeNode = {\n        low,\n        high,\n        max: high,\n        C: RED,\n        P: y,\n        L: NULL_NODE,\n        R: NULL_NODE,\n        list: { index, high, next: null },\n      };\n\n      if (y === NULL_NODE) {\n        tree.root = z;\n      } else {\n        if (z.low < y.low) y.L = z;\n        else y.R = z;\n        updateMaxUp(z);\n      }\n\n      fixInsert(tree, z);\n      indexMap[index] = z;\n      tree.size++;\n    },\n\n    remove(index) {\n      const z = indexMap[index];\n      if (z === void 0) return;\n      delete indexMap[index];\n\n      const intervalResult = removeInterval(z, index);\n      if (intervalResult === void 0) return;\n      if (intervalResult === KEEP) {\n        z.high = z.list.high;\n        updateMax(z);\n        updateMaxUp(z);\n        tree.size--;\n        return;\n      }\n\n      let y = z;\n      let originalYColor = y.C;\n      let x: TreeNode;\n\n      if (z.L === NULL_NODE) {\n        x = z.R;\n        replaceNode(tree, z, z.R);\n      } else if (z.R === NULL_NODE) {\n        x = z.L;\n        replaceNode(tree, z, z.L);\n      } else {\n        y = minimumTree(z.R);\n        originalYColor = y.C;\n        x = y.R;\n\n        if (y.P === z) {\n          x.P = y;\n        } else {\n          replaceNode(tree, y, y.R);\n          y.R = z.R;\n          y.R.P = y;\n        }\n\n        replaceNode(tree, z, y);\n        y.L = z.L;\n        y.L.P = y;\n        y.C = z.C;\n      }\n\n      updateMax(x);\n      updateMaxUp(x);\n\n      if (originalYColor === BLACK) fixRemove(tree, x);\n      tree.size--;\n    },\n\n    search(low, high, callback) {\n      const stack = [tree.root];\n      while (stack.length !== 0) {\n        const node = stack.pop() as TreeNode;\n        if (node === NULL_NODE || low > node.max) continue;\n        if (node.L !== NULL_NODE) stack.push(node.L);\n        if (node.R !== NULL_NODE) stack.push(node.R);\n        if (node.low <= high && node.high >= low) {\n          let curr: ListNode | null = node.list;\n          while (curr !== null) {\n            if (curr.high >= low) callback(curr.index, node.low);\n            curr = curr.next;\n          }\n        }\n      }\n    },\n\n    get size() {\n      return tree.size;\n    },\n  };\n}\n","import * as React from 'react'\n\nconst useLatest = <T extends any>(current: T) => {\n  const storedValue = React.useRef(current)\n  React.useEffect(() => {\n    storedValue.current = current\n  })\n  return storedValue\n}\n\nexport default useLatest\n","import * as React from 'react'\nimport useLatest from '@react-hook/latest'\n\nexport const useDebounceCallback = <CallbackArgs extends any[]>(\n  callback: (...args: CallbackArgs) => void,\n  wait = 100,\n  leading = false\n): ((...args: CallbackArgs) => void) => {\n  const storedCallback = useLatest(callback)\n  const timeout = React.useRef<ReturnType<typeof setTimeout>>()\n  const deps = [wait, leading, storedCallback]\n  // Cleans up pending timeouts when the deps change\n  React.useEffect(\n    () => () => {\n      timeout.current && clearTimeout(timeout.current)\n      timeout.current = void 0\n    },\n    deps\n  )\n\n  return React.useCallback(function () {\n    // eslint-disable-next-line prefer-rest-params\n    const args = arguments\n    const {current} = timeout\n    // Calls on leading edge\n    if (current === void 0 && leading) {\n      timeout.current = setTimeout(() => {\n        timeout.current = void 0\n      }, wait)\n      // eslint-disable-next-line prefer-spread\n      return storedCallback.current.apply(null, args as any)\n    }\n    // Clear the timeout every call and start waiting again\n    current && clearTimeout(current)\n    // Waits for `wait` before invoking the callback\n    timeout.current = setTimeout(() => {\n      timeout.current = void 0\n      storedCallback.current.apply(null, args as any)\n    }, wait)\n  }, deps)\n}\n\nexport const useDebounce = <State extends any>(\n  initialState: State | (() => State),\n  wait?: number,\n  leading?: boolean\n): [State, React.Dispatch<React.SetStateAction<State>>] => {\n  const state = React.useState(initialState)\n  return [state[0], useDebounceCallback(state[1], wait, leading)]\n}\n","import * as React from 'react'\n\nfunction useEvent<\n  T extends Window = Window,\n  K extends keyof WindowEventMap = keyof WindowEventMap\n>(\n  target: Window | null,\n  type: K,\n  listener: WindowEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent<\n  T extends Document = Document,\n  K extends keyof DocumentEventMap = keyof DocumentEventMap\n>(\n  target: Document | null,\n  type: K,\n  listener: DocumentEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent<\n  T extends HTMLElement = HTMLElement,\n  K extends keyof HTMLElementEventMap = keyof HTMLElementEventMap\n>(\n  target: React.RefObject<T> | T | null,\n  type: K,\n  listener: ElementEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent(target: any, type: any, listener: any, cleanup: any): void {\n  const storedListener = React.useRef(listener)\n  const storedCleanup = React.useRef(cleanup)\n\n  React.useEffect(() => {\n    storedListener.current = listener\n    storedCleanup.current = cleanup\n  })\n\n  React.useEffect(() => {\n    const targetEl = target && 'current' in target ? target.current : target\n    if (!targetEl) return\n\n    let didUnsubscribe = 0\n    function listener(this: any, ...args: any[]) {\n      if (didUnsubscribe) return\n      storedListener.current.apply(this, args)\n    }\n\n    targetEl.addEventListener(type, listener)\n    const cleanup = storedCleanup.current\n\n    return () => {\n      didUnsubscribe = 1\n      targetEl.removeEventListener(type, listener)\n      cleanup && cleanup()\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [target, type])\n}\n\nexport type ElementEventListener<\n  K extends keyof HTMLElementEventMap = keyof HTMLElementEventMap\n> = (this: HTMLElement, ev: HTMLElementEventMap[K]) => any\n\nexport type DocumentEventListener<\n  K extends keyof DocumentEventMap = keyof DocumentEventMap\n> = (this: Document, ev: DocumentEventMap[K]) => any\n\nexport type WindowEventListener<\n  K extends keyof WindowEventMap = keyof WindowEventMap\n> = (this: Document, ev: WindowEventMap[K]) => any\n\nexport default useEvent\n","import {useDebounce} from '@react-hook/debounce'\nimport useEvent from '@react-hook/event'\n\nconst emptyObj = {}\n\nexport interface DebouncedWindowSizeOptions {\n  initialWidth?: number\n  initialHeight?: number\n  wait?: number\n  leading?: boolean\n}\n\nconst win = typeof window === 'undefined' ? null : window\nconst wv =\n  win && typeof win.visualViewport !== 'undefined' ? win.visualViewport : null\nconst getSize = () =>\n  [\n    document.documentElement.clientWidth,\n    document.documentElement.clientHeight,\n  ] as const\n\nexport const useWindowSize = (\n  options: DebouncedWindowSizeOptions = emptyObj\n): readonly [number, number] => {\n  const {wait, leading, initialWidth = 0, initialHeight = 0} = options\n  const [size, setDebouncedSize] = useDebounce<readonly [number, number]>(\n    /* istanbul ignore next */\n    typeof document === 'undefined' ? [initialWidth, initialHeight] : getSize,\n    wait,\n    leading\n  )\n  const setSize = (): void => setDebouncedSize(getSize)\n\n  useEvent(win, 'resize', setSize)\n  // @ts-expect-error\n  useEvent(wv, 'resize', setSize)\n  useEvent(win, 'orientationchange', setSize)\n\n  return size\n}\n\nexport const useWindowHeight = (\n  options?: Omit<DebouncedWindowSizeOptions, 'initialWidth'>\n): number => useWindowSize(options)[1]\n\nexport const useWindowWidth = (\n  options?: Omit<DebouncedWindowSizeOptions, 'initialHeight'>\n): number => useWindowSize(options)[0]\n","const memoOne = <Args extends any[], T extends any>(\n  fn: (...args: Args) => T,\n  areEqual?: AreEqual<Args>\n): OutputFunction<Args, T> => {\n  const equal = areEqual || defaultAreEqual\n  let args: Args, value: any\n\n  return function (): T {\n    return !!args && equal(arguments as any, args)\n      ? value\n      : (value = fn.apply(null, (args = arguments as any)))\n  } as OutputFunction<Args, T>\n}\n\nexport default memoOne\n\nconst defaultAreEqual = (\n  current: IArguments,\n  prev: IArguments | any[]\n): boolean =>\n  current[0] === prev[0] &&\n  current[1] === prev[1] &&\n  current[2] === prev[2] &&\n  current[3] === prev[3]\n\nexport type AreEqual<Args> = (currentArgs: Args, prevArgs: Args) => boolean\nexport type InputFunction = (...args: any[]) => any\nexport type OutputFunction<Args extends any[], T extends any> = (\n  ...args: Args\n) => T\n","class OneKeyMap<K extends any = any, V extends any = any> {\n  set: (k: K, v: V) => void\n  get: (k: K) => V | undefined\n\n  constructor() {\n    let key: K | undefined, val: V | undefined\n    this.get = (k: K): V | undefined => (k === key ? val : void 0)\n    this.set = (k: K, v: V): void => {\n      key = k\n      val = v\n    }\n  }\n}\n\nexport default OneKeyMap\n","export interface MapLike {\n  new (...args: any[]): any\n}\n\nexport type CacheConstructor =\n  | MapConstructor\n  | WeakMapConstructor\n  | MapLike\n  | Record<any, any>\n\ninterface Cache<K = any, V = any> {\n  set: (k: K, v: V) => V\n  get: (k: K) => V\n}\n\nconst createCache = (obj: CacheConstructor): Cache => {\n  try {\n    // @ts-ignore\n    return new obj()\n  } catch (e) {\n    const cache: Record<string, any> = {}\n\n    return {\n      set(k, v): void {\n        cache[k] = v\n      },\n      get(k): any {\n        return cache[k]\n      },\n    }\n  }\n}\n\nconst memo = (\n  constructors: CacheConstructor[]\n): {s: Cache['set']; g: Cache['get']} => {\n  const depth = constructors.length,\n    baseCache = createCache(constructors[0])\n  let base: any\n  let map: any\n  let i: number\n  let node: typeof baseCache\n  const one = depth === 1\n  // quicker access for one and two-argument functions\n  const g1 = (args: IArguments): any =>\n    (base = baseCache.get(args[0])) === void 0 || one ? base : base.get(args[1])\n  const s1 = (args: IArguments, value: any): any => {\n    if (one) baseCache.set(args[0], value)\n    else {\n      if ((base = baseCache.get(args[0])) === void 0) {\n        map = createCache(constructors[1])\n        map.set(args[1], value)\n        baseCache.set(args[0], map)\n      } else {\n        base.set(args[1], value)\n      }\n    }\n\n    return value\n  }\n\n  const g2 = (args: IArguments): any => {\n    node = baseCache\n\n    for (i = 0; i < depth; i++)\n      if ((node = node.get(args[i])) === void 0) return\n\n    return node\n  }\n\n  const s2 = (args: IArguments, value: any): any => {\n    node = baseCache\n\n    for (i = 0; i < depth - 1; i++) {\n      if ((map = node.get(args[i])) === void 0) {\n        map = createCache(constructors[i + 1])\n        node.set(args[i], map)\n        node = map\n      } else {\n        node = map\n      }\n    }\n\n    node.set(args[depth - 1], value)\n    return value\n  }\n\n  return depth < 3 ? {g: g1, s: s1} : {g: g2, s: s2}\n}\n\nconst memoize = <T extends any[], U extends any>(\n  mapConstructors: CacheConstructor[],\n  fn: (...args: T) => U\n): ((...args: T) => U) => {\n  let item: U\n  const {g, s} = memo(mapConstructors)\n  return function () {\n    return (item = g(arguments)) === void 0\n      ? s(arguments, fn.apply(null, arguments as any))\n      : item\n  }\n}\n\nexport default memoize\n","export const elementsCache: WeakMap<Element, number> = new WeakMap();\n","import * as React from \"react\";\n\nexport function useForceUpdate() {\n  const setState = React.useState(emptyObj)[1];\n  return React.useRef(() => setState({})).current;\n}\n\nconst emptyObj = {};\n","import memoizeOne from \"@essentials/memoize-one\";\nimport OneKeyMap from \"@essentials/one-key-map\";\nimport useLatest from \"@react-hook/latest\";\nimport * as React from \"react\";\nimport trieMemoize from \"trie-memoize\";\nimport { elementsCache } from \"./elements-cache\";\nimport { useForceUpdate } from \"./use-force-update\";\nimport type { Positioner } from \"./use-positioner\";\n\n/**\n * This hook handles the render phases of the masonry layout and returns the grid as a React element.\n *\n * @param options - Options for configuring the masonry layout renderer. See `UseMasonryOptions`.\n * @param options.positioner\n * @param options.resizeObserver\n * @param options.items\n * @param options.as\n * @param options.id\n * @param options.className\n * @param options.style\n * @param options.role\n * @param options.tabIndex\n * @param options.containerRef\n * @param options.itemAs\n * @param options.itemStyle\n * @param options.itemHeightEstimate\n * @param options.itemKey\n * @param options.overscanBy\n * @param options.scrollTop\n * @param options.isScrolling\n * @param options.height\n * @param options.render\n * @param options.onRender\n */\nexport function useMasonry<Item>({\n  // Measurement and layout\n  positioner,\n  resizeObserver,\n  // Grid items\n  items,\n  // Container props\n  as: ContainerComponent = \"div\",\n  id,\n  className,\n  style,\n  role = \"grid\",\n  tabIndex = 0,\n  containerRef,\n  // Item props\n  itemAs: ItemComponent = \"div\",\n  itemStyle,\n  itemHeightEstimate = 300,\n  itemKey = defaultGetItemKey,\n  // Rendering props\n  overscanBy = 2,\n  scrollTop,\n  isScrolling,\n  height,\n  render: RenderComponent,\n  onRender,\n}: UseMasonryOptions<Item>) {\n  let startIndex = 0;\n  let stopIndex: number | undefined;\n  const forceUpdate = useForceUpdate();\n  const setItemRef = getRefSetter(positioner, resizeObserver);\n  const itemCount = items.length;\n  const {\n    columnWidth,\n    columnCount,\n    range,\n    estimateHeight,\n    size,\n    shortestColumn,\n  } = positioner;\n  const measuredCount = size();\n  const shortestColumnSize = shortestColumn();\n  const children: React.ReactElement[] = [];\n  const itemRole =\n    role === \"list\" ? \"listitem\" : role === \"grid\" ? \"gridcell\" : undefined;\n  const storedOnRender = useLatest(onRender);\n\n  overscanBy = height * overscanBy;\n  const rangeEnd = scrollTop + overscanBy;\n  const needsFreshBatch =\n    shortestColumnSize < rangeEnd && measuredCount < itemCount;\n\n  range(\n    // We overscan in both directions because users scroll both ways,\n    // though one must admit scrolling down is more common and thus\n    // we only overscan by half the downward overscan amount\n    Math.max(0, scrollTop - overscanBy / 2),\n    rangeEnd,\n    (index, left, top) => {\n      const data = items[index];\n      const key = itemKey(data, index);\n      const phaseTwoStyle: React.CSSProperties = {\n        top,\n        left,\n        width: columnWidth,\n        writingMode: \"horizontal-tb\",\n        position: \"absolute\",\n      };\n\n      /* istanbul ignore next */\n      if (\n        typeof process !== \"undefined\" &&\n        process.env.NODE_ENV !== \"production\"\n      ) {\n        throwWithoutData(data, index);\n      }\n\n      children.push(\n        <ItemComponent\n          key={key}\n          ref={setItemRef(index)}\n          role={itemRole}\n          style={\n            typeof itemStyle === \"object\" && itemStyle !== null\n              ? Object.assign({}, phaseTwoStyle, itemStyle)\n              : phaseTwoStyle\n          }\n        >\n          {createRenderElement(RenderComponent, index, data, columnWidth)}\n        </ItemComponent>\n      );\n\n      if (stopIndex === void 0) {\n        startIndex = index;\n        stopIndex = index;\n      } else {\n        startIndex = Math.min(startIndex, index);\n        stopIndex = Math.max(stopIndex, index);\n      }\n    }\n  );\n\n  if (needsFreshBatch) {\n    const batchSize = Math.min(\n      itemCount - measuredCount,\n      Math.ceil(\n        ((scrollTop + overscanBy - shortestColumnSize) / itemHeightEstimate) *\n          columnCount\n      )\n    );\n\n    let index = measuredCount;\n    const phaseOneStyle = getCachedSize(columnWidth);\n\n    for (; index < measuredCount + batchSize; index++) {\n      const data = items[index];\n      const key = itemKey(data, index);\n\n      /* istanbul ignore next */\n      if (\n        typeof process !== \"undefined\" &&\n        process.env.NODE_ENV !== \"production\"\n      ) {\n        throwWithoutData(data, index);\n      }\n\n      children.push(\n        <ItemComponent\n          key={key}\n          ref={setItemRef(index)}\n          role={itemRole}\n          style={\n            typeof itemStyle === \"object\"\n              ? Object.assign({}, phaseOneStyle, itemStyle)\n              : phaseOneStyle\n          }\n        >\n          {createRenderElement(RenderComponent, index, data, columnWidth)}\n        </ItemComponent>\n      );\n    }\n  }\n\n  // Calls the onRender callback if the rendered indices changed\n  React.useEffect(() => {\n    if (typeof storedOnRender.current === \"function\" && stopIndex !== void 0)\n      storedOnRender.current(startIndex, stopIndex, items);\n\n    didEverMount = \"1\";\n  }, [startIndex, stopIndex, items, storedOnRender]);\n  // If we needed a fresh batch we should reload our components with the measured\n  // sizes\n  React.useEffect(() => {\n    if (needsFreshBatch) forceUpdate();\n    // eslint-disable-next-line\n  }, [needsFreshBatch, positioner]);\n\n  // gets the container style object based upon the estimated height and whether or not\n  // the page is being scrolled\n  const containerStyle = getContainerStyle(\n    isScrolling,\n    estimateHeight(itemCount, itemHeightEstimate)\n  );\n\n  return (\n    <ContainerComponent\n      ref={containerRef}\n      key={didEverMount}\n      id={id}\n      role={role}\n      className={className}\n      tabIndex={tabIndex}\n      style={\n        typeof style === \"object\"\n          ? assignUserStyle(containerStyle, style)\n          : containerStyle\n      }\n      children={children}\n    />\n  );\n}\n\n/* istanbul ignore next */\nfunction throwWithoutData(data: any, index: number) {\n  if (!data) {\n    throw new Error(\n      `No data was found at index: ${index}\\n\\n` +\n        `This usually happens when you've mutated or changed the \"items\" array in a ` +\n        `way that makes it shorter than the previous \"items\" array. Masonic knows nothing ` +\n        `about your underlying data and when it caches cell positions, it assumes you aren't ` +\n        `mutating the underlying \"items\".\\n\\n` +\n        `See https://codesandbox.io/s/masonic-w-react-router-example-2b5f9?file=/src/index.js for ` +\n        `an example that gets around this limitations. For advanced implementations, see ` +\n        `https://codesandbox.io/s/masonic-w-react-router-and-advanced-config-example-8em42?file=/src/index.js\\n\\n` +\n        `If this was the result of your removing an item from your \"items\", see this issue: ` +\n        `https://github.com/jaredLunde/masonic/issues/12`\n    );\n  }\n}\n\n// This is for triggering a remount after SSR has loaded in the client w/ hydrate()\nlet didEverMount = \"0\";\n\nexport interface UseMasonryOptions<Item> {\n  /**\n   * An array containing the data used by the grid items.\n   */\n  items: Item[];\n  /**\n   * A grid cell positioner and cache created by the `usePositioner()` hook or\n   * the `createPositioner` utility.\n   */\n  positioner: Positioner;\n  /**\n   * A resize observer that tracks mutations to the grid cells and forces the\n   * Masonry grid to recalculate its layout if any cells affect column heights\n   * change. Check out the `useResizeObserver()` hook.\n   */\n  resizeObserver?: {\n    observe: ResizeObserver[\"observe\"];\n    disconnect: ResizeObserver[\"observe\"];\n    unobserve: ResizeObserver[\"unobserve\"];\n  };\n  /**\n   * This is the type of element the grid container will be rendered as.\n   *\n   * @default \"div\"`\n   */\n  as?: keyof JSX.IntrinsicElements | React.ComponentType<any>;\n  /**\n   * Optionally gives the grid container an `id` prop.\n   */\n  id?: string;\n  /**\n   * Optionally gives the grid container a `className` prop.\n   */\n  className?: string;\n  /**\n   * Adds extra `style` attributes to the container in addition to those\n   * created by the `useMasonry()` hook.\n   */\n  style?: React.CSSProperties;\n  /**\n   * Optionally swap out the accessibility `role` prop of the container and its items.\n   *\n   * @default \"grid\"\n   */\n  role?: \"grid\" | \"list\";\n  /**\n   * Change the `tabIndex` of the grid container.\n   *\n   * @default 0\n   */\n  tabIndex?: number;\n  /**\n   * Forwards a React ref to the grid container.\n   */\n  containerRef?:\n    | ((element: HTMLElement) => void)\n    | React.MutableRefObject<HTMLElement | null>;\n  /**\n   * This is the type of element the grid items will be rendered as.\n   *\n   * @default \"div\"\n   */\n  itemAs?: keyof JSX.IntrinsicElements | React.ComponentType<any>;\n  /**\n   * Adds extra `style` attributes to the grid items in addition to those\n   * created by the `useMasonry()` hook.\n   */\n  itemStyle?: React.CSSProperties;\n  /**\n   * This value is used for estimating the initial height of the masonry grid. It is important for\n   * the UX of the scrolling behavior and in determining how many `items` to render in a batch, so it's\n   * wise to set this value with some level accuracy, though it doesn't need to be perfect.\n   *\n   * @default 300\n   */\n  itemHeightEstimate?: number;\n  /**\n   * The value returned here must be unique to the item. By default, the key is the item's index. This is ok\n   * if your collection of items is never modified. Setting this property ensures that the component in `render`\n   * is reused each time the masonry grid is reflowed. A common pattern would be to return the item's database\n   * ID here if there is one, e.g. `data => data.id`\n   *\n   * @default (data, index) => index`\n   */\n  itemKey?: (data: Item, index: number) => string | number;\n  /**\n   * This number is used for determining the number of grid cells outside of the visible window to render.\n   * The default value is `2` which means \"render 2 windows worth (2 * `height`) of content before and after\n   * the items in the visible window\". A value of `3` would be 3 windows worth of grid cells, so it's a\n   * linear relationship.\n   *\n   * Overscanning is important for preventing tearing when scrolling through items in the grid, but setting\n   * too high of a vaimport { useForceUpdate } from './use-force-update';\nlue may create too much work for React to handle, so it's best that you tune this\n   * value accordingly.\n   *\n   * @default 2\n   */\n  overscanBy?: number;\n\n  /**\n   * This is the height of the window. If you're rendering the grid relative to the browser `window`,\n   * the current `document.documentElement.clientHeight` is the value you'll want to set here. If you're\n   * rendering the grid inside of another HTML element, you'll want to provide the current `element.offsetHeight`\n   * here.\n   */\n  height: number;\n  /**\n   * The current scroll progress in pixel of the window the grid is rendered in. If you're rendering\n   * the grid relative to the browser `window`, you'll want the most current `window.scrollY` here.\n   * If you're rendering the grid inside of another HTML element, you'll want the current `element.scrollTop`\n   * value here. The `useScroller()` hook and `<MasonryScroller>` components will help you if you're\n   * rendering the grid relative to the browser `window`.\n   */\n  scrollTop: number;\n  /**\n   * This property is used for determining whether or not the grid container should add styles that\n   * dramatically increase scroll performance. That is, turning off `pointer-events` and adding a\n   * `will-change: contents;` value to the style string. You can forgo using this prop, but I would\n   * not recommend that. The `useScroller()` hook and `<MasonryScroller>` components will help you if\n   * you're rendering the grid relative to the browser `window`.\n   *\n   * @default false\n   */\n  isScrolling?: boolean;\n  /**\n   * This component is rendered for each item of your `items` prop array. It should accept three props:\n   * `index`, `width`, and `data`. See RenderComponentProps.\n   */\n  render: React.ComponentType<RenderComponentProps<Item>>;\n  /**\n   * This callback is invoked any time the items currently being rendered by the grid change.\n   */\n  onRender?: (startIndex: number, stopIndex: number, items: Item[]) => void;\n}\n\nexport interface RenderComponentProps<Item> {\n  /**\n   * The index of the cell in the `items` prop array.\n   */\n  index: number;\n  /**\n   * The rendered width of the cell's column.\n   */\n  width: number;\n  /**\n   * The data at `items[index]` of your `items` prop array.\n   */\n  data: Item;\n}\n\n//\n// Render-phase utilities\n\n// ~5.5x faster than createElement without the memo\nconst createRenderElement = trieMemoize(\n  [OneKeyMap, {}, WeakMap, OneKeyMap],\n  (RenderComponent, index, data, columnWidth) => (\n    <RenderComponent index={index} data={data} width={columnWidth} />\n  )\n);\n\nconst getContainerStyle = memoizeOne(\n  (isScrolling: boolean | undefined, estimateHeight: number) => ({\n    position: \"relative\",\n    width: \"100%\",\n    maxWidth: \"100%\",\n    height: Math.ceil(estimateHeight),\n    maxHeight: Math.ceil(estimateHeight),\n    willChange: isScrolling ? \"contents\" : void 0,\n    pointerEvents: isScrolling ? \"none\" : void 0,\n  })\n);\n\nconst cmp2 = (args: IArguments, pargs: IArguments | any[]): boolean =>\n  args[0] === pargs[0] && args[1] === pargs[1];\n\nconst assignUserStyle = memoizeOne(\n  (containerStyle, userStyle) => Object.assign({}, containerStyle, userStyle),\n  // @ts-expect-error\n  cmp2\n);\n\nfunction defaultGetItemKey<Item>(_: Item, i: number) {\n  return i;\n}\n\n// the below memoizations for for ensuring shallow equal is reliable for pure\n// component children\nconst getCachedSize = memoizeOne(\n  (width: number): React.CSSProperties => ({\n    width,\n    zIndex: -1000,\n    visibility: \"hidden\",\n    position: \"absolute\",\n    writingMode: \"horizontal-tb\",\n  }),\n  (args, pargs) => args[0] === pargs[0]\n);\n\nconst getRefSetter = memoizeOne(\n  (\n      positioner: Positioner,\n      resizeObserver?: UseMasonryOptions<any>[\"resizeObserver\"]\n    ) =>\n    (index: number) =>\n    (el: HTMLElement | null): void => {\n      if (el === null) return;\n      if (resizeObserver) {\n        resizeObserver.observe(el);\n        elementsCache.set(el, index);\n      }\n      if (positioner.get(index) === void 0)\n        positioner.set(index, el.offsetHeight);\n    },\n  // @ts-expect-error\n  cmp2\n);\n","export type Raf = (callback: (timestamp: number) => void) => number\nexport type Caf = (handle: number) => void\n\nlet u = 'undefined',\n  win = typeof window !== u ? window : ({} as any),\n  p = typeof performance !== u ? performance : Date,\n  now = () => p.now(),\n  af = 'AnimationFrame' as const,\n  Caf = 'cancel' + af,\n  Raf = 'request' + af,\n  raf: Raf = win[Raf] && win[Raf].bind(win),\n  caf: Caf = win[Caf] && win[Caf].bind(win)\n\nif (!raf || !caf) {\n  let lastTime = 0\n  raf = (callback: FrameRequestCallback) => {\n    let curr = now(),\n      next = Math.max(lastTime + 1000 / 60, curr)\n    return setTimeout(() => {\n      callback((lastTime = next))\n    }, next - curr) as any\n  }\n  caf = (h) => clearTimeout(h)\n}\n\nexport {raf, caf, now}\n","/**\n * Copyright 2011, Joe Lambert.\n * Free to use under the MIT license.\n * http://www.opensource.org/licenses/mit-license.php\n **/\nimport {raf, caf, now} from '@essentials/raf'\n\nexport interface RequestTimeoutHandle {\n  v?: number\n}\n\nexport const clearRequestTimeout = (handle: RequestTimeoutHandle): void => {\n  caf(handle.v || -1)\n}\n\nexport const requestTimeout = (\n  fn: (...args: any[]) => void,\n  ms: number\n): RequestTimeoutHandle => {\n  const start = now(),\n    handle: RequestTimeoutHandle = {}\n\n  const loop = () => {\n    now() - start >= ms ? fn.call(null) : (handle.v = raf(loop))\n  }\n\n  handle.v = raf(loop)\n  return handle\n}\n\nexport default requestTimeout\n","import * as React from 'react'\nimport useLatest from '@react-hook/latest'\n\nconst perf = typeof performance !== 'undefined' ? performance : Date\nconst now = () => perf.now()\n\nexport function useThrottleCallback<CallbackArguments extends any[]>(\n  callback: (...args: CallbackArguments) => void,\n  fps = 30,\n  leading = false\n): (...args: CallbackArguments) => void {\n  const storedCallback = useLatest(callback)\n  const ms = 1000 / fps\n  const prev = React.useRef(0)\n  const trailingTimeout = React.useRef<ReturnType<typeof setTimeout>>()\n  const clearTrailing = () =>\n    trailingTimeout.current && clearTimeout(trailingTimeout.current)\n  const deps = [fps, leading, storedCallback]\n\n  // Reset any time the deps change\n  React.useEffect(\n    () => () => {\n      prev.current = 0\n      clearTrailing()\n    },\n    deps\n  )\n\n  return React.useCallback(function () {\n    // eslint-disable-next-line prefer-rest-params\n    const args = arguments\n    const rightNow = now()\n    const call = () => {\n      prev.current = rightNow\n      clearTrailing()\n      storedCallback.current.apply(null, args as any)\n    }\n    const current = prev.current\n    // leading\n    if (leading && current === 0) return call()\n    // body\n    if (rightNow - current > ms) {\n      if (current > 0) return call()\n      prev.current = rightNow\n    }\n    // trailing\n    clearTrailing()\n    trailingTimeout.current = setTimeout(() => {\n      call()\n      prev.current = 0\n    }, ms)\n  }, deps)\n}\n\nexport function useThrottle<State>(\n  initialState: State | (() => State),\n  fps?: number,\n  leading?: boolean\n): [State, React.Dispatch<React.SetStateAction<State>>] {\n  const state = React.useState<State>(initialState)\n  return [state[0], useThrottleCallback(state[1], fps, leading)]\n}\n","import {useThrottle} from '@react-hook/throttle'\nimport useEvent from '@react-hook/event'\n\nconst win = typeof window === 'undefined' ? null : window\nconst getScrollY = (): number =>\n  (win as Window).scrollY !== void 0\n    ? (win as Window).scrollY\n    : (win as Window).pageYOffset === void 0\n    ? 0\n    : (win as Window).pageYOffset\n\nexport const useWindowScroll = (fps = 30): number => {\n  const state = useThrottle(\n    typeof window === 'undefined' ? 0 : getScrollY,\n    fps,\n    true\n  )\n  useEvent(win, 'scroll', (): void => state[1](getScrollY()))\n  return state[0]\n}\n\nexport default useWindowScroll\n","import {\n  clearRequestTimeout,\n  requestTimeout,\n} from \"@essentials/request-timeout\";\nimport useScrollPosition from \"@react-hook/window-scroll\";\nimport * as React from \"react\";\n\n/**\n * A hook for tracking whether the `window` is currently being scrolled and it's scroll position on\n * the y-axis. These values are used for determining which grid cells to render and when\n * to add styles to the masonry container that maximize scroll performance.\n *\n * @param offset - The vertical space in pixels between the top of the grid container and the top\n *  of the browser `document.documentElement`.\n * @param fps - This determines how often (in frames per second) to update the scroll position of the\n *  browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\n *  The default value of `12` has been very reasonable in my own testing, but if you have particularly\n *  heavy `render` components it may be prudent to reduce this number.\n */\nexport function useScroller(\n  offset = 0,\n  fps = 12\n): { scrollTop: number; isScrolling: boolean } {\n  const scrollTop = useScrollPosition(fps);\n  const [isScrolling, setIsScrolling] = React.useState(false);\n  const didMount = React.useRef(0);\n\n  React.useEffect(() => {\n    if (didMount.current === 1) setIsScrolling(true);\n    let didUnsubscribe = false;\n    const to = requestTimeout(() => {\n      if (didUnsubscribe) return;\n      // This is here to prevent premature bail outs while maintaining high resolution\n      // unsets. Without it there will always bee a lot of unnecessary DOM writes to style.\n      setIsScrolling(false);\n    }, 40 + 1000 / fps);\n    didMount.current = 1;\n    return () => {\n      didUnsubscribe = true;\n      clearRequestTimeout(to);\n    };\n  }, [fps, scrollTop]);\n\n  return { scrollTop: Math.max(0, scrollTop - offset), isScrolling };\n}\n","import { useMasonry } from \"./use-masonry\";\nimport type { UseMasonryOptions } from \"./use-masonry\";\nimport { useScroller } from \"./use-scroller\";\n/**\n * A heavily-optimized component that updates `useMasonry()` when the scroll position of the browser `window`\n * changes. This bare-metal component is used by `<Masonry>` under the hood.\n *\n * @param props\n */\nexport function MasonryScroller<Item>(props: MasonryScrollerProps<Item>) {\n  // We put this in its own layer because it's the thing that will trigger the most updates\n  // and we don't want to slower ourselves by cycling through all the functions, objects, and effects\n  // of other hooks\n  const { scrollTop, isScrolling } = useScroller(props.offset, props.scrollFps);\n  // This is an update-heavy phase and while we could just Object.assign here,\n  // it is way faster to inline and there's a relatively low hit to he bundle\n  // size.\n  return useMasonry<Item>({\n    scrollTop,\n    isScrolling,\n    positioner: props.positioner,\n    resizeObserver: props.resizeObserver,\n    items: props.items,\n    onRender: props.onRender,\n    as: props.as,\n    id: props.id,\n    className: props.className,\n    style: props.style,\n    role: props.role,\n    tabIndex: props.tabIndex,\n    containerRef: props.containerRef,\n    itemAs: props.itemAs,\n    itemStyle: props.itemStyle,\n    itemHeightEstimate: props.itemHeightEstimate,\n    itemKey: props.itemKey,\n    overscanBy: props.overscanBy,\n    height: props.height,\n    render: props.render,\n  });\n}\n\nexport interface MasonryScrollerProps<Item>\n  extends Omit<UseMasonryOptions<Item>, \"scrollTop\" | \"isScrolling\"> {\n  /**\n   * This determines how often (in frames per second) to update the scroll position of the\n   * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\n   * The default value of `12` has been very reasonable in my own testing, but if you have particularly\n   * heavy `render` components it may be prudent to reduce this number.\n   *\n   * @default 12\n   */\n  scrollFps?: number;\n  /**\n   * The vertical space in pixels between the top of the grid container and the top\n   * of the browser `document.documentElement`.\n   *\n   * @default 0\n   */\n  offset?: number;\n}\n\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n  MasonryScroller.displayName = \"MasonryScroller\";\n}\n","import React from 'react'\n\nconst usePassiveLayoutEffect =\n  React[\n    typeof document !== 'undefined' && document.createElement !== void 0\n      ? 'useLayoutEffect'\n      : 'useEffect'\n  ]\n\nexport default usePassiveLayoutEffect\n","import useLayoutEffect from \"@react-hook/passive-layout-effect\";\nimport * as React from \"react\";\n\n/**\n * A hook for measuring the width of the grid container, as well as its distance\n * from the top of the document. These values are necessary to correctly calculate the number/width\n * of columns to render, as well as the number of rows to render.\n *\n * @param elementRef - A `ref` object created by `React.useRef()`. That ref should be provided to the\n *   `containerRef` property in `useMasonry()`.\n * @param deps - You can force this hook to recalculate the `offset` and `width` whenever this\n *   dependencies list changes. A common dependencies list might look like `[windowWidth, windowHeight]`,\n *   which would force the hook to recalculate any time the size of the browser `window` changed.\n */\nexport function useContainerPosition(\n  elementRef: React.MutableRefObject<HTMLElement | null>,\n  deps: React.DependencyList = emptyArr\n): ContainerPosition {\n  const [containerPosition, setContainerPosition] =\n    React.useState<ContainerPosition>({ offset: 0, width: 0 });\n\n  useLayoutEffect(() => {\n    const { current } = elementRef;\n    if (current !== null) {\n      let offset = 0;\n      let el = current;\n\n      do {\n        offset += el.offsetTop || 0;\n        el = el.offsetParent as HTMLElement;\n      } while (el);\n\n      if (\n        offset !== containerPosition.offset ||\n        current.offsetWidth !== containerPosition.width\n      ) {\n        setContainerPosition({\n          offset,\n          width: current.offsetWidth,\n        });\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, deps);\n\n  return containerPosition;\n}\n\nexport interface ContainerPosition {\n  /**\n   * The distance in pixels between the top of the element in `elementRef` and the top of\n   * the `document.documentElement`.\n   */\n  offset: number;\n  /**\n   * The `offsetWidth` of the element in `elementRef`.\n   */\n  width: number;\n}\n\nconst emptyArr: [] = [];\n","import * as React from \"react\";\nimport { createIntervalTree } from \"./interval-tree\";\n\n/**\n * This hook creates the grid cell positioner and cache required by `useMasonry()`. This is\n * the meat of the grid's layout algorithm, determining which cells to render at a given scroll\n * position, as well as where to place new items in the grid.\n *\n * @param options - Properties that determine the number of columns in the grid, as well\n *  as their widths.\n * @param options.columnWidth\n * @param options.width\n * @param deps - This hook will create a new positioner, clearing all existing cached positions,\n *  whenever the dependencies in this list change.\n * @param options.columnGutter\n * @param options.rowGutter\n * @param options.columnCount\n * @param options.maxColumnCount\n * @param options.maxColumnWidth\n */\nexport function usePositioner(\n  {\n    width,\n    columnWidth = 200,\n    columnGutter = 0,\n    rowGutter,\n    columnCount,\n    maxColumnCount,\n    maxColumnWidth,\n  }: UsePositionerOptions,\n  deps: React.DependencyList = emptyArr\n): Positioner {\n  const initPositioner = (): Positioner => {\n    const [computedColumnWidth, computedColumnCount] = getColumns(\n      width,\n      columnWidth,\n      columnGutter,\n      columnCount,\n      maxColumnCount,\n      maxColumnWidth\n    );\n    return createPositioner(\n      computedColumnCount,\n      computedColumnWidth,\n      columnGutter,\n      rowGutter ?? columnGutter\n    );\n  };\n  const positionerRef = React.useRef<Positioner>();\n  if (positionerRef.current === undefined)\n    positionerRef.current = initPositioner();\n\n  const prevDeps = React.useRef(deps);\n  const opts = [\n    width,\n    columnWidth,\n    columnGutter,\n    rowGutter,\n    columnCount,\n    maxColumnCount,\n    maxColumnWidth,\n  ];\n  const prevOpts = React.useRef(opts);\n  const optsChanged = !opts.every((item, i) => prevOpts.current[i] === item);\n\n  if (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n    if (deps.length !== prevDeps.current.length) {\n      throw new Error(\n        \"usePositioner(): The length of your dependencies array changed.\"\n      );\n    }\n  }\n\n  // Create a new positioner when the dependencies or sizes change\n  // Thanks to https://github.com/khmm12 for pointing this out\n  // https://github.com/jaredLunde/masonic/pull/41\n  if (optsChanged || !deps.every((item, i) => prevDeps.current[i] === item)) {\n    const prevPositioner = positionerRef.current;\n    const positioner = initPositioner();\n    prevDeps.current = deps;\n    prevOpts.current = opts;\n\n    if (optsChanged) {\n      const cacheSize = prevPositioner.size();\n      for (let index = 0; index < cacheSize; index++) {\n        const pos = prevPositioner.get(index);\n        positioner.set(index, pos !== void 0 ? pos.height : 0);\n      }\n    }\n\n    positionerRef.current = positioner;\n  }\n\n  return positionerRef.current;\n}\n\nexport interface UsePositionerOptions {\n  /**\n   * The width of the container you're rendering the grid within, i.e. the container\n   * element's `element.offsetWidth`\n   */\n  width: number;\n  /**\n   * The minimum column width. The `usePositioner()` hook will automatically size the\n   * columns to fill their container based upon the `columnWidth` and `columnGutter` values.\n   * It will never render anything smaller than this width unless its container itself is\n   * smaller than its value. This property is optional if you're using a static `columnCount`.\n   *\n   * @default 200\n   */\n  columnWidth?: number;\n  /**\n   * The maximum column width. Calculated column widths will be capped at this value.\n   */\n  maxColumnWidth?: number;\n  /**\n   * This sets the horizontal space between grid columns in pixels. If `rowGutter` is not set, this\n   * also sets the vertical space between cells within a column in pixels.\n   *\n   * @default 0\n   */\n  columnGutter?: number;\n  /**\n   * This sets the vertical space between cells within a column in pixels. If not set, the value of\n   * `columnGutter` is used instead.\n   */\n  rowGutter?: number;\n  /**\n   * By default, `usePositioner()` derives the column count from the `columnWidth`, `columnGutter`,\n   * and `width` props. However, in some situations it is nice to be able to override that behavior\n   * (e.g. creating a `List` component).\n   */\n  columnCount?: number;\n  /**\n   * The upper bound of column count. This property won't work if `columnCount` is set.\n   */\n  maxColumnCount?: number;\n}\n\n/**\n * Creates a cell positioner for the `useMasonry()` hook. The `usePositioner()` hook uses\n * this utility under the hood.\n *\n * @param columnCount - The number of columns in the grid\n * @param columnWidth - The width of each column in the grid\n * @param columnGutter - The amount of horizontal space between columns in pixels.\n * @param rowGutter - The amount of vertical space between cells within a column in pixels (falls back\n * to `columnGutter`).\n */\nexport const createPositioner = (\n  columnCount: number,\n  columnWidth: number,\n  columnGutter = 0,\n  rowGutter = columnGutter\n): Positioner => {\n  // O(log(n)) lookup of cells to render for a given viewport size\n  // Store tops and bottoms of each cell for fast intersection lookup.\n  const intervalTree = createIntervalTree();\n  // Track the height of each column.\n  // Layout algorithm below always inserts into the shortest column.\n  const columnHeights: number[] = new Array(columnCount);\n  // Used for O(1) item access\n  const items: PositionerItem[] = [];\n  // Tracks the item indexes within an individual column\n  const columnItems: number[][] = new Array(columnCount);\n\n  for (let i = 0; i < columnCount; i++) {\n    columnHeights[i] = 0;\n    columnItems[i] = [];\n  }\n\n  return {\n    columnCount,\n    columnWidth,\n    set: (index, height = 0) => {\n      let column = 0;\n\n      // finds the shortest column and uses it\n      for (let i = 1; i < columnHeights.length; i++) {\n        if (columnHeights[i] < columnHeights[column]) column = i;\n      }\n\n      const top = columnHeights[column] || 0;\n      columnHeights[column] = top + height + rowGutter;\n      columnItems[column].push(index);\n      items[index] = {\n        left: column * (columnWidth + columnGutter),\n        top,\n        height,\n        column,\n      };\n      intervalTree.insert(top, top + height, index);\n    },\n    get: (index) => items[index],\n    // This only updates items in the specific columns that have changed, on and after the\n    // specific items that have changed\n    update: (updates) => {\n      const columns: number[] = new Array(columnCount);\n      let i = 0,\n        j = 0;\n\n      // determines which columns have items that changed, as well as the minimum index\n      // changed in that column, as all items after that index will have their positions\n      // affected by the change\n      for (; i < updates.length - 1; i++) {\n        const index = updates[i];\n        const item = items[index];\n        item.height = updates[++i];\n        intervalTree.remove(index);\n        intervalTree.insert(item.top, item.top + item.height, index);\n        columns[item.column] =\n          columns[item.column] === void 0\n            ? index\n            : Math.min(index, columns[item.column]);\n      }\n\n      for (i = 0; i < columns.length; i++) {\n        // bails out if the column didn't change\n        if (columns[i] === void 0) continue;\n        const itemsInColumn = columnItems[i];\n        // the index order is sorted with certainty so binary search is a great solution\n        // here as opposed to Array.indexOf()\n        const startIndex = binarySearch(itemsInColumn, columns[i]);\n        const index = columnItems[i][startIndex];\n        const startItem = items[index];\n        columnHeights[i] = startItem.top + startItem.height + rowGutter;\n\n        for (j = startIndex + 1; j < itemsInColumn.length; j++) {\n          const index = itemsInColumn[j];\n          const item = items[index];\n          item.top = columnHeights[i];\n          columnHeights[i] = item.top + item.height + rowGutter;\n          intervalTree.remove(index);\n          intervalTree.insert(item.top, item.top + item.height, index);\n        }\n      }\n    },\n    // Render all cells visible within the viewport range defined.\n    range: (lo, hi, renderCallback) =>\n      intervalTree.search(lo, hi, (index, top) =>\n        renderCallback(index, items[index].left, top)\n      ),\n    estimateHeight: (itemCount, defaultItemHeight): number => {\n      const tallestColumn = Math.max(0, Math.max.apply(null, columnHeights));\n\n      return itemCount === intervalTree.size\n        ? tallestColumn\n        : tallestColumn +\n            Math.ceil((itemCount - intervalTree.size) / columnCount) *\n              defaultItemHeight;\n    },\n    shortestColumn: () => {\n      if (columnHeights.length > 1) return Math.min.apply(null, columnHeights);\n      return columnHeights[0] || 0;\n    },\n    size(): number {\n      return intervalTree.size;\n    },\n    all(): PositionerItem[] {\n      return items;\n    },\n  };\n};\n\nexport interface Positioner {\n  /**\n   * The number of columns in the grid\n   */\n  columnCount: number;\n  /**\n   * The width of each column in the grid\n   */\n  columnWidth: number;\n  /**\n   * Sets the position for the cell at `index` based upon the cell's height\n   */\n  set: (index: number, height: number) => void;\n  /**\n   * Gets the `PositionerItem` for the cell at `index`\n   */\n  get: (index: number) => PositionerItem | undefined;\n  /**\n   * Updates cells based on their indexes and heights\n   * positioner.update([index, height, index, height, index, height...])\n   */\n  update: (updates: number[]) => void;\n  /**\n   * Searches the interval tree for grid cells with a `top` value in\n   * betwen `lo` and `hi` and invokes the callback for each item that\n   * is discovered\n   */\n  range: (\n    lo: number,\n    hi: number,\n    renderCallback: (index: number, left: number, top: number) => void\n  ) => void;\n  /**\n   * Returns the number of grid cells in the cache\n   */\n\n  size: () => number;\n  /**\n   * Estimates the total height of the grid\n   */\n\n  estimateHeight: (itemCount: number, defaultItemHeight: number) => number;\n  /**\n   * Returns the height of the shortest column in the grid\n   */\n\n  shortestColumn: () => number;\n  /**\n   * Returns all `PositionerItem` items\n   */\n  all: () => PositionerItem[];\n}\n\nexport interface PositionerItem {\n  /**\n   * This is how far from the top edge of the grid container in pixels the\n   * item is placed\n   */\n  top: number;\n  /**\n   * This is how far from the left edge of the grid container in pixels the\n   * item is placed\n   */\n  left: number;\n  /**\n   * This is the height of the grid cell\n   */\n  height: number;\n  /**\n   * This is the column number containing the grid cell\n   */\n  column: number;\n}\n\n/* istanbul ignore next */\nconst binarySearch = (a: number[], y: number): number => {\n  let l = 0;\n  let h = a.length - 1;\n\n  while (l <= h) {\n    const m = (l + h) >>> 1;\n    const x = a[m];\n    if (x === y) return m;\n    else if (x <= y) l = m + 1;\n    else h = m - 1;\n  }\n\n  return -1;\n};\n\nconst getColumns = (\n  width = 0,\n  minimumWidth = 0,\n  gutter = 8,\n  columnCount?: number,\n  maxColumnCount?: number,\n  maxColumnWidth?: number\n): [number, number] => {\n  columnCount =\n    columnCount ||\n    Math.min(\n      Math.floor((width + gutter) / (minimumWidth + gutter)),\n      maxColumnCount || Infinity\n    ) ||\n    1;\n  let columnWidth = Math.floor(\n    (width - gutter * (columnCount - 1)) / columnCount\n  );\n\n  // Cap the column width if maxColumnWidth is specified\n  if (maxColumnWidth !== undefined && columnWidth > maxColumnWidth) {\n    columnWidth = maxColumnWidth;\n  }\n\n  return [columnWidth, columnCount];\n};\n\nconst emptyArr: [] = [];\n","var rafSchd = function rafSchd(fn) {\n  var lastArgs = [];\n  var frameId = null;\n\n  var wrapperFn = function wrapperFn() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    lastArgs = args;\n\n    if (frameId) {\n      return;\n    }\n\n    frameId = requestAnimationFrame(function () {\n      frameId = null;\n      fn.apply(void 0, lastArgs);\n    });\n  };\n\n  wrapperFn.cancel = function () {\n    if (!frameId) {\n      return;\n    }\n\n    cancelAnimationFrame(frameId);\n    frameId = null;\n  };\n\n  return wrapperFn;\n};\n\nexport default rafSchd;\n","import rafSchd from \"raf-schd\";\nimport * as React from \"react\";\nimport trieMemoize from \"trie-memoize\";\nimport { elementsCache } from \"./elements-cache\";\nimport { useForceUpdate } from \"./use-force-update\";\nimport type { Positioner } from \"./use-positioner\";\n\n/**\n * Creates a resize observer that forces updates to the grid cell positions when mutations are\n * made to cells affecting their height.\n *\n * @param positioner - The masonry cell positioner created by the `usePositioner()` hook.\n */\nexport function useResizeObserver(positioner: Positioner) {\n  const forceUpdate = useForceUpdate();\n  const resizeObserver = createResizeObserver(positioner, forceUpdate);\n  // Cleans up the resize observers when they change or the\n  // component unmounts\n  React.useEffect(() => () => resizeObserver.disconnect(), [resizeObserver]);\n  return resizeObserver;\n}\n\nconst _handlerForType = rafSchd((target: HTMLElement) => {});\n\ntype IHandler = typeof _handlerForType;\n\n/**\n * Creates a resize observer that fires an `updater` callback whenever the height of\n * one or many cells change. The `useResizeObserver()` hook is using this under the hood.\n *\n * @param positioner - A cell positioner created by the `usePositioner()` hook or the `createPositioner()` utility\n * @param updater - A callback that fires whenever one or many cell heights change.\n */\nexport const createResizeObserver = trieMemoize(\n  [WeakMap],\n  // TODO: figure out a way to test this\n  /* istanbul ignore next */\n  (positioner: Positioner, updater: (updates: number[]) => void) => {\n    const updates: number[] = [];\n\n    const update = rafSchd(() => {\n      if (updates.length > 0) {\n        // Updates the size/positions of the cell with the resize\n        // observer updates\n        positioner.update(updates);\n        updater(updates);\n      }\n      updates.length = 0;\n    });\n\n    const commonHandler = (target: HTMLElement) => {\n      const height = target.offsetHeight;\n      if (height > 0) {\n        const index = elementsCache.get(target);\n        if (index !== void 0) {\n          const position = positioner.get(index);\n          if (position !== void 0 && height !== position.height)\n            updates.push(index, height);\n        }\n      }\n      update();\n    };\n\n    const handlers = new Map<number, IHandler>();\n    const handleEntries: ResizeObserverCallback = (entries) => {\n      let i = 0;\n\n      for (; i < entries.length; i++) {\n        const entry = entries[i];\n        const index = elementsCache.get(entry.target);\n\n        if (index === void 0) continue;\n        let handler = handlers.get(index);\n        if (!handler) {\n          handler = rafSchd(commonHandler);\n          handlers.set(index, handler);\n        }\n        handler(entry.target as HTMLElement);\n      }\n    };\n\n    const ro = new ResizeObserver(handleEntries);\n    // Overrides the original disconnect to include cancelling handling the entries.\n    // Ideally this would be its own method but that would result in a breaking\n    // change.\n    const disconnect = ro.disconnect.bind(ro);\n    ro.disconnect = () => {\n      disconnect();\n      handlers.forEach((handler) => {\n        handler.cancel();\n      });\n    };\n\n    return ro;\n  }\n);\n","import useEvent from \"@react-hook/event\";\nimport useLatest from \"@react-hook/latest\";\nimport { useThrottleCallback } from \"@react-hook/throttle\";\nimport * as React from \"react\";\nimport type { Positioner, PositionerItem } from \"./use-positioner\";\n\n/**\n * A hook that creates a callback for scrolling to a specific index in\n * the \"items\" array.\n *\n * @param positioner - A positioner created by the `usePositioner()` hook\n * @param options - Configuration options\n */\nexport function useScrollToIndex(\n  positioner: Positioner,\n  options: UseScrollToIndexOptions\n) {\n  const {\n    align = \"top\",\n    element = typeof window !== \"undefined\" && window,\n    offset = 0,\n    height = typeof window !== \"undefined\" ? window.innerHeight : 0,\n  } = options;\n  const latestOptions = useLatest({\n    positioner,\n    element,\n    align,\n    offset,\n    height,\n  } as const);\n  const getTarget = React.useRef(() => {\n    const latestElement = latestOptions.current.element;\n    return latestElement && \"current\" in latestElement\n      ? latestElement.current\n      : latestElement;\n  }).current;\n  const [state, dispatch] = React.useReducer(\n    (\n      state: {\n        position: PositionerItem | undefined;\n        index: number | undefined;\n        prevTop: number | undefined;\n      },\n      action:\n        | { type: \"scrollToIndex\"; value: number | undefined }\n        | { type: \"setPosition\"; value: PositionerItem | undefined }\n        | { type: \"setPrevTop\"; value: number | undefined }\n        | { type: \"reset\" }\n    ) => {\n      const nextState = {\n        position: state.position,\n        index: state.index,\n        prevTop: state.prevTop,\n      };\n\n      /* istanbul ignore next */\n      if (action.type === \"scrollToIndex\") {\n        return {\n          position: latestOptions.current.positioner.get(action.value ?? -1),\n          index: action.value,\n          prevTop: void 0,\n        };\n      } else if (action.type === \"setPosition\") {\n        nextState.position = action.value;\n      } else if (action.type === \"setPrevTop\") {\n        nextState.prevTop = action.value;\n      } else if (action.type === \"reset\") {\n        return defaultState;\n      }\n\n      return nextState;\n    },\n    defaultState\n  );\n  const throttledDispatch = useThrottleCallback(dispatch, 15);\n\n  // If we find the position along the way we can immediately take off\n  // to the correct spot.\n  useEvent(getTarget() as Window, \"scroll\", () => {\n    if (!state.position && state.index) {\n      const position = latestOptions.current.positioner.get(state.index);\n\n      if (position) {\n        dispatch({ type: \"setPosition\", value: position });\n      }\n    }\n  });\n\n  // If the top changes out from under us in the case of dynamic cells, we\n  // want to keep following it.\n  const currentTop =\n    state.index !== void 0 &&\n    latestOptions.current.positioner.get(state.index)?.top;\n\n  React.useEffect(() => {\n    const target = getTarget();\n    if (!target) return;\n    const { height, align, offset, positioner } = latestOptions.current;\n\n    if (state.position) {\n      let scrollTop = state.position.top;\n\n      if (align === \"bottom\") {\n        scrollTop = scrollTop - height + state.position.height;\n      } else if (align === \"center\") {\n        scrollTop -= (height - state.position.height) / 2;\n      }\n\n      target.scrollTo(0, Math.max(0, (scrollTop += offset)));\n      // Resets state after 400ms, an arbitrary time I determined to be\n      // still visually pleasing if there is a slow network reply in dynamic\n      // cells\n      let didUnsubscribe = false;\n      const timeout = setTimeout(\n        () => !didUnsubscribe && dispatch({ type: \"reset\" }),\n        400\n      );\n      return () => {\n        didUnsubscribe = true;\n        clearTimeout(timeout);\n      };\n    } else if (state.index !== void 0) {\n      // Estimates the top based upon the average height of current cells\n      let estimatedTop =\n        (positioner.shortestColumn() / positioner.size()) * state.index;\n      if (state.prevTop)\n        estimatedTop = Math.max(estimatedTop, state.prevTop + height);\n      target.scrollTo(0, estimatedTop);\n      throttledDispatch({ type: \"setPrevTop\", value: estimatedTop });\n    }\n  }, [currentTop, state, latestOptions, getTarget, throttledDispatch]);\n\n  return React.useRef((index: number) => {\n    dispatch({ type: \"scrollToIndex\", value: index });\n  }).current;\n}\n\nconst defaultState = {\n  index: void 0,\n  position: void 0,\n  prevTop: void 0,\n} as const;\n\nexport type UseScrollToIndexOptions = {\n  /**\n   * The window element or a React ref for the window element. That is,\n   * this is the grid container.\n   *\n   * @default window\n   */\n  element?: Window | HTMLElement | React.RefObject<HTMLElement> | null;\n  /**\n   * Sets the vertical alignment of the cell within the grid container.\n   *\n   * @default \"top\"\n   */\n  align?: \"center\" | \"top\" | \"bottom\";\n  /**\n   * The height of the grid.\n   *\n   * @default window.innerHeight\n   */\n  height?: number;\n  /**\n   * The vertical space in pixels between the top of the grid container and the top\n   * of the window.\n   *\n   * @default 0\n   */\n  offset?: number;\n};\n","import { useWindowSize } from \"@react-hook/window-size\";\nimport * as React from \"react\";\nimport { MasonryScroller } from \"./masonry-scroller\";\nimport type { MasonryScrollerProps } from \"./masonry-scroller\";\nimport { useContainerPosition } from \"./use-container-position\";\nimport { usePositioner } from \"./use-positioner\";\nimport type { UsePositionerOptions } from \"./use-positioner\";\nimport { useResizeObserver } from \"./use-resize-observer\";\nimport { useScrollToIndex } from \"./use-scroll-to-index\";\nimport type { UseScrollToIndexOptions } from \"./use-scroll-to-index\";\n\n/**\n * A \"batteries included\" masonry grid which includes all of the implementation details below. This component is the\n * easiest way to get off and running in your app, before switching to more advanced implementations, if necessary.\n * It will change its column count to fit its container's width and will decide how many rows to render based upon\n * the height of the browser `window`.\n *\n * @param props\n */\nexport function Masonry<Item>(props: MasonryProps<Item>) {\n  const containerRef = React.useRef<null | HTMLElement>(null);\n  const windowSize = useWindowSize({\n    initialWidth: props.ssrWidth,\n    initialHeight: props.ssrHeight,\n  });\n  const containerPos = useContainerPosition(containerRef, windowSize);\n  const nextProps = Object.assign(\n    {\n      offset: containerPos.offset,\n      width: containerPos.width || windowSize[0],\n      height: windowSize[1],\n      containerRef,\n    },\n    props\n  ) as any;\n  nextProps.positioner = usePositioner(nextProps);\n  nextProps.resizeObserver = useResizeObserver(nextProps.positioner);\n  const scrollToIndex = useScrollToIndex(nextProps.positioner, {\n    height: nextProps.height,\n    offset: containerPos.offset,\n    align:\n      typeof props.scrollToIndex === \"object\"\n        ? props.scrollToIndex.align\n        : void 0,\n  });\n  const index =\n    props.scrollToIndex &&\n    (typeof props.scrollToIndex === \"number\"\n      ? props.scrollToIndex\n      : props.scrollToIndex.index);\n\n  React.useEffect(() => {\n    if (index !== void 0) scrollToIndex(index);\n  }, [index, scrollToIndex]);\n\n  return React.createElement(MasonryScroller, nextProps);\n}\n\nexport interface MasonryProps<Item>\n  extends Omit<\n      MasonryScrollerProps<Item>,\n      \"offset\" | \"width\" | \"height\" | \"containerRef\" | \"positioner\"\n    >,\n    Pick<\n      UsePositionerOptions,\n      | \"columnWidth\"\n      | \"columnGutter\"\n      | \"rowGutter\"\n      | \"columnCount\"\n      | \"maxColumnCount\"\n      | \"maxColumnWidth\"\n    > {\n  /**\n   * Scrolls to a given index within the grid. The grid will re-scroll\n   * any time the index changes.\n   */\n  scrollToIndex?:\n    | number\n    | {\n        index: number;\n        align: UseScrollToIndexOptions[\"align\"];\n      };\n  /**\n   * This is the width that will be used for the browser `window` when rendering this component in SSR.\n   * This prop isn't relevant for client-side only apps.\n   */\n  ssrWidth?: number;\n  /**\n   * This is the height that will be used for the browser `window` when rendering this component in SSR.\n   * This prop isn't relevant for client-side only apps.\n   */\n  ssrHeight?: number;\n  /**\n   * This determines how often (in frames per second) to update the scroll position of the\n   * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\n   * The default value of `12` has been very reasonable in my own testing, but if you have particularly\n   * heavy `render` components it may be prudent to reduce this number.\n   *\n   * @default 12\n   */\n  scrollFps?: number;\n}\n\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n  Masonry.displayName = \"Masonry\";\n}\n","import * as React from \"react\";\nimport { Masonry } from \"./masonry\";\nimport type { MasonryProps } from \"./masonry\";\n\n/**\n * This is just a single-column `<Masonry>` component without column-specific props.\n *\n * @param props\n */\nexport function List<Item>(props: ListProps<Item>) {\n  return (\n    <Masonry<Item>\n      role=\"list\"\n      rowGutter={props.rowGutter}\n      columnCount={1}\n      columnWidth={1}\n      {...props}\n    />\n  );\n}\n\nexport interface ListProps<Item>\n  extends Omit<\n    MasonryProps<Item>,\n    \"columGutter\" | \"columnCount\" | \"columnWidth\"\n  > {\n  /**\n   * The amount of vertical space in pixels to add between the list cells.\n   *\n   * @default 0\n   */\n  rowGutter?: number;\n}\n\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n  List.displayName = \"List\";\n}\n","import useLatest from \"@react-hook/latest\";\nimport * as React from \"react\";\n\n/**\n * A utility hook for seamlessly adding infinite scroll behavior to the `useMasonry()` hook. This\n * hook invokes a callback each time the last rendered index surpasses the total number of items\n * in your items array or the number defined in the `totalItems` option.\n *\n * @param loadMoreItems - This callback is invoked when more rows must be loaded. It will be used to\n *  determine when to refresh the list with the newly-loaded data. This callback may be called multiple\n *  times in reaction to a single scroll event, so it's important to memoize its arguments. If you're\n *  creating this callback inside of a functional component, make sure you wrap it in `React.useCallback()`,\n *  as well.\n * @param options\n */\nexport function useInfiniteLoader<Item, T extends LoadMoreItemsCallback<Item>>(\n  loadMoreItems: T,\n  options: UseInfiniteLoaderOptions<Item> = emptyObj\n): LoadMoreItemsCallback<Item> {\n  const {\n    isItemLoaded,\n    minimumBatchSize = 16,\n    threshold = 16,\n    totalItems = 9e9,\n  } = options;\n  const storedLoadMoreItems = useLatest(loadMoreItems);\n  const storedIsItemLoaded = useLatest(isItemLoaded);\n\n  return React.useCallback(\n    (startIndex, stopIndex, items) => {\n      const unloadedRanges = scanForUnloadedRanges(\n        storedIsItemLoaded.current,\n        minimumBatchSize,\n        items,\n        totalItems,\n        Math.max(0, startIndex - threshold),\n        Math.min(totalItems - 1, (stopIndex || 0) + threshold)\n      );\n      // The user is responsible for memoizing their loadMoreItems() function\n      // because we don't want to make assumptions about how they want to deal\n      // with `items`\n      for (let i = 0; i < unloadedRanges.length - 1; ++i)\n        storedLoadMoreItems.current(\n          unloadedRanges[i],\n          unloadedRanges[++i],\n          items\n        );\n    },\n    [\n      totalItems,\n      minimumBatchSize,\n      threshold,\n      storedLoadMoreItems,\n      storedIsItemLoaded,\n    ]\n  );\n}\n\n/**\n * Returns all of the ranges within a larger range that contain unloaded rows.\n *\n * @param isItemLoaded\n * @param minimumBatchSize\n * @param items\n * @param totalItems\n * @param startIndex\n * @param stopIndex\n */\nfunction scanForUnloadedRanges<Item>(\n  isItemLoaded: UseInfiniteLoaderOptions<Item>[\"isItemLoaded\"] = defaultIsItemLoaded,\n  minimumBatchSize: UseInfiniteLoaderOptions<Item>[\"minimumBatchSize\"] = 16,\n  items: any[],\n  totalItems: UseInfiniteLoaderOptions<Item>[\"totalItems\"] = 9e9,\n  startIndex: number,\n  stopIndex: number\n): number[] {\n  const unloadedRanges: number[] = [];\n  let rangeStartIndex: number | undefined,\n    rangeStopIndex: number | undefined,\n    index = startIndex;\n\n  /* istanbul ignore next */\n  for (; index <= stopIndex; index++) {\n    if (!isItemLoaded(index, items)) {\n      rangeStopIndex = index;\n      if (rangeStartIndex === void 0) rangeStartIndex = index;\n    } else if (rangeStartIndex !== void 0 && rangeStopIndex !== void 0) {\n      unloadedRanges.push(rangeStartIndex, rangeStopIndex);\n      rangeStartIndex = rangeStopIndex = void 0;\n    }\n  }\n\n  // If :rangeStopIndex is not null it means we haven't run out of unloaded rows.\n  // Scan forward to try filling our :minimumBatchSize.\n  if (rangeStartIndex !== void 0 && rangeStopIndex !== void 0) {\n    const potentialStopIndex = Math.min(\n      Math.max(rangeStopIndex, rangeStartIndex + minimumBatchSize - 1),\n      totalItems - 1\n    );\n\n    /* istanbul ignore next */\n    for (index = rangeStopIndex + 1; index <= potentialStopIndex; index++) {\n      if (!isItemLoaded(index, items)) {\n        rangeStopIndex = index;\n      } else {\n        break;\n      }\n    }\n\n    unloadedRanges.push(rangeStartIndex, rangeStopIndex);\n  }\n\n  // Check to see if our first range ended prematurely.\n  // In this case we should scan backwards to try filling our :minimumBatchSize.\n  /* istanbul ignore next */\n  if (unloadedRanges.length) {\n    let firstUnloadedStart = unloadedRanges[0];\n    const firstUnloadedStop = unloadedRanges[1];\n\n    while (\n      firstUnloadedStop - firstUnloadedStart + 1 < minimumBatchSize &&\n      firstUnloadedStart > 0\n    ) {\n      const index = firstUnloadedStart - 1;\n\n      if (!isItemLoaded(index, items)) {\n        unloadedRanges[0] = firstUnloadedStart = index;\n      } else {\n        break;\n      }\n    }\n  }\n\n  return unloadedRanges;\n}\n\nconst defaultIsItemLoaded = <Item>(index: number, items: Item[]): boolean =>\n  items[index] !== void 0;\n\nexport interface UseInfiniteLoaderOptions<Item> {\n  /**\n   *  A callback responsible for determining the loaded state of each item. Should return `true`\n   * if the item has already been loaded and `false` if not.\n   *\n   * @default (index: number, items: any[]) => boolean\n   */\n  isItemLoaded?: (index: number, items: Item[]) => boolean;\n  /**\n   * The minimum number of new items to be loaded at a time.  This property can be used to\n   * batch requests and reduce HTTP requests.\n   *\n   * @default 16\n   */\n  minimumBatchSize?: number;\n  /**\n   * The threshold at which to pre-fetch data. A threshold X means that new data should start\n   * loading when a user scrolls within X cells of the end of your `items` array.\n   *\n   * @default 16\n   */\n  threshold?: number;\n  /**\n   * The total number of items you'll need to eventually load (if known). This can\n   * be arbitrarily high if not known.\n   *\n   * @default 9e9\n   */\n  totalItems?: number;\n}\n\nexport type LoadMoreItemsCallback<Item> = (\n  startIndex: number,\n  stopIndex: number,\n  items: Item[]\n) => any;\n\nconst emptyObj = {};\n"],"names":["RED","BLACK","NIL","DELETE","KEEP","addInterval","treeNode","high","index","node","list","prevNode","next","removeInterval","NULL_NODE","low","max","C","P","undefined","R","L","updateMax","Math","updateMaxUp","x","rotateLeft","tree","y","root","rotateRight","replaceNode","fixRemove","w","minimumTree","fixInsert","z","createIntervalTree","size","indexMap","insert","remove","intervalResult","originalYColor","search","callback","stack","length","pop","push","curr","useLatest","current","storedValue","React","useRef","useEffect","useDebounceCallback","wait","leading","storedCallback","timeout","deps","clearTimeout","useCallback","args","arguments","setTimeout","apply","useDebounce","initialState","state","useState","useEvent","target","type","listener","cleanup","storedListener","storedCleanup","targetEl","didUnsubscribe","addEventListener","removeEventListener","emptyObj","win","window","wv","visualViewport","getSize","document","documentElement","clientWidth","clientHeight","useWindowSize","options","initialWidth","initialHeight","setDebouncedSize","setSize","memoOne","fn","areEqual","equal","defaultAreEqual","value","prev","OneKeyMap","set","get","key","val","k","v","createCache","obj","cache","e","memo","constructors","depth","baseCache","base","map","i","one","g1","s1","g2","s2","g","s","memoize","mapConstructors","item","elementsCache","WeakMap","useForceUpdate","setState","useMasonry","positioner","resizeObserver","items","as","ContainerComponent","id","className","style","role","tabIndex","containerRef","itemAs","ItemComponent","itemStyle","itemHeightEstimate","itemKey","defaultGetItemKey","overscanBy","scrollTop","isScrolling","height","RenderComponent","render","onRender","startIndex","stopIndex","forceUpdate","setItemRef","getRefSetter","itemCount","columnWidth","columnCount","range","estimateHeight","shortestColumn","measuredCount","shortestColumnSize","children","itemRole","storedOnRender","rangeEnd","needsFreshBatch","left","top","data","phaseTwoStyle","width","writingMode","position","process","throwWithoutData","__reactCreateElement__","createRenderElement","min","batchSize","ceil","phaseOneStyle","getCachedSize","didEverMount","containerStyle","getContainerStyle","assignUserStyle","Error","trieMemoize","memoizeOne","maxWidth","maxHeight","willChange","pointerEvents","cmp2","pargs","userStyle","_","zIndex","visibility","el","observe","offsetHeight","u","p","performance","Date","now","af","Caf","Raf","raf","bind","caf","lastTime","h","clearRequestTimeout","handle","requestTimeout","ms","start","loop","call","perf","useThrottleCallback","fps","trailingTimeout","clearTrailing","rightNow","useThrottle","getScrollY","scrollY","pageYOffset","useWindowScroll","useScroller","offset","useScrollPosition","setIsScrolling","didMount","to","MasonryScroller","props","scrollFps","displayName","usePassiveLayoutEffect","createElement","useContainerPosition","elementRef","emptyArr","containerPosition","setContainerPosition","useLayoutEffect","offsetTop","offsetParent","offsetWidth","usePositioner","columnGutter","rowGutter","maxColumnCount","maxColumnWidth","initPositioner","getColumns","computedColumnWidth","computedColumnCount","createPositioner","positionerRef","prevDeps","opts","prevOpts","optsChanged","every","prevPositioner","cacheSize","pos","intervalTree","columnHeights","Array","columnItems","column","update","updates","columns","j","itemsInColumn","binarySearch","startItem","lo","hi","renderCallback","defaultItemHeight","tallestColumn","all","a","l","m","minimumWidth","gutter","floor","Infinity","rafSchd","lastArgs","frameId","wrapperFn","_len","_key","requestAnimationFrame","cancel","cancelAnimationFrame","useResizeObserver","createResizeObserver","disconnect","handler","updater","commonHandler","handlers","Map","handleEntries","entries","entry","ro","ResizeObserver","forEach","useScrollToIndex","align","element","innerHeight","latestOptions","getTarget","latestElement","useReducer","action","nextState","prevTop","defaultState","dispatch","throttledDispatch","currentTop","scrollTo","estimatedTop","Masonry","windowSize","ssrWidth","ssrHeight","containerPos","nextProps","scrollToIndex","List","useInfiniteLoader","loadMoreItems","isItemLoaded","minimumBatchSize","threshold","totalItems","storedLoadMoreItems","storedIsItemLoaded","unloadedRanges","scanForUnloadedRanges","defaultIsItemLoaded","rangeStartIndex","rangeStopIndex","potentialStopIndex","firstUnloadedStart","firstUnloadedStop"],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"masonic.dev.js","sources":["../../src/interval-tree.ts","../../node_modules/.pnpm/@react-hook+latest@1.0.3_react@17.0.2/node_modules/@react-hook/latest/src/index.tsx","../../node_modules/.pnpm/@react-hook+debounce@3.0.0_react@17.0.2/node_modules/@react-hook/debounce/src/index.tsx","../../node_modules/.pnpm/@react-hook+event@1.2.6_react@17.0.2/node_modules/@react-hook/event/src/index.tsx","../../node_modules/.pnpm/@react-hook+window-size@3.1.1_react@17.0.2/node_modules/@react-hook/window-size/src/index.tsx","../../node_modules/.pnpm/@essentials+memoize-one@1.1.0/node_modules/@essentials/memoize-one/src/index.ts","../../node_modules/.pnpm/@essentials+one-key-map@1.2.0/node_modules/@essentials/one-key-map/src/index.ts","../../node_modules/.pnpm/trie-memoize@1.2.0/node_modules/trie-memoize/src/index.ts","../../src/elements-cache.ts","../../src/use-force-update.ts","../../src/use-masonry.tsx","../../node_modules/.pnpm/@essentials+raf@1.2.0/node_modules/@essentials/raf/src/index.ts","../../node_modules/.pnpm/@essentials+request-timeout@1.3.0/node_modules/@essentials/request-timeout/src/index.ts","../../node_modules/.pnpm/@react-hook+throttle@2.2.0_react@17.0.2/node_modules/@react-hook/throttle/src/index.tsx","../../node_modules/.pnpm/@react-hook+window-scroll@1.3.0_react@17.0.2/node_modules/@react-hook/window-scroll/src/index.tsx","../../src/use-scroller.ts","../../src/masonry-scroller.tsx","../../node_modules/.pnpm/@react-hook+passive-layout-effect@1.2.1_react@17.0.2/node_modules/@react-hook/passive-layout-effect/src/index.tsx","../../src/use-container-position.ts","../../src/use-positioner.ts","../../node_modules/.pnpm/raf-schd@4.0.3/node_modules/raf-schd/dist/raf-schd.esm.js","../../src/use-resize-observer.ts","../../src/use-scroll-to-index.ts","../../src/masonry.tsx","../../src/list.tsx","../../src/use-infinite-loader.ts"],"sourcesContent":["type Color = 0 | 1 | 2;\r\nconst RED = 0;\r\nconst BLACK = 1;\r\nconst NIL = 2;\r\n\r\nconst DELETE = 0;\r\nconst KEEP = 1;\r\n\r\ntype ListNode = {\r\n  index: number;\r\n  high: number;\r\n  next: ListNode | null;\r\n};\r\n\r\ninterface TreeNode {\r\n  max: number;\r\n  low: number;\r\n  high: number;\r\n  // color\r\n  C: Color;\r\n  // P\r\n  P: TreeNode;\r\n  // right\r\n  R: TreeNode;\r\n  // left\r\n  L: TreeNode;\r\n  list: ListNode;\r\n}\r\n\r\ninterface Tree {\r\n  root: TreeNode;\r\n  size: number;\r\n}\r\n\r\nfunction addInterval(treeNode: TreeNode, high: number, index: number): boolean {\r\n  let node: ListNode | null = treeNode.list;\r\n  let prevNode: ListNode | undefined;\r\n\r\n  while (node) {\r\n    if (node.index === index) return false;\r\n    if (high > node.high) break;\r\n    prevNode = node;\r\n    node = node.next;\r\n  }\r\n\r\n  if (!prevNode) treeNode.list = { index, high, next: node };\r\n  if (prevNode) prevNode.next = { index, high, next: prevNode.next };\r\n\r\n  return true;\r\n}\r\n\r\nfunction removeInterval(treeNode: TreeNode, index: number) {\r\n  let node: ListNode | null = treeNode.list;\r\n  if (node.index === index) {\r\n    if (node.next === null) return DELETE;\r\n    treeNode.list = node.next;\r\n    return KEEP;\r\n  }\r\n\r\n  let prevNode: ListNode | undefined = node;\r\n  node = node.next;\r\n\r\n  while (node !== null) {\r\n    if (node.index === index) {\r\n      prevNode.next = node.next;\r\n      return KEEP;\r\n    }\r\n    prevNode = node;\r\n    node = node.next;\r\n  }\r\n}\r\n\r\nconst NULL_NODE: TreeNode = {\r\n  low: 0,\r\n  max: 0,\r\n  high: 0,\r\n  C: NIL,\r\n  // @ts-expect-error\r\n  P: undefined,\r\n  // @ts-expect-error\r\n  R: undefined,\r\n  // @ts-expect-error\r\n  L: undefined,\r\n  // @ts-expect-error\r\n  list: undefined,\r\n};\r\n\r\nNULL_NODE.P = NULL_NODE;\r\nNULL_NODE.L = NULL_NODE;\r\nNULL_NODE.R = NULL_NODE;\r\n\r\nfunction updateMax(node: TreeNode) {\r\n  const max = node.high;\r\n  if (node.L === NULL_NODE && node.R === NULL_NODE) node.max = max;\r\n  else if (node.L === NULL_NODE) node.max = Math.max(node.R.max, max);\r\n  else if (node.R === NULL_NODE) node.max = Math.max(node.L.max, max);\r\n  else node.max = Math.max(Math.max(node.L.max, node.R.max), max);\r\n}\r\n\r\nfunction updateMaxUp(node: TreeNode) {\r\n  let x = node;\r\n\r\n  while (x.P !== NULL_NODE) {\r\n    updateMax(x.P);\r\n    x = x.P;\r\n  }\r\n}\r\n\r\nfunction rotateLeft(tree: Tree, x: TreeNode) {\r\n  if (x.R === NULL_NODE) return;\r\n  const y = x.R;\r\n  x.R = y.L;\r\n  if (y.L !== NULL_NODE) y.L.P = x;\r\n  y.P = x.P;\r\n\r\n  if (x.P === NULL_NODE) tree.root = y;\r\n  else if (x === x.P.L) x.P.L = y;\r\n  else x.P.R = y;\r\n\r\n  y.L = x;\r\n  x.P = y;\r\n\r\n  updateMax(x);\r\n  updateMax(y);\r\n}\r\n\r\nfunction rotateRight(tree: Tree, x: TreeNode) {\r\n  if (x.L === NULL_NODE) return;\r\n  const y = x.L;\r\n  x.L = y.R;\r\n  if (y.R !== NULL_NODE) y.R.P = x;\r\n  y.P = x.P;\r\n\r\n  if (x.P === NULL_NODE) tree.root = y;\r\n  else if (x === x.P.R) x.P.R = y;\r\n  else x.P.L = y;\r\n\r\n  y.R = x;\r\n  x.P = y;\r\n\r\n  updateMax(x);\r\n  updateMax(y);\r\n}\r\n\r\nfunction replaceNode(tree: Tree, x: TreeNode, y: TreeNode) {\r\n  if (x.P === NULL_NODE) tree.root = y;\r\n  else if (x === x.P.L) x.P.L = y;\r\n  else x.P.R = y;\r\n  y.P = x.P;\r\n}\r\n\r\nfunction fixRemove(tree: Tree, x: TreeNode) {\r\n  let w;\r\n\r\n  while (x !== NULL_NODE && x.C === BLACK) {\r\n    if (x === x.P.L) {\r\n      w = x.P.R;\r\n\r\n      if (w.C === RED) {\r\n        w.C = BLACK;\r\n        x.P.C = RED;\r\n        rotateLeft(tree, x.P);\r\n        w = x.P.R;\r\n      }\r\n\r\n      if (w.L.C === BLACK && w.R.C === BLACK) {\r\n        w.C = RED;\r\n        x = x.P;\r\n      } else {\r\n        if (w.R.C === BLACK) {\r\n          w.L.C = BLACK;\r\n          w.C = RED;\r\n          rotateRight(tree, w);\r\n          w = x.P.R;\r\n        }\r\n\r\n        w.C = x.P.C;\r\n        x.P.C = BLACK;\r\n        w.R.C = BLACK;\r\n        rotateLeft(tree, x.P);\r\n        x = tree.root;\r\n      }\r\n    } else {\r\n      w = x.P.L;\r\n\r\n      if (w.C === RED) {\r\n        w.C = BLACK;\r\n        x.P.C = RED;\r\n        rotateRight(tree, x.P);\r\n        w = x.P.L;\r\n      }\r\n\r\n      if (w.R.C === BLACK && w.L.C === BLACK) {\r\n        w.C = RED;\r\n        x = x.P;\r\n      } else {\r\n        if (w.L.C === BLACK) {\r\n          w.R.C = BLACK;\r\n          w.C = RED;\r\n          rotateLeft(tree, w);\r\n          w = x.P.L;\r\n        }\r\n\r\n        w.C = x.P.C;\r\n        x.P.C = BLACK;\r\n        w.L.C = BLACK;\r\n        rotateRight(tree, x.P);\r\n        x = tree.root;\r\n      }\r\n    }\r\n  }\r\n\r\n  x.C = BLACK;\r\n}\r\n\r\nfunction minimumTree(x: TreeNode) {\r\n  while (x.L !== NULL_NODE) x = x.L;\r\n  return x;\r\n}\r\n\r\nfunction fixInsert(tree: Tree, z: TreeNode) {\r\n  let y: TreeNode;\r\n  while (z.P.C === RED) {\r\n    if (z.P === z.P.P.L) {\r\n      y = z.P.P.R;\r\n\r\n      if (y.C === RED) {\r\n        z.P.C = BLACK;\r\n        y.C = BLACK;\r\n        z.P.P.C = RED;\r\n        z = z.P.P;\r\n      } else {\r\n        if (z === z.P.R) {\r\n          z = z.P;\r\n          rotateLeft(tree, z);\r\n        }\r\n\r\n        z.P.C = BLACK;\r\n        z.P.P.C = RED;\r\n        rotateRight(tree, z.P.P);\r\n      }\r\n    } else {\r\n      y = z.P.P.L;\r\n\r\n      if (y.C === RED) {\r\n        z.P.C = BLACK;\r\n        y.C = BLACK;\r\n        z.P.P.C = RED;\r\n        z = z.P.P;\r\n      } else {\r\n        if (z === z.P.L) {\r\n          z = z.P;\r\n          rotateRight(tree, z);\r\n        }\r\n\r\n        z.P.C = BLACK;\r\n        z.P.P.C = RED;\r\n        rotateLeft(tree, z.P.P);\r\n      }\r\n    }\r\n  }\r\n  tree.root.C = BLACK;\r\n}\r\n\r\nexport interface IIntervalTree {\r\n  insert(low: number, high: number, index: number): void;\r\n  remove(index: number): void;\r\n  search(\r\n    low: number,\r\n    high: number,\r\n    callback: (index: number, low: number) => any\r\n  ): void;\r\n  size: number;\r\n}\r\n\r\nexport function createIntervalTree(): IIntervalTree {\r\n  const tree = {\r\n    root: NULL_NODE,\r\n    size: 0,\r\n  };\r\n  // we know these indexes are a consistent, safe way to make look ups\r\n  // for our case so it's a solid O(1) alternative to\r\n  // the O(log n) searchNode() in typical interval trees\r\n  const indexMap: Record<number, TreeNode> = {};\r\n\r\n  return {\r\n    insert(low, high, index) {\r\n      let x: TreeNode = tree.root;\r\n      let y: TreeNode = NULL_NODE;\r\n\r\n      while (x !== NULL_NODE) {\r\n        y = x;\r\n        if (low === y.low) break;\r\n        if (low < x.low) x = x.L;\r\n        else x = x.R;\r\n      }\r\n\r\n      if (low === y.low && y !== NULL_NODE) {\r\n        if (!addInterval(y, high, index)) return;\r\n        y.high = Math.max(y.high, high);\r\n        updateMax(y);\r\n        updateMaxUp(y);\r\n        indexMap[index] = y;\r\n        tree.size++;\r\n        return;\r\n      }\r\n\r\n      const z: TreeNode = {\r\n        low,\r\n        high,\r\n        max: high,\r\n        C: RED,\r\n        P: y,\r\n        L: NULL_NODE,\r\n        R: NULL_NODE,\r\n        list: { index, high, next: null },\r\n      };\r\n\r\n      if (y === NULL_NODE) {\r\n        tree.root = z;\r\n      } else {\r\n        if (z.low < y.low) y.L = z;\r\n        else y.R = z;\r\n        updateMaxUp(z);\r\n      }\r\n\r\n      fixInsert(tree, z);\r\n      indexMap[index] = z;\r\n      tree.size++;\r\n    },\r\n\r\n    remove(index) {\r\n      const z = indexMap[index];\r\n      if (z === void 0) return;\r\n      delete indexMap[index];\r\n\r\n      const intervalResult = removeInterval(z, index);\r\n      if (intervalResult === void 0) return;\r\n      if (intervalResult === KEEP) {\r\n        z.high = z.list.high;\r\n        updateMax(z);\r\n        updateMaxUp(z);\r\n        tree.size--;\r\n        return;\r\n      }\r\n\r\n      let y = z;\r\n      let originalYColor = y.C;\r\n      let x: TreeNode;\r\n\r\n      if (z.L === NULL_NODE) {\r\n        x = z.R;\r\n        replaceNode(tree, z, z.R);\r\n      } else if (z.R === NULL_NODE) {\r\n        x = z.L;\r\n        replaceNode(tree, z, z.L);\r\n      } else {\r\n        y = minimumTree(z.R);\r\n        originalYColor = y.C;\r\n        x = y.R;\r\n\r\n        if (y.P === z) {\r\n          x.P = y;\r\n        } else {\r\n          replaceNode(tree, y, y.R);\r\n          y.R = z.R;\r\n          y.R.P = y;\r\n        }\r\n\r\n        replaceNode(tree, z, y);\r\n        y.L = z.L;\r\n        y.L.P = y;\r\n        y.C = z.C;\r\n      }\r\n\r\n      updateMax(x);\r\n      updateMaxUp(x);\r\n\r\n      if (originalYColor === BLACK) fixRemove(tree, x);\r\n      tree.size--;\r\n    },\r\n\r\n    search(low, high, callback) {\r\n      const stack = [tree.root];\r\n      while (stack.length !== 0) {\r\n        const node = stack.pop() as TreeNode;\r\n        if (node === NULL_NODE || low > node.max) continue;\r\n        if (node.L !== NULL_NODE) stack.push(node.L);\r\n        if (node.R !== NULL_NODE) stack.push(node.R);\r\n        if (node.low <= high && node.high >= low) {\r\n          let curr: ListNode | null = node.list;\r\n          while (curr !== null) {\r\n            if (curr.high >= low) callback(curr.index, node.low);\r\n            curr = curr.next;\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    get size() {\r\n      return tree.size;\r\n    },\r\n  };\r\n}\r\n","import * as React from 'react'\n\nconst useLatest = <T extends any>(current: T) => {\n  const storedValue = React.useRef(current)\n  React.useEffect(() => {\n    storedValue.current = current\n  })\n  return storedValue\n}\n\nexport default useLatest\n","import * as React from 'react'\nimport useLatest from '@react-hook/latest'\n\nexport const useDebounceCallback = <CallbackArgs extends any[]>(\n  callback: (...args: CallbackArgs) => void,\n  wait = 100,\n  leading = false\n): ((...args: CallbackArgs) => void) => {\n  const storedCallback = useLatest(callback)\n  const timeout = React.useRef<ReturnType<typeof setTimeout>>()\n  const deps = [wait, leading, storedCallback]\n  // Cleans up pending timeouts when the deps change\n  React.useEffect(\n    () => () => {\n      timeout.current && clearTimeout(timeout.current)\n      timeout.current = void 0\n    },\n    deps\n  )\n\n  return React.useCallback(function () {\n    // eslint-disable-next-line prefer-rest-params\n    const args = arguments\n    const {current} = timeout\n    // Calls on leading edge\n    if (current === void 0 && leading) {\n      timeout.current = setTimeout(() => {\n        timeout.current = void 0\n      }, wait)\n      // eslint-disable-next-line prefer-spread\n      return storedCallback.current.apply(null, args as any)\n    }\n    // Clear the timeout every call and start waiting again\n    current && clearTimeout(current)\n    // Waits for `wait` before invoking the callback\n    timeout.current = setTimeout(() => {\n      timeout.current = void 0\n      storedCallback.current.apply(null, args as any)\n    }, wait)\n  }, deps)\n}\n\nexport const useDebounce = <State extends any>(\n  initialState: State | (() => State),\n  wait?: number,\n  leading?: boolean\n): [State, React.Dispatch<React.SetStateAction<State>>] => {\n  const state = React.useState(initialState)\n  return [state[0], useDebounceCallback(state[1], wait, leading)]\n}\n","import * as React from 'react'\n\nfunction useEvent<\n  T extends Window = Window,\n  K extends keyof WindowEventMap = keyof WindowEventMap\n>(\n  target: Window | null,\n  type: K,\n  listener: WindowEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent<\n  T extends Document = Document,\n  K extends keyof DocumentEventMap = keyof DocumentEventMap\n>(\n  target: Document | null,\n  type: K,\n  listener: DocumentEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent<\n  T extends HTMLElement = HTMLElement,\n  K extends keyof HTMLElementEventMap = keyof HTMLElementEventMap\n>(\n  target: React.RefObject<T> | T | null,\n  type: K,\n  listener: ElementEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent(target: any, type: any, listener: any, cleanup: any): void {\n  const storedListener = React.useRef(listener)\n  const storedCleanup = React.useRef(cleanup)\n\n  React.useEffect(() => {\n    storedListener.current = listener\n    storedCleanup.current = cleanup\n  })\n\n  React.useEffect(() => {\n    const targetEl = target && 'current' in target ? target.current : target\n    if (!targetEl) return\n\n    let didUnsubscribe = 0\n    function listener(this: any, ...args: any[]) {\n      if (didUnsubscribe) return\n      storedListener.current.apply(this, args)\n    }\n\n    targetEl.addEventListener(type, listener)\n    const cleanup = storedCleanup.current\n\n    return () => {\n      didUnsubscribe = 1\n      targetEl.removeEventListener(type, listener)\n      cleanup && cleanup()\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [target, type])\n}\n\nexport type ElementEventListener<\n  K extends keyof HTMLElementEventMap = keyof HTMLElementEventMap\n> = (this: HTMLElement, ev: HTMLElementEventMap[K]) => any\n\nexport type DocumentEventListener<\n  K extends keyof DocumentEventMap = keyof DocumentEventMap\n> = (this: Document, ev: DocumentEventMap[K]) => any\n\nexport type WindowEventListener<\n  K extends keyof WindowEventMap = keyof WindowEventMap\n> = (this: Document, ev: WindowEventMap[K]) => any\n\nexport default useEvent\n","import {useDebounce} from '@react-hook/debounce'\nimport useEvent from '@react-hook/event'\n\nconst emptyObj = {}\n\nexport interface DebouncedWindowSizeOptions {\n  initialWidth?: number\n  initialHeight?: number\n  wait?: number\n  leading?: boolean\n}\n\nconst win = typeof window === 'undefined' ? null : window\nconst wv =\n  win && typeof win.visualViewport !== 'undefined' ? win.visualViewport : null\nconst getSize = () =>\n  [\n    document.documentElement.clientWidth,\n    document.documentElement.clientHeight,\n  ] as const\n\nexport const useWindowSize = (\n  options: DebouncedWindowSizeOptions = emptyObj\n): readonly [number, number] => {\n  const {wait, leading, initialWidth = 0, initialHeight = 0} = options\n  const [size, setDebouncedSize] = useDebounce<readonly [number, number]>(\n    /* istanbul ignore next */\n    typeof document === 'undefined' ? [initialWidth, initialHeight] : getSize,\n    wait,\n    leading\n  )\n  const setSize = (): void => setDebouncedSize(getSize)\n\n  useEvent(win, 'resize', setSize)\n  // @ts-expect-error\n  useEvent(wv, 'resize', setSize)\n  useEvent(win, 'orientationchange', setSize)\n\n  return size\n}\n\nexport const useWindowHeight = (\n  options?: Omit<DebouncedWindowSizeOptions, 'initialWidth'>\n): number => useWindowSize(options)[1]\n\nexport const useWindowWidth = (\n  options?: Omit<DebouncedWindowSizeOptions, 'initialHeight'>\n): number => useWindowSize(options)[0]\n","const memoOne = <Args extends any[], T extends any>(\n  fn: (...args: Args) => T,\n  areEqual?: AreEqual<Args>\n): OutputFunction<Args, T> => {\n  const equal = areEqual || defaultAreEqual\n  let args: Args, value: any\n\n  return function (): T {\n    return !!args && equal(arguments as any, args)\n      ? value\n      : (value = fn.apply(null, (args = arguments as any)))\n  } as OutputFunction<Args, T>\n}\n\nexport default memoOne\n\nconst defaultAreEqual = (\n  current: IArguments,\n  prev: IArguments | any[]\n): boolean =>\n  current[0] === prev[0] &&\n  current[1] === prev[1] &&\n  current[2] === prev[2] &&\n  current[3] === prev[3]\n\nexport type AreEqual<Args> = (currentArgs: Args, prevArgs: Args) => boolean\nexport type InputFunction = (...args: any[]) => any\nexport type OutputFunction<Args extends any[], T extends any> = (\n  ...args: Args\n) => T\n","class OneKeyMap<K extends any = any, V extends any = any> {\n  set: (k: K, v: V) => void\n  get: (k: K) => V | undefined\n\n  constructor() {\n    let key: K | undefined, val: V | undefined\n    this.get = (k: K): V | undefined => (k === key ? val : void 0)\n    this.set = (k: K, v: V): void => {\n      key = k\n      val = v\n    }\n  }\n}\n\nexport default OneKeyMap\n","export interface MapLike {\n  new (...args: any[]): any\n}\n\nexport type CacheConstructor =\n  | MapConstructor\n  | WeakMapConstructor\n  | MapLike\n  | Record<any, any>\n\ninterface Cache<K = any, V = any> {\n  set: (k: K, v: V) => V\n  get: (k: K) => V\n}\n\nconst createCache = (obj: CacheConstructor): Cache => {\n  try {\n    // @ts-ignore\n    return new obj()\n  } catch (e) {\n    const cache: Record<string, any> = {}\n\n    return {\n      set(k, v): void {\n        cache[k] = v\n      },\n      get(k): any {\n        return cache[k]\n      },\n    }\n  }\n}\n\nconst memo = (\n  constructors: CacheConstructor[]\n): {s: Cache['set']; g: Cache['get']} => {\n  const depth = constructors.length,\n    baseCache = createCache(constructors[0])\n  let base: any\n  let map: any\n  let i: number\n  let node: typeof baseCache\n  const one = depth === 1\n  // quicker access for one and two-argument functions\n  const g1 = (args: IArguments): any =>\n    (base = baseCache.get(args[0])) === void 0 || one ? base : base.get(args[1])\n  const s1 = (args: IArguments, value: any): any => {\n    if (one) baseCache.set(args[0], value)\n    else {\n      if ((base = baseCache.get(args[0])) === void 0) {\n        map = createCache(constructors[1])\n        map.set(args[1], value)\n        baseCache.set(args[0], map)\n      } else {\n        base.set(args[1], value)\n      }\n    }\n\n    return value\n  }\n\n  const g2 = (args: IArguments): any => {\n    node = baseCache\n\n    for (i = 0; i < depth; i++)\n      if ((node = node.get(args[i])) === void 0) return\n\n    return node\n  }\n\n  const s2 = (args: IArguments, value: any): any => {\n    node = baseCache\n\n    for (i = 0; i < depth - 1; i++) {\n      if ((map = node.get(args[i])) === void 0) {\n        map = createCache(constructors[i + 1])\n        node.set(args[i], map)\n        node = map\n      } else {\n        node = map\n      }\n    }\n\n    node.set(args[depth - 1], value)\n    return value\n  }\n\n  return depth < 3 ? {g: g1, s: s1} : {g: g2, s: s2}\n}\n\nconst memoize = <T extends any[], U extends any>(\n  mapConstructors: CacheConstructor[],\n  fn: (...args: T) => U\n): ((...args: T) => U) => {\n  let item: U\n  const {g, s} = memo(mapConstructors)\n  return function () {\n    return (item = g(arguments)) === void 0\n      ? s(arguments, fn.apply(null, arguments as any))\n      : item\n  }\n}\n\nexport default memoize\n","export const elementsCache: WeakMap<Element, number> = new WeakMap();\r\n","import * as React from \"react\";\r\n\r\nexport function useForceUpdate() {\r\n  const setState = React.useState(emptyObj)[1];\r\n  return React.useRef(() => setState({})).current;\r\n}\r\n\r\nconst emptyObj = {};\r\n","import memoizeOne from \"@essentials/memoize-one\";\r\nimport OneKeyMap from \"@essentials/one-key-map\";\r\nimport useLatest from \"@react-hook/latest\";\r\nimport * as React from \"react\";\r\nimport trieMemoize from \"trie-memoize\";\r\nimport { elementsCache } from \"./elements-cache\";\r\nimport { useForceUpdate } from \"./use-force-update\";\r\nimport type { Positioner } from \"./use-positioner\";\r\n\r\n/**\r\n * This hook handles the render phases of the masonry layout and returns the grid as a React element.\r\n *\r\n * @param options - Options for configuring the masonry layout renderer. See `UseMasonryOptions`.\r\n * @param options.positioner\r\n * @param options.resizeObserver\r\n * @param options.items\r\n * @param options.as\r\n * @param options.id\r\n * @param options.className\r\n * @param options.style\r\n * @param options.role\r\n * @param options.tabIndex\r\n * @param options.containerRef\r\n * @param options.itemAs\r\n * @param options.itemStyle\r\n * @param options.itemHeightEstimate\r\n * @param options.itemKey\r\n * @param options.overscanBy\r\n * @param options.scrollTop\r\n * @param options.isScrolling\r\n * @param options.height\r\n * @param options.render\r\n * @param options.onRender\r\n */\r\nexport function useMasonry<Item>({\r\n  // Measurement and layout\r\n  positioner,\r\n  resizeObserver,\r\n  // Grid items\r\n  items,\r\n  // Container props\r\n  as: ContainerComponent = \"div\",\r\n  id,\r\n  className,\r\n  style,\r\n  role = \"grid\",\r\n  tabIndex = 0,\r\n  containerRef,\r\n  // Item props\r\n  itemAs: ItemComponent = \"div\",\r\n  itemStyle,\r\n  itemHeightEstimate = 300,\r\n  itemKey = defaultGetItemKey,\r\n  // Rendering props\r\n  overscanBy = 2,\r\n  scrollTop,\r\n  isScrolling,\r\n  height,\r\n  render: RenderComponent,\r\n  onRender,\r\n}: UseMasonryOptions<Item>) {\r\n  let startIndex = 0;\r\n  let stopIndex: number | undefined;\r\n  const forceUpdate = useForceUpdate();\r\n  const setItemRef = getRefSetter(positioner, resizeObserver);\r\n  const itemCount = items.length;\r\n  const {\r\n    columnWidth,\r\n    columnCount,\r\n    range,\r\n    estimateHeight,\r\n    size,\r\n    shortestColumn,\r\n  } = positioner;\r\n  const measuredCount = size();\r\n  const shortestColumnSize = shortestColumn();\r\n  const children: React.ReactElement[] = [];\r\n  const itemRole =\r\n    role === \"list\" ? \"listitem\" : role === \"grid\" ? \"gridcell\" : undefined;\r\n  const storedOnRender = useLatest(onRender);\r\n\r\n  overscanBy = height * overscanBy;\r\n  const rangeEnd = scrollTop + overscanBy;\r\n  const needsFreshBatch =\r\n    shortestColumnSize < rangeEnd && measuredCount < itemCount;\r\n\r\n  range(\r\n    // We overscan in both directions because users scroll both ways,\r\n    // though one must admit scrolling down is more common and thus\r\n    // we only overscan by half the downward overscan amount\r\n    Math.max(0, scrollTop - overscanBy / 2),\r\n    rangeEnd,\r\n    (index, left, top) => {\r\n      const data = items[index];\r\n      const key = itemKey(data, index);\r\n      const phaseTwoStyle: React.CSSProperties = {\r\n        top,\r\n        left,\r\n        width: columnWidth,\r\n        writingMode: \"horizontal-tb\",\r\n        position: \"absolute\",\r\n      };\r\n\r\n      /* istanbul ignore next */\r\n      if (\r\n        typeof process !== \"undefined\" &&\r\n        process.env.NODE_ENV !== \"production\"\r\n      ) {\r\n        throwWithoutData(data, index);\r\n      }\r\n\r\n      children.push(\r\n        <ItemComponent\r\n          key={key}\r\n          ref={setItemRef(index)}\r\n          role={itemRole}\r\n          style={\r\n            typeof itemStyle === \"object\" && itemStyle !== null\r\n              ? Object.assign({}, phaseTwoStyle, itemStyle)\r\n              : phaseTwoStyle\r\n          }\r\n        >\r\n          {createRenderElement(RenderComponent, index, data, columnWidth)}\r\n        </ItemComponent>\r\n      );\r\n\r\n      if (stopIndex === void 0) {\r\n        startIndex = index;\r\n        stopIndex = index;\r\n      } else {\r\n        startIndex = Math.min(startIndex, index);\r\n        stopIndex = Math.max(stopIndex, index);\r\n      }\r\n    }\r\n  );\r\n\r\n  if (needsFreshBatch) {\r\n    const batchSize = Math.min(\r\n      itemCount - measuredCount,\r\n      Math.ceil(\r\n        ((scrollTop + overscanBy - shortestColumnSize) / itemHeightEstimate) *\r\n          columnCount\r\n      )\r\n    );\r\n\r\n    let index = measuredCount;\r\n    const phaseOneStyle = getCachedSize(columnWidth);\r\n\r\n    for (; index < measuredCount + batchSize; index++) {\r\n      const data = items[index];\r\n      const key = itemKey(data, index);\r\n\r\n      /* istanbul ignore next */\r\n      if (\r\n        typeof process !== \"undefined\" &&\r\n        process.env.NODE_ENV !== \"production\"\r\n      ) {\r\n        throwWithoutData(data, index);\r\n      }\r\n\r\n      children.push(\r\n        <ItemComponent\r\n          key={key}\r\n          ref={setItemRef(index)}\r\n          role={itemRole}\r\n          style={\r\n            typeof itemStyle === \"object\"\r\n              ? Object.assign({}, phaseOneStyle, itemStyle)\r\n              : phaseOneStyle\r\n          }\r\n        >\r\n          {createRenderElement(RenderComponent, index, data, columnWidth)}\r\n        </ItemComponent>\r\n      );\r\n    }\r\n  }\r\n\r\n  // Calls the onRender callback if the rendered indices changed\r\n  React.useEffect(() => {\r\n    if (typeof storedOnRender.current === \"function\" && stopIndex !== void 0)\r\n      storedOnRender.current(startIndex, stopIndex, items);\r\n\r\n    didEverMount = \"1\";\r\n  }, [startIndex, stopIndex, items, storedOnRender]);\r\n  // If we needed a fresh batch we should reload our components with the measured\r\n  // sizes\r\n  React.useEffect(() => {\r\n    if (needsFreshBatch) forceUpdate();\r\n    // eslint-disable-next-line\r\n  }, [needsFreshBatch, positioner]);\r\n\r\n  // gets the container style object based upon the estimated height and whether or not\r\n  // the page is being scrolled\r\n  const containerStyle = getContainerStyle(\r\n    isScrolling,\r\n    estimateHeight(itemCount, itemHeightEstimate)\r\n  );\r\n\r\n  return (\r\n    <ContainerComponent\r\n      ref={containerRef}\r\n      key={didEverMount}\r\n      id={id}\r\n      role={role}\r\n      className={className}\r\n      tabIndex={tabIndex}\r\n      style={\r\n        typeof style === \"object\"\r\n          ? assignUserStyle(containerStyle, style)\r\n          : containerStyle\r\n      }\r\n      children={children}\r\n    />\r\n  );\r\n}\r\n\r\n/* istanbul ignore next */\r\nfunction throwWithoutData(data: any, index: number) {\r\n  if (!data) {\r\n    throw new Error(\r\n      `No data was found at index: ${index}\\n\\n` +\r\n        `This usually happens when you've mutated or changed the \"items\" array in a ` +\r\n        `way that makes it shorter than the previous \"items\" array. Masonic knows nothing ` +\r\n        `about your underlying data and when it caches cell positions, it assumes you aren't ` +\r\n        `mutating the underlying \"items\".\\n\\n` +\r\n        `See https://codesandbox.io/s/masonic-w-react-router-example-2b5f9?file=/src/index.js for ` +\r\n        `an example that gets around this limitations. For advanced implementations, see ` +\r\n        `https://codesandbox.io/s/masonic-w-react-router-and-advanced-config-example-8em42?file=/src/index.js\\n\\n` +\r\n        `If this was the result of your removing an item from your \"items\", see this issue: ` +\r\n        `https://github.com/jaredLunde/masonic/issues/12`\r\n    );\r\n  }\r\n}\r\n\r\n// This is for triggering a remount after SSR has loaded in the client w/ hydrate()\r\nlet didEverMount = \"0\";\r\n\r\nexport interface UseMasonryOptions<Item> {\r\n  /**\r\n   * An array containing the data used by the grid items.\r\n   */\r\n  items: Item[];\r\n  /**\r\n   * A grid cell positioner and cache created by the `usePositioner()` hook or\r\n   * the `createPositioner` utility.\r\n   */\r\n  positioner: Positioner;\r\n  /**\r\n   * A resize observer that tracks mutations to the grid cells and forces the\r\n   * Masonry grid to recalculate its layout if any cells affect column heights\r\n   * change. Check out the `useResizeObserver()` hook.\r\n   */\r\n  resizeObserver?: {\r\n    observe: ResizeObserver[\"observe\"];\r\n    disconnect: ResizeObserver[\"observe\"];\r\n    unobserve: ResizeObserver[\"unobserve\"];\r\n  };\r\n  /**\r\n   * This is the type of element the grid container will be rendered as.\r\n   *\r\n   * @default \"div\"`\r\n   */\r\n  as?: keyof JSX.IntrinsicElements | React.ComponentType<any>;\r\n  /**\r\n   * Optionally gives the grid container an `id` prop.\r\n   */\r\n  id?: string;\r\n  /**\r\n   * Optionally gives the grid container a `className` prop.\r\n   */\r\n  className?: string;\r\n  /**\r\n   * Adds extra `style` attributes to the container in addition to those\r\n   * created by the `useMasonry()` hook.\r\n   */\r\n  style?: React.CSSProperties;\r\n  /**\r\n   * Optionally swap out the accessibility `role` prop of the container and its items.\r\n   *\r\n   * @default \"grid\"\r\n   */\r\n  role?: \"grid\" | \"list\";\r\n  /**\r\n   * Change the `tabIndex` of the grid container.\r\n   *\r\n   * @default 0\r\n   */\r\n  tabIndex?: number;\r\n  /**\r\n   * Forwards a React ref to the grid container.\r\n   */\r\n  containerRef?:\r\n    | ((element: HTMLElement) => void)\r\n    | React.MutableRefObject<HTMLElement | null>;\r\n  /**\r\n   * This is the type of element the grid items will be rendered as.\r\n   *\r\n   * @default \"div\"\r\n   */\r\n  itemAs?: keyof JSX.IntrinsicElements | React.ComponentType<any>;\r\n  /**\r\n   * Adds extra `style` attributes to the grid items in addition to those\r\n   * created by the `useMasonry()` hook.\r\n   */\r\n  itemStyle?: React.CSSProperties;\r\n  /**\r\n   * This value is used for estimating the initial height of the masonry grid. It is important for\r\n   * the UX of the scrolling behavior and in determining how many `items` to render in a batch, so it's\r\n   * wise to set this value with some level accuracy, though it doesn't need to be perfect.\r\n   *\r\n   * @default 300\r\n   */\r\n  itemHeightEstimate?: number;\r\n  /**\r\n   * The value returned here must be unique to the item. By default, the key is the item's index. This is ok\r\n   * if your collection of items is never modified. Setting this property ensures that the component in `render`\r\n   * is reused each time the masonry grid is reflowed. A common pattern would be to return the item's database\r\n   * ID here if there is one, e.g. `data => data.id`\r\n   *\r\n   * @default (data, index) => index`\r\n   */\r\n  itemKey?: (data: Item, index: number) => string | number;\r\n  /**\r\n   * This number is used for determining the number of grid cells outside of the visible window to render.\r\n   * The default value is `2` which means \"render 2 windows worth (2 * `height`) of content before and after\r\n   * the items in the visible window\". A value of `3` would be 3 windows worth of grid cells, so it's a\r\n   * linear relationship.\r\n   *\r\n   * Overscanning is important for preventing tearing when scrolling through items in the grid, but setting\r\n   * too high of a vaimport { useForceUpdate } from './use-force-update';\r\nlue may create too much work for React to handle, so it's best that you tune this\r\n   * value accordingly.\r\n   *\r\n   * @default 2\r\n   */\r\n  overscanBy?: number;\r\n\r\n  /**\r\n   * This is the height of the window. If you're rendering the grid relative to the browser `window`,\r\n   * the current `document.documentElement.clientHeight` is the value you'll want to set here. If you're\r\n   * rendering the grid inside of another HTML element, you'll want to provide the current `element.offsetHeight`\r\n   * here.\r\n   */\r\n  height: number;\r\n  /**\r\n   * The current scroll progress in pixel of the window the grid is rendered in. If you're rendering\r\n   * the grid relative to the browser `window`, you'll want the most current `window.scrollY` here.\r\n   * If you're rendering the grid inside of another HTML element, you'll want the current `element.scrollTop`\r\n   * value here. The `useScroller()` hook and `<MasonryScroller>` components will help you if you're\r\n   * rendering the grid relative to the browser `window`.\r\n   */\r\n  scrollTop: number;\r\n  /**\r\n   * This property is used for determining whether or not the grid container should add styles that\r\n   * dramatically increase scroll performance. That is, turning off `pointer-events` and adding a\r\n   * `will-change: contents;` value to the style string. You can forgo using this prop, but I would\r\n   * not recommend that. The `useScroller()` hook and `<MasonryScroller>` components will help you if\r\n   * you're rendering the grid relative to the browser `window`.\r\n   *\r\n   * @default false\r\n   */\r\n  isScrolling?: boolean;\r\n  /**\r\n   * This component is rendered for each item of your `items` prop array. It should accept three props:\r\n   * `index`, `width`, and `data`. See RenderComponentProps.\r\n   */\r\n  render: React.ComponentType<RenderComponentProps<Item>>;\r\n  /**\r\n   * This callback is invoked any time the items currently being rendered by the grid change.\r\n   */\r\n  onRender?: (startIndex: number, stopIndex: number, items: Item[]) => void;\r\n}\r\n\r\nexport interface RenderComponentProps<Item> {\r\n  /**\r\n   * The index of the cell in the `items` prop array.\r\n   */\r\n  index: number;\r\n  /**\r\n   * The rendered width of the cell's column.\r\n   */\r\n  width: number;\r\n  /**\r\n   * The data at `items[index]` of your `items` prop array.\r\n   */\r\n  data: Item;\r\n}\r\n\r\n//\r\n// Render-phase utilities\r\n\r\n// ~5.5x faster than createElement without the memo\r\nconst createRenderElement = trieMemoize(\r\n  [OneKeyMap, {}, WeakMap, OneKeyMap],\r\n  (RenderComponent, index, data, columnWidth) => (\r\n    <RenderComponent index={index} data={data} width={columnWidth} />\r\n  )\r\n);\r\n\r\nconst getContainerStyle = memoizeOne(\r\n  (isScrolling: boolean | undefined, estimateHeight: number) => ({\r\n    position: \"relative\",\r\n    width: \"100%\",\r\n    maxWidth: \"100%\",\r\n    height: Math.ceil(estimateHeight),\r\n    maxHeight: Math.ceil(estimateHeight),\r\n    willChange: isScrolling ? \"contents\" : void 0,\r\n    pointerEvents: isScrolling ? \"none\" : void 0,\r\n  })\r\n);\r\n\r\nconst cmp2 = (args: IArguments, pargs: IArguments | any[]): boolean =>\r\n  args[0] === pargs[0] && args[1] === pargs[1];\r\n\r\nconst assignUserStyle = memoizeOne(\r\n  (containerStyle, userStyle) => Object.assign({}, containerStyle, userStyle),\r\n  // @ts-expect-error\r\n  cmp2\r\n);\r\n\r\nfunction defaultGetItemKey<Item>(_: Item, i: number) {\r\n  return i;\r\n}\r\n\r\n// the below memoizations for for ensuring shallow equal is reliable for pure\r\n// component children\r\nconst getCachedSize = memoizeOne(\r\n  (width: number): React.CSSProperties => ({\r\n    width,\r\n    zIndex: -1000,\r\n    visibility: \"hidden\",\r\n    position: \"absolute\",\r\n    writingMode: \"horizontal-tb\",\r\n  }),\r\n  (args, pargs) => args[0] === pargs[0]\r\n);\r\n\r\nconst getRefSetter = memoizeOne(\r\n  (\r\n      positioner: Positioner,\r\n      resizeObserver?: UseMasonryOptions<any>[\"resizeObserver\"]\r\n    ) =>\r\n    (index: number) =>\r\n    (el: HTMLElement | null): void => {\r\n      if (el === null) return;\r\n      if (resizeObserver) {\r\n        resizeObserver.observe(el);\r\n        elementsCache.set(el, index);\r\n      }\r\n      if (positioner.get(index) === void 0)\r\n        positioner.set(index, el.offsetHeight);\r\n    },\r\n  // @ts-expect-error\r\n  cmp2\r\n);\r\n","export type Raf = (callback: (timestamp: number) => void) => number\nexport type Caf = (handle: number) => void\n\nlet u = 'undefined',\n  win = typeof window !== u ? window : ({} as any),\n  p = typeof performance !== u ? performance : Date,\n  now = () => p.now(),\n  af = 'AnimationFrame' as const,\n  Caf = 'cancel' + af,\n  Raf = 'request' + af,\n  raf: Raf = win[Raf] && win[Raf].bind(win),\n  caf: Caf = win[Caf] && win[Caf].bind(win)\n\nif (!raf || !caf) {\n  let lastTime = 0\n  raf = (callback: FrameRequestCallback) => {\n    let curr = now(),\n      next = Math.max(lastTime + 1000 / 60, curr)\n    return setTimeout(() => {\n      callback((lastTime = next))\n    }, next - curr) as any\n  }\n  caf = (h) => clearTimeout(h)\n}\n\nexport {raf, caf, now}\n","/**\n * Copyright 2011, Joe Lambert.\n * Free to use under the MIT license.\n * http://www.opensource.org/licenses/mit-license.php\n **/\nimport {raf, caf, now} from '@essentials/raf'\n\nexport interface RequestTimeoutHandle {\n  v?: number\n}\n\nexport const clearRequestTimeout = (handle: RequestTimeoutHandle): void => {\n  caf(handle.v || -1)\n}\n\nexport const requestTimeout = (\n  fn: (...args: any[]) => void,\n  ms: number\n): RequestTimeoutHandle => {\n  const start = now(),\n    handle: RequestTimeoutHandle = {}\n\n  const loop = () => {\n    now() - start >= ms ? fn.call(null) : (handle.v = raf(loop))\n  }\n\n  handle.v = raf(loop)\n  return handle\n}\n\nexport default requestTimeout\n","import * as React from 'react'\nimport useLatest from '@react-hook/latest'\n\nconst perf = typeof performance !== 'undefined' ? performance : Date\nconst now = () => perf.now()\n\nexport function useThrottleCallback<CallbackArguments extends any[]>(\n  callback: (...args: CallbackArguments) => void,\n  fps = 30,\n  leading = false\n): (...args: CallbackArguments) => void {\n  const storedCallback = useLatest(callback)\n  const ms = 1000 / fps\n  const prev = React.useRef(0)\n  const trailingTimeout = React.useRef<ReturnType<typeof setTimeout>>()\n  const clearTrailing = () =>\n    trailingTimeout.current && clearTimeout(trailingTimeout.current)\n  const deps = [fps, leading, storedCallback]\n\n  // Reset any time the deps change\n  React.useEffect(\n    () => () => {\n      prev.current = 0\n      clearTrailing()\n    },\n    deps\n  )\n\n  return React.useCallback(function () {\n    // eslint-disable-next-line prefer-rest-params\n    const args = arguments\n    const rightNow = now()\n    const call = () => {\n      prev.current = rightNow\n      clearTrailing()\n      storedCallback.current.apply(null, args as any)\n    }\n    const current = prev.current\n    // leading\n    if (leading && current === 0) return call()\n    // body\n    if (rightNow - current > ms) {\n      if (current > 0) return call()\n      prev.current = rightNow\n    }\n    // trailing\n    clearTrailing()\n    trailingTimeout.current = setTimeout(() => {\n      call()\n      prev.current = 0\n    }, ms)\n  }, deps)\n}\n\nexport function useThrottle<State>(\n  initialState: State | (() => State),\n  fps?: number,\n  leading?: boolean\n): [State, React.Dispatch<React.SetStateAction<State>>] {\n  const state = React.useState<State>(initialState)\n  return [state[0], useThrottleCallback(state[1], fps, leading)]\n}\n","import {useThrottle} from '@react-hook/throttle'\nimport useEvent from '@react-hook/event'\n\nconst win = typeof window === 'undefined' ? null : window\nconst getScrollY = (): number =>\n  (win as Window).scrollY !== void 0\n    ? (win as Window).scrollY\n    : (win as Window).pageYOffset === void 0\n    ? 0\n    : (win as Window).pageYOffset\n\nexport const useWindowScroll = (fps = 30): number => {\n  const state = useThrottle(\n    typeof window === 'undefined' ? 0 : getScrollY,\n    fps,\n    true\n  )\n  useEvent(win, 'scroll', (): void => state[1](getScrollY()))\n  return state[0]\n}\n\nexport default useWindowScroll\n","import {\r\n  clearRequestTimeout,\r\n  requestTimeout,\r\n} from \"@essentials/request-timeout\";\r\nimport useScrollPosition from \"@react-hook/window-scroll\";\r\nimport * as React from \"react\";\r\n\r\n/**\r\n * A hook for tracking whether the `window` is currently being scrolled and it's scroll position on\r\n * the y-axis. These values are used for determining which grid cells to render and when\r\n * to add styles to the masonry container that maximize scroll performance.\r\n *\r\n * @param offset - The vertical space in pixels between the top of the grid container and the top\r\n *  of the browser `document.documentElement`.\r\n * @param fps - This determines how often (in frames per second) to update the scroll position of the\r\n *  browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\r\n *  The default value of `12` has been very reasonable in my own testing, but if you have particularly\r\n *  heavy `render` components it may be prudent to reduce this number.\r\n */\r\nexport function useScroller(\r\n  offset = 0,\r\n  fps = 12\r\n): { scrollTop: number; isScrolling: boolean } {\r\n  const scrollTop = useScrollPosition(fps);\r\n  const [isScrolling, setIsScrolling] = React.useState(false);\r\n  const didMount = React.useRef(0);\r\n\r\n  React.useEffect(() => {\r\n    if (didMount.current === 1) setIsScrolling(true);\r\n    let didUnsubscribe = false;\r\n    const to = requestTimeout(() => {\r\n      if (didUnsubscribe) return;\r\n      // This is here to prevent premature bail outs while maintaining high resolution\r\n      // unsets. Without it there will always bee a lot of unnecessary DOM writes to style.\r\n      setIsScrolling(false);\r\n    }, 40 + 1000 / fps);\r\n    didMount.current = 1;\r\n    return () => {\r\n      didUnsubscribe = true;\r\n      clearRequestTimeout(to);\r\n    };\r\n  }, [fps, scrollTop]);\r\n\r\n  return { scrollTop: Math.max(0, scrollTop - offset), isScrolling };\r\n}\r\n","import { useMasonry } from \"./use-masonry\";\r\nimport type { UseMasonryOptions } from \"./use-masonry\";\r\nimport { useScroller } from \"./use-scroller\";\r\n/**\r\n * A heavily-optimized component that updates `useMasonry()` when the scroll position of the browser `window`\r\n * changes. This bare-metal component is used by `<Masonry>` under the hood.\r\n *\r\n * @param props\r\n */\r\nexport function MasonryScroller<Item>(props: MasonryScrollerProps<Item>) {\r\n  // We put this in its own layer because it's the thing that will trigger the most updates\r\n  // and we don't want to slower ourselves by cycling through all the functions, objects, and effects\r\n  // of other hooks\r\n  const { scrollTop, isScrolling } = useScroller(props.offset, props.scrollFps);\r\n  // This is an update-heavy phase and while we could just Object.assign here,\r\n  // it is way faster to inline and there's a relatively low hit to he bundle\r\n  // size.\r\n  return useMasonry<Item>({\r\n    scrollTop,\r\n    isScrolling,\r\n    positioner: props.positioner,\r\n    resizeObserver: props.resizeObserver,\r\n    items: props.items,\r\n    onRender: props.onRender,\r\n    as: props.as,\r\n    id: props.id,\r\n    className: props.className,\r\n    style: props.style,\r\n    role: props.role,\r\n    tabIndex: props.tabIndex,\r\n    containerRef: props.containerRef,\r\n    itemAs: props.itemAs,\r\n    itemStyle: props.itemStyle,\r\n    itemHeightEstimate: props.itemHeightEstimate,\r\n    itemKey: props.itemKey,\r\n    overscanBy: props.overscanBy,\r\n    height: props.height,\r\n    render: props.render,\r\n  });\r\n}\r\n\r\nexport interface MasonryScrollerProps<Item>\r\n  extends Omit<UseMasonryOptions<Item>, \"scrollTop\" | \"isScrolling\"> {\r\n  /**\r\n   * This determines how often (in frames per second) to update the scroll position of the\r\n   * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\r\n   * The default value of `12` has been very reasonable in my own testing, but if you have particularly\r\n   * heavy `render` components it may be prudent to reduce this number.\r\n   *\r\n   * @default 12\r\n   */\r\n  scrollFps?: number;\r\n  /**\r\n   * The vertical space in pixels between the top of the grid container and the top\r\n   * of the browser `document.documentElement`.\r\n   *\r\n   * @default 0\r\n   */\r\n  offset?: number;\r\n}\r\n\r\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\r\n  MasonryScroller.displayName = \"MasonryScroller\";\r\n}\r\n","import React from 'react'\n\nconst usePassiveLayoutEffect =\n  React[\n    typeof document !== 'undefined' && document.createElement !== void 0\n      ? 'useLayoutEffect'\n      : 'useEffect'\n  ]\n\nexport default usePassiveLayoutEffect\n","import useLayoutEffect from \"@react-hook/passive-layout-effect\";\r\nimport * as React from \"react\";\r\n\r\n/**\r\n * A hook for measuring the width of the grid container, as well as its distance\r\n * from the top of the document. These values are necessary to correctly calculate the number/width\r\n * of columns to render, as well as the number of rows to render.\r\n *\r\n * @param elementRef - A `ref` object created by `React.useRef()`. That ref should be provided to the\r\n *   `containerRef` property in `useMasonry()`.\r\n * @param deps - You can force this hook to recalculate the `offset` and `width` whenever this\r\n *   dependencies list changes. A common dependencies list might look like `[windowWidth, windowHeight]`,\r\n *   which would force the hook to recalculate any time the size of the browser `window` changed.\r\n */\r\nexport function useContainerPosition(\r\n  elementRef: React.MutableRefObject<HTMLElement | null>,\r\n  deps: React.DependencyList = emptyArr\r\n): ContainerPosition {\r\n  const [containerPosition, setContainerPosition] =\r\n    React.useState<ContainerPosition>({ offset: 0, width: 0 });\r\n\r\n  useLayoutEffect(() => {\r\n    const { current } = elementRef;\r\n    if (current !== null) {\r\n      let offset = 0;\r\n      let el = current;\r\n\r\n      do {\r\n        offset += el.offsetTop || 0;\r\n        el = el.offsetParent as HTMLElement;\r\n      } while (el);\r\n\r\n      if (\r\n        offset !== containerPosition.offset ||\r\n        current.offsetWidth !== containerPosition.width\r\n      ) {\r\n        setContainerPosition({\r\n          offset,\r\n          width: current.offsetWidth,\r\n        });\r\n      }\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, deps);\r\n\r\n  return containerPosition;\r\n}\r\n\r\nexport interface ContainerPosition {\r\n  /**\r\n   * The distance in pixels between the top of the element in `elementRef` and the top of\r\n   * the `document.documentElement`.\r\n   */\r\n  offset: number;\r\n  /**\r\n   * The `offsetWidth` of the element in `elementRef`.\r\n   */\r\n  width: number;\r\n}\r\n\r\nconst emptyArr: [] = [];\r\n","import * as React from \"react\";\r\nimport { createIntervalTree } from \"./interval-tree\";\r\n\r\n/**\r\n * This hook creates the grid cell positioner and cache required by `useMasonry()`. This is\r\n * the meat of the grid's layout algorithm, determining which cells to render at a given scroll\r\n * position, as well as where to place new items in the grid.\r\n *\r\n * @param options - Properties that determine the number of columns in the grid, as well\r\n *  as their widths.\r\n * @param options.columnWidth\r\n * @param options.width\r\n * @param deps - This hook will create a new positioner, clearing all existing cached positions,\r\n *  whenever the dependencies in this list change.\r\n * @param options.columnGutter\r\n * @param options.rowGutter\r\n * @param options.columnCount\r\n * @param options.maxColumnCount\r\n * @param options.maxColumnWidth\r\n */\r\nexport function usePositioner(\r\n  {\r\n    width,\r\n    columnWidth = 200,\r\n    columnGutter = 0,\r\n    rowGutter,\r\n    columnCount,\r\n    maxColumnCount,\r\n    maxColumnWidth,\r\n  }: UsePositionerOptions,\r\n  deps: React.DependencyList = emptyArr\r\n): Positioner {\r\n  const initPositioner = (): Positioner => {\r\n    const [computedColumnWidth, computedColumnCount] = getColumns(\r\n      width,\r\n      columnWidth,\r\n      columnGutter,\r\n      columnCount,\r\n      maxColumnCount,\r\n      maxColumnWidth\r\n    );\r\n    return createPositioner(\r\n      computedColumnCount,\r\n      computedColumnWidth,\r\n      columnGutter,\r\n      rowGutter ?? columnGutter\r\n    );\r\n  };\r\n  const positionerRef = React.useRef<Positioner>();\r\n  if (positionerRef.current === undefined)\r\n    positionerRef.current = initPositioner();\r\n\r\n  const prevDeps = React.useRef(deps);\r\n  const opts = [\r\n    width,\r\n    columnWidth,\r\n    columnGutter,\r\n    rowGutter,\r\n    columnCount,\r\n    maxColumnCount,\r\n    maxColumnWidth,\r\n  ];\r\n  const prevOpts = React.useRef(opts);\r\n  const optsChanged = !opts.every((item, i) => prevOpts.current[i] === item);\r\n\r\n  if (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\r\n    if (deps.length !== prevDeps.current.length) {\r\n      throw new Error(\r\n        \"usePositioner(): The length of your dependencies array changed.\"\r\n      );\r\n    }\r\n  }\r\n\r\n  // Create a new positioner when the dependencies or sizes change\r\n  // Thanks to https://github.com/khmm12 for pointing this out\r\n  // https://github.com/jaredLunde/masonic/pull/41\r\n  if (optsChanged || !deps.every((item, i) => prevDeps.current[i] === item)) {\r\n    const prevPositioner = positionerRef.current;\r\n    const positioner = initPositioner();\r\n    prevDeps.current = deps;\r\n    prevOpts.current = opts;\r\n\r\n    if (optsChanged) {\r\n      const cacheSize = prevPositioner.size();\r\n      for (let index = 0; index < cacheSize; index++) {\r\n        const pos = prevPositioner.get(index);\r\n        positioner.set(index, pos !== void 0 ? pos.height : 0);\r\n      }\r\n    }\r\n\r\n    positionerRef.current = positioner;\r\n  }\r\n\r\n  return positionerRef.current;\r\n}\r\n\r\nexport interface UsePositionerOptions {\r\n  /**\r\n   * The width of the container you're rendering the grid within, i.e. the container\r\n   * element's `element.offsetWidth`\r\n   */\r\n  width: number;\r\n  /**\r\n   * The minimum column width. The `usePositioner()` hook will automatically size the\r\n   * columns to fill their container based upon the `columnWidth` and `columnGutter` values.\r\n   * It will never render anything smaller than this width unless its container itself is\r\n   * smaller than its value. This property is optional if you're using a static `columnCount`.\r\n   *\r\n   * @default 200\r\n   */\r\n  columnWidth?: number;\r\n  /**\r\n   * The maximum column width. Calculated column widths will be capped at this value.\r\n   */\r\n  maxColumnWidth?: number;\r\n  /**\r\n   * This sets the horizontal space between grid columns in pixels. If `rowGutter` is not set, this\r\n   * also sets the vertical space between cells within a column in pixels.\r\n   *\r\n   * @default 0\r\n   */\r\n  columnGutter?: number;\r\n  /**\r\n   * This sets the vertical space between cells within a column in pixels. If not set, the value of\r\n   * `columnGutter` is used instead.\r\n   */\r\n  rowGutter?: number;\r\n  /**\r\n   * By default, `usePositioner()` derives the column count from the `columnWidth`, `columnGutter`,\r\n   * and `width` props. However, in some situations it is nice to be able to override that behavior\r\n   * (e.g. creating a `List` component).\r\n   */\r\n  columnCount?: number;\r\n  /**\r\n   * The upper bound of column count. This property won't work if `columnCount` is set.\r\n   */\r\n  maxColumnCount?: number;\r\n}\r\n\r\n/**\r\n * Creates a cell positioner for the `useMasonry()` hook. The `usePositioner()` hook uses\r\n * this utility under the hood.\r\n *\r\n * @param columnCount - The number of columns in the grid\r\n * @param columnWidth - The width of each column in the grid\r\n * @param columnGutter - The amount of horizontal space between columns in pixels.\r\n * @param rowGutter - The amount of vertical space between cells within a column in pixels (falls back\r\n * to `columnGutter`).\r\n */\r\nexport const createPositioner = (\r\n  columnCount: number,\r\n  columnWidth: number,\r\n  columnGutter = 0,\r\n  rowGutter = columnGutter\r\n): Positioner => {\r\n  // O(log(n)) lookup of cells to render for a given viewport size\r\n  // Store tops and bottoms of each cell for fast intersection lookup.\r\n  const intervalTree = createIntervalTree();\r\n  // Track the height of each column.\r\n  // Layout algorithm below always inserts into the shortest column.\r\n  const columnHeights: number[] = new Array(columnCount);\r\n  // Used for O(1) item access\r\n  const items: PositionerItem[] = [];\r\n  // Tracks the item indexes within an individual column\r\n  const columnItems: number[][] = new Array(columnCount);\r\n\r\n  for (let i = 0; i < columnCount; i++) {\r\n    columnHeights[i] = 0;\r\n    columnItems[i] = [];\r\n  }\r\n\r\n  return {\r\n    columnCount,\r\n    columnWidth,\r\n    set: (index, height = 0) => {\r\n      const column = index % columnCount;\r\n      const top = columnHeights[column] || 0;\r\n      columnHeights[column] = top + height + rowGutter;\r\n      columnItems[column].push(index);\r\n      items[index] = {\r\n        left: column * (columnWidth + columnGutter),\r\n        top,\r\n        height,\r\n        column,\r\n      };\r\n      intervalTree.insert(top, top + height, index);\r\n    },\r\n    get: (index) => items[index],\r\n    // This only updates items in the specific columns that have changed, on and after the\r\n    // specific items that have changed\r\n    update: (updates) => {\r\n      const columns: number[] = new Array(columnCount);\r\n      let i = 0,\r\n        j = 0;\r\n\r\n      // determines which columns have items that changed, as well as the minimum index\r\n      // changed in that column, as all items after that index will have their positions\r\n      // affected by the change\r\n      for (; i < updates.length - 1; i++) {\r\n        const index = updates[i];\r\n        const item = items[index];\r\n        item.height = updates[++i];\r\n        intervalTree.remove(index);\r\n        intervalTree.insert(item.top, item.top + item.height, index);\r\n        columns[item.column] =\r\n          columns[item.column] === void 0\r\n            ? index\r\n            : Math.min(index, columns[item.column]);\r\n      }\r\n\r\n      for (i = 0; i < columns.length; i++) {\r\n        // bails out if the column didn't change\r\n        if (columns[i] === void 0) continue;\r\n        const itemsInColumn = columnItems[i];\r\n        // the index order is sorted with certainty so binary search is a great solution\r\n        // here as opposed to Array.indexOf()\r\n        const startIndex = binarySearch(itemsInColumn, columns[i]);\r\n        const index = columnItems[i][startIndex];\r\n        const startItem = items[index];\r\n        columnHeights[i] = startItem.top + startItem.height + rowGutter;\r\n\r\n        for (j = startIndex + 1; j < itemsInColumn.length; j++) {\r\n          const index = itemsInColumn[j];\r\n          const item = items[index];\r\n          item.top = columnHeights[i];\r\n          columnHeights[i] = item.top + item.height + rowGutter;\r\n          intervalTree.remove(index);\r\n          intervalTree.insert(item.top, item.top + item.height, index);\r\n        }\r\n      }\r\n    },\r\n    // Render all cells visible within the viewport range defined.\r\n    range: (lo, hi, renderCallback) =>\r\n      intervalTree.search(lo, hi, (index, top) =>\r\n        renderCallback(index, items[index].left, top)\r\n      ),\r\n    estimateHeight: (itemCount, defaultItemHeight): number => {\r\n      const tallestColumn = Math.max(0, Math.max.apply(null, columnHeights));\r\n\r\n      return itemCount === intervalTree.size\r\n        ? tallestColumn\r\n        : tallestColumn +\r\n            Math.ceil((itemCount - intervalTree.size) / columnCount) *\r\n              defaultItemHeight;\r\n    },\r\n    shortestColumn: () => {\r\n      if (columnHeights.length > 1) return Math.min.apply(null, columnHeights);\r\n      return columnHeights[0] || 0;\r\n    },\r\n    size(): number {\r\n      return intervalTree.size;\r\n    },\r\n    all(): PositionerItem[] {\r\n      return items;\r\n    },\r\n  };\r\n};\r\n\r\nexport interface Positioner {\r\n  /**\r\n   * The number of columns in the grid\r\n   */\r\n  columnCount: number;\r\n  /**\r\n   * The width of each column in the grid\r\n   */\r\n  columnWidth: number;\r\n  /**\r\n   * Sets the position for the cell at `index` based upon the cell's height\r\n   */\r\n  set: (index: number, height: number) => void;\r\n  /**\r\n   * Gets the `PositionerItem` for the cell at `index`\r\n   */\r\n  get: (index: number) => PositionerItem | undefined;\r\n  /**\r\n   * Updates cells based on their indexes and heights\r\n   * positioner.update([index, height, index, height, index, height...])\r\n   */\r\n  update: (updates: number[]) => void;\r\n  /**\r\n   * Searches the interval tree for grid cells with a `top` value in\r\n   * betwen `lo` and `hi` and invokes the callback for each item that\r\n   * is discovered\r\n   */\r\n  range: (\r\n    lo: number,\r\n    hi: number,\r\n    renderCallback: (index: number, left: number, top: number) => void\r\n  ) => void;\r\n  /**\r\n   * Returns the number of grid cells in the cache\r\n   */\r\n\r\n  size: () => number;\r\n  /**\r\n   * Estimates the total height of the grid\r\n   */\r\n\r\n  estimateHeight: (itemCount: number, defaultItemHeight: number) => number;\r\n  /**\r\n   * Returns the height of the shortest column in the grid\r\n   */\r\n\r\n  shortestColumn: () => number;\r\n  /**\r\n   * Returns all `PositionerItem` items\r\n   */\r\n  all: () => PositionerItem[];\r\n}\r\n\r\nexport interface PositionerItem {\r\n  /**\r\n   * This is how far from the top edge of the grid container in pixels the\r\n   * item is placed\r\n   */\r\n  top: number;\r\n  /**\r\n   * This is how far from the left edge of the grid container in pixels the\r\n   * item is placed\r\n   */\r\n  left: number;\r\n  /**\r\n   * This is the height of the grid cell\r\n   */\r\n  height: number;\r\n  /**\r\n   * This is the column number containing the grid cell\r\n   */\r\n  column: number;\r\n}\r\n\r\n/* istanbul ignore next */\r\nconst binarySearch = (a: number[], y: number): number => {\r\n  let l = 0;\r\n  let h = a.length - 1;\r\n\r\n  while (l <= h) {\r\n    const m = (l + h) >>> 1;\r\n    const x = a[m];\r\n    if (x === y) return m;\r\n    else if (x <= y) l = m + 1;\r\n    else h = m - 1;\r\n  }\r\n\r\n  return -1;\r\n};\r\n\r\nconst getColumns = (\r\n  width = 0,\r\n  minimumWidth = 0,\r\n  gutter = 8,\r\n  columnCount?: number,\r\n  maxColumnCount?: number,\r\n  maxColumnWidth?: number\r\n): [number, number] => {\r\n  columnCount =\r\n    columnCount ||\r\n    Math.min(\r\n      Math.floor((width + gutter) / (minimumWidth + gutter)),\r\n      maxColumnCount || Infinity\r\n    ) ||\r\n    1;\r\n  let columnWidth = Math.floor(\r\n    (width - gutter * (columnCount - 1)) / columnCount\r\n  );\r\n\r\n  // Cap the column width if maxColumnWidth is specified\r\n  if (maxColumnWidth !== undefined && columnWidth > maxColumnWidth) {\r\n    columnWidth = maxColumnWidth;\r\n  }\r\n\r\n  return [columnWidth, columnCount];\r\n};\r\n\r\nconst emptyArr: [] = [];\r\n","var rafSchd = function rafSchd(fn) {\n  var lastArgs = [];\n  var frameId = null;\n\n  var wrapperFn = function wrapperFn() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    lastArgs = args;\n\n    if (frameId) {\n      return;\n    }\n\n    frameId = requestAnimationFrame(function () {\n      frameId = null;\n      fn.apply(void 0, lastArgs);\n    });\n  };\n\n  wrapperFn.cancel = function () {\n    if (!frameId) {\n      return;\n    }\n\n    cancelAnimationFrame(frameId);\n    frameId = null;\n  };\n\n  return wrapperFn;\n};\n\nexport default rafSchd;\n","import rafSchd from \"raf-schd\";\r\nimport * as React from \"react\";\r\nimport trieMemoize from \"trie-memoize\";\r\nimport { elementsCache } from \"./elements-cache\";\r\nimport { useForceUpdate } from \"./use-force-update\";\r\nimport type { Positioner } from \"./use-positioner\";\r\n\r\n/**\r\n * Creates a resize observer that forces updates to the grid cell positions when mutations are\r\n * made to cells affecting their height.\r\n *\r\n * @param positioner - The masonry cell positioner created by the `usePositioner()` hook.\r\n */\r\nexport function useResizeObserver(positioner: Positioner) {\r\n  const forceUpdate = useForceUpdate();\r\n  const resizeObserver = createResizeObserver(positioner, forceUpdate);\r\n  // Cleans up the resize observers when they change or the\r\n  // component unmounts\r\n  React.useEffect(() => () => resizeObserver.disconnect(), [resizeObserver]);\r\n  return resizeObserver;\r\n}\r\n\r\nconst _handlerForType = rafSchd((target: HTMLElement) => {});\r\n\r\ntype IHandler = typeof _handlerForType;\r\n\r\n/**\r\n * Creates a resize observer that fires an `updater` callback whenever the height of\r\n * one or many cells change. The `useResizeObserver()` hook is using this under the hood.\r\n *\r\n * @param positioner - A cell positioner created by the `usePositioner()` hook or the `createPositioner()` utility\r\n * @param updater - A callback that fires whenever one or many cell heights change.\r\n */\r\nexport const createResizeObserver = trieMemoize(\r\n  [WeakMap],\r\n  // TODO: figure out a way to test this\r\n  /* istanbul ignore next */\r\n  (positioner: Positioner, updater: (updates: number[]) => void) => {\r\n    const updates: number[] = [];\r\n\r\n    const update = rafSchd(() => {\r\n      if (updates.length > 0) {\r\n        // Updates the size/positions of the cell with the resize\r\n        // observer updates\r\n        positioner.update(updates);\r\n        updater(updates);\r\n      }\r\n      updates.length = 0;\r\n    });\r\n\r\n    const commonHandler = (target: HTMLElement) => {\r\n      const height = target.offsetHeight;\r\n      if (height > 0) {\r\n        const index = elementsCache.get(target);\r\n        if (index !== void 0) {\r\n          const position = positioner.get(index);\r\n          if (position !== void 0 && height !== position.height)\r\n            updates.push(index, height);\r\n        }\r\n      }\r\n      update();\r\n    };\r\n\r\n    const handlers = new Map<number, IHandler>();\r\n    const handleEntries: ResizeObserverCallback = (entries) => {\r\n      let i = 0;\r\n\r\n      for (; i < entries.length; i++) {\r\n        const entry = entries[i];\r\n        const index = elementsCache.get(entry.target);\r\n\r\n        if (index === void 0) continue;\r\n        let handler = handlers.get(index);\r\n        if (!handler) {\r\n          handler = rafSchd(commonHandler);\r\n          handlers.set(index, handler);\r\n        }\r\n        handler(entry.target as HTMLElement);\r\n      }\r\n    };\r\n\r\n    const ro = new ResizeObserver(handleEntries);\r\n    // Overrides the original disconnect to include cancelling handling the entries.\r\n    // Ideally this would be its own method but that would result in a breaking\r\n    // change.\r\n    const disconnect = ro.disconnect.bind(ro);\r\n    ro.disconnect = () => {\r\n      disconnect();\r\n      handlers.forEach((handler) => {\r\n        handler.cancel();\r\n      });\r\n    };\r\n\r\n    return ro;\r\n  }\r\n);\r\n","import useEvent from \"@react-hook/event\";\r\nimport useLatest from \"@react-hook/latest\";\r\nimport { useThrottleCallback } from \"@react-hook/throttle\";\r\nimport * as React from \"react\";\r\nimport type { Positioner, PositionerItem } from \"./use-positioner\";\r\n\r\n/**\r\n * A hook that creates a callback for scrolling to a specific index in\r\n * the \"items\" array.\r\n *\r\n * @param positioner - A positioner created by the `usePositioner()` hook\r\n * @param options - Configuration options\r\n */\r\nexport function useScrollToIndex(\r\n  positioner: Positioner,\r\n  options: UseScrollToIndexOptions\r\n) {\r\n  const {\r\n    align = \"top\",\r\n    element = typeof window !== \"undefined\" && window,\r\n    offset = 0,\r\n    height = typeof window !== \"undefined\" ? window.innerHeight : 0,\r\n  } = options;\r\n  const latestOptions = useLatest({\r\n    positioner,\r\n    element,\r\n    align,\r\n    offset,\r\n    height,\r\n  } as const);\r\n  const getTarget = React.useRef(() => {\r\n    const latestElement = latestOptions.current.element;\r\n    return latestElement && \"current\" in latestElement\r\n      ? latestElement.current\r\n      : latestElement;\r\n  }).current;\r\n  const [state, dispatch] = React.useReducer(\r\n    (\r\n      state: {\r\n        position: PositionerItem | undefined;\r\n        index: number | undefined;\r\n        prevTop: number | undefined;\r\n      },\r\n      action:\r\n        | { type: \"scrollToIndex\"; value: number | undefined }\r\n        | { type: \"setPosition\"; value: PositionerItem | undefined }\r\n        | { type: \"setPrevTop\"; value: number | undefined }\r\n        | { type: \"reset\" }\r\n    ) => {\r\n      const nextState = {\r\n        position: state.position,\r\n        index: state.index,\r\n        prevTop: state.prevTop,\r\n      };\r\n\r\n      /* istanbul ignore next */\r\n      if (action.type === \"scrollToIndex\") {\r\n        return {\r\n          position: latestOptions.current.positioner.get(action.value ?? -1),\r\n          index: action.value,\r\n          prevTop: void 0,\r\n        };\r\n      } else if (action.type === \"setPosition\") {\r\n        nextState.position = action.value;\r\n      } else if (action.type === \"setPrevTop\") {\r\n        nextState.prevTop = action.value;\r\n      } else if (action.type === \"reset\") {\r\n        return defaultState;\r\n      }\r\n\r\n      return nextState;\r\n    },\r\n    defaultState\r\n  );\r\n  const throttledDispatch = useThrottleCallback(dispatch, 15);\r\n\r\n  // If we find the position along the way we can immediately take off\r\n  // to the correct spot.\r\n  useEvent(getTarget() as Window, \"scroll\", () => {\r\n    if (!state.position && state.index) {\r\n      const position = latestOptions.current.positioner.get(state.index);\r\n\r\n      if (position) {\r\n        dispatch({ type: \"setPosition\", value: position });\r\n      }\r\n    }\r\n  });\r\n\r\n  // If the top changes out from under us in the case of dynamic cells, we\r\n  // want to keep following it.\r\n  const currentTop =\r\n    state.index !== void 0 &&\r\n    latestOptions.current.positioner.get(state.index)?.top;\r\n\r\n  React.useEffect(() => {\r\n    const target = getTarget();\r\n    if (!target) return;\r\n    const { height, align, offset, positioner } = latestOptions.current;\r\n\r\n    if (state.position) {\r\n      let scrollTop = state.position.top;\r\n\r\n      if (align === \"bottom\") {\r\n        scrollTop = scrollTop - height + state.position.height;\r\n      } else if (align === \"center\") {\r\n        scrollTop -= (height - state.position.height) / 2;\r\n      }\r\n\r\n      target.scrollTo(0, Math.max(0, (scrollTop += offset)));\r\n      // Resets state after 400ms, an arbitrary time I determined to be\r\n      // still visually pleasing if there is a slow network reply in dynamic\r\n      // cells\r\n      let didUnsubscribe = false;\r\n      const timeout = setTimeout(\r\n        () => !didUnsubscribe && dispatch({ type: \"reset\" }),\r\n        400\r\n      );\r\n      return () => {\r\n        didUnsubscribe = true;\r\n        clearTimeout(timeout);\r\n      };\r\n    } else if (state.index !== void 0) {\r\n      // Estimates the top based upon the average height of current cells\r\n      let estimatedTop =\r\n        (positioner.shortestColumn() / positioner.size()) * state.index;\r\n      if (state.prevTop)\r\n        estimatedTop = Math.max(estimatedTop, state.prevTop + height);\r\n      target.scrollTo(0, estimatedTop);\r\n      throttledDispatch({ type: \"setPrevTop\", value: estimatedTop });\r\n    }\r\n  }, [currentTop, state, latestOptions, getTarget, throttledDispatch]);\r\n\r\n  return React.useRef((index: number) => {\r\n    dispatch({ type: \"scrollToIndex\", value: index });\r\n  }).current;\r\n}\r\n\r\nconst defaultState = {\r\n  index: void 0,\r\n  position: void 0,\r\n  prevTop: void 0,\r\n} as const;\r\n\r\nexport type UseScrollToIndexOptions = {\r\n  /**\r\n   * The window element or a React ref for the window element. That is,\r\n   * this is the grid container.\r\n   *\r\n   * @default window\r\n   */\r\n  element?: Window | HTMLElement | React.RefObject<HTMLElement> | null;\r\n  /**\r\n   * Sets the vertical alignment of the cell within the grid container.\r\n   *\r\n   * @default \"top\"\r\n   */\r\n  align?: \"center\" | \"top\" | \"bottom\";\r\n  /**\r\n   * The height of the grid.\r\n   *\r\n   * @default window.innerHeight\r\n   */\r\n  height?: number;\r\n  /**\r\n   * The vertical space in pixels between the top of the grid container and the top\r\n   * of the window.\r\n   *\r\n   * @default 0\r\n   */\r\n  offset?: number;\r\n};\r\n","import { useWindowSize } from \"@react-hook/window-size\";\r\nimport * as React from \"react\";\r\nimport { MasonryScroller } from \"./masonry-scroller\";\r\nimport type { MasonryScrollerProps } from \"./masonry-scroller\";\r\nimport { useContainerPosition } from \"./use-container-position\";\r\nimport { usePositioner } from \"./use-positioner\";\r\nimport type { UsePositionerOptions } from \"./use-positioner\";\r\nimport { useResizeObserver } from \"./use-resize-observer\";\r\nimport { useScrollToIndex } from \"./use-scroll-to-index\";\r\nimport type { UseScrollToIndexOptions } from \"./use-scroll-to-index\";\r\n\r\n/**\r\n * A \"batteries included\" masonry grid which includes all of the implementation details below. This component is the\r\n * easiest way to get off and running in your app, before switching to more advanced implementations, if necessary.\r\n * It will change its column count to fit its container's width and will decide how many rows to render based upon\r\n * the height of the browser `window`.\r\n *\r\n * @param props\r\n */\r\nexport function Masonry<Item>(props: MasonryProps<Item>) {\r\n  const containerRef = React.useRef<null | HTMLElement>(null);\r\n  const windowSize = useWindowSize({\r\n    initialWidth: props.ssrWidth,\r\n    initialHeight: props.ssrHeight,\r\n  });\r\n  const containerPos = useContainerPosition(containerRef, windowSize);\r\n  const nextProps = Object.assign(\r\n    {\r\n      offset: containerPos.offset,\r\n      width: containerPos.width || windowSize[0],\r\n      height: windowSize[1],\r\n      containerRef,\r\n    },\r\n    props\r\n  ) as any;\r\n  nextProps.positioner = usePositioner(nextProps);\r\n  nextProps.resizeObserver = useResizeObserver(nextProps.positioner);\r\n  const scrollToIndex = useScrollToIndex(nextProps.positioner, {\r\n    height: nextProps.height,\r\n    offset: containerPos.offset,\r\n    align:\r\n      typeof props.scrollToIndex === \"object\"\r\n        ? props.scrollToIndex.align\r\n        : void 0,\r\n  });\r\n  const index =\r\n    props.scrollToIndex &&\r\n    (typeof props.scrollToIndex === \"number\"\r\n      ? props.scrollToIndex\r\n      : props.scrollToIndex.index);\r\n\r\n  React.useEffect(() => {\r\n    if (index !== void 0) scrollToIndex(index);\r\n  }, [index, scrollToIndex]);\r\n\r\n  return React.createElement(MasonryScroller, nextProps);\r\n}\r\n\r\nexport interface MasonryProps<Item>\r\n  extends Omit<\r\n      MasonryScrollerProps<Item>,\r\n      \"offset\" | \"width\" | \"height\" | \"containerRef\" | \"positioner\"\r\n    >,\r\n    Pick<\r\n      UsePositionerOptions,\r\n      | \"columnWidth\"\r\n      | \"columnGutter\"\r\n      | \"rowGutter\"\r\n      | \"columnCount\"\r\n      | \"maxColumnCount\"\r\n      | \"maxColumnWidth\"\r\n    > {\r\n  /**\r\n   * Scrolls to a given index within the grid. The grid will re-scroll\r\n   * any time the index changes.\r\n   */\r\n  scrollToIndex?:\r\n    | number\r\n    | {\r\n        index: number;\r\n        align: UseScrollToIndexOptions[\"align\"];\r\n      };\r\n  /**\r\n   * This is the width that will be used for the browser `window` when rendering this component in SSR.\r\n   * This prop isn't relevant for client-side only apps.\r\n   */\r\n  ssrWidth?: number;\r\n  /**\r\n   * This is the height that will be used for the browser `window` when rendering this component in SSR.\r\n   * This prop isn't relevant for client-side only apps.\r\n   */\r\n  ssrHeight?: number;\r\n  /**\r\n   * This determines how often (in frames per second) to update the scroll position of the\r\n   * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\r\n   * The default value of `12` has been very reasonable in my own testing, but if you have particularly\r\n   * heavy `render` components it may be prudent to reduce this number.\r\n   *\r\n   * @default 12\r\n   */\r\n  scrollFps?: number;\r\n}\r\n\r\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\r\n  Masonry.displayName = \"Masonry\";\r\n}\r\n","import * as React from \"react\";\r\nimport { Masonry } from \"./masonry\";\r\nimport type { MasonryProps } from \"./masonry\";\r\n\r\n/**\r\n * This is just a single-column `<Masonry>` component without column-specific props.\r\n *\r\n * @param props\r\n */\r\nexport function List<Item>(props: ListProps<Item>) {\r\n  return (\r\n    <Masonry<Item>\r\n      role=\"list\"\r\n      rowGutter={props.rowGutter}\r\n      columnCount={1}\r\n      columnWidth={1}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nexport interface ListProps<Item>\r\n  extends Omit<\r\n    MasonryProps<Item>,\r\n    \"columGutter\" | \"columnCount\" | \"columnWidth\"\r\n  > {\r\n  /**\r\n   * The amount of vertical space in pixels to add between the list cells.\r\n   *\r\n   * @default 0\r\n   */\r\n  rowGutter?: number;\r\n}\r\n\r\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\r\n  List.displayName = \"List\";\r\n}\r\n","import useLatest from \"@react-hook/latest\";\r\nimport * as React from \"react\";\r\n\r\n/**\r\n * A utility hook for seamlessly adding infinite scroll behavior to the `useMasonry()` hook. This\r\n * hook invokes a callback each time the last rendered index surpasses the total number of items\r\n * in your items array or the number defined in the `totalItems` option.\r\n *\r\n * @param loadMoreItems - This callback is invoked when more rows must be loaded. It will be used to\r\n *  determine when to refresh the list with the newly-loaded data. This callback may be called multiple\r\n *  times in reaction to a single scroll event, so it's important to memoize its arguments. If you're\r\n *  creating this callback inside of a functional component, make sure you wrap it in `React.useCallback()`,\r\n *  as well.\r\n * @param options\r\n */\r\nexport function useInfiniteLoader<Item, T extends LoadMoreItemsCallback<Item>>(\r\n  loadMoreItems: T,\r\n  options: UseInfiniteLoaderOptions<Item> = emptyObj\r\n): LoadMoreItemsCallback<Item> {\r\n  const {\r\n    isItemLoaded,\r\n    minimumBatchSize = 16,\r\n    threshold = 16,\r\n    totalItems = 9e9,\r\n  } = options;\r\n  const storedLoadMoreItems = useLatest(loadMoreItems);\r\n  const storedIsItemLoaded = useLatest(isItemLoaded);\r\n\r\n  return React.useCallback(\r\n    (startIndex, stopIndex, items) => {\r\n      const unloadedRanges = scanForUnloadedRanges(\r\n        storedIsItemLoaded.current,\r\n        minimumBatchSize,\r\n        items,\r\n        totalItems,\r\n        Math.max(0, startIndex - threshold),\r\n        Math.min(totalItems - 1, (stopIndex || 0) + threshold)\r\n      );\r\n      // The user is responsible for memoizing their loadMoreItems() function\r\n      // because we don't want to make assumptions about how they want to deal\r\n      // with `items`\r\n      for (let i = 0; i < unloadedRanges.length - 1; ++i)\r\n        storedLoadMoreItems.current(\r\n          unloadedRanges[i],\r\n          unloadedRanges[++i],\r\n          items\r\n        );\r\n    },\r\n    [\r\n      totalItems,\r\n      minimumBatchSize,\r\n      threshold,\r\n      storedLoadMoreItems,\r\n      storedIsItemLoaded,\r\n    ]\r\n  );\r\n}\r\n\r\n/**\r\n * Returns all of the ranges within a larger range that contain unloaded rows.\r\n *\r\n * @param isItemLoaded\r\n * @param minimumBatchSize\r\n * @param items\r\n * @param totalItems\r\n * @param startIndex\r\n * @param stopIndex\r\n */\r\nfunction scanForUnloadedRanges<Item>(\r\n  isItemLoaded: UseInfiniteLoaderOptions<Item>[\"isItemLoaded\"] = defaultIsItemLoaded,\r\n  minimumBatchSize: UseInfiniteLoaderOptions<Item>[\"minimumBatchSize\"] = 16,\r\n  items: any[],\r\n  totalItems: UseInfiniteLoaderOptions<Item>[\"totalItems\"] = 9e9,\r\n  startIndex: number,\r\n  stopIndex: number\r\n): number[] {\r\n  const unloadedRanges: number[] = [];\r\n  let rangeStartIndex: number | undefined,\r\n    rangeStopIndex: number | undefined,\r\n    index = startIndex;\r\n\r\n  /* istanbul ignore next */\r\n  for (; index <= stopIndex; index++) {\r\n    if (!isItemLoaded(index, items)) {\r\n      rangeStopIndex = index;\r\n      if (rangeStartIndex === void 0) rangeStartIndex = index;\r\n    } else if (rangeStartIndex !== void 0 && rangeStopIndex !== void 0) {\r\n      unloadedRanges.push(rangeStartIndex, rangeStopIndex);\r\n      rangeStartIndex = rangeStopIndex = void 0;\r\n    }\r\n  }\r\n\r\n  // If :rangeStopIndex is not null it means we haven't run out of unloaded rows.\r\n  // Scan forward to try filling our :minimumBatchSize.\r\n  if (rangeStartIndex !== void 0 && rangeStopIndex !== void 0) {\r\n    const potentialStopIndex = Math.min(\r\n      Math.max(rangeStopIndex, rangeStartIndex + minimumBatchSize - 1),\r\n      totalItems - 1\r\n    );\r\n\r\n    /* istanbul ignore next */\r\n    for (index = rangeStopIndex + 1; index <= potentialStopIndex; index++) {\r\n      if (!isItemLoaded(index, items)) {\r\n        rangeStopIndex = index;\r\n      } else {\r\n        break;\r\n      }\r\n    }\r\n\r\n    unloadedRanges.push(rangeStartIndex, rangeStopIndex);\r\n  }\r\n\r\n  // Check to see if our first range ended prematurely.\r\n  // In this case we should scan backwards to try filling our :minimumBatchSize.\r\n  /* istanbul ignore next */\r\n  if (unloadedRanges.length) {\r\n    let firstUnloadedStart = unloadedRanges[0];\r\n    const firstUnloadedStop = unloadedRanges[1];\r\n\r\n    while (\r\n      firstUnloadedStop - firstUnloadedStart + 1 < minimumBatchSize &&\r\n      firstUnloadedStart > 0\r\n    ) {\r\n      const index = firstUnloadedStart - 1;\r\n\r\n      if (!isItemLoaded(index, items)) {\r\n        unloadedRanges[0] = firstUnloadedStart = index;\r\n      } else {\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  return unloadedRanges;\r\n}\r\n\r\nconst defaultIsItemLoaded = <Item>(index: number, items: Item[]): boolean =>\r\n  items[index] !== void 0;\r\n\r\nexport interface UseInfiniteLoaderOptions<Item> {\r\n  /**\r\n   *  A callback responsible for determining the loaded state of each item. Should return `true`\r\n   * if the item has already been loaded and `false` if not.\r\n   *\r\n   * @default (index: number, items: any[]) => boolean\r\n   */\r\n  isItemLoaded?: (index: number, items: Item[]) => boolean;\r\n  /**\r\n   * The minimum number of new items to be loaded at a time.  This property can be used to\r\n   * batch requests and reduce HTTP requests.\r\n   *\r\n   * @default 16\r\n   */\r\n  minimumBatchSize?: number;\r\n  /**\r\n   * The threshold at which to pre-fetch data. A threshold X means that new data should start\r\n   * loading when a user scrolls within X cells of the end of your `items` array.\r\n   *\r\n   * @default 16\r\n   */\r\n  threshold?: number;\r\n  /**\r\n   * The total number of items you'll need to eventually load (if known). This can\r\n   * be arbitrarily high if not known.\r\n   *\r\n   * @default 9e9\r\n   */\r\n  totalItems?: number;\r\n}\r\n\r\nexport type LoadMoreItemsCallback<Item> = (\r\n  startIndex: number,\r\n  stopIndex: number,\r\n  items: Item[]\r\n) => any;\r\n\r\nconst emptyObj = {};\r\n"],"names":["RED","BLACK","NIL","DELETE","KEEP","addInterval","treeNode","high","index","node","list","prevNode","next","removeInterval","NULL_NODE","low","max","C","P","undefined","R","L","updateMax","Math","updateMaxUp","x","rotateLeft","tree","y","root","rotateRight","replaceNode","fixRemove","w","minimumTree","fixInsert","z","createIntervalTree","size","indexMap","insert","remove","intervalResult","originalYColor","search","callback","stack","length","pop","push","curr","useLatest","current","storedValue","React","useRef","useEffect","useDebounceCallback","wait","leading","storedCallback","timeout","deps","clearTimeout","useCallback","args","arguments","setTimeout","apply","useDebounce","initialState","state","useState","useEvent","target","type","listener","cleanup","storedListener","storedCleanup","targetEl","didUnsubscribe","addEventListener","removeEventListener","emptyObj","win","window","wv","visualViewport","getSize","document","documentElement","clientWidth","clientHeight","useWindowSize","options","initialWidth","initialHeight","setDebouncedSize","setSize","memoOne","fn","areEqual","equal","defaultAreEqual","value","prev","OneKeyMap","set","get","key","val","k","v","createCache","obj","cache","e","memo","constructors","depth","baseCache","base","map","i","one","g1","s1","g2","s2","g","s","memoize","mapConstructors","item","elementsCache","WeakMap","useForceUpdate","setState","useMasonry","positioner","resizeObserver","items","as","ContainerComponent","id","className","style","role","tabIndex","containerRef","itemAs","ItemComponent","itemStyle","itemHeightEstimate","itemKey","defaultGetItemKey","overscanBy","scrollTop","isScrolling","height","RenderComponent","render","onRender","startIndex","stopIndex","forceUpdate","setItemRef","getRefSetter","itemCount","columnWidth","columnCount","range","estimateHeight","shortestColumn","measuredCount","shortestColumnSize","children","itemRole","storedOnRender","rangeEnd","needsFreshBatch","left","top","data","phaseTwoStyle","width","writingMode","position","process","throwWithoutData","__reactCreateElement__","createRenderElement","min","batchSize","ceil","phaseOneStyle","getCachedSize","didEverMount","containerStyle","getContainerStyle","assignUserStyle","Error","trieMemoize","memoizeOne","maxWidth","maxHeight","willChange","pointerEvents","cmp2","pargs","userStyle","_","zIndex","visibility","el","observe","offsetHeight","u","p","performance","Date","now","af","Caf","Raf","raf","bind","caf","lastTime","h","clearRequestTimeout","handle","requestTimeout","ms","start","loop","call","perf","useThrottleCallback","fps","trailingTimeout","clearTrailing","rightNow","useThrottle","getScrollY","scrollY","pageYOffset","useWindowScroll","useScroller","offset","useScrollPosition","setIsScrolling","didMount","to","MasonryScroller","props","scrollFps","displayName","usePassiveLayoutEffect","createElement","useContainerPosition","elementRef","emptyArr","containerPosition","setContainerPosition","useLayoutEffect","offsetTop","offsetParent","offsetWidth","usePositioner","columnGutter","rowGutter","maxColumnCount","maxColumnWidth","initPositioner","getColumns","computedColumnWidth","computedColumnCount","createPositioner","positionerRef","prevDeps","opts","prevOpts","optsChanged","every","prevPositioner","cacheSize","pos","intervalTree","columnHeights","Array","columnItems","column","update","updates","columns","j","itemsInColumn","binarySearch","startItem","lo","hi","renderCallback","defaultItemHeight","tallestColumn","all","a","l","m","minimumWidth","gutter","floor","Infinity","rafSchd","lastArgs","frameId","wrapperFn","_len","_key","requestAnimationFrame","cancel","cancelAnimationFrame","useResizeObserver","createResizeObserver","disconnect","handler","updater","commonHandler","handlers","Map","handleEntries","entries","entry","ro","ResizeObserver","forEach","useScrollToIndex","align","element","innerHeight","latestOptions","getTarget","latestElement","useReducer","action","nextState","prevTop","defaultState","dispatch","throttledDispatch","currentTop","scrollTo","estimatedTop","Masonry","windowSize","ssrWidth","ssrHeight","containerPos","nextProps","scrollToIndex","List","useInfiniteLoader","loadMoreItems","isItemLoaded","minimumBatchSize","threshold","totalItems","storedLoadMoreItems","storedIsItemLoaded","unloadedRanges","scanForUnloadedRanges","defaultIsItemLoaded","rangeStartIndex","rangeStopIndex","potentialStopIndex","firstUnloadedStart","firstUnloadedStop"],"mappings":"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"}
\ No newline at end of file
diff --git a/dist/umd/masonic.js b/dist/umd/masonic.js
index 4916098fb39617373638731b2596208261111633..f9d6d11883b1a0160402c93feaa12b62e0fb217a 100644
--- a/dist/umd/masonic.js
+++ b/dist/umd/masonic.js
@@ -1,2 +1,2 @@
-!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Masonic={},e.React)}(this,(function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function r(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:1,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}function i(e){var t=e.high;e.L===M&&e.R===M?e.max=t:e.L===M?e.max=Math.max(e.R.max,t):e.R===M?e.max=Math.max(e.L.max,t):e.max=Math.max(Math.max(e.L.max,e.R.max),t)}function o(e){for(var t=e;t.P!==M;)i(t.P),t=t.P}function u(e,t){if(t.R!==M){var n=t.R;t.R=n.L,n.L!==M&&(n.L.P=t),n.P=t.P,t.P===M?e.root=n:t===t.P.L?t.P.L=n:t.P.R=n,n.L=t,t.P=n,i(t),i(n)}}function f(e,t){if(t.L!==M){var n=t.L;t.L=n.R,n.R!==M&&(n.R.P=t),n.P=t.P,t.P===M?e.root=n:t===t.P.R?t.P.R=n:t.P.L=n,n.R=t,t.P=n,i(t),i(n)}}function c(e,t,n){t.P===M?e.root=n:t===t.P.L?t.P.L=n:t.P.R=n,n.P=t.P}function a(){var e={root:M,size:0},t={};return{insert:function(n,r,c){for(var a=e.root,s=M;a!==M&&n!==(s=a).low;)a=n<a.low?a.L:a.R;if(n===s.low&&s!==M){if(!function(e,t,n){for(var r,i=e.list;i;){if(i.index===n)return 0;if(t>i.high)break;r=i,i=i.next}return r||(e.list={index:n,high:t,next:i}),r&&(r.next={index:n,high:t,next:r.next}),1}(s,r,c))return;return s.high=Math.max(s.high,r),i(s),o(s),t[c]=s,void e.size++}var l={low:n,high:r,max:r,C:0,P:s,L:M,R:M,list:{index:c,high:r,next:null}};s===M?e.root=l:(l.low<s.low?s.L=l:s.R=l,o(l)),function(e,t){for(var n;0===t.P.C;)t.P===t.P.P.L?0===(n=t.P.P.R).C?(t.P.C=1,n.C=1,t.P.P.C=0,t=t.P.P):(t===t.P.R&&u(e,t=t.P),t.P.C=1,t.P.P.C=0,f(e,t.P.P)):0===(n=t.P.P.L).C?(t.P.C=1,n.C=1,t.P.P.C=0,t=t.P.P):(t===t.P.L&&f(e,t=t.P),t.P.C=1,t.P.P.C=0,u(e,t.P.P));e.root.C=1}(e,l),t[c]=l,e.size++},remove:function(n){var r=t[n];if(void 0!==r){delete t[n];var a=function(e,t){var n=e.list;if(n.index===t)return null===n.next?0:(e.list=n.next,1);var r=n;for(n=n.next;null!==n;){if(n.index===t)return r.next=n.next,1;r=n,n=n.next}}(r,n);if(void 0!==a){if(1===a)return r.high=r.list.high,i(r),o(r),void e.size--;var s,l=r,v=l.C;r.L===M?(s=r.R,c(e,r,r.R)):r.R===M?(s=r.L,c(e,r,r.L)):(v=(l=function(e){for(;e.L!==M;)e=e.L;return e}(r.R)).C,s=l.R,l.P===r?s.P=l:(c(e,l,l.R),l.R=r.R,l.R.P=l),c(e,r,l),l.L=r.L,l.L.P=l,l.C=r.C),i(s),o(s),1===v&&function(e,t){for(var n;t!==M&&1===t.C;)t===t.P.L?(0===(n=t.P.R).C&&(n.C=1,t.P.C=0,u(e,t.P),n=t.P.R),1===n.L.C&&1===n.R.C?(n.C=0,t=t.P):(1===n.R.C&&(n.L.C=1,n.C=0,f(e,n),n=t.P.R),n.C=t.P.C,t.P.C=1,n.R.C=1,u(e,t.P),t=e.root)):(0===(n=t.P.L).C&&(n.C=1,t.P.C=0,f(e,t.P),n=t.P.L),1===n.R.C&&1===n.L.C?(n.C=0,t=t.P):(1===n.L.C&&(n.R.C=1,n.C=0,u(e,n),n=t.P.L),n.C=t.P.C,t.P.C=1,n.L.C=1,f(e,t.P),t=e.root));t.C=1}(e,s),e.size--}}},search:function(t,n,r){for(var i=[e.root];0!==i.length;){var o=i.pop();if(o!==M&&t<=o.max&&(o.L!==M&&i.push(o.L),o.R!==M&&i.push(o.R),o.low<=n&&o.high>=t))for(var u=o.list;null!==u;)u.high<t||r(u.index,o.low),u=u.next}},get size(){return e.size}}}function s(){return(s=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t,n,r){var i=L.useRef(n),o=L.useRef(r);L.useEffect((function(){i.current=n,o.current=r})),L.useEffect((function(){function n(){if(!u){for(var e=arguments.length,t=new Array(e),n=0;e>n;n++)t[n]=arguments[n];i.current.apply(this,t)}}var r=e&&"current"in e?e.current:e;if(r){var u=0;r.addEventListener(t,n);var f=o.current;return function(){u=1,r.removeEventListener(t,n),f&&f()}}}),[e,t])}function v(){var e=L.useState(F)[1];return L.useRef((function(){return e({})})).current}function d(e){var t,n=e.positioner,r=e.resizeObserver,i=e.items,o=e.as,u=void 0===o?"div":o,f=e.id,c=e.className,a=e.style,l=e.role,d=void 0===l?"grid":l,p=e.tabIndex,m=void 0===p?0:p,g=e.containerRef,P=e.itemAs,x=void 0===P?"div":P,y=e.itemStyle,R=e.itemHeightEstimate,w=void 0===R?300:R,C=e.itemKey,b=void 0===C?h:C,M=e.overscanBy,z=void 0===M?2:M,E=e.scrollTop,O=e.isScrolling,I=e.height,S=e.render,W=e.onRender,j=0,H=v(),k=V(n,r),A=i.length,B=n.columnWidth,F=n.columnCount,q=n.range,J=n.estimateHeight,Q=n.size,U=n.shortestColumn,X=Q(),Z=U(),$=[],ee="list"===d?"listitem":"grid"===d?"gridcell":void 0,te=T(W),ne=E+(z*=I),re=ne>Z&&A>X;if(q(Math.max(0,E-z/2),ne,(function(e,n,r){var o=i[e],u=b(o,e),f={top:r,left:n,width:B,writingMode:"horizontal-tb",position:"absolute"};$.push(G(x,{key:u,ref:k(e),role:ee,style:"object"==typeof y&&null!==y?s({},f,y):f},Y(S,e,o,B))),void 0===t?(j=e,t=e):(j=Math.min(j,e),t=Math.max(t,e))})),re)for(var ie=Math.min(A-X,Math.ceil((E+z-Z)/w*F)),oe=X,ue=K(B);X+ie>oe;oe++){var fe=i[oe],ce=b(fe,oe);$.push(G(x,{key:ce,ref:k(oe),role:ee,style:"object"==typeof y?s({},ue,y):ue},Y(S,oe,fe,B)))}L.useEffect((function(){"function"==typeof te.current&&void 0!==t&&te.current(j,t,i),N="1"}),[j,t,i,te]),L.useEffect((function(){re&&H()}),[re,n]);var ae=_(O,J(A,w));return G(u,{ref:g,key:N,id:f,role:d,className:c,tabIndex:m,style:"object"==typeof a?D(ae,a):ae,children:$})}function h(e,t){return t}function p(e,t,n){function r(){u.current=0,c()}void 0===t&&(t=30),void 0===n&&(n=0);var i=T(e),o=1e3/t,u=L.useRef(0),f=L.useRef(),c=function(){return f.current&&clearTimeout(f.current)},a=[t,n,i];return L.useEffect((function(){return r}),a),L.useCallback((function(){var e=arguments,t=oe(),r=function(){u.current=t,c(),i.current.apply(null,e)},a=u.current;if(n&&0===a)return r();if(t-a>o){if(a>0)return r();u.current=t}c(),f.current=setTimeout((function(){r(),u.current=0}),o)}),a)}function m(e,t){void 0===e&&(e=0),void 0===t&&(t=12);var n=ce(t),r=L.useState(0),i=r[0],o=r[1],u=L.useRef(0);return L.useEffect((function(){1===u.current&&o(1);var e,n,r,i,f=0,c=(e=function(){f||o(0)},n=40+1e3/t,r=X(),(i={}).v=te((function t(){X()-r<n?i.v=te(t):e.call(null)})),i);return u.current=1,function(){f=1,function(e){ne(e.v||-1)}(c)}}),[t,n]),{scrollTop:Math.max(0,n-e),isScrolling:i}}function g(e){var t=m(e.offset,e.scrollFps);return d({scrollTop:t.scrollTop,isScrolling:t.isScrolling,positioner:e.positioner,resizeObserver:e.resizeObserver,items:e.items,onRender:e.onRender,as:e.as,id:e.id,className:e.className,style:e.style,role:e.role,tabIndex:e.tabIndex,containerRef:e.containerRef,itemAs:e.itemAs,itemStyle:e.itemStyle,itemHeightEstimate:e.itemHeightEstimate,itemKey:e.itemKey,overscanBy:e.overscanBy,height:e.height,render:e.render})}function P(e,t){void 0===t&&(t=se);var n=L.useState({offset:0,width:0}),r=n[0],i=n[1];return ae((function(){var t=e.current;if(null!==t){var n=0,o=t;do{n+=o.offsetTop||0,o=o.offsetParent}while(o);n===r.offset&&t.offsetWidth===r.width||i({offset:n,width:t.offsetWidth})}}),t),r}function x(e,t){var n=e.width,r=e.columnWidth,i=void 0===r?200:r,o=e.columnGutter,u=void 0===o?0:o,f=e.rowGutter,c=e.columnCount,a=e.maxColumnCount,s=e.maxColumnWidth;void 0===t&&(t=he);var l=function(){var e=de(n,i,u,c,a,s),t=e[0],r=e[1];return le(r,t,u,null!=f?f:u)},v=L.useRef();void 0===v.current&&(v.current=l());var d=L.useRef(t),h=[n,i,u,f,c,a,s],p=L.useRef(h),m=!h.every((function(e,t){return p.current[t]===e}));if(m||!t.every((function(e,t){return d.current[t]===e}))){var g=v.current,P=l();if(d.current=t,p.current=h,m)for(var x=g.size(),y=0;x>y;y++){var R=g.get(y);P.set(y,void 0!==R?R.height:0)}v.current=P}return v.current}function y(e){function t(){return r.disconnect()}var n=v(),r=me(e,n);return L.useEffect((function(){return t}),[r]),r}function R(e){e.cancel()}function w(e,t){var n,r=t.align,i=void 0===r?"top":r,o=t.element,u=void 0===o?"undefined"!=typeof window&&window:o,f=t.offset,c=void 0===f?0:f,a=t.height,s=void 0===a?"undefined"!=typeof window?window.innerHeight:0:a,v=T({positioner:e,element:u,align:i,offset:c,height:s}),d=L.useRef((function(){var e=v.current.element;return e&&"current"in e?e.current:e})).current,h=L.useReducer((function(e,t){var n,r={position:e.position,index:e.index,prevTop:e.prevTop};if("scrollToIndex"===t.type)return{position:v.current.positioner.get(null!==(n=t.value)&&void 0!==n?n:-1),index:t.value,prevTop:void 0};if("setPosition"===t.type)r.position=t.value;else if("setPrevTop"===t.type)r.prevTop=t.value;else if("reset"===t.type)return ge;return r}),ge),m=h[0],g=h[1],P=p(g,15);l(d(),"scroll",(function(){if(!m.position&&m.index){var e=v.current.positioner.get(m.index);e&&g({type:"setPosition",value:e})}}));var x=void 0!==m.index&&(null===(n=v.current.positioner.get(m.index))||void 0===n?void 0:n.top);return L.useEffect((function(){var e=d();if(e){var t=v.current,n=t.height,r=t.align,i=t.offset,o=t.positioner;if(m.position){var u=m.position.top;"bottom"===r?u=u-n+m.position.height:"center"===r&&(u-=(n-m.position.height)/2),e.scrollTo(0,Math.max(0,u+=i));var f=0,c=setTimeout((function(){return!f&&g({type:"reset"})}),400);return function(){f=1,clearTimeout(c)}}if(void 0!==m.index){var a=o.shortestColumn()/o.size()*m.index;m.prevTop&&(a=Math.max(a,m.prevTop+n)),e.scrollTo(0,a),P({type:"setPrevTop",value:a})}}}),[x,m,v,d,P]),L.useRef((function(e){g({type:"scrollToIndex",value:e})})).current}function C(e){var t=L.useRef(null),n=function(e){void 0===e&&(e=E);var t=e,n=t.wait,r=t.leading,i=t.initialWidth,o=void 0===i?0:i,u=t.initialHeight,f=function(e,t,n){var r=L.useState(e);return[r[0],z(r[1],t,n)]}("undefined"==typeof document?[o,void 0===u?0:u]:S,n,r),c=f[0],a=f[1],s=function(){return a(S)};return l(O,"resize",s),l(I,"resize",s),l(O,"orientationchange",s),c}({initialWidth:e.ssrWidth,initialHeight:e.ssrHeight}),r=P(t,n),i=s({offset:r.offset,width:r.width||n[0],height:n[1],containerRef:t},e);i.positioner=x(i),i.resizeObserver=y(i.positioner);var o=w(i.positioner,{height:i.height,offset:r.offset,align:"object"==typeof e.scrollToIndex?e.scrollToIndex.align:void 0}),u=e.scrollToIndex&&("number"==typeof e.scrollToIndex?e.scrollToIndex:e.scrollToIndex.index);return L.useEffect((function(){void 0!==u&&o(u)}),[u,o]),Pe(g,i)}var L=r(t),b=n(t),M={low:0,max:0,high:0,C:2,P:void 0,R:void 0,L:void 0,list:void 0};M.P=M,M.L=M,M.R=M;var T=function(e){var t=L.useRef(e);return L.useEffect((function(){t.current=e})),t},z=function(e,t,n){function r(){u.current&&clearTimeout(u.current),u.current=void 0}function i(){u.current=void 0}void 0===t&&(t=100),void 0===n&&(n=0);var o=T(e),u=L.useRef(),f=[t,n,o];return L.useEffect((function(){return r}),f),L.useCallback((function(){var e=arguments,r=u.current;if(void 0===r&&n)return u.current=setTimeout(i,t),o.current.apply(null,e);r&&clearTimeout(r),u.current=setTimeout((function(){u.current=void 0,o.current.apply(null,e)}),t)}),f)},E={},O="undefined"==typeof window?null:window,I=O&&void 0!==O.visualViewport?O.visualViewport:null,S=function(){return[document.documentElement.clientWidth,document.documentElement.clientHeight]},W=function(e,t){var n,r,i=t||j;return function(){return n&&i(arguments,n)?r:r=e.apply(null,n=arguments)}},j=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},H=function(){var e,t;this.set=void 0,this.get=void 0,this.get=function(n){return n===e?t:void 0},this.set=function(n,r){e=n,t=r}},k=function(e){try{return new e}catch(e){var t={};return{set:function(e,n){t[e]=n},get:function(e){return t[e]}}}},A=function(e,t){var n,r,i,o,u,f,c,a,s,l=(c=(r=e).length,a=k(r[0]),s=1===c,3>c?{g:function(e){return void 0===(i=a.get(e[0]))||s?i:i.get(e[1])},s:function(e,t){return s?a.set(e[0],t):void 0===(i=a.get(e[0]))?((o=k(r[1])).set(e[1],t),a.set(e[0],o)):i.set(e[1],t),t}}:{g:function(e){for(f=a,u=0;c>u;u++)if(void 0===(f=f.get(e[u])))return;return f},s:function(e,t){for(f=a,u=0;c-1>u;u++)void 0===(o=f.get(e[u]))?(o=k(r[u+1]),f.set(e[u],o),f=o):f=o;return f.set(e[c-1],t),t}}),v=l.g,d=l.s;return function(){return void 0===(n=v(arguments))?d(arguments,t.apply(null,arguments)):n}},B=new WeakMap,F={},G=L.createElement,N="0",Y=A([H,{},WeakMap,H],(function(e,t,n,r){return G(e,{index:t,data:n,width:r})})),_=W((function(e,t){return{position:"relative",width:"100%",maxWidth:"100%",height:Math.ceil(t),maxHeight:Math.ceil(t),willChange:e?"contents":void 0,pointerEvents:e?"none":void 0}})),q=function(e,t){return e[0]===t[0]&&e[1]===t[1]},D=W((function(e,t){return s({},e,t)}),q),K=W((function(e){return{width:e,zIndex:-1e3,visibility:"hidden",position:"absolute",writingMode:"horizontal-tb"}}),(function(e,t){return e[0]===t[0]})),V=W((function(e,t){return function(n){return function(r){null!==r&&(t&&(t.observe(r),B.set(r,n)),void 0===e.get(n)&&e.set(n,r.offsetHeight))}}}),q),J="undefined",Q=typeof window!==J?window:{},U=typeof performance!==J?performance:Date,X=function(){return U.now()},Z="AnimationFrame",$="cancel"+Z,ee="request"+Z,te=Q[ee]&&Q[ee].bind(Q),ne=Q[$]&&Q[$].bind(Q);if(!te||!ne){var re=0;te=function(e){var t=X(),n=Math.max(re+1e3/60,t);return setTimeout((function(){e(re=n)}),n-t)},ne=function(e){return clearTimeout(e)}}var ie="undefined"!=typeof performance?performance:Date,oe=function(){return ie.now()},ue="undefined"==typeof window?null:window,fe=function(){return void 0!==ue.scrollY?ue.scrollY:void 0===ue.pageYOffset?0:ue.pageYOffset},ce=function(e){void 0===e&&(e=30);var t=function(e,t){var n=L.useState(e);return[n[0],p(n[1],t,1)]}("undefined"==typeof window?0:fe,e);return l(ue,"scroll",(function(){return t[1](fe())})),t[0]},ae=b.default["undefined"!=typeof document&&void 0!==document.createElement?"useLayoutEffect":"useEffect"],se=[],le=function(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=n);for(var i=a(),o=new Array(e),u=[],f=new Array(e),c=0;e>c;c++)o[c]=0,f[c]=[];return{columnCount:e,columnWidth:t,set:function(e,c){void 0===c&&(c=0);for(var a=0,s=1;s<o.length;s++)o[s]<o[a]&&(a=s);var l=o[a]||0;o[a]=l+c+r,f[a].push(e),u[e]={left:a*(t+n),top:l,height:c,column:a},i.insert(l,l+c,e)},get:function(e){return u[e]},update:function(t){for(var n=new Array(e),c=0,a=0;c<t.length-1;c++){var s=t[c],l=u[s];l.height=t[++c],i.remove(s),i.insert(l.top,l.top+l.height,s),n[l.column]=void 0===n[l.column]?s:Math.min(s,n[l.column])}for(c=0;c<n.length;c++)if(void 0!==n[c]){var v=f[c],d=ve(v,n[c]),h=f[c][d],p=u[h];for(o[c]=p.top+p.height+r,a=d+1;a<v.length;a++){var m=v[a],g=u[m];g.top=o[c],o[c]=g.top+g.height+r,i.remove(m),i.insert(g.top,g.top+g.height,m)}}},range:function(e,t,n){return i.search(e,t,(function(e,t){return n(e,u[e].left,t)}))},estimateHeight:function(t,n){var r=Math.max(0,Math.max.apply(null,o));return t===i.size?r:r+Math.ceil((t-i.size)/e)*n},shortestColumn:function(){return o.length>1?Math.min.apply(null,o):o[0]||0},size:function(){return i.size},all:function(){return u}}},ve=function(e,t){for(var n=0,r=e.length-1;r>=n;){var i=n+r>>>1,o=e[i];if(o===t)return i;o>t?r=i-1:n=i+1}return-1},de=function(e,t,n,r,i,o){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=8),r=r||Math.min(Math.floor((e+n)/(t+n)),i||1/0)||1;var u=Math.floor((e-n*(r-1))/r);return void 0!==o&&u>o&&(u=o),[u,r]},he=[],pe=function(e){function t(){r=null,e.apply(void 0,n)}var n=[],r=null,i=function(){for(var e=arguments.length,i=new Array(e),o=0;e>o;o++)i[o]=arguments[o];n=i,r||(r=requestAnimationFrame(t))};return i.cancel=function(){r&&(cancelAnimationFrame(r),r=null)},i},me=A([WeakMap],(function(e,t){var n=[],r=pe((function(){n.length>0&&(e.update(n),t(n)),n.length=0})),i=function(t){var i=t.offsetHeight;if(i>0){var o=B.get(t);if(void 0!==o){var u=e.get(o);void 0!==u&&i!==u.height&&n.push(o,i)}}r()},o=new Map,u=new ResizeObserver((function(e){for(var t=0;t<e.length;t++){var n=e[t],r=B.get(n.target);if(void 0!==r){var u=o.get(r);u||(u=pe(i),o.set(r,u)),u(n.target)}}})),f=u.disconnect.bind(u);return u.disconnect=function(){f(),o.forEach(R)},u})),ge={index:void 0,position:void 0,prevTop:void 0},Pe=L.createElement,xe=L.createElement,ye=function(e,t){return void 0!==t[e]},Re={};e.List=function(e){return xe(C,s({role:"list",rowGutter:e.rowGutter,columnCount:1,columnWidth:1},e))},e.Masonry=C,e.MasonryScroller=g,e.createIntervalTree=a,e.createPositioner=le,e.createResizeObserver=me,e.useContainerPosition=P,e.useInfiniteLoader=function(e,t){void 0===t&&(t=Re);var n=t,r=n.isItemLoaded,i=n.minimumBatchSize,o=void 0===i?16:i,u=n.threshold,f=void 0===u?16:u,c=n.totalItems,a=void 0===c?9e9:c,s=T(e),l=T(r);return L.useCallback((function(e,t,n){for(var r=function(e,t,n,r,i,o){void 0===e&&(e=ye),void 0===t&&(t=16),void 0===r&&(r=9e9);for(var u,f,c=[],a=i;o>=a;a++)e(a,n)?void 0!==u&&void 0!==f&&(c.push(u,f),u=f=void 0):(f=a,void 0===u&&(u=a));if(void 0!==u&&void 0!==f){var s=Math.min(Math.max(f,u+t-1),r-1);for(a=f+1;s>=a&&!e(a,n);a++)f=a;c.push(u,f)}if(c.length)for(var l=c[0],v=c[1];t>v-l+1&&l>0;){var d=l-1;if(e(d,n))break;c[0]=l=d}return c}(l.current,o,n,a,Math.max(0,e-f),Math.min(a-1,(t||0)+f)),i=0;i<r.length-1;++i)s.current(r[i],r[++i],n)}),[a,o,f,s,l])},e.useMasonry=d,e.usePositioner=x,e.useResizeObserver=y,e.useScrollToIndex=w,e.useScroller=m,Object.defineProperty(e,"__esModule",{value:1})}));
+!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Masonic={},e.React)}(this,(function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function r(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:1,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}function i(e){var t=e.high;e.L===M&&e.R===M?e.max=t:e.L===M?e.max=Math.max(e.R.max,t):e.R===M?e.max=Math.max(e.L.max,t):e.max=Math.max(Math.max(e.L.max,e.R.max),t)}function o(e){for(var t=e;t.P!==M;)i(t.P),t=t.P}function u(e,t){if(t.R!==M){var n=t.R;t.R=n.L,n.L!==M&&(n.L.P=t),n.P=t.P,t.P===M?e.root=n:t===t.P.L?t.P.L=n:t.P.R=n,n.L=t,t.P=n,i(t),i(n)}}function f(e,t){if(t.L!==M){var n=t.L;t.L=n.R,n.R!==M&&(n.R.P=t),n.P=t.P,t.P===M?e.root=n:t===t.P.R?t.P.R=n:t.P.L=n,n.R=t,t.P=n,i(t),i(n)}}function c(e,t,n){t.P===M?e.root=n:t===t.P.L?t.P.L=n:t.P.R=n,n.P=t.P}function a(){var e={root:M,size:0},t={};return{insert:function(n,r,c){for(var a=e.root,s=M;a!==M&&n!==(s=a).low;)a=n<a.low?a.L:a.R;if(n===s.low&&s!==M){if(!function(e,t,n){for(var r,i=e.list;i;){if(i.index===n)return 0;if(t>i.high)break;r=i,i=i.next}return r||(e.list={index:n,high:t,next:i}),r&&(r.next={index:n,high:t,next:r.next}),1}(s,r,c))return;return s.high=Math.max(s.high,r),i(s),o(s),t[c]=s,void e.size++}var l={low:n,high:r,max:r,C:0,P:s,L:M,R:M,list:{index:c,high:r,next:null}};s===M?e.root=l:(l.low<s.low?s.L=l:s.R=l,o(l)),function(e,t){for(var n;0===t.P.C;)t.P===t.P.P.L?0===(n=t.P.P.R).C?(t.P.C=1,n.C=1,t.P.P.C=0,t=t.P.P):(t===t.P.R&&u(e,t=t.P),t.P.C=1,t.P.P.C=0,f(e,t.P.P)):0===(n=t.P.P.L).C?(t.P.C=1,n.C=1,t.P.P.C=0,t=t.P.P):(t===t.P.L&&f(e,t=t.P),t.P.C=1,t.P.P.C=0,u(e,t.P.P));e.root.C=1}(e,l),t[c]=l,e.size++},remove:function(n){var r=t[n];if(void 0!==r){delete t[n];var a=function(e,t){var n=e.list;if(n.index===t)return null===n.next?0:(e.list=n.next,1);var r=n;for(n=n.next;null!==n;){if(n.index===t)return r.next=n.next,1;r=n,n=n.next}}(r,n);if(void 0!==a){if(1===a)return r.high=r.list.high,i(r),o(r),void e.size--;var s,l=r,v=l.C;r.L===M?(s=r.R,c(e,r,r.R)):r.R===M?(s=r.L,c(e,r,r.L)):(v=(l=function(e){for(;e.L!==M;)e=e.L;return e}(r.R)).C,s=l.R,l.P===r?s.P=l:(c(e,l,l.R),l.R=r.R,l.R.P=l),c(e,r,l),l.L=r.L,l.L.P=l,l.C=r.C),i(s),o(s),1===v&&function(e,t){for(var n;t!==M&&1===t.C;)t===t.P.L?(0===(n=t.P.R).C&&(n.C=1,t.P.C=0,u(e,t.P),n=t.P.R),1===n.L.C&&1===n.R.C?(n.C=0,t=t.P):(1===n.R.C&&(n.L.C=1,n.C=0,f(e,n),n=t.P.R),n.C=t.P.C,t.P.C=1,n.R.C=1,u(e,t.P),t=e.root)):(0===(n=t.P.L).C&&(n.C=1,t.P.C=0,f(e,t.P),n=t.P.L),1===n.R.C&&1===n.L.C?(n.C=0,t=t.P):(1===n.L.C&&(n.R.C=1,n.C=0,u(e,n),n=t.P.L),n.C=t.P.C,t.P.C=1,n.L.C=1,f(e,t.P),t=e.root));t.C=1}(e,s),e.size--}}},search:function(t,n,r){for(var i=[e.root];0!==i.length;){var o=i.pop();if(o!==M&&t<=o.max&&(o.L!==M&&i.push(o.L),o.R!==M&&i.push(o.R),o.low<=n&&o.high>=t))for(var u=o.list;null!==u;)u.high<t||r(u.index,o.low),u=u.next}},get size(){return e.size}}}function s(){return(s=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t,n,r){var i=L.useRef(n),o=L.useRef(r);L.useEffect((function(){i.current=n,o.current=r})),L.useEffect((function(){function n(){if(!u){for(var e=arguments.length,t=new Array(e),n=0;e>n;n++)t[n]=arguments[n];i.current.apply(this,t)}}var r=e&&"current"in e?e.current:e;if(r){var u=0;r.addEventListener(t,n);var f=o.current;return function(){u=1,r.removeEventListener(t,n),f&&f()}}}),[e,t])}function v(){var e=L.useState(F)[1];return L.useRef((function(){return e({})})).current}function d(e){var t,n=e.positioner,r=e.resizeObserver,i=e.items,o=e.as,u=void 0===o?"div":o,f=e.id,c=e.className,a=e.style,l=e.role,d=void 0===l?"grid":l,p=e.tabIndex,m=void 0===p?0:p,g=e.containerRef,P=e.itemAs,x=void 0===P?"div":P,y=e.itemStyle,R=e.itemHeightEstimate,w=void 0===R?300:R,C=e.itemKey,b=void 0===C?h:C,M=e.overscanBy,z=void 0===M?2:M,E=e.scrollTop,O=e.isScrolling,I=e.height,S=e.render,W=e.onRender,j=0,H=v(),k=V(n,r),A=i.length,B=n.columnWidth,F=n.columnCount,q=n.range,J=n.estimateHeight,Q=n.size,U=n.shortestColumn,X=Q(),Z=U(),$=[],ee="list"===d?"listitem":"grid"===d?"gridcell":void 0,te=T(W),ne=E+(z*=I),re=ne>Z&&A>X;if(q(Math.max(0,E-z/2),ne,(function(e,n,r){var o=i[e],u=b(o,e),f={top:r,left:n,width:B,writingMode:"horizontal-tb",position:"absolute"};$.push(G(x,{key:u,ref:k(e),role:ee,style:"object"==typeof y&&null!==y?s({},f,y):f},Y(S,e,o,B))),void 0===t?(j=e,t=e):(j=Math.min(j,e),t=Math.max(t,e))})),re)for(var ie=Math.min(A-X,Math.ceil((E+z-Z)/w*F)),oe=X,ue=K(B);X+ie>oe;oe++){var fe=i[oe],ce=b(fe,oe);$.push(G(x,{key:ce,ref:k(oe),role:ee,style:"object"==typeof y?s({},ue,y):ue},Y(S,oe,fe,B)))}L.useEffect((function(){"function"==typeof te.current&&void 0!==t&&te.current(j,t,i),N="1"}),[j,t,i,te]),L.useEffect((function(){re&&H()}),[re,n]);var ae=_(O,J(A,w));return G(u,{ref:g,key:N,id:f,role:d,className:c,tabIndex:m,style:"object"==typeof a?D(ae,a):ae,children:$})}function h(e,t){return t}function p(e,t,n){function r(){u.current=0,c()}void 0===t&&(t=30),void 0===n&&(n=0);var i=T(e),o=1e3/t,u=L.useRef(0),f=L.useRef(),c=function(){return f.current&&clearTimeout(f.current)},a=[t,n,i];return L.useEffect((function(){return r}),a),L.useCallback((function(){var e=arguments,t=oe(),r=function(){u.current=t,c(),i.current.apply(null,e)},a=u.current;if(n&&0===a)return r();if(t-a>o){if(a>0)return r();u.current=t}c(),f.current=setTimeout((function(){r(),u.current=0}),o)}),a)}function m(e,t){void 0===e&&(e=0),void 0===t&&(t=12);var n=ce(t),r=L.useState(0),i=r[0],o=r[1],u=L.useRef(0);return L.useEffect((function(){1===u.current&&o(1);var e,n,r,i,f,c=0,a=(e=function(){c||o(0)},n=40+1e3/t,r=X(),f=function(){X()-r<n?i.v=te(f):e.call(null)},(i={}).v=te(f),i);return u.current=1,function(){c=1,function(e){ne(e.v||-1)}(a)}}),[t,n]),{scrollTop:Math.max(0,n-e),isScrolling:i}}function g(e){var t=m(e.offset,e.scrollFps);return d({scrollTop:t.scrollTop,isScrolling:t.isScrolling,positioner:e.positioner,resizeObserver:e.resizeObserver,items:e.items,onRender:e.onRender,as:e.as,id:e.id,className:e.className,style:e.style,role:e.role,tabIndex:e.tabIndex,containerRef:e.containerRef,itemAs:e.itemAs,itemStyle:e.itemStyle,itemHeightEstimate:e.itemHeightEstimate,itemKey:e.itemKey,overscanBy:e.overscanBy,height:e.height,render:e.render})}function P(e,t){void 0===t&&(t=se);var n=L.useState({offset:0,width:0}),r=n[0],i=n[1];return ae((function(){var t=e.current;if(null!==t){var n=0,o=t;do{n+=o.offsetTop||0,o=o.offsetParent}while(o);n===r.offset&&t.offsetWidth===r.width||i({offset:n,width:t.offsetWidth})}}),t),r}function x(e,t){var n=e.width,r=e.columnWidth,i=void 0===r?200:r,o=e.columnGutter,u=void 0===o?0:o,f=e.rowGutter,c=e.columnCount,a=e.maxColumnCount,s=e.maxColumnWidth;void 0===t&&(t=he);var l=function(){var e=de(n,i,u,c,a,s),t=e[0],r=e[1];return le(r,t,u,null!=f?f:u)},v=L.useRef();void 0===v.current&&(v.current=l());var d=L.useRef(t),h=[n,i,u,f,c,a,s],p=L.useRef(h),m=!h.every((function(e,t){return p.current[t]===e}));if(m||!t.every((function(e,t){return d.current[t]===e}))){var g=v.current,P=l();if(d.current=t,p.current=h,m)for(var x=g.size(),y=0;x>y;y++){var R=g.get(y);P.set(y,void 0!==R?R.height:0)}v.current=P}return v.current}function y(e){function t(){return r.disconnect()}var n=v(),r=me(e,n);return L.useEffect((function(){return t}),[r]),r}function R(e){e.cancel()}function w(e,t){var n,r=t.align,i=void 0===r?"top":r,o=t.element,u=void 0===o?"undefined"!=typeof window&&window:o,f=t.offset,c=void 0===f?0:f,a=t.height,s=void 0===a?"undefined"!=typeof window?window.innerHeight:0:a,v=T({positioner:e,element:u,align:i,offset:c,height:s}),d=L.useRef((function(){var e=v.current.element;return e&&"current"in e?e.current:e})).current,h=L.useReducer((function(e,t){var n,r={position:e.position,index:e.index,prevTop:e.prevTop};if("scrollToIndex"===t.type)return{position:v.current.positioner.get(null!==(n=t.value)&&void 0!==n?n:-1),index:t.value,prevTop:void 0};if("setPosition"===t.type)r.position=t.value;else if("setPrevTop"===t.type)r.prevTop=t.value;else if("reset"===t.type)return ge;return r}),ge),m=h[0],g=h[1],P=p(g,15);l(d(),"scroll",(function(){if(!m.position&&m.index){var e=v.current.positioner.get(m.index);e&&g({type:"setPosition",value:e})}}));var x=void 0!==m.index&&(null===(n=v.current.positioner.get(m.index))||void 0===n?void 0:n.top);return L.useEffect((function(){var e=d();if(e){var t=v.current,n=t.height,r=t.align,i=t.offset,o=t.positioner;if(m.position){var u=m.position.top;"bottom"===r?u=u-n+m.position.height:"center"===r&&(u-=(n-m.position.height)/2),e.scrollTo(0,Math.max(0,u+=i));var f=0,c=setTimeout((function(){return!f&&g({type:"reset"})}),400);return function(){f=1,clearTimeout(c)}}if(void 0!==m.index){var a=o.shortestColumn()/o.size()*m.index;m.prevTop&&(a=Math.max(a,m.prevTop+n)),e.scrollTo(0,a),P({type:"setPrevTop",value:a})}}}),[x,m,v,d,P]),L.useRef((function(e){g({type:"scrollToIndex",value:e})})).current}function C(e){var t=L.useRef(null),n=function(e){void 0===e&&(e=E);var t=e,n=t.wait,r=t.leading,i=t.initialWidth,o=void 0===i?0:i,u=t.initialHeight,f=function(e,t,n){var r=L.useState(e);return[r[0],z(r[1],t,n)]}("undefined"==typeof document?[o,void 0===u?0:u]:S,n,r),c=f[0],a=f[1],s=function(){return a(S)};return l(O,"resize",s),l(I,"resize",s),l(O,"orientationchange",s),c}({initialWidth:e.ssrWidth,initialHeight:e.ssrHeight}),r=P(t,n),i=s({offset:r.offset,width:r.width||n[0],height:n[1],containerRef:t},e);i.positioner=x(i),i.resizeObserver=y(i.positioner);var o=w(i.positioner,{height:i.height,offset:r.offset,align:"object"==typeof e.scrollToIndex?e.scrollToIndex.align:void 0}),u=e.scrollToIndex&&("number"==typeof e.scrollToIndex?e.scrollToIndex:e.scrollToIndex.index);return L.useEffect((function(){void 0!==u&&o(u)}),[u,o]),Pe(g,i)}var L=r(t),b=n(t),M={low:0,max:0,high:0,C:2,P:void 0,R:void 0,L:void 0,list:void 0};M.P=M,M.L=M,M.R=M;var T=function(e){var t=L.useRef(e);return L.useEffect((function(){t.current=e})),t},z=function(e,t,n){function r(){u.current&&clearTimeout(u.current),u.current=void 0}function i(){u.current=void 0}void 0===t&&(t=100),void 0===n&&(n=0);var o=T(e),u=L.useRef(),f=[t,n,o];return L.useEffect((function(){return r}),f),L.useCallback((function(){var e=arguments,r=u.current;if(void 0===r&&n)return u.current=setTimeout(i,t),o.current.apply(null,e);r&&clearTimeout(r),u.current=setTimeout((function(){u.current=void 0,o.current.apply(null,e)}),t)}),f)},E={},O="undefined"==typeof window?null:window,I=O&&void 0!==O.visualViewport?O.visualViewport:null,S=function(){return[document.documentElement.clientWidth,document.documentElement.clientHeight]},W=function(e,t){var n,r,i=t||j;return function(){return n&&i(arguments,n)?r:r=e.apply(null,n=arguments)}},j=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},H=function(){var e,t;this.set=void 0,this.get=void 0,this.get=function(n){return n===e?t:void 0},this.set=function(n,r){e=n,t=r}},k=function(e){try{return new e}catch(e){var t={};return{set:function(e,n){t[e]=n},get:function(e){return t[e]}}}},A=function(e,t){var n,r,i,o,u,f,c,a,s,l=(c=(r=e).length,a=k(r[0]),s=1===c,3>c?{g:function(e){return void 0===(i=a.get(e[0]))||s?i:i.get(e[1])},s:function(e,t){return s?a.set(e[0],t):void 0===(i=a.get(e[0]))?((o=k(r[1])).set(e[1],t),a.set(e[0],o)):i.set(e[1],t),t}}:{g:function(e){for(f=a,u=0;c>u;u++)if(void 0===(f=f.get(e[u])))return;return f},s:function(e,t){for(f=a,u=0;c-1>u;u++)void 0===(o=f.get(e[u]))?(o=k(r[u+1]),f.set(e[u],o),f=o):f=o;return f.set(e[c-1],t),t}}),v=l.g,d=l.s;return function(){return void 0===(n=v(arguments))?d(arguments,t.apply(null,arguments)):n}},B=new WeakMap,F={},G=L.createElement,N="0",Y=A([H,{},WeakMap,H],(function(e,t,n,r){return G(e,{index:t,data:n,width:r})})),_=W((function(e,t){return{position:"relative",width:"100%",maxWidth:"100%",height:Math.ceil(t),maxHeight:Math.ceil(t),willChange:e?"contents":void 0,pointerEvents:e?"none":void 0}})),q=function(e,t){return e[0]===t[0]&&e[1]===t[1]},D=W((function(e,t){return s({},e,t)}),q),K=W((function(e){return{width:e,zIndex:-1e3,visibility:"hidden",position:"absolute",writingMode:"horizontal-tb"}}),(function(e,t){return e[0]===t[0]})),V=W((function(e,t){return function(n){return function(r){null!==r&&(t&&(t.observe(r),B.set(r,n)),void 0===e.get(n)&&e.set(n,r.offsetHeight))}}}),q),J="undefined",Q=typeof window!==J?window:{},U=typeof performance!==J?performance:Date,X=function(){return U.now()},Z="AnimationFrame",$="cancel"+Z,ee="request"+Z,te=Q[ee]&&Q[ee].bind(Q),ne=Q[$]&&Q[$].bind(Q);if(!te||!ne){var re=0;te=function(e){var t=X(),n=Math.max(re+1e3/60,t);return setTimeout((function(){e(re=n)}),n-t)},ne=function(e){return clearTimeout(e)}}var ie="undefined"!=typeof performance?performance:Date,oe=function(){return ie.now()},ue="undefined"==typeof window?null:window,fe=function(){return void 0!==ue.scrollY?ue.scrollY:void 0===ue.pageYOffset?0:ue.pageYOffset},ce=function(e){void 0===e&&(e=30);var t=function(e,t){var n=L.useState(e);return[n[0],p(n[1],t,1)]}("undefined"==typeof window?0:fe,e);return l(ue,"scroll",(function(){return t[1](fe())})),t[0]},ae=b.default["undefined"!=typeof document&&void 0!==document.createElement?"useLayoutEffect":"useEffect"],se=[],le=function(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=n);for(var i=a(),o=new Array(e),u=[],f=new Array(e),c=0;e>c;c++)o[c]=0,f[c]=[];return{columnCount:e,columnWidth:t,set:function(c,a){void 0===a&&(a=0);var s=c%e,l=o[s]||0;o[s]=l+a+r,f[s].push(c),u[c]={left:s*(t+n),top:l,height:a,column:s},i.insert(l,l+a,c)},get:function(e){return u[e]},update:function(t){for(var n=new Array(e),c=0,a=0;c<t.length-1;c++){var s=t[c],l=u[s];l.height=t[++c],i.remove(s),i.insert(l.top,l.top+l.height,s),n[l.column]=void 0===n[l.column]?s:Math.min(s,n[l.column])}for(c=0;c<n.length;c++)if(void 0!==n[c]){var v=f[c],d=ve(v,n[c]),h=f[c][d],p=u[h];for(o[c]=p.top+p.height+r,a=d+1;a<v.length;a++){var m=v[a],g=u[m];g.top=o[c],o[c]=g.top+g.height+r,i.remove(m),i.insert(g.top,g.top+g.height,m)}}},range:function(e,t,n){return i.search(e,t,(function(e,t){return n(e,u[e].left,t)}))},estimateHeight:function(t,n){var r=Math.max(0,Math.max.apply(null,o));return t===i.size?r:r+Math.ceil((t-i.size)/e)*n},shortestColumn:function(){return o.length>1?Math.min.apply(null,o):o[0]||0},size:function(){return i.size},all:function(){return u}}},ve=function(e,t){for(var n=0,r=e.length-1;r>=n;){var i=n+r>>>1,o=e[i];if(o===t)return i;o>t?r=i-1:n=i+1}return-1},de=function(e,t,n,r,i,o){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=8),r=r||Math.min(Math.floor((e+n)/(t+n)),i||1/0)||1;var u=Math.floor((e-n*(r-1))/r);return void 0!==o&&u>o&&(u=o),[u,r]},he=[],pe=function(e){function t(){r=null,e.apply(void 0,n)}var n=[],r=null,i=function(){for(var e=arguments.length,i=new Array(e),o=0;e>o;o++)i[o]=arguments[o];n=i,r||(r=requestAnimationFrame(t))};return i.cancel=function(){r&&(cancelAnimationFrame(r),r=null)},i},me=A([WeakMap],(function(e,t){var n=[],r=pe((function(){n.length>0&&(e.update(n),t(n)),n.length=0})),i=function(t){var i=t.offsetHeight;if(i>0){var o=B.get(t);if(void 0!==o){var u=e.get(o);void 0!==u&&i!==u.height&&n.push(o,i)}}r()},o=new Map,u=new ResizeObserver((function(e){for(var t=0;t<e.length;t++){var n=e[t],r=B.get(n.target);if(void 0!==r){var u=o.get(r);u||(u=pe(i),o.set(r,u)),u(n.target)}}})),f=u.disconnect.bind(u);return u.disconnect=function(){f(),o.forEach(R)},u})),ge={index:void 0,position:void 0,prevTop:void 0},Pe=L.createElement,xe=L.createElement,ye=function(e,t){return void 0!==t[e]},Re={};e.List=function(e){return xe(C,s({role:"list",rowGutter:e.rowGutter,columnCount:1,columnWidth:1},e))},e.Masonry=C,e.MasonryScroller=g,e.createIntervalTree=a,e.createPositioner=le,e.createResizeObserver=me,e.useContainerPosition=P,e.useInfiniteLoader=function(e,t){void 0===t&&(t=Re);var n=t,r=n.isItemLoaded,i=n.minimumBatchSize,o=void 0===i?16:i,u=n.threshold,f=void 0===u?16:u,c=n.totalItems,a=void 0===c?9e9:c,s=T(e),l=T(r);return L.useCallback((function(e,t,n){for(var r=function(e,t,n,r,i,o){void 0===e&&(e=ye),void 0===t&&(t=16),void 0===r&&(r=9e9);for(var u,f,c=[],a=i;o>=a;a++)e(a,n)?void 0!==u&&void 0!==f&&(c.push(u,f),u=f=void 0):(f=a,void 0===u&&(u=a));if(void 0!==u&&void 0!==f){var s=Math.min(Math.max(f,u+t-1),r-1);for(a=f+1;s>=a&&!e(a,n);a++)f=a;c.push(u,f)}if(c.length)for(var l=c[0],v=c[1];t>v-l+1&&l>0;){var d=l-1;if(e(d,n))break;c[0]=l=d}return c}(l.current,o,n,a,Math.max(0,e-f),Math.min(a-1,(t||0)+f)),i=0;i<r.length-1;++i)s.current(r[i],r[++i],n)}),[a,o,f,s,l])},e.useMasonry=d,e.usePositioner=x,e.useResizeObserver=y,e.useScrollToIndex=w,e.useScroller=m,Object.defineProperty(e,"__esModule",{value:1})}));
 //# sourceMappingURL=masonic.js.map
diff --git a/dist/umd/masonic.js.map b/dist/umd/masonic.js.map
index 824f30517c5acd00cfcd73d2840c352a2818c098..ef4ac9792cde35a3f79288776bfa2972e7c22675 100644
--- a/dist/umd/masonic.js.map
+++ b/dist/umd/masonic.js.map
@@ -1 +1 @@
-{"version":3,"file":"masonic.js","sources":["../../src/interval-tree.ts","../../node_modules/.pnpm/@react-hook+event@1.2.6_react@17.0.2/node_modules/@react-hook/event/src/index.tsx","../../src/use-force-update.ts","../../src/use-masonry.tsx","../../node_modules/.pnpm/@react-hook+throttle@2.2.0_react@17.0.2/node_modules/@react-hook/throttle/src/index.tsx","../../src/use-scroller.ts","../../node_modules/.pnpm/@essentials+request-timeout@1.3.0/node_modules/@essentials/request-timeout/src/index.ts","../../src/masonry-scroller.tsx","../../src/use-container-position.ts","../../src/use-positioner.ts","../../src/use-resize-observer.ts","../../src/use-scroll-to-index.ts","../../src/masonry.tsx","../../node_modules/.pnpm/@react-hook+window-size@3.1.1_react@17.0.2/node_modules/@react-hook/window-size/src/index.tsx","../../node_modules/.pnpm/@react-hook+debounce@3.0.0_react@17.0.2/node_modules/@react-hook/debounce/src/index.tsx","../../node_modules/.pnpm/@react-hook+latest@1.0.3_react@17.0.2/node_modules/@react-hook/latest/src/index.tsx","../../node_modules/.pnpm/@essentials+memoize-one@1.1.0/node_modules/@essentials/memoize-one/src/index.ts","../../node_modules/.pnpm/@essentials+one-key-map@1.2.0/node_modules/@essentials/one-key-map/src/index.ts","../../node_modules/.pnpm/trie-memoize@1.2.0/node_modules/trie-memoize/src/index.ts","../../src/elements-cache.ts","../../node_modules/.pnpm/@essentials+raf@1.2.0/node_modules/@essentials/raf/src/index.ts","../../node_modules/.pnpm/@react-hook+window-scroll@1.3.0_react@17.0.2/node_modules/@react-hook/window-scroll/src/index.tsx","../../node_modules/.pnpm/@react-hook+passive-layout-effect@1.2.1_react@17.0.2/node_modules/@react-hook/passive-layout-effect/src/index.tsx","../../node_modules/.pnpm/raf-schd@4.0.3/node_modules/raf-schd/dist/raf-schd.esm.js","../../src/use-infinite-loader.ts","../../src/list.tsx"],"sourcesContent":["type Color = 0 | 1 | 2;\nconst RED = 0;\nconst BLACK = 1;\nconst NIL = 2;\n\nconst DELETE = 0;\nconst KEEP = 1;\n\ntype ListNode = {\n  index: number;\n  high: number;\n  next: ListNode | null;\n};\n\ninterface TreeNode {\n  max: number;\n  low: number;\n  high: number;\n  // color\n  C: Color;\n  // P\n  P: TreeNode;\n  // right\n  R: TreeNode;\n  // left\n  L: TreeNode;\n  list: ListNode;\n}\n\ninterface Tree {\n  root: TreeNode;\n  size: number;\n}\n\nfunction addInterval(treeNode: TreeNode, high: number, index: number): boolean {\n  let node: ListNode | null = treeNode.list;\n  let prevNode: ListNode | undefined;\n\n  while (node) {\n    if (node.index === index) return false;\n    if (high > node.high) break;\n    prevNode = node;\n    node = node.next;\n  }\n\n  if (!prevNode) treeNode.list = { index, high, next: node };\n  if (prevNode) prevNode.next = { index, high, next: prevNode.next };\n\n  return true;\n}\n\nfunction removeInterval(treeNode: TreeNode, index: number) {\n  let node: ListNode | null = treeNode.list;\n  if (node.index === index) {\n    if (node.next === null) return DELETE;\n    treeNode.list = node.next;\n    return KEEP;\n  }\n\n  let prevNode: ListNode | undefined = node;\n  node = node.next;\n\n  while (node !== null) {\n    if (node.index === index) {\n      prevNode.next = node.next;\n      return KEEP;\n    }\n    prevNode = node;\n    node = node.next;\n  }\n}\n\nconst NULL_NODE: TreeNode = {\n  low: 0,\n  max: 0,\n  high: 0,\n  C: NIL,\n  // @ts-expect-error\n  P: undefined,\n  // @ts-expect-error\n  R: undefined,\n  // @ts-expect-error\n  L: undefined,\n  // @ts-expect-error\n  list: undefined,\n};\n\nNULL_NODE.P = NULL_NODE;\nNULL_NODE.L = NULL_NODE;\nNULL_NODE.R = NULL_NODE;\n\nfunction updateMax(node: TreeNode) {\n  const max = node.high;\n  if (node.L === NULL_NODE && node.R === NULL_NODE) node.max = max;\n  else if (node.L === NULL_NODE) node.max = Math.max(node.R.max, max);\n  else if (node.R === NULL_NODE) node.max = Math.max(node.L.max, max);\n  else node.max = Math.max(Math.max(node.L.max, node.R.max), max);\n}\n\nfunction updateMaxUp(node: TreeNode) {\n  let x = node;\n\n  while (x.P !== NULL_NODE) {\n    updateMax(x.P);\n    x = x.P;\n  }\n}\n\nfunction rotateLeft(tree: Tree, x: TreeNode) {\n  if (x.R === NULL_NODE) return;\n  const y = x.R;\n  x.R = y.L;\n  if (y.L !== NULL_NODE) y.L.P = x;\n  y.P = x.P;\n\n  if (x.P === NULL_NODE) tree.root = y;\n  else if (x === x.P.L) x.P.L = y;\n  else x.P.R = y;\n\n  y.L = x;\n  x.P = y;\n\n  updateMax(x);\n  updateMax(y);\n}\n\nfunction rotateRight(tree: Tree, x: TreeNode) {\n  if (x.L === NULL_NODE) return;\n  const y = x.L;\n  x.L = y.R;\n  if (y.R !== NULL_NODE) y.R.P = x;\n  y.P = x.P;\n\n  if (x.P === NULL_NODE) tree.root = y;\n  else if (x === x.P.R) x.P.R = y;\n  else x.P.L = y;\n\n  y.R = x;\n  x.P = y;\n\n  updateMax(x);\n  updateMax(y);\n}\n\nfunction replaceNode(tree: Tree, x: TreeNode, y: TreeNode) {\n  if (x.P === NULL_NODE) tree.root = y;\n  else if (x === x.P.L) x.P.L = y;\n  else x.P.R = y;\n  y.P = x.P;\n}\n\nfunction fixRemove(tree: Tree, x: TreeNode) {\n  let w;\n\n  while (x !== NULL_NODE && x.C === BLACK) {\n    if (x === x.P.L) {\n      w = x.P.R;\n\n      if (w.C === RED) {\n        w.C = BLACK;\n        x.P.C = RED;\n        rotateLeft(tree, x.P);\n        w = x.P.R;\n      }\n\n      if (w.L.C === BLACK && w.R.C === BLACK) {\n        w.C = RED;\n        x = x.P;\n      } else {\n        if (w.R.C === BLACK) {\n          w.L.C = BLACK;\n          w.C = RED;\n          rotateRight(tree, w);\n          w = x.P.R;\n        }\n\n        w.C = x.P.C;\n        x.P.C = BLACK;\n        w.R.C = BLACK;\n        rotateLeft(tree, x.P);\n        x = tree.root;\n      }\n    } else {\n      w = x.P.L;\n\n      if (w.C === RED) {\n        w.C = BLACK;\n        x.P.C = RED;\n        rotateRight(tree, x.P);\n        w = x.P.L;\n      }\n\n      if (w.R.C === BLACK && w.L.C === BLACK) {\n        w.C = RED;\n        x = x.P;\n      } else {\n        if (w.L.C === BLACK) {\n          w.R.C = BLACK;\n          w.C = RED;\n          rotateLeft(tree, w);\n          w = x.P.L;\n        }\n\n        w.C = x.P.C;\n        x.P.C = BLACK;\n        w.L.C = BLACK;\n        rotateRight(tree, x.P);\n        x = tree.root;\n      }\n    }\n  }\n\n  x.C = BLACK;\n}\n\nfunction minimumTree(x: TreeNode) {\n  while (x.L !== NULL_NODE) x = x.L;\n  return x;\n}\n\nfunction fixInsert(tree: Tree, z: TreeNode) {\n  let y: TreeNode;\n  while (z.P.C === RED) {\n    if (z.P === z.P.P.L) {\n      y = z.P.P.R;\n\n      if (y.C === RED) {\n        z.P.C = BLACK;\n        y.C = BLACK;\n        z.P.P.C = RED;\n        z = z.P.P;\n      } else {\n        if (z === z.P.R) {\n          z = z.P;\n          rotateLeft(tree, z);\n        }\n\n        z.P.C = BLACK;\n        z.P.P.C = RED;\n        rotateRight(tree, z.P.P);\n      }\n    } else {\n      y = z.P.P.L;\n\n      if (y.C === RED) {\n        z.P.C = BLACK;\n        y.C = BLACK;\n        z.P.P.C = RED;\n        z = z.P.P;\n      } else {\n        if (z === z.P.L) {\n          z = z.P;\n          rotateRight(tree, z);\n        }\n\n        z.P.C = BLACK;\n        z.P.P.C = RED;\n        rotateLeft(tree, z.P.P);\n      }\n    }\n  }\n  tree.root.C = BLACK;\n}\n\nexport interface IIntervalTree {\n  insert(low: number, high: number, index: number): void;\n  remove(index: number): void;\n  search(\n    low: number,\n    high: number,\n    callback: (index: number, low: number) => any\n  ): void;\n  size: number;\n}\n\nexport function createIntervalTree(): IIntervalTree {\n  const tree = {\n    root: NULL_NODE,\n    size: 0,\n  };\n  // we know these indexes are a consistent, safe way to make look ups\n  // for our case so it's a solid O(1) alternative to\n  // the O(log n) searchNode() in typical interval trees\n  const indexMap: Record<number, TreeNode> = {};\n\n  return {\n    insert(low, high, index) {\n      let x: TreeNode = tree.root;\n      let y: TreeNode = NULL_NODE;\n\n      while (x !== NULL_NODE) {\n        y = x;\n        if (low === y.low) break;\n        if (low < x.low) x = x.L;\n        else x = x.R;\n      }\n\n      if (low === y.low && y !== NULL_NODE) {\n        if (!addInterval(y, high, index)) return;\n        y.high = Math.max(y.high, high);\n        updateMax(y);\n        updateMaxUp(y);\n        indexMap[index] = y;\n        tree.size++;\n        return;\n      }\n\n      const z: TreeNode = {\n        low,\n        high,\n        max: high,\n        C: RED,\n        P: y,\n        L: NULL_NODE,\n        R: NULL_NODE,\n        list: { index, high, next: null },\n      };\n\n      if (y === NULL_NODE) {\n        tree.root = z;\n      } else {\n        if (z.low < y.low) y.L = z;\n        else y.R = z;\n        updateMaxUp(z);\n      }\n\n      fixInsert(tree, z);\n      indexMap[index] = z;\n      tree.size++;\n    },\n\n    remove(index) {\n      const z = indexMap[index];\n      if (z === void 0) return;\n      delete indexMap[index];\n\n      const intervalResult = removeInterval(z, index);\n      if (intervalResult === void 0) return;\n      if (intervalResult === KEEP) {\n        z.high = z.list.high;\n        updateMax(z);\n        updateMaxUp(z);\n        tree.size--;\n        return;\n      }\n\n      let y = z;\n      let originalYColor = y.C;\n      let x: TreeNode;\n\n      if (z.L === NULL_NODE) {\n        x = z.R;\n        replaceNode(tree, z, z.R);\n      } else if (z.R === NULL_NODE) {\n        x = z.L;\n        replaceNode(tree, z, z.L);\n      } else {\n        y = minimumTree(z.R);\n        originalYColor = y.C;\n        x = y.R;\n\n        if (y.P === z) {\n          x.P = y;\n        } else {\n          replaceNode(tree, y, y.R);\n          y.R = z.R;\n          y.R.P = y;\n        }\n\n        replaceNode(tree, z, y);\n        y.L = z.L;\n        y.L.P = y;\n        y.C = z.C;\n      }\n\n      updateMax(x);\n      updateMaxUp(x);\n\n      if (originalYColor === BLACK) fixRemove(tree, x);\n      tree.size--;\n    },\n\n    search(low, high, callback) {\n      const stack = [tree.root];\n      while (stack.length !== 0) {\n        const node = stack.pop() as TreeNode;\n        if (node === NULL_NODE || low > node.max) continue;\n        if (node.L !== NULL_NODE) stack.push(node.L);\n        if (node.R !== NULL_NODE) stack.push(node.R);\n        if (node.low <= high && node.high >= low) {\n          let curr: ListNode | null = node.list;\n          while (curr !== null) {\n            if (curr.high >= low) callback(curr.index, node.low);\n            curr = curr.next;\n          }\n        }\n      }\n    },\n\n    get size() {\n      return tree.size;\n    },\n  };\n}\n","import * as React from 'react'\n\nfunction useEvent<\n  T extends Window = Window,\n  K extends keyof WindowEventMap = keyof WindowEventMap\n>(\n  target: Window | null,\n  type: K,\n  listener: WindowEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent<\n  T extends Document = Document,\n  K extends keyof DocumentEventMap = keyof DocumentEventMap\n>(\n  target: Document | null,\n  type: K,\n  listener: DocumentEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent<\n  T extends HTMLElement = HTMLElement,\n  K extends keyof HTMLElementEventMap = keyof HTMLElementEventMap\n>(\n  target: React.RefObject<T> | T | null,\n  type: K,\n  listener: ElementEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent(target: any, type: any, listener: any, cleanup: any): void {\n  const storedListener = React.useRef(listener)\n  const storedCleanup = React.useRef(cleanup)\n\n  React.useEffect(() => {\n    storedListener.current = listener\n    storedCleanup.current = cleanup\n  })\n\n  React.useEffect(() => {\n    const targetEl = target && 'current' in target ? target.current : target\n    if (!targetEl) return\n\n    let didUnsubscribe = 0\n    function listener(this: any, ...args: any[]) {\n      if (didUnsubscribe) return\n      storedListener.current.apply(this, args)\n    }\n\n    targetEl.addEventListener(type, listener)\n    const cleanup = storedCleanup.current\n\n    return () => {\n      didUnsubscribe = 1\n      targetEl.removeEventListener(type, listener)\n      cleanup && cleanup()\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [target, type])\n}\n\nexport type ElementEventListener<\n  K extends keyof HTMLElementEventMap = keyof HTMLElementEventMap\n> = (this: HTMLElement, ev: HTMLElementEventMap[K]) => any\n\nexport type DocumentEventListener<\n  K extends keyof DocumentEventMap = keyof DocumentEventMap\n> = (this: Document, ev: DocumentEventMap[K]) => any\n\nexport type WindowEventListener<\n  K extends keyof WindowEventMap = keyof WindowEventMap\n> = (this: Document, ev: WindowEventMap[K]) => any\n\nexport default useEvent\n","import * as React from \"react\";\n\nexport function useForceUpdate() {\n  const setState = React.useState(emptyObj)[1];\n  return React.useRef(() => setState({})).current;\n}\n\nconst emptyObj = {};\n","import memoizeOne from \"@essentials/memoize-one\";\nimport OneKeyMap from \"@essentials/one-key-map\";\nimport useLatest from \"@react-hook/latest\";\nimport * as React from \"react\";\nimport trieMemoize from \"trie-memoize\";\nimport { elementsCache } from \"./elements-cache\";\nimport { useForceUpdate } from \"./use-force-update\";\nimport type { Positioner } from \"./use-positioner\";\n\n/**\n * This hook handles the render phases of the masonry layout and returns the grid as a React element.\n *\n * @param options - Options for configuring the masonry layout renderer. See `UseMasonryOptions`.\n * @param options.positioner\n * @param options.resizeObserver\n * @param options.items\n * @param options.as\n * @param options.id\n * @param options.className\n * @param options.style\n * @param options.role\n * @param options.tabIndex\n * @param options.containerRef\n * @param options.itemAs\n * @param options.itemStyle\n * @param options.itemHeightEstimate\n * @param options.itemKey\n * @param options.overscanBy\n * @param options.scrollTop\n * @param options.isScrolling\n * @param options.height\n * @param options.render\n * @param options.onRender\n */\nexport function useMasonry<Item>({\n  // Measurement and layout\n  positioner,\n  resizeObserver,\n  // Grid items\n  items,\n  // Container props\n  as: ContainerComponent = \"div\",\n  id,\n  className,\n  style,\n  role = \"grid\",\n  tabIndex = 0,\n  containerRef,\n  // Item props\n  itemAs: ItemComponent = \"div\",\n  itemStyle,\n  itemHeightEstimate = 300,\n  itemKey = defaultGetItemKey,\n  // Rendering props\n  overscanBy = 2,\n  scrollTop,\n  isScrolling,\n  height,\n  render: RenderComponent,\n  onRender,\n}: UseMasonryOptions<Item>) {\n  let startIndex = 0;\n  let stopIndex: number | undefined;\n  const forceUpdate = useForceUpdate();\n  const setItemRef = getRefSetter(positioner, resizeObserver);\n  const itemCount = items.length;\n  const {\n    columnWidth,\n    columnCount,\n    range,\n    estimateHeight,\n    size,\n    shortestColumn,\n  } = positioner;\n  const measuredCount = size();\n  const shortestColumnSize = shortestColumn();\n  const children: React.ReactElement[] = [];\n  const itemRole =\n    role === \"list\" ? \"listitem\" : role === \"grid\" ? \"gridcell\" : undefined;\n  const storedOnRender = useLatest(onRender);\n\n  overscanBy = height * overscanBy;\n  const rangeEnd = scrollTop + overscanBy;\n  const needsFreshBatch =\n    shortestColumnSize < rangeEnd && measuredCount < itemCount;\n\n  range(\n    // We overscan in both directions because users scroll both ways,\n    // though one must admit scrolling down is more common and thus\n    // we only overscan by half the downward overscan amount\n    Math.max(0, scrollTop - overscanBy / 2),\n    rangeEnd,\n    (index, left, top) => {\n      const data = items[index];\n      const key = itemKey(data, index);\n      const phaseTwoStyle: React.CSSProperties = {\n        top,\n        left,\n        width: columnWidth,\n        writingMode: \"horizontal-tb\",\n        position: \"absolute\",\n      };\n\n      /* istanbul ignore next */\n      if (\n        typeof process !== \"undefined\" &&\n        process.env.NODE_ENV !== \"production\"\n      ) {\n        throwWithoutData(data, index);\n      }\n\n      children.push(\n        <ItemComponent\n          key={key}\n          ref={setItemRef(index)}\n          role={itemRole}\n          style={\n            typeof itemStyle === \"object\" && itemStyle !== null\n              ? Object.assign({}, phaseTwoStyle, itemStyle)\n              : phaseTwoStyle\n          }\n        >\n          {createRenderElement(RenderComponent, index, data, columnWidth)}\n        </ItemComponent>\n      );\n\n      if (stopIndex === void 0) {\n        startIndex = index;\n        stopIndex = index;\n      } else {\n        startIndex = Math.min(startIndex, index);\n        stopIndex = Math.max(stopIndex, index);\n      }\n    }\n  );\n\n  if (needsFreshBatch) {\n    const batchSize = Math.min(\n      itemCount - measuredCount,\n      Math.ceil(\n        ((scrollTop + overscanBy - shortestColumnSize) / itemHeightEstimate) *\n          columnCount\n      )\n    );\n\n    let index = measuredCount;\n    const phaseOneStyle = getCachedSize(columnWidth);\n\n    for (; index < measuredCount + batchSize; index++) {\n      const data = items[index];\n      const key = itemKey(data, index);\n\n      /* istanbul ignore next */\n      if (\n        typeof process !== \"undefined\" &&\n        process.env.NODE_ENV !== \"production\"\n      ) {\n        throwWithoutData(data, index);\n      }\n\n      children.push(\n        <ItemComponent\n          key={key}\n          ref={setItemRef(index)}\n          role={itemRole}\n          style={\n            typeof itemStyle === \"object\"\n              ? Object.assign({}, phaseOneStyle, itemStyle)\n              : phaseOneStyle\n          }\n        >\n          {createRenderElement(RenderComponent, index, data, columnWidth)}\n        </ItemComponent>\n      );\n    }\n  }\n\n  // Calls the onRender callback if the rendered indices changed\n  React.useEffect(() => {\n    if (typeof storedOnRender.current === \"function\" && stopIndex !== void 0)\n      storedOnRender.current(startIndex, stopIndex, items);\n\n    didEverMount = \"1\";\n  }, [startIndex, stopIndex, items, storedOnRender]);\n  // If we needed a fresh batch we should reload our components with the measured\n  // sizes\n  React.useEffect(() => {\n    if (needsFreshBatch) forceUpdate();\n    // eslint-disable-next-line\n  }, [needsFreshBatch, positioner]);\n\n  // gets the container style object based upon the estimated height and whether or not\n  // the page is being scrolled\n  const containerStyle = getContainerStyle(\n    isScrolling,\n    estimateHeight(itemCount, itemHeightEstimate)\n  );\n\n  return (\n    <ContainerComponent\n      ref={containerRef}\n      key={didEverMount}\n      id={id}\n      role={role}\n      className={className}\n      tabIndex={tabIndex}\n      style={\n        typeof style === \"object\"\n          ? assignUserStyle(containerStyle, style)\n          : containerStyle\n      }\n      children={children}\n    />\n  );\n}\n\n/* istanbul ignore next */\nfunction throwWithoutData(data: any, index: number) {\n  if (!data) {\n    throw new Error(\n      `No data was found at index: ${index}\\n\\n` +\n        `This usually happens when you've mutated or changed the \"items\" array in a ` +\n        `way that makes it shorter than the previous \"items\" array. Masonic knows nothing ` +\n        `about your underlying data and when it caches cell positions, it assumes you aren't ` +\n        `mutating the underlying \"items\".\\n\\n` +\n        `See https://codesandbox.io/s/masonic-w-react-router-example-2b5f9?file=/src/index.js for ` +\n        `an example that gets around this limitations. For advanced implementations, see ` +\n        `https://codesandbox.io/s/masonic-w-react-router-and-advanced-config-example-8em42?file=/src/index.js\\n\\n` +\n        `If this was the result of your removing an item from your \"items\", see this issue: ` +\n        `https://github.com/jaredLunde/masonic/issues/12`\n    );\n  }\n}\n\n// This is for triggering a remount after SSR has loaded in the client w/ hydrate()\nlet didEverMount = \"0\";\n\nexport interface UseMasonryOptions<Item> {\n  /**\n   * An array containing the data used by the grid items.\n   */\n  items: Item[];\n  /**\n   * A grid cell positioner and cache created by the `usePositioner()` hook or\n   * the `createPositioner` utility.\n   */\n  positioner: Positioner;\n  /**\n   * A resize observer that tracks mutations to the grid cells and forces the\n   * Masonry grid to recalculate its layout if any cells affect column heights\n   * change. Check out the `useResizeObserver()` hook.\n   */\n  resizeObserver?: {\n    observe: ResizeObserver[\"observe\"];\n    disconnect: ResizeObserver[\"observe\"];\n    unobserve: ResizeObserver[\"unobserve\"];\n  };\n  /**\n   * This is the type of element the grid container will be rendered as.\n   *\n   * @default \"div\"`\n   */\n  as?: keyof JSX.IntrinsicElements | React.ComponentType<any>;\n  /**\n   * Optionally gives the grid container an `id` prop.\n   */\n  id?: string;\n  /**\n   * Optionally gives the grid container a `className` prop.\n   */\n  className?: string;\n  /**\n   * Adds extra `style` attributes to the container in addition to those\n   * created by the `useMasonry()` hook.\n   */\n  style?: React.CSSProperties;\n  /**\n   * Optionally swap out the accessibility `role` prop of the container and its items.\n   *\n   * @default \"grid\"\n   */\n  role?: \"grid\" | \"list\";\n  /**\n   * Change the `tabIndex` of the grid container.\n   *\n   * @default 0\n   */\n  tabIndex?: number;\n  /**\n   * Forwards a React ref to the grid container.\n   */\n  containerRef?:\n    | ((element: HTMLElement) => void)\n    | React.MutableRefObject<HTMLElement | null>;\n  /**\n   * This is the type of element the grid items will be rendered as.\n   *\n   * @default \"div\"\n   */\n  itemAs?: keyof JSX.IntrinsicElements | React.ComponentType<any>;\n  /**\n   * Adds extra `style` attributes to the grid items in addition to those\n   * created by the `useMasonry()` hook.\n   */\n  itemStyle?: React.CSSProperties;\n  /**\n   * This value is used for estimating the initial height of the masonry grid. It is important for\n   * the UX of the scrolling behavior and in determining how many `items` to render in a batch, so it's\n   * wise to set this value with some level accuracy, though it doesn't need to be perfect.\n   *\n   * @default 300\n   */\n  itemHeightEstimate?: number;\n  /**\n   * The value returned here must be unique to the item. By default, the key is the item's index. This is ok\n   * if your collection of items is never modified. Setting this property ensures that the component in `render`\n   * is reused each time the masonry grid is reflowed. A common pattern would be to return the item's database\n   * ID here if there is one, e.g. `data => data.id`\n   *\n   * @default (data, index) => index`\n   */\n  itemKey?: (data: Item, index: number) => string | number;\n  /**\n   * This number is used for determining the number of grid cells outside of the visible window to render.\n   * The default value is `2` which means \"render 2 windows worth (2 * `height`) of content before and after\n   * the items in the visible window\". A value of `3` would be 3 windows worth of grid cells, so it's a\n   * linear relationship.\n   *\n   * Overscanning is important for preventing tearing when scrolling through items in the grid, but setting\n   * too high of a vaimport { useForceUpdate } from './use-force-update';\nlue may create too much work for React to handle, so it's best that you tune this\n   * value accordingly.\n   *\n   * @default 2\n   */\n  overscanBy?: number;\n\n  /**\n   * This is the height of the window. If you're rendering the grid relative to the browser `window`,\n   * the current `document.documentElement.clientHeight` is the value you'll want to set here. If you're\n   * rendering the grid inside of another HTML element, you'll want to provide the current `element.offsetHeight`\n   * here.\n   */\n  height: number;\n  /**\n   * The current scroll progress in pixel of the window the grid is rendered in. If you're rendering\n   * the grid relative to the browser `window`, you'll want the most current `window.scrollY` here.\n   * If you're rendering the grid inside of another HTML element, you'll want the current `element.scrollTop`\n   * value here. The `useScroller()` hook and `<MasonryScroller>` components will help you if you're\n   * rendering the grid relative to the browser `window`.\n   */\n  scrollTop: number;\n  /**\n   * This property is used for determining whether or not the grid container should add styles that\n   * dramatically increase scroll performance. That is, turning off `pointer-events` and adding a\n   * `will-change: contents;` value to the style string. You can forgo using this prop, but I would\n   * not recommend that. The `useScroller()` hook and `<MasonryScroller>` components will help you if\n   * you're rendering the grid relative to the browser `window`.\n   *\n   * @default false\n   */\n  isScrolling?: boolean;\n  /**\n   * This component is rendered for each item of your `items` prop array. It should accept three props:\n   * `index`, `width`, and `data`. See RenderComponentProps.\n   */\n  render: React.ComponentType<RenderComponentProps<Item>>;\n  /**\n   * This callback is invoked any time the items currently being rendered by the grid change.\n   */\n  onRender?: (startIndex: number, stopIndex: number, items: Item[]) => void;\n}\n\nexport interface RenderComponentProps<Item> {\n  /**\n   * The index of the cell in the `items` prop array.\n   */\n  index: number;\n  /**\n   * The rendered width of the cell's column.\n   */\n  width: number;\n  /**\n   * The data at `items[index]` of your `items` prop array.\n   */\n  data: Item;\n}\n\n//\n// Render-phase utilities\n\n// ~5.5x faster than createElement without the memo\nconst createRenderElement = trieMemoize(\n  [OneKeyMap, {}, WeakMap, OneKeyMap],\n  (RenderComponent, index, data, columnWidth) => (\n    <RenderComponent index={index} data={data} width={columnWidth} />\n  )\n);\n\nconst getContainerStyle = memoizeOne(\n  (isScrolling: boolean | undefined, estimateHeight: number) => ({\n    position: \"relative\",\n    width: \"100%\",\n    maxWidth: \"100%\",\n    height: Math.ceil(estimateHeight),\n    maxHeight: Math.ceil(estimateHeight),\n    willChange: isScrolling ? \"contents\" : void 0,\n    pointerEvents: isScrolling ? \"none\" : void 0,\n  })\n);\n\nconst cmp2 = (args: IArguments, pargs: IArguments | any[]): boolean =>\n  args[0] === pargs[0] && args[1] === pargs[1];\n\nconst assignUserStyle = memoizeOne(\n  (containerStyle, userStyle) => Object.assign({}, containerStyle, userStyle),\n  // @ts-expect-error\n  cmp2\n);\n\nfunction defaultGetItemKey<Item>(_: Item, i: number) {\n  return i;\n}\n\n// the below memoizations for for ensuring shallow equal is reliable for pure\n// component children\nconst getCachedSize = memoizeOne(\n  (width: number): React.CSSProperties => ({\n    width,\n    zIndex: -1000,\n    visibility: \"hidden\",\n    position: \"absolute\",\n    writingMode: \"horizontal-tb\",\n  }),\n  (args, pargs) => args[0] === pargs[0]\n);\n\nconst getRefSetter = memoizeOne(\n  (\n      positioner: Positioner,\n      resizeObserver?: UseMasonryOptions<any>[\"resizeObserver\"]\n    ) =>\n    (index: number) =>\n    (el: HTMLElement | null): void => {\n      if (el === null) return;\n      if (resizeObserver) {\n        resizeObserver.observe(el);\n        elementsCache.set(el, index);\n      }\n      if (positioner.get(index) === void 0)\n        positioner.set(index, el.offsetHeight);\n    },\n  // @ts-expect-error\n  cmp2\n);\n","import * as React from 'react'\nimport useLatest from '@react-hook/latest'\n\nconst perf = typeof performance !== 'undefined' ? performance : Date\nconst now = () => perf.now()\n\nexport function useThrottleCallback<CallbackArguments extends any[]>(\n  callback: (...args: CallbackArguments) => void,\n  fps = 30,\n  leading = false\n): (...args: CallbackArguments) => void {\n  const storedCallback = useLatest(callback)\n  const ms = 1000 / fps\n  const prev = React.useRef(0)\n  const trailingTimeout = React.useRef<ReturnType<typeof setTimeout>>()\n  const clearTrailing = () =>\n    trailingTimeout.current && clearTimeout(trailingTimeout.current)\n  const deps = [fps, leading, storedCallback]\n\n  // Reset any time the deps change\n  React.useEffect(\n    () => () => {\n      prev.current = 0\n      clearTrailing()\n    },\n    deps\n  )\n\n  return React.useCallback(function () {\n    // eslint-disable-next-line prefer-rest-params\n    const args = arguments\n    const rightNow = now()\n    const call = () => {\n      prev.current = rightNow\n      clearTrailing()\n      storedCallback.current.apply(null, args as any)\n    }\n    const current = prev.current\n    // leading\n    if (leading && current === 0) return call()\n    // body\n    if (rightNow - current > ms) {\n      if (current > 0) return call()\n      prev.current = rightNow\n    }\n    // trailing\n    clearTrailing()\n    trailingTimeout.current = setTimeout(() => {\n      call()\n      prev.current = 0\n    }, ms)\n  }, deps)\n}\n\nexport function useThrottle<State>(\n  initialState: State | (() => State),\n  fps?: number,\n  leading?: boolean\n): [State, React.Dispatch<React.SetStateAction<State>>] {\n  const state = React.useState<State>(initialState)\n  return [state[0], useThrottleCallback(state[1], fps, leading)]\n}\n","import {\n  clearRequestTimeout,\n  requestTimeout,\n} from \"@essentials/request-timeout\";\nimport useScrollPosition from \"@react-hook/window-scroll\";\nimport * as React from \"react\";\n\n/**\n * A hook for tracking whether the `window` is currently being scrolled and it's scroll position on\n * the y-axis. These values are used for determining which grid cells to render and when\n * to add styles to the masonry container that maximize scroll performance.\n *\n * @param offset - The vertical space in pixels between the top of the grid container and the top\n *  of the browser `document.documentElement`.\n * @param fps - This determines how often (in frames per second) to update the scroll position of the\n *  browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\n *  The default value of `12` has been very reasonable in my own testing, but if you have particularly\n *  heavy `render` components it may be prudent to reduce this number.\n */\nexport function useScroller(\n  offset = 0,\n  fps = 12\n): { scrollTop: number; isScrolling: boolean } {\n  const scrollTop = useScrollPosition(fps);\n  const [isScrolling, setIsScrolling] = React.useState(false);\n  const didMount = React.useRef(0);\n\n  React.useEffect(() => {\n    if (didMount.current === 1) setIsScrolling(true);\n    let didUnsubscribe = false;\n    const to = requestTimeout(() => {\n      if (didUnsubscribe) return;\n      // This is here to prevent premature bail outs while maintaining high resolution\n      // unsets. Without it there will always bee a lot of unnecessary DOM writes to style.\n      setIsScrolling(false);\n    }, 40 + 1000 / fps);\n    didMount.current = 1;\n    return () => {\n      didUnsubscribe = true;\n      clearRequestTimeout(to);\n    };\n  }, [fps, scrollTop]);\n\n  return { scrollTop: Math.max(0, scrollTop - offset), isScrolling };\n}\n","/**\n * Copyright 2011, Joe Lambert.\n * Free to use under the MIT license.\n * http://www.opensource.org/licenses/mit-license.php\n **/\nimport {raf, caf, now} from '@essentials/raf'\n\nexport interface RequestTimeoutHandle {\n  v?: number\n}\n\nexport const clearRequestTimeout = (handle: RequestTimeoutHandle): void => {\n  caf(handle.v || -1)\n}\n\nexport const requestTimeout = (\n  fn: (...args: any[]) => void,\n  ms: number\n): RequestTimeoutHandle => {\n  const start = now(),\n    handle: RequestTimeoutHandle = {}\n\n  const loop = () => {\n    now() - start >= ms ? fn.call(null) : (handle.v = raf(loop))\n  }\n\n  handle.v = raf(loop)\n  return handle\n}\n\nexport default requestTimeout\n","import { useMasonry } from \"./use-masonry\";\nimport type { UseMasonryOptions } from \"./use-masonry\";\nimport { useScroller } from \"./use-scroller\";\n/**\n * A heavily-optimized component that updates `useMasonry()` when the scroll position of the browser `window`\n * changes. This bare-metal component is used by `<Masonry>` under the hood.\n *\n * @param props\n */\nexport function MasonryScroller<Item>(props: MasonryScrollerProps<Item>) {\n  // We put this in its own layer because it's the thing that will trigger the most updates\n  // and we don't want to slower ourselves by cycling through all the functions, objects, and effects\n  // of other hooks\n  const { scrollTop, isScrolling } = useScroller(props.offset, props.scrollFps);\n  // This is an update-heavy phase and while we could just Object.assign here,\n  // it is way faster to inline and there's a relatively low hit to he bundle\n  // size.\n  return useMasonry<Item>({\n    scrollTop,\n    isScrolling,\n    positioner: props.positioner,\n    resizeObserver: props.resizeObserver,\n    items: props.items,\n    onRender: props.onRender,\n    as: props.as,\n    id: props.id,\n    className: props.className,\n    style: props.style,\n    role: props.role,\n    tabIndex: props.tabIndex,\n    containerRef: props.containerRef,\n    itemAs: props.itemAs,\n    itemStyle: props.itemStyle,\n    itemHeightEstimate: props.itemHeightEstimate,\n    itemKey: props.itemKey,\n    overscanBy: props.overscanBy,\n    height: props.height,\n    render: props.render,\n  });\n}\n\nexport interface MasonryScrollerProps<Item>\n  extends Omit<UseMasonryOptions<Item>, \"scrollTop\" | \"isScrolling\"> {\n  /**\n   * This determines how often (in frames per second) to update the scroll position of the\n   * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\n   * The default value of `12` has been very reasonable in my own testing, but if you have particularly\n   * heavy `render` components it may be prudent to reduce this number.\n   *\n   * @default 12\n   */\n  scrollFps?: number;\n  /**\n   * The vertical space in pixels between the top of the grid container and the top\n   * of the browser `document.documentElement`.\n   *\n   * @default 0\n   */\n  offset?: number;\n}\n\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n  MasonryScroller.displayName = \"MasonryScroller\";\n}\n","import useLayoutEffect from \"@react-hook/passive-layout-effect\";\nimport * as React from \"react\";\n\n/**\n * A hook for measuring the width of the grid container, as well as its distance\n * from the top of the document. These values are necessary to correctly calculate the number/width\n * of columns to render, as well as the number of rows to render.\n *\n * @param elementRef - A `ref` object created by `React.useRef()`. That ref should be provided to the\n *   `containerRef` property in `useMasonry()`.\n * @param deps - You can force this hook to recalculate the `offset` and `width` whenever this\n *   dependencies list changes. A common dependencies list might look like `[windowWidth, windowHeight]`,\n *   which would force the hook to recalculate any time the size of the browser `window` changed.\n */\nexport function useContainerPosition(\n  elementRef: React.MutableRefObject<HTMLElement | null>,\n  deps: React.DependencyList = emptyArr\n): ContainerPosition {\n  const [containerPosition, setContainerPosition] =\n    React.useState<ContainerPosition>({ offset: 0, width: 0 });\n\n  useLayoutEffect(() => {\n    const { current } = elementRef;\n    if (current !== null) {\n      let offset = 0;\n      let el = current;\n\n      do {\n        offset += el.offsetTop || 0;\n        el = el.offsetParent as HTMLElement;\n      } while (el);\n\n      if (\n        offset !== containerPosition.offset ||\n        current.offsetWidth !== containerPosition.width\n      ) {\n        setContainerPosition({\n          offset,\n          width: current.offsetWidth,\n        });\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, deps);\n\n  return containerPosition;\n}\n\nexport interface ContainerPosition {\n  /**\n   * The distance in pixels between the top of the element in `elementRef` and the top of\n   * the `document.documentElement`.\n   */\n  offset: number;\n  /**\n   * The `offsetWidth` of the element in `elementRef`.\n   */\n  width: number;\n}\n\nconst emptyArr: [] = [];\n","import * as React from \"react\";\nimport { createIntervalTree } from \"./interval-tree\";\n\n/**\n * This hook creates the grid cell positioner and cache required by `useMasonry()`. This is\n * the meat of the grid's layout algorithm, determining which cells to render at a given scroll\n * position, as well as where to place new items in the grid.\n *\n * @param options - Properties that determine the number of columns in the grid, as well\n *  as their widths.\n * @param options.columnWidth\n * @param options.width\n * @param deps - This hook will create a new positioner, clearing all existing cached positions,\n *  whenever the dependencies in this list change.\n * @param options.columnGutter\n * @param options.rowGutter\n * @param options.columnCount\n * @param options.maxColumnCount\n * @param options.maxColumnWidth\n */\nexport function usePositioner(\n  {\n    width,\n    columnWidth = 200,\n    columnGutter = 0,\n    rowGutter,\n    columnCount,\n    maxColumnCount,\n    maxColumnWidth,\n  }: UsePositionerOptions,\n  deps: React.DependencyList = emptyArr\n): Positioner {\n  const initPositioner = (): Positioner => {\n    const [computedColumnWidth, computedColumnCount] = getColumns(\n      width,\n      columnWidth,\n      columnGutter,\n      columnCount,\n      maxColumnCount,\n      maxColumnWidth\n    );\n    return createPositioner(\n      computedColumnCount,\n      computedColumnWidth,\n      columnGutter,\n      rowGutter ?? columnGutter\n    );\n  };\n  const positionerRef = React.useRef<Positioner>();\n  if (positionerRef.current === undefined)\n    positionerRef.current = initPositioner();\n\n  const prevDeps = React.useRef(deps);\n  const opts = [\n    width,\n    columnWidth,\n    columnGutter,\n    rowGutter,\n    columnCount,\n    maxColumnCount,\n    maxColumnWidth,\n  ];\n  const prevOpts = React.useRef(opts);\n  const optsChanged = !opts.every((item, i) => prevOpts.current[i] === item);\n\n  if (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n    if (deps.length !== prevDeps.current.length) {\n      throw new Error(\n        \"usePositioner(): The length of your dependencies array changed.\"\n      );\n    }\n  }\n\n  // Create a new positioner when the dependencies or sizes change\n  // Thanks to https://github.com/khmm12 for pointing this out\n  // https://github.com/jaredLunde/masonic/pull/41\n  if (optsChanged || !deps.every((item, i) => prevDeps.current[i] === item)) {\n    const prevPositioner = positionerRef.current;\n    const positioner = initPositioner();\n    prevDeps.current = deps;\n    prevOpts.current = opts;\n\n    if (optsChanged) {\n      const cacheSize = prevPositioner.size();\n      for (let index = 0; index < cacheSize; index++) {\n        const pos = prevPositioner.get(index);\n        positioner.set(index, pos !== void 0 ? pos.height : 0);\n      }\n    }\n\n    positionerRef.current = positioner;\n  }\n\n  return positionerRef.current;\n}\n\nexport interface UsePositionerOptions {\n  /**\n   * The width of the container you're rendering the grid within, i.e. the container\n   * element's `element.offsetWidth`\n   */\n  width: number;\n  /**\n   * The minimum column width. The `usePositioner()` hook will automatically size the\n   * columns to fill their container based upon the `columnWidth` and `columnGutter` values.\n   * It will never render anything smaller than this width unless its container itself is\n   * smaller than its value. This property is optional if you're using a static `columnCount`.\n   *\n   * @default 200\n   */\n  columnWidth?: number;\n  /**\n   * The maximum column width. Calculated column widths will be capped at this value.\n   */\n  maxColumnWidth?: number;\n  /**\n   * This sets the horizontal space between grid columns in pixels. If `rowGutter` is not set, this\n   * also sets the vertical space between cells within a column in pixels.\n   *\n   * @default 0\n   */\n  columnGutter?: number;\n  /**\n   * This sets the vertical space between cells within a column in pixels. If not set, the value of\n   * `columnGutter` is used instead.\n   */\n  rowGutter?: number;\n  /**\n   * By default, `usePositioner()` derives the column count from the `columnWidth`, `columnGutter`,\n   * and `width` props. However, in some situations it is nice to be able to override that behavior\n   * (e.g. creating a `List` component).\n   */\n  columnCount?: number;\n  /**\n   * The upper bound of column count. This property won't work if `columnCount` is set.\n   */\n  maxColumnCount?: number;\n}\n\n/**\n * Creates a cell positioner for the `useMasonry()` hook. The `usePositioner()` hook uses\n * this utility under the hood.\n *\n * @param columnCount - The number of columns in the grid\n * @param columnWidth - The width of each column in the grid\n * @param columnGutter - The amount of horizontal space between columns in pixels.\n * @param rowGutter - The amount of vertical space between cells within a column in pixels (falls back\n * to `columnGutter`).\n */\nexport const createPositioner = (\n  columnCount: number,\n  columnWidth: number,\n  columnGutter = 0,\n  rowGutter = columnGutter\n): Positioner => {\n  // O(log(n)) lookup of cells to render for a given viewport size\n  // Store tops and bottoms of each cell for fast intersection lookup.\n  const intervalTree = createIntervalTree();\n  // Track the height of each column.\n  // Layout algorithm below always inserts into the shortest column.\n  const columnHeights: number[] = new Array(columnCount);\n  // Used for O(1) item access\n  const items: PositionerItem[] = [];\n  // Tracks the item indexes within an individual column\n  const columnItems: number[][] = new Array(columnCount);\n\n  for (let i = 0; i < columnCount; i++) {\n    columnHeights[i] = 0;\n    columnItems[i] = [];\n  }\n\n  return {\n    columnCount,\n    columnWidth,\n    set: (index, height = 0) => {\n      let column = 0;\n\n      // finds the shortest column and uses it\n      for (let i = 1; i < columnHeights.length; i++) {\n        if (columnHeights[i] < columnHeights[column]) column = i;\n      }\n\n      const top = columnHeights[column] || 0;\n      columnHeights[column] = top + height + rowGutter;\n      columnItems[column].push(index);\n      items[index] = {\n        left: column * (columnWidth + columnGutter),\n        top,\n        height,\n        column,\n      };\n      intervalTree.insert(top, top + height, index);\n    },\n    get: (index) => items[index],\n    // This only updates items in the specific columns that have changed, on and after the\n    // specific items that have changed\n    update: (updates) => {\n      const columns: number[] = new Array(columnCount);\n      let i = 0,\n        j = 0;\n\n      // determines which columns have items that changed, as well as the minimum index\n      // changed in that column, as all items after that index will have their positions\n      // affected by the change\n      for (; i < updates.length - 1; i++) {\n        const index = updates[i];\n        const item = items[index];\n        item.height = updates[++i];\n        intervalTree.remove(index);\n        intervalTree.insert(item.top, item.top + item.height, index);\n        columns[item.column] =\n          columns[item.column] === void 0\n            ? index\n            : Math.min(index, columns[item.column]);\n      }\n\n      for (i = 0; i < columns.length; i++) {\n        // bails out if the column didn't change\n        if (columns[i] === void 0) continue;\n        const itemsInColumn = columnItems[i];\n        // the index order is sorted with certainty so binary search is a great solution\n        // here as opposed to Array.indexOf()\n        const startIndex = binarySearch(itemsInColumn, columns[i]);\n        const index = columnItems[i][startIndex];\n        const startItem = items[index];\n        columnHeights[i] = startItem.top + startItem.height + rowGutter;\n\n        for (j = startIndex + 1; j < itemsInColumn.length; j++) {\n          const index = itemsInColumn[j];\n          const item = items[index];\n          item.top = columnHeights[i];\n          columnHeights[i] = item.top + item.height + rowGutter;\n          intervalTree.remove(index);\n          intervalTree.insert(item.top, item.top + item.height, index);\n        }\n      }\n    },\n    // Render all cells visible within the viewport range defined.\n    range: (lo, hi, renderCallback) =>\n      intervalTree.search(lo, hi, (index, top) =>\n        renderCallback(index, items[index].left, top)\n      ),\n    estimateHeight: (itemCount, defaultItemHeight): number => {\n      const tallestColumn = Math.max(0, Math.max.apply(null, columnHeights));\n\n      return itemCount === intervalTree.size\n        ? tallestColumn\n        : tallestColumn +\n            Math.ceil((itemCount - intervalTree.size) / columnCount) *\n              defaultItemHeight;\n    },\n    shortestColumn: () => {\n      if (columnHeights.length > 1) return Math.min.apply(null, columnHeights);\n      return columnHeights[0] || 0;\n    },\n    size(): number {\n      return intervalTree.size;\n    },\n    all(): PositionerItem[] {\n      return items;\n    },\n  };\n};\n\nexport interface Positioner {\n  /**\n   * The number of columns in the grid\n   */\n  columnCount: number;\n  /**\n   * The width of each column in the grid\n   */\n  columnWidth: number;\n  /**\n   * Sets the position for the cell at `index` based upon the cell's height\n   */\n  set: (index: number, height: number) => void;\n  /**\n   * Gets the `PositionerItem` for the cell at `index`\n   */\n  get: (index: number) => PositionerItem | undefined;\n  /**\n   * Updates cells based on their indexes and heights\n   * positioner.update([index, height, index, height, index, height...])\n   */\n  update: (updates: number[]) => void;\n  /**\n   * Searches the interval tree for grid cells with a `top` value in\n   * betwen `lo` and `hi` and invokes the callback for each item that\n   * is discovered\n   */\n  range: (\n    lo: number,\n    hi: number,\n    renderCallback: (index: number, left: number, top: number) => void\n  ) => void;\n  /**\n   * Returns the number of grid cells in the cache\n   */\n\n  size: () => number;\n  /**\n   * Estimates the total height of the grid\n   */\n\n  estimateHeight: (itemCount: number, defaultItemHeight: number) => number;\n  /**\n   * Returns the height of the shortest column in the grid\n   */\n\n  shortestColumn: () => number;\n  /**\n   * Returns all `PositionerItem` items\n   */\n  all: () => PositionerItem[];\n}\n\nexport interface PositionerItem {\n  /**\n   * This is how far from the top edge of the grid container in pixels the\n   * item is placed\n   */\n  top: number;\n  /**\n   * This is how far from the left edge of the grid container in pixels the\n   * item is placed\n   */\n  left: number;\n  /**\n   * This is the height of the grid cell\n   */\n  height: number;\n  /**\n   * This is the column number containing the grid cell\n   */\n  column: number;\n}\n\n/* istanbul ignore next */\nconst binarySearch = (a: number[], y: number): number => {\n  let l = 0;\n  let h = a.length - 1;\n\n  while (l <= h) {\n    const m = (l + h) >>> 1;\n    const x = a[m];\n    if (x === y) return m;\n    else if (x <= y) l = m + 1;\n    else h = m - 1;\n  }\n\n  return -1;\n};\n\nconst getColumns = (\n  width = 0,\n  minimumWidth = 0,\n  gutter = 8,\n  columnCount?: number,\n  maxColumnCount?: number,\n  maxColumnWidth?: number\n): [number, number] => {\n  columnCount =\n    columnCount ||\n    Math.min(\n      Math.floor((width + gutter) / (minimumWidth + gutter)),\n      maxColumnCount || Infinity\n    ) ||\n    1;\n  let columnWidth = Math.floor(\n    (width - gutter * (columnCount - 1)) / columnCount\n  );\n\n  // Cap the column width if maxColumnWidth is specified\n  if (maxColumnWidth !== undefined && columnWidth > maxColumnWidth) {\n    columnWidth = maxColumnWidth;\n  }\n\n  return [columnWidth, columnCount];\n};\n\nconst emptyArr: [] = [];\n","import rafSchd from \"raf-schd\";\nimport * as React from \"react\";\nimport trieMemoize from \"trie-memoize\";\nimport { elementsCache } from \"./elements-cache\";\nimport { useForceUpdate } from \"./use-force-update\";\nimport type { Positioner } from \"./use-positioner\";\n\n/**\n * Creates a resize observer that forces updates to the grid cell positions when mutations are\n * made to cells affecting their height.\n *\n * @param positioner - The masonry cell positioner created by the `usePositioner()` hook.\n */\nexport function useResizeObserver(positioner: Positioner) {\n  const forceUpdate = useForceUpdate();\n  const resizeObserver = createResizeObserver(positioner, forceUpdate);\n  // Cleans up the resize observers when they change or the\n  // component unmounts\n  React.useEffect(() => () => resizeObserver.disconnect(), [resizeObserver]);\n  return resizeObserver;\n}\n\nconst _handlerForType = rafSchd((target: HTMLElement) => {});\n\ntype IHandler = typeof _handlerForType;\n\n/**\n * Creates a resize observer that fires an `updater` callback whenever the height of\n * one or many cells change. The `useResizeObserver()` hook is using this under the hood.\n *\n * @param positioner - A cell positioner created by the `usePositioner()` hook or the `createPositioner()` utility\n * @param updater - A callback that fires whenever one or many cell heights change.\n */\nexport const createResizeObserver = trieMemoize(\n  [WeakMap],\n  // TODO: figure out a way to test this\n  /* istanbul ignore next */\n  (positioner: Positioner, updater: (updates: number[]) => void) => {\n    const updates: number[] = [];\n\n    const update = rafSchd(() => {\n      if (updates.length > 0) {\n        // Updates the size/positions of the cell with the resize\n        // observer updates\n        positioner.update(updates);\n        updater(updates);\n      }\n      updates.length = 0;\n    });\n\n    const commonHandler = (target: HTMLElement) => {\n      const height = target.offsetHeight;\n      if (height > 0) {\n        const index = elementsCache.get(target);\n        if (index !== void 0) {\n          const position = positioner.get(index);\n          if (position !== void 0 && height !== position.height)\n            updates.push(index, height);\n        }\n      }\n      update();\n    };\n\n    const handlers = new Map<number, IHandler>();\n    const handleEntries: ResizeObserverCallback = (entries) => {\n      let i = 0;\n\n      for (; i < entries.length; i++) {\n        const entry = entries[i];\n        const index = elementsCache.get(entry.target);\n\n        if (index === void 0) continue;\n        let handler = handlers.get(index);\n        if (!handler) {\n          handler = rafSchd(commonHandler);\n          handlers.set(index, handler);\n        }\n        handler(entry.target as HTMLElement);\n      }\n    };\n\n    const ro = new ResizeObserver(handleEntries);\n    // Overrides the original disconnect to include cancelling handling the entries.\n    // Ideally this would be its own method but that would result in a breaking\n    // change.\n    const disconnect = ro.disconnect.bind(ro);\n    ro.disconnect = () => {\n      disconnect();\n      handlers.forEach((handler) => {\n        handler.cancel();\n      });\n    };\n\n    return ro;\n  }\n);\n","import useEvent from \"@react-hook/event\";\nimport useLatest from \"@react-hook/latest\";\nimport { useThrottleCallback } from \"@react-hook/throttle\";\nimport * as React from \"react\";\nimport type { Positioner, PositionerItem } from \"./use-positioner\";\n\n/**\n * A hook that creates a callback for scrolling to a specific index in\n * the \"items\" array.\n *\n * @param positioner - A positioner created by the `usePositioner()` hook\n * @param options - Configuration options\n */\nexport function useScrollToIndex(\n  positioner: Positioner,\n  options: UseScrollToIndexOptions\n) {\n  const {\n    align = \"top\",\n    element = typeof window !== \"undefined\" && window,\n    offset = 0,\n    height = typeof window !== \"undefined\" ? window.innerHeight : 0,\n  } = options;\n  const latestOptions = useLatest({\n    positioner,\n    element,\n    align,\n    offset,\n    height,\n  } as const);\n  const getTarget = React.useRef(() => {\n    const latestElement = latestOptions.current.element;\n    return latestElement && \"current\" in latestElement\n      ? latestElement.current\n      : latestElement;\n  }).current;\n  const [state, dispatch] = React.useReducer(\n    (\n      state: {\n        position: PositionerItem | undefined;\n        index: number | undefined;\n        prevTop: number | undefined;\n      },\n      action:\n        | { type: \"scrollToIndex\"; value: number | undefined }\n        | { type: \"setPosition\"; value: PositionerItem | undefined }\n        | { type: \"setPrevTop\"; value: number | undefined }\n        | { type: \"reset\" }\n    ) => {\n      const nextState = {\n        position: state.position,\n        index: state.index,\n        prevTop: state.prevTop,\n      };\n\n      /* istanbul ignore next */\n      if (action.type === \"scrollToIndex\") {\n        return {\n          position: latestOptions.current.positioner.get(action.value ?? -1),\n          index: action.value,\n          prevTop: void 0,\n        };\n      } else if (action.type === \"setPosition\") {\n        nextState.position = action.value;\n      } else if (action.type === \"setPrevTop\") {\n        nextState.prevTop = action.value;\n      } else if (action.type === \"reset\") {\n        return defaultState;\n      }\n\n      return nextState;\n    },\n    defaultState\n  );\n  const throttledDispatch = useThrottleCallback(dispatch, 15);\n\n  // If we find the position along the way we can immediately take off\n  // to the correct spot.\n  useEvent(getTarget() as Window, \"scroll\", () => {\n    if (!state.position && state.index) {\n      const position = latestOptions.current.positioner.get(state.index);\n\n      if (position) {\n        dispatch({ type: \"setPosition\", value: position });\n      }\n    }\n  });\n\n  // If the top changes out from under us in the case of dynamic cells, we\n  // want to keep following it.\n  const currentTop =\n    state.index !== void 0 &&\n    latestOptions.current.positioner.get(state.index)?.top;\n\n  React.useEffect(() => {\n    const target = getTarget();\n    if (!target) return;\n    const { height, align, offset, positioner } = latestOptions.current;\n\n    if (state.position) {\n      let scrollTop = state.position.top;\n\n      if (align === \"bottom\") {\n        scrollTop = scrollTop - height + state.position.height;\n      } else if (align === \"center\") {\n        scrollTop -= (height - state.position.height) / 2;\n      }\n\n      target.scrollTo(0, Math.max(0, (scrollTop += offset)));\n      // Resets state after 400ms, an arbitrary time I determined to be\n      // still visually pleasing if there is a slow network reply in dynamic\n      // cells\n      let didUnsubscribe = false;\n      const timeout = setTimeout(\n        () => !didUnsubscribe && dispatch({ type: \"reset\" }),\n        400\n      );\n      return () => {\n        didUnsubscribe = true;\n        clearTimeout(timeout);\n      };\n    } else if (state.index !== void 0) {\n      // Estimates the top based upon the average height of current cells\n      let estimatedTop =\n        (positioner.shortestColumn() / positioner.size()) * state.index;\n      if (state.prevTop)\n        estimatedTop = Math.max(estimatedTop, state.prevTop + height);\n      target.scrollTo(0, estimatedTop);\n      throttledDispatch({ type: \"setPrevTop\", value: estimatedTop });\n    }\n  }, [currentTop, state, latestOptions, getTarget, throttledDispatch]);\n\n  return React.useRef((index: number) => {\n    dispatch({ type: \"scrollToIndex\", value: index });\n  }).current;\n}\n\nconst defaultState = {\n  index: void 0,\n  position: void 0,\n  prevTop: void 0,\n} as const;\n\nexport type UseScrollToIndexOptions = {\n  /**\n   * The window element or a React ref for the window element. That is,\n   * this is the grid container.\n   *\n   * @default window\n   */\n  element?: Window | HTMLElement | React.RefObject<HTMLElement> | null;\n  /**\n   * Sets the vertical alignment of the cell within the grid container.\n   *\n   * @default \"top\"\n   */\n  align?: \"center\" | \"top\" | \"bottom\";\n  /**\n   * The height of the grid.\n   *\n   * @default window.innerHeight\n   */\n  height?: number;\n  /**\n   * The vertical space in pixels between the top of the grid container and the top\n   * of the window.\n   *\n   * @default 0\n   */\n  offset?: number;\n};\n","import { useWindowSize } from \"@react-hook/window-size\";\nimport * as React from \"react\";\nimport { MasonryScroller } from \"./masonry-scroller\";\nimport type { MasonryScrollerProps } from \"./masonry-scroller\";\nimport { useContainerPosition } from \"./use-container-position\";\nimport { usePositioner } from \"./use-positioner\";\nimport type { UsePositionerOptions } from \"./use-positioner\";\nimport { useResizeObserver } from \"./use-resize-observer\";\nimport { useScrollToIndex } from \"./use-scroll-to-index\";\nimport type { UseScrollToIndexOptions } from \"./use-scroll-to-index\";\n\n/**\n * A \"batteries included\" masonry grid which includes all of the implementation details below. This component is the\n * easiest way to get off and running in your app, before switching to more advanced implementations, if necessary.\n * It will change its column count to fit its container's width and will decide how many rows to render based upon\n * the height of the browser `window`.\n *\n * @param props\n */\nexport function Masonry<Item>(props: MasonryProps<Item>) {\n  const containerRef = React.useRef<null | HTMLElement>(null);\n  const windowSize = useWindowSize({\n    initialWidth: props.ssrWidth,\n    initialHeight: props.ssrHeight,\n  });\n  const containerPos = useContainerPosition(containerRef, windowSize);\n  const nextProps = Object.assign(\n    {\n      offset: containerPos.offset,\n      width: containerPos.width || windowSize[0],\n      height: windowSize[1],\n      containerRef,\n    },\n    props\n  ) as any;\n  nextProps.positioner = usePositioner(nextProps);\n  nextProps.resizeObserver = useResizeObserver(nextProps.positioner);\n  const scrollToIndex = useScrollToIndex(nextProps.positioner, {\n    height: nextProps.height,\n    offset: containerPos.offset,\n    align:\n      typeof props.scrollToIndex === \"object\"\n        ? props.scrollToIndex.align\n        : void 0,\n  });\n  const index =\n    props.scrollToIndex &&\n    (typeof props.scrollToIndex === \"number\"\n      ? props.scrollToIndex\n      : props.scrollToIndex.index);\n\n  React.useEffect(() => {\n    if (index !== void 0) scrollToIndex(index);\n  }, [index, scrollToIndex]);\n\n  return React.createElement(MasonryScroller, nextProps);\n}\n\nexport interface MasonryProps<Item>\n  extends Omit<\n      MasonryScrollerProps<Item>,\n      \"offset\" | \"width\" | \"height\" | \"containerRef\" | \"positioner\"\n    >,\n    Pick<\n      UsePositionerOptions,\n      | \"columnWidth\"\n      | \"columnGutter\"\n      | \"rowGutter\"\n      | \"columnCount\"\n      | \"maxColumnCount\"\n      | \"maxColumnWidth\"\n    > {\n  /**\n   * Scrolls to a given index within the grid. The grid will re-scroll\n   * any time the index changes.\n   */\n  scrollToIndex?:\n    | number\n    | {\n        index: number;\n        align: UseScrollToIndexOptions[\"align\"];\n      };\n  /**\n   * This is the width that will be used for the browser `window` when rendering this component in SSR.\n   * This prop isn't relevant for client-side only apps.\n   */\n  ssrWidth?: number;\n  /**\n   * This is the height that will be used for the browser `window` when rendering this component in SSR.\n   * This prop isn't relevant for client-side only apps.\n   */\n  ssrHeight?: number;\n  /**\n   * This determines how often (in frames per second) to update the scroll position of the\n   * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\n   * The default value of `12` has been very reasonable in my own testing, but if you have particularly\n   * heavy `render` components it may be prudent to reduce this number.\n   *\n   * @default 12\n   */\n  scrollFps?: number;\n}\n\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n  Masonry.displayName = \"Masonry\";\n}\n","import {useDebounce} from '@react-hook/debounce'\nimport useEvent from '@react-hook/event'\n\nconst emptyObj = {}\n\nexport interface DebouncedWindowSizeOptions {\n  initialWidth?: number\n  initialHeight?: number\n  wait?: number\n  leading?: boolean\n}\n\nconst win = typeof window === 'undefined' ? null : window\nconst wv =\n  win && typeof win.visualViewport !== 'undefined' ? win.visualViewport : null\nconst getSize = () =>\n  [\n    document.documentElement.clientWidth,\n    document.documentElement.clientHeight,\n  ] as const\n\nexport const useWindowSize = (\n  options: DebouncedWindowSizeOptions = emptyObj\n): readonly [number, number] => {\n  const {wait, leading, initialWidth = 0, initialHeight = 0} = options\n  const [size, setDebouncedSize] = useDebounce<readonly [number, number]>(\n    /* istanbul ignore next */\n    typeof document === 'undefined' ? [initialWidth, initialHeight] : getSize,\n    wait,\n    leading\n  )\n  const setSize = (): void => setDebouncedSize(getSize)\n\n  useEvent(win, 'resize', setSize)\n  // @ts-expect-error\n  useEvent(wv, 'resize', setSize)\n  useEvent(win, 'orientationchange', setSize)\n\n  return size\n}\n\nexport const useWindowHeight = (\n  options?: Omit<DebouncedWindowSizeOptions, 'initialWidth'>\n): number => useWindowSize(options)[1]\n\nexport const useWindowWidth = (\n  options?: Omit<DebouncedWindowSizeOptions, 'initialHeight'>\n): number => useWindowSize(options)[0]\n","import * as React from 'react'\nimport useLatest from '@react-hook/latest'\n\nexport const useDebounceCallback = <CallbackArgs extends any[]>(\n  callback: (...args: CallbackArgs) => void,\n  wait = 100,\n  leading = false\n): ((...args: CallbackArgs) => void) => {\n  const storedCallback = useLatest(callback)\n  const timeout = React.useRef<ReturnType<typeof setTimeout>>()\n  const deps = [wait, leading, storedCallback]\n  // Cleans up pending timeouts when the deps change\n  React.useEffect(\n    () => () => {\n      timeout.current && clearTimeout(timeout.current)\n      timeout.current = void 0\n    },\n    deps\n  )\n\n  return React.useCallback(function () {\n    // eslint-disable-next-line prefer-rest-params\n    const args = arguments\n    const {current} = timeout\n    // Calls on leading edge\n    if (current === void 0 && leading) {\n      timeout.current = setTimeout(() => {\n        timeout.current = void 0\n      }, wait)\n      // eslint-disable-next-line prefer-spread\n      return storedCallback.current.apply(null, args as any)\n    }\n    // Clear the timeout every call and start waiting again\n    current && clearTimeout(current)\n    // Waits for `wait` before invoking the callback\n    timeout.current = setTimeout(() => {\n      timeout.current = void 0\n      storedCallback.current.apply(null, args as any)\n    }, wait)\n  }, deps)\n}\n\nexport const useDebounce = <State extends any>(\n  initialState: State | (() => State),\n  wait?: number,\n  leading?: boolean\n): [State, React.Dispatch<React.SetStateAction<State>>] => {\n  const state = React.useState(initialState)\n  return [state[0], useDebounceCallback(state[1], wait, leading)]\n}\n","import * as React from 'react'\n\nconst useLatest = <T extends any>(current: T) => {\n  const storedValue = React.useRef(current)\n  React.useEffect(() => {\n    storedValue.current = current\n  })\n  return storedValue\n}\n\nexport default useLatest\n","const memoOne = <Args extends any[], T extends any>(\n  fn: (...args: Args) => T,\n  areEqual?: AreEqual<Args>\n): OutputFunction<Args, T> => {\n  const equal = areEqual || defaultAreEqual\n  let args: Args, value: any\n\n  return function (): T {\n    return !!args && equal(arguments as any, args)\n      ? value\n      : (value = fn.apply(null, (args = arguments as any)))\n  } as OutputFunction<Args, T>\n}\n\nexport default memoOne\n\nconst defaultAreEqual = (\n  current: IArguments,\n  prev: IArguments | any[]\n): boolean =>\n  current[0] === prev[0] &&\n  current[1] === prev[1] &&\n  current[2] === prev[2] &&\n  current[3] === prev[3]\n\nexport type AreEqual<Args> = (currentArgs: Args, prevArgs: Args) => boolean\nexport type InputFunction = (...args: any[]) => any\nexport type OutputFunction<Args extends any[], T extends any> = (\n  ...args: Args\n) => T\n","class OneKeyMap<K extends any = any, V extends any = any> {\n  set: (k: K, v: V) => void\n  get: (k: K) => V | undefined\n\n  constructor() {\n    let key: K | undefined, val: V | undefined\n    this.get = (k: K): V | undefined => (k === key ? val : void 0)\n    this.set = (k: K, v: V): void => {\n      key = k\n      val = v\n    }\n  }\n}\n\nexport default OneKeyMap\n","export interface MapLike {\n  new (...args: any[]): any\n}\n\nexport type CacheConstructor =\n  | MapConstructor\n  | WeakMapConstructor\n  | MapLike\n  | Record<any, any>\n\ninterface Cache<K = any, V = any> {\n  set: (k: K, v: V) => V\n  get: (k: K) => V\n}\n\nconst createCache = (obj: CacheConstructor): Cache => {\n  try {\n    // @ts-ignore\n    return new obj()\n  } catch (e) {\n    const cache: Record<string, any> = {}\n\n    return {\n      set(k, v): void {\n        cache[k] = v\n      },\n      get(k): any {\n        return cache[k]\n      },\n    }\n  }\n}\n\nconst memo = (\n  constructors: CacheConstructor[]\n): {s: Cache['set']; g: Cache['get']} => {\n  const depth = constructors.length,\n    baseCache = createCache(constructors[0])\n  let base: any\n  let map: any\n  let i: number\n  let node: typeof baseCache\n  const one = depth === 1\n  // quicker access for one and two-argument functions\n  const g1 = (args: IArguments): any =>\n    (base = baseCache.get(args[0])) === void 0 || one ? base : base.get(args[1])\n  const s1 = (args: IArguments, value: any): any => {\n    if (one) baseCache.set(args[0], value)\n    else {\n      if ((base = baseCache.get(args[0])) === void 0) {\n        map = createCache(constructors[1])\n        map.set(args[1], value)\n        baseCache.set(args[0], map)\n      } else {\n        base.set(args[1], value)\n      }\n    }\n\n    return value\n  }\n\n  const g2 = (args: IArguments): any => {\n    node = baseCache\n\n    for (i = 0; i < depth; i++)\n      if ((node = node.get(args[i])) === void 0) return\n\n    return node\n  }\n\n  const s2 = (args: IArguments, value: any): any => {\n    node = baseCache\n\n    for (i = 0; i < depth - 1; i++) {\n      if ((map = node.get(args[i])) === void 0) {\n        map = createCache(constructors[i + 1])\n        node.set(args[i], map)\n        node = map\n      } else {\n        node = map\n      }\n    }\n\n    node.set(args[depth - 1], value)\n    return value\n  }\n\n  return depth < 3 ? {g: g1, s: s1} : {g: g2, s: s2}\n}\n\nconst memoize = <T extends any[], U extends any>(\n  mapConstructors: CacheConstructor[],\n  fn: (...args: T) => U\n): ((...args: T) => U) => {\n  let item: U\n  const {g, s} = memo(mapConstructors)\n  return function () {\n    return (item = g(arguments)) === void 0\n      ? s(arguments, fn.apply(null, arguments as any))\n      : item\n  }\n}\n\nexport default memoize\n","export const elementsCache: WeakMap<Element, number> = new WeakMap();\n","export type Raf = (callback: (timestamp: number) => void) => number\nexport type Caf = (handle: number) => void\n\nlet u = 'undefined',\n  win = typeof window !== u ? window : ({} as any),\n  p = typeof performance !== u ? performance : Date,\n  now = () => p.now(),\n  af = 'AnimationFrame' as const,\n  Caf = 'cancel' + af,\n  Raf = 'request' + af,\n  raf: Raf = win[Raf] && win[Raf].bind(win),\n  caf: Caf = win[Caf] && win[Caf].bind(win)\n\nif (!raf || !caf) {\n  let lastTime = 0\n  raf = (callback: FrameRequestCallback) => {\n    let curr = now(),\n      next = Math.max(lastTime + 1000 / 60, curr)\n    return setTimeout(() => {\n      callback((lastTime = next))\n    }, next - curr) as any\n  }\n  caf = (h) => clearTimeout(h)\n}\n\nexport {raf, caf, now}\n","import {useThrottle} from '@react-hook/throttle'\nimport useEvent from '@react-hook/event'\n\nconst win = typeof window === 'undefined' ? null : window\nconst getScrollY = (): number =>\n  (win as Window).scrollY !== void 0\n    ? (win as Window).scrollY\n    : (win as Window).pageYOffset === void 0\n    ? 0\n    : (win as Window).pageYOffset\n\nexport const useWindowScroll = (fps = 30): number => {\n  const state = useThrottle(\n    typeof window === 'undefined' ? 0 : getScrollY,\n    fps,\n    true\n  )\n  useEvent(win, 'scroll', (): void => state[1](getScrollY()))\n  return state[0]\n}\n\nexport default useWindowScroll\n","import React from 'react'\n\nconst usePassiveLayoutEffect =\n  React[\n    typeof document !== 'undefined' && document.createElement !== void 0\n      ? 'useLayoutEffect'\n      : 'useEffect'\n  ]\n\nexport default usePassiveLayoutEffect\n","var rafSchd = function rafSchd(fn) {\n  var lastArgs = [];\n  var frameId = null;\n\n  var wrapperFn = function wrapperFn() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    lastArgs = args;\n\n    if (frameId) {\n      return;\n    }\n\n    frameId = requestAnimationFrame(function () {\n      frameId = null;\n      fn.apply(void 0, lastArgs);\n    });\n  };\n\n  wrapperFn.cancel = function () {\n    if (!frameId) {\n      return;\n    }\n\n    cancelAnimationFrame(frameId);\n    frameId = null;\n  };\n\n  return wrapperFn;\n};\n\nexport default rafSchd;\n","import useLatest from \"@react-hook/latest\";\nimport * as React from \"react\";\n\n/**\n * A utility hook for seamlessly adding infinite scroll behavior to the `useMasonry()` hook. This\n * hook invokes a callback each time the last rendered index surpasses the total number of items\n * in your items array or the number defined in the `totalItems` option.\n *\n * @param loadMoreItems - This callback is invoked when more rows must be loaded. It will be used to\n *  determine when to refresh the list with the newly-loaded data. This callback may be called multiple\n *  times in reaction to a single scroll event, so it's important to memoize its arguments. If you're\n *  creating this callback inside of a functional component, make sure you wrap it in `React.useCallback()`,\n *  as well.\n * @param options\n */\nexport function useInfiniteLoader<Item, T extends LoadMoreItemsCallback<Item>>(\n  loadMoreItems: T,\n  options: UseInfiniteLoaderOptions<Item> = emptyObj\n): LoadMoreItemsCallback<Item> {\n  const {\n    isItemLoaded,\n    minimumBatchSize = 16,\n    threshold = 16,\n    totalItems = 9e9,\n  } = options;\n  const storedLoadMoreItems = useLatest(loadMoreItems);\n  const storedIsItemLoaded = useLatest(isItemLoaded);\n\n  return React.useCallback(\n    (startIndex, stopIndex, items) => {\n      const unloadedRanges = scanForUnloadedRanges(\n        storedIsItemLoaded.current,\n        minimumBatchSize,\n        items,\n        totalItems,\n        Math.max(0, startIndex - threshold),\n        Math.min(totalItems - 1, (stopIndex || 0) + threshold)\n      );\n      // The user is responsible for memoizing their loadMoreItems() function\n      // because we don't want to make assumptions about how they want to deal\n      // with `items`\n      for (let i = 0; i < unloadedRanges.length - 1; ++i)\n        storedLoadMoreItems.current(\n          unloadedRanges[i],\n          unloadedRanges[++i],\n          items\n        );\n    },\n    [\n      totalItems,\n      minimumBatchSize,\n      threshold,\n      storedLoadMoreItems,\n      storedIsItemLoaded,\n    ]\n  );\n}\n\n/**\n * Returns all of the ranges within a larger range that contain unloaded rows.\n *\n * @param isItemLoaded\n * @param minimumBatchSize\n * @param items\n * @param totalItems\n * @param startIndex\n * @param stopIndex\n */\nfunction scanForUnloadedRanges<Item>(\n  isItemLoaded: UseInfiniteLoaderOptions<Item>[\"isItemLoaded\"] = defaultIsItemLoaded,\n  minimumBatchSize: UseInfiniteLoaderOptions<Item>[\"minimumBatchSize\"] = 16,\n  items: any[],\n  totalItems: UseInfiniteLoaderOptions<Item>[\"totalItems\"] = 9e9,\n  startIndex: number,\n  stopIndex: number\n): number[] {\n  const unloadedRanges: number[] = [];\n  let rangeStartIndex: number | undefined,\n    rangeStopIndex: number | undefined,\n    index = startIndex;\n\n  /* istanbul ignore next */\n  for (; index <= stopIndex; index++) {\n    if (!isItemLoaded(index, items)) {\n      rangeStopIndex = index;\n      if (rangeStartIndex === void 0) rangeStartIndex = index;\n    } else if (rangeStartIndex !== void 0 && rangeStopIndex !== void 0) {\n      unloadedRanges.push(rangeStartIndex, rangeStopIndex);\n      rangeStartIndex = rangeStopIndex = void 0;\n    }\n  }\n\n  // If :rangeStopIndex is not null it means we haven't run out of unloaded rows.\n  // Scan forward to try filling our :minimumBatchSize.\n  if (rangeStartIndex !== void 0 && rangeStopIndex !== void 0) {\n    const potentialStopIndex = Math.min(\n      Math.max(rangeStopIndex, rangeStartIndex + minimumBatchSize - 1),\n      totalItems - 1\n    );\n\n    /* istanbul ignore next */\n    for (index = rangeStopIndex + 1; index <= potentialStopIndex; index++) {\n      if (!isItemLoaded(index, items)) {\n        rangeStopIndex = index;\n      } else {\n        break;\n      }\n    }\n\n    unloadedRanges.push(rangeStartIndex, rangeStopIndex);\n  }\n\n  // Check to see if our first range ended prematurely.\n  // In this case we should scan backwards to try filling our :minimumBatchSize.\n  /* istanbul ignore next */\n  if (unloadedRanges.length) {\n    let firstUnloadedStart = unloadedRanges[0];\n    const firstUnloadedStop = unloadedRanges[1];\n\n    while (\n      firstUnloadedStop - firstUnloadedStart + 1 < minimumBatchSize &&\n      firstUnloadedStart > 0\n    ) {\n      const index = firstUnloadedStart - 1;\n\n      if (!isItemLoaded(index, items)) {\n        unloadedRanges[0] = firstUnloadedStart = index;\n      } else {\n        break;\n      }\n    }\n  }\n\n  return unloadedRanges;\n}\n\nconst defaultIsItemLoaded = <Item>(index: number, items: Item[]): boolean =>\n  items[index] !== void 0;\n\nexport interface UseInfiniteLoaderOptions<Item> {\n  /**\n   *  A callback responsible for determining the loaded state of each item. Should return `true`\n   * if the item has already been loaded and `false` if not.\n   *\n   * @default (index: number, items: any[]) => boolean\n   */\n  isItemLoaded?: (index: number, items: Item[]) => boolean;\n  /**\n   * The minimum number of new items to be loaded at a time.  This property can be used to\n   * batch requests and reduce HTTP requests.\n   *\n   * @default 16\n   */\n  minimumBatchSize?: number;\n  /**\n   * The threshold at which to pre-fetch data. A threshold X means that new data should start\n   * loading when a user scrolls within X cells of the end of your `items` array.\n   *\n   * @default 16\n   */\n  threshold?: number;\n  /**\n   * The total number of items you'll need to eventually load (if known). This can\n   * be arbitrarily high if not known.\n   *\n   * @default 9e9\n   */\n  totalItems?: number;\n}\n\nexport type LoadMoreItemsCallback<Item> = (\n  startIndex: number,\n  stopIndex: number,\n  items: Item[]\n) => any;\n\nconst emptyObj = {};\n","import * as React from \"react\";\nimport { Masonry } from \"./masonry\";\nimport type { MasonryProps } from \"./masonry\";\n\n/**\n * This is just a single-column `<Masonry>` component without column-specific props.\n *\n * @param props\n */\nexport function List<Item>(props: ListProps<Item>) {\n  return (\n    <Masonry<Item>\n      role=\"list\"\n      rowGutter={props.rowGutter}\n      columnCount={1}\n      columnWidth={1}\n      {...props}\n    />\n  );\n}\n\nexport interface ListProps<Item>\n  extends Omit<\n    MasonryProps<Item>,\n    \"columGutter\" | \"columnCount\" | \"columnWidth\"\n  > {\n  /**\n   * The amount of vertical space in pixels to add between the list cells.\n   *\n   * @default 0\n   */\n  rowGutter?: number;\n}\n\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n  List.displayName = \"List\";\n}\n"],"names":["updateMax","node","max","high","L","NULL_NODE","R","Math","updateMaxUp","x","P","rotateLeft","tree","y","root","rotateRight","replaceNode","createIntervalTree","size","indexMap","insert","low","index","treeNode","prevNode","list","next","addInterval","z","C","fixInsert","remove","intervalResult","removeInterval","originalYColor","minimumTree","w","fixRemove","search","callback","stack","length","pop","push","curr","useEvent","target","type","listener","cleanup","storedListener","React","useRef","storedCleanup","useEffect","current","didUnsubscribe","args","apply","this","targetEl","addEventListener","removeEventListener","useForceUpdate","setState","useState","emptyObj","useMasonry","stopIndex","positioner","resizeObserver","items","as","ContainerComponent","id","className","style","role","tabIndex","containerRef","itemAs","ItemComponent","itemStyle","itemHeightEstimate","itemKey","defaultGetItemKey","overscanBy","scrollTop","isScrolling","height","RenderComponent","render","onRender","startIndex","forceUpdate","setItemRef","getRefSetter","itemCount","columnWidth","columnCount","range","estimateHeight","shortestColumn","measuredCount","shortestColumnSize","children","itemRole","undefined","storedOnRender","useLatest","rangeEnd","needsFreshBatch","left","top","data","key","phaseTwoStyle","width","writingMode","position","__reactCreateElement__","ref","_extends","createRenderElement","min","batchSize","ceil","phaseOneStyle","getCachedSize","didEverMount","containerStyle","getContainerStyle","assignUserStyle","_","i","useThrottleCallback","fps","leading","prev","clearTrailing","storedCallback","ms","trailingTimeout","clearTimeout","deps","useCallback","arguments","rightNow","now","call","setTimeout","useScroller","offset","useScrollPosition","setIsScrolling","didMount","fn","start","handle","to","v","raf","loop","caf","clearRequestTimeout","MasonryScroller","props","scrollFps","useContainerPosition","elementRef","emptyArr","containerPosition","setContainerPosition","useLayoutEffect","el","offsetTop","offsetParent","offsetWidth","usePositioner","columnGutter","rowGutter","maxColumnCount","maxColumnWidth","initPositioner","getColumns","computedColumnWidth","computedColumnCount","createPositioner","positionerRef","prevDeps","opts","prevOpts","optsChanged","every","item","prevPositioner","cacheSize","pos","get","set","useResizeObserver","disconnect","createResizeObserver","handler","cancel","useScrollToIndex","options","align","element","window","innerHeight","latestOptions","getTarget","latestElement","useReducer","state","action","nextState","prevTop","value","defaultState","dispatch","throttledDispatch","currentTop","_latestOptions$curren","scrollTo","timeout","estimatedTop","Masonry","windowSize","wait","initialWidth","initialHeight","initialState","useDebounceCallback","useDebounce","document","getSize","setDebouncedSize","setSize","win","wv","useWindowSize","ssrWidth","ssrHeight","containerPos","nextProps","scrollToIndex","storedValue","visualViewport","documentElement","clientWidth","clientHeight","areEqual","equal","defaultAreEqual","val","k","createCache","obj","e","cache","mapConstructors","constructors","base","map","depth","baseCache","one","g","s","elementsCache","WeakMap","trieMemoize","OneKeyMap","memoizeOne","maxWidth","maxHeight","willChange","pointerEvents","cmp2","pargs","userStyle","zIndex","visibility","observe","offsetHeight","u","p","performance","Date","af","Caf","Raf","bind","lastTime","h","perf","getScrollY","scrollY","pageYOffset","useThrottle","createElement","intervalTree","columnHeights","Array","columnItems","column","update","updates","columns","j","itemsInColumn","binarySearch","startItem","lo","hi","renderCallback","defaultItemHeight","tallestColumn","all","a","l","m","minimumWidth","gutter","floor","Infinity","frameId","lastArgs","wrapperFn","_len","_key","requestAnimationFrame","cancelAnimationFrame","updater","rafSchd","commonHandler","handlers","Map","ro","ResizeObserver","entries","entry","forEach","defaultIsItemLoaded","loadMoreItems","isItemLoaded","minimumBatchSize","threshold","totalItems","storedLoadMoreItems","storedIsItemLoaded","unloadedRanges","rangeStartIndex","rangeStopIndex","potentialStopIndex","firstUnloadedStart","firstUnloadedStop","scanForUnloadedRanges"],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"masonic.js","sources":["../../src/interval-tree.ts","../../node_modules/.pnpm/@react-hook+event@1.2.6_react@17.0.2/node_modules/@react-hook/event/src/index.tsx","../../src/use-force-update.ts","../../src/use-masonry.tsx","../../node_modules/.pnpm/@react-hook+throttle@2.2.0_react@17.0.2/node_modules/@react-hook/throttle/src/index.tsx","../../src/use-scroller.ts","../../node_modules/.pnpm/@essentials+request-timeout@1.3.0/node_modules/@essentials/request-timeout/src/index.ts","../../src/masonry-scroller.tsx","../../src/use-container-position.ts","../../src/use-positioner.ts","../../src/use-resize-observer.ts","../../src/use-scroll-to-index.ts","../../src/masonry.tsx","../../node_modules/.pnpm/@react-hook+window-size@3.1.1_react@17.0.2/node_modules/@react-hook/window-size/src/index.tsx","../../node_modules/.pnpm/@react-hook+debounce@3.0.0_react@17.0.2/node_modules/@react-hook/debounce/src/index.tsx","../../node_modules/.pnpm/@react-hook+latest@1.0.3_react@17.0.2/node_modules/@react-hook/latest/src/index.tsx","../../node_modules/.pnpm/@essentials+memoize-one@1.1.0/node_modules/@essentials/memoize-one/src/index.ts","../../node_modules/.pnpm/@essentials+one-key-map@1.2.0/node_modules/@essentials/one-key-map/src/index.ts","../../node_modules/.pnpm/trie-memoize@1.2.0/node_modules/trie-memoize/src/index.ts","../../src/elements-cache.ts","../../node_modules/.pnpm/@essentials+raf@1.2.0/node_modules/@essentials/raf/src/index.ts","../../node_modules/.pnpm/@react-hook+window-scroll@1.3.0_react@17.0.2/node_modules/@react-hook/window-scroll/src/index.tsx","../../node_modules/.pnpm/@react-hook+passive-layout-effect@1.2.1_react@17.0.2/node_modules/@react-hook/passive-layout-effect/src/index.tsx","../../node_modules/.pnpm/raf-schd@4.0.3/node_modules/raf-schd/dist/raf-schd.esm.js","../../src/use-infinite-loader.ts","../../src/list.tsx"],"sourcesContent":["type Color = 0 | 1 | 2;\r\nconst RED = 0;\r\nconst BLACK = 1;\r\nconst NIL = 2;\r\n\r\nconst DELETE = 0;\r\nconst KEEP = 1;\r\n\r\ntype ListNode = {\r\n  index: number;\r\n  high: number;\r\n  next: ListNode | null;\r\n};\r\n\r\ninterface TreeNode {\r\n  max: number;\r\n  low: number;\r\n  high: number;\r\n  // color\r\n  C: Color;\r\n  // P\r\n  P: TreeNode;\r\n  // right\r\n  R: TreeNode;\r\n  // left\r\n  L: TreeNode;\r\n  list: ListNode;\r\n}\r\n\r\ninterface Tree {\r\n  root: TreeNode;\r\n  size: number;\r\n}\r\n\r\nfunction addInterval(treeNode: TreeNode, high: number, index: number): boolean {\r\n  let node: ListNode | null = treeNode.list;\r\n  let prevNode: ListNode | undefined;\r\n\r\n  while (node) {\r\n    if (node.index === index) return false;\r\n    if (high > node.high) break;\r\n    prevNode = node;\r\n    node = node.next;\r\n  }\r\n\r\n  if (!prevNode) treeNode.list = { index, high, next: node };\r\n  if (prevNode) prevNode.next = { index, high, next: prevNode.next };\r\n\r\n  return true;\r\n}\r\n\r\nfunction removeInterval(treeNode: TreeNode, index: number) {\r\n  let node: ListNode | null = treeNode.list;\r\n  if (node.index === index) {\r\n    if (node.next === null) return DELETE;\r\n    treeNode.list = node.next;\r\n    return KEEP;\r\n  }\r\n\r\n  let prevNode: ListNode | undefined = node;\r\n  node = node.next;\r\n\r\n  while (node !== null) {\r\n    if (node.index === index) {\r\n      prevNode.next = node.next;\r\n      return KEEP;\r\n    }\r\n    prevNode = node;\r\n    node = node.next;\r\n  }\r\n}\r\n\r\nconst NULL_NODE: TreeNode = {\r\n  low: 0,\r\n  max: 0,\r\n  high: 0,\r\n  C: NIL,\r\n  // @ts-expect-error\r\n  P: undefined,\r\n  // @ts-expect-error\r\n  R: undefined,\r\n  // @ts-expect-error\r\n  L: undefined,\r\n  // @ts-expect-error\r\n  list: undefined,\r\n};\r\n\r\nNULL_NODE.P = NULL_NODE;\r\nNULL_NODE.L = NULL_NODE;\r\nNULL_NODE.R = NULL_NODE;\r\n\r\nfunction updateMax(node: TreeNode) {\r\n  const max = node.high;\r\n  if (node.L === NULL_NODE && node.R === NULL_NODE) node.max = max;\r\n  else if (node.L === NULL_NODE) node.max = Math.max(node.R.max, max);\r\n  else if (node.R === NULL_NODE) node.max = Math.max(node.L.max, max);\r\n  else node.max = Math.max(Math.max(node.L.max, node.R.max), max);\r\n}\r\n\r\nfunction updateMaxUp(node: TreeNode) {\r\n  let x = node;\r\n\r\n  while (x.P !== NULL_NODE) {\r\n    updateMax(x.P);\r\n    x = x.P;\r\n  }\r\n}\r\n\r\nfunction rotateLeft(tree: Tree, x: TreeNode) {\r\n  if (x.R === NULL_NODE) return;\r\n  const y = x.R;\r\n  x.R = y.L;\r\n  if (y.L !== NULL_NODE) y.L.P = x;\r\n  y.P = x.P;\r\n\r\n  if (x.P === NULL_NODE) tree.root = y;\r\n  else if (x === x.P.L) x.P.L = y;\r\n  else x.P.R = y;\r\n\r\n  y.L = x;\r\n  x.P = y;\r\n\r\n  updateMax(x);\r\n  updateMax(y);\r\n}\r\n\r\nfunction rotateRight(tree: Tree, x: TreeNode) {\r\n  if (x.L === NULL_NODE) return;\r\n  const y = x.L;\r\n  x.L = y.R;\r\n  if (y.R !== NULL_NODE) y.R.P = x;\r\n  y.P = x.P;\r\n\r\n  if (x.P === NULL_NODE) tree.root = y;\r\n  else if (x === x.P.R) x.P.R = y;\r\n  else x.P.L = y;\r\n\r\n  y.R = x;\r\n  x.P = y;\r\n\r\n  updateMax(x);\r\n  updateMax(y);\r\n}\r\n\r\nfunction replaceNode(tree: Tree, x: TreeNode, y: TreeNode) {\r\n  if (x.P === NULL_NODE) tree.root = y;\r\n  else if (x === x.P.L) x.P.L = y;\r\n  else x.P.R = y;\r\n  y.P = x.P;\r\n}\r\n\r\nfunction fixRemove(tree: Tree, x: TreeNode) {\r\n  let w;\r\n\r\n  while (x !== NULL_NODE && x.C === BLACK) {\r\n    if (x === x.P.L) {\r\n      w = x.P.R;\r\n\r\n      if (w.C === RED) {\r\n        w.C = BLACK;\r\n        x.P.C = RED;\r\n        rotateLeft(tree, x.P);\r\n        w = x.P.R;\r\n      }\r\n\r\n      if (w.L.C === BLACK && w.R.C === BLACK) {\r\n        w.C = RED;\r\n        x = x.P;\r\n      } else {\r\n        if (w.R.C === BLACK) {\r\n          w.L.C = BLACK;\r\n          w.C = RED;\r\n          rotateRight(tree, w);\r\n          w = x.P.R;\r\n        }\r\n\r\n        w.C = x.P.C;\r\n        x.P.C = BLACK;\r\n        w.R.C = BLACK;\r\n        rotateLeft(tree, x.P);\r\n        x = tree.root;\r\n      }\r\n    } else {\r\n      w = x.P.L;\r\n\r\n      if (w.C === RED) {\r\n        w.C = BLACK;\r\n        x.P.C = RED;\r\n        rotateRight(tree, x.P);\r\n        w = x.P.L;\r\n      }\r\n\r\n      if (w.R.C === BLACK && w.L.C === BLACK) {\r\n        w.C = RED;\r\n        x = x.P;\r\n      } else {\r\n        if (w.L.C === BLACK) {\r\n          w.R.C = BLACK;\r\n          w.C = RED;\r\n          rotateLeft(tree, w);\r\n          w = x.P.L;\r\n        }\r\n\r\n        w.C = x.P.C;\r\n        x.P.C = BLACK;\r\n        w.L.C = BLACK;\r\n        rotateRight(tree, x.P);\r\n        x = tree.root;\r\n      }\r\n    }\r\n  }\r\n\r\n  x.C = BLACK;\r\n}\r\n\r\nfunction minimumTree(x: TreeNode) {\r\n  while (x.L !== NULL_NODE) x = x.L;\r\n  return x;\r\n}\r\n\r\nfunction fixInsert(tree: Tree, z: TreeNode) {\r\n  let y: TreeNode;\r\n  while (z.P.C === RED) {\r\n    if (z.P === z.P.P.L) {\r\n      y = z.P.P.R;\r\n\r\n      if (y.C === RED) {\r\n        z.P.C = BLACK;\r\n        y.C = BLACK;\r\n        z.P.P.C = RED;\r\n        z = z.P.P;\r\n      } else {\r\n        if (z === z.P.R) {\r\n          z = z.P;\r\n          rotateLeft(tree, z);\r\n        }\r\n\r\n        z.P.C = BLACK;\r\n        z.P.P.C = RED;\r\n        rotateRight(tree, z.P.P);\r\n      }\r\n    } else {\r\n      y = z.P.P.L;\r\n\r\n      if (y.C === RED) {\r\n        z.P.C = BLACK;\r\n        y.C = BLACK;\r\n        z.P.P.C = RED;\r\n        z = z.P.P;\r\n      } else {\r\n        if (z === z.P.L) {\r\n          z = z.P;\r\n          rotateRight(tree, z);\r\n        }\r\n\r\n        z.P.C = BLACK;\r\n        z.P.P.C = RED;\r\n        rotateLeft(tree, z.P.P);\r\n      }\r\n    }\r\n  }\r\n  tree.root.C = BLACK;\r\n}\r\n\r\nexport interface IIntervalTree {\r\n  insert(low: number, high: number, index: number): void;\r\n  remove(index: number): void;\r\n  search(\r\n    low: number,\r\n    high: number,\r\n    callback: (index: number, low: number) => any\r\n  ): void;\r\n  size: number;\r\n}\r\n\r\nexport function createIntervalTree(): IIntervalTree {\r\n  const tree = {\r\n    root: NULL_NODE,\r\n    size: 0,\r\n  };\r\n  // we know these indexes are a consistent, safe way to make look ups\r\n  // for our case so it's a solid O(1) alternative to\r\n  // the O(log n) searchNode() in typical interval trees\r\n  const indexMap: Record<number, TreeNode> = {};\r\n\r\n  return {\r\n    insert(low, high, index) {\r\n      let x: TreeNode = tree.root;\r\n      let y: TreeNode = NULL_NODE;\r\n\r\n      while (x !== NULL_NODE) {\r\n        y = x;\r\n        if (low === y.low) break;\r\n        if (low < x.low) x = x.L;\r\n        else x = x.R;\r\n      }\r\n\r\n      if (low === y.low && y !== NULL_NODE) {\r\n        if (!addInterval(y, high, index)) return;\r\n        y.high = Math.max(y.high, high);\r\n        updateMax(y);\r\n        updateMaxUp(y);\r\n        indexMap[index] = y;\r\n        tree.size++;\r\n        return;\r\n      }\r\n\r\n      const z: TreeNode = {\r\n        low,\r\n        high,\r\n        max: high,\r\n        C: RED,\r\n        P: y,\r\n        L: NULL_NODE,\r\n        R: NULL_NODE,\r\n        list: { index, high, next: null },\r\n      };\r\n\r\n      if (y === NULL_NODE) {\r\n        tree.root = z;\r\n      } else {\r\n        if (z.low < y.low) y.L = z;\r\n        else y.R = z;\r\n        updateMaxUp(z);\r\n      }\r\n\r\n      fixInsert(tree, z);\r\n      indexMap[index] = z;\r\n      tree.size++;\r\n    },\r\n\r\n    remove(index) {\r\n      const z = indexMap[index];\r\n      if (z === void 0) return;\r\n      delete indexMap[index];\r\n\r\n      const intervalResult = removeInterval(z, index);\r\n      if (intervalResult === void 0) return;\r\n      if (intervalResult === KEEP) {\r\n        z.high = z.list.high;\r\n        updateMax(z);\r\n        updateMaxUp(z);\r\n        tree.size--;\r\n        return;\r\n      }\r\n\r\n      let y = z;\r\n      let originalYColor = y.C;\r\n      let x: TreeNode;\r\n\r\n      if (z.L === NULL_NODE) {\r\n        x = z.R;\r\n        replaceNode(tree, z, z.R);\r\n      } else if (z.R === NULL_NODE) {\r\n        x = z.L;\r\n        replaceNode(tree, z, z.L);\r\n      } else {\r\n        y = minimumTree(z.R);\r\n        originalYColor = y.C;\r\n        x = y.R;\r\n\r\n        if (y.P === z) {\r\n          x.P = y;\r\n        } else {\r\n          replaceNode(tree, y, y.R);\r\n          y.R = z.R;\r\n          y.R.P = y;\r\n        }\r\n\r\n        replaceNode(tree, z, y);\r\n        y.L = z.L;\r\n        y.L.P = y;\r\n        y.C = z.C;\r\n      }\r\n\r\n      updateMax(x);\r\n      updateMaxUp(x);\r\n\r\n      if (originalYColor === BLACK) fixRemove(tree, x);\r\n      tree.size--;\r\n    },\r\n\r\n    search(low, high, callback) {\r\n      const stack = [tree.root];\r\n      while (stack.length !== 0) {\r\n        const node = stack.pop() as TreeNode;\r\n        if (node === NULL_NODE || low > node.max) continue;\r\n        if (node.L !== NULL_NODE) stack.push(node.L);\r\n        if (node.R !== NULL_NODE) stack.push(node.R);\r\n        if (node.low <= high && node.high >= low) {\r\n          let curr: ListNode | null = node.list;\r\n          while (curr !== null) {\r\n            if (curr.high >= low) callback(curr.index, node.low);\r\n            curr = curr.next;\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    get size() {\r\n      return tree.size;\r\n    },\r\n  };\r\n}\r\n","import * as React from 'react'\n\nfunction useEvent<\n  T extends Window = Window,\n  K extends keyof WindowEventMap = keyof WindowEventMap\n>(\n  target: Window | null,\n  type: K,\n  listener: WindowEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent<\n  T extends Document = Document,\n  K extends keyof DocumentEventMap = keyof DocumentEventMap\n>(\n  target: Document | null,\n  type: K,\n  listener: DocumentEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent<\n  T extends HTMLElement = HTMLElement,\n  K extends keyof HTMLElementEventMap = keyof HTMLElementEventMap\n>(\n  target: React.RefObject<T> | T | null,\n  type: K,\n  listener: ElementEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent(target: any, type: any, listener: any, cleanup: any): void {\n  const storedListener = React.useRef(listener)\n  const storedCleanup = React.useRef(cleanup)\n\n  React.useEffect(() => {\n    storedListener.current = listener\n    storedCleanup.current = cleanup\n  })\n\n  React.useEffect(() => {\n    const targetEl = target && 'current' in target ? target.current : target\n    if (!targetEl) return\n\n    let didUnsubscribe = 0\n    function listener(this: any, ...args: any[]) {\n      if (didUnsubscribe) return\n      storedListener.current.apply(this, args)\n    }\n\n    targetEl.addEventListener(type, listener)\n    const cleanup = storedCleanup.current\n\n    return () => {\n      didUnsubscribe = 1\n      targetEl.removeEventListener(type, listener)\n      cleanup && cleanup()\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [target, type])\n}\n\nexport type ElementEventListener<\n  K extends keyof HTMLElementEventMap = keyof HTMLElementEventMap\n> = (this: HTMLElement, ev: HTMLElementEventMap[K]) => any\n\nexport type DocumentEventListener<\n  K extends keyof DocumentEventMap = keyof DocumentEventMap\n> = (this: Document, ev: DocumentEventMap[K]) => any\n\nexport type WindowEventListener<\n  K extends keyof WindowEventMap = keyof WindowEventMap\n> = (this: Document, ev: WindowEventMap[K]) => any\n\nexport default useEvent\n","import * as React from \"react\";\r\n\r\nexport function useForceUpdate() {\r\n  const setState = React.useState(emptyObj)[1];\r\n  return React.useRef(() => setState({})).current;\r\n}\r\n\r\nconst emptyObj = {};\r\n","import memoizeOne from \"@essentials/memoize-one\";\r\nimport OneKeyMap from \"@essentials/one-key-map\";\r\nimport useLatest from \"@react-hook/latest\";\r\nimport * as React from \"react\";\r\nimport trieMemoize from \"trie-memoize\";\r\nimport { elementsCache } from \"./elements-cache\";\r\nimport { useForceUpdate } from \"./use-force-update\";\r\nimport type { Positioner } from \"./use-positioner\";\r\n\r\n/**\r\n * This hook handles the render phases of the masonry layout and returns the grid as a React element.\r\n *\r\n * @param options - Options for configuring the masonry layout renderer. See `UseMasonryOptions`.\r\n * @param options.positioner\r\n * @param options.resizeObserver\r\n * @param options.items\r\n * @param options.as\r\n * @param options.id\r\n * @param options.className\r\n * @param options.style\r\n * @param options.role\r\n * @param options.tabIndex\r\n * @param options.containerRef\r\n * @param options.itemAs\r\n * @param options.itemStyle\r\n * @param options.itemHeightEstimate\r\n * @param options.itemKey\r\n * @param options.overscanBy\r\n * @param options.scrollTop\r\n * @param options.isScrolling\r\n * @param options.height\r\n * @param options.render\r\n * @param options.onRender\r\n */\r\nexport function useMasonry<Item>({\r\n  // Measurement and layout\r\n  positioner,\r\n  resizeObserver,\r\n  // Grid items\r\n  items,\r\n  // Container props\r\n  as: ContainerComponent = \"div\",\r\n  id,\r\n  className,\r\n  style,\r\n  role = \"grid\",\r\n  tabIndex = 0,\r\n  containerRef,\r\n  // Item props\r\n  itemAs: ItemComponent = \"div\",\r\n  itemStyle,\r\n  itemHeightEstimate = 300,\r\n  itemKey = defaultGetItemKey,\r\n  // Rendering props\r\n  overscanBy = 2,\r\n  scrollTop,\r\n  isScrolling,\r\n  height,\r\n  render: RenderComponent,\r\n  onRender,\r\n}: UseMasonryOptions<Item>) {\r\n  let startIndex = 0;\r\n  let stopIndex: number | undefined;\r\n  const forceUpdate = useForceUpdate();\r\n  const setItemRef = getRefSetter(positioner, resizeObserver);\r\n  const itemCount = items.length;\r\n  const {\r\n    columnWidth,\r\n    columnCount,\r\n    range,\r\n    estimateHeight,\r\n    size,\r\n    shortestColumn,\r\n  } = positioner;\r\n  const measuredCount = size();\r\n  const shortestColumnSize = shortestColumn();\r\n  const children: React.ReactElement[] = [];\r\n  const itemRole =\r\n    role === \"list\" ? \"listitem\" : role === \"grid\" ? \"gridcell\" : undefined;\r\n  const storedOnRender = useLatest(onRender);\r\n\r\n  overscanBy = height * overscanBy;\r\n  const rangeEnd = scrollTop + overscanBy;\r\n  const needsFreshBatch =\r\n    shortestColumnSize < rangeEnd && measuredCount < itemCount;\r\n\r\n  range(\r\n    // We overscan in both directions because users scroll both ways,\r\n    // though one must admit scrolling down is more common and thus\r\n    // we only overscan by half the downward overscan amount\r\n    Math.max(0, scrollTop - overscanBy / 2),\r\n    rangeEnd,\r\n    (index, left, top) => {\r\n      const data = items[index];\r\n      const key = itemKey(data, index);\r\n      const phaseTwoStyle: React.CSSProperties = {\r\n        top,\r\n        left,\r\n        width: columnWidth,\r\n        writingMode: \"horizontal-tb\",\r\n        position: \"absolute\",\r\n      };\r\n\r\n      /* istanbul ignore next */\r\n      if (\r\n        typeof process !== \"undefined\" &&\r\n        process.env.NODE_ENV !== \"production\"\r\n      ) {\r\n        throwWithoutData(data, index);\r\n      }\r\n\r\n      children.push(\r\n        <ItemComponent\r\n          key={key}\r\n          ref={setItemRef(index)}\r\n          role={itemRole}\r\n          style={\r\n            typeof itemStyle === \"object\" && itemStyle !== null\r\n              ? Object.assign({}, phaseTwoStyle, itemStyle)\r\n              : phaseTwoStyle\r\n          }\r\n        >\r\n          {createRenderElement(RenderComponent, index, data, columnWidth)}\r\n        </ItemComponent>\r\n      );\r\n\r\n      if (stopIndex === void 0) {\r\n        startIndex = index;\r\n        stopIndex = index;\r\n      } else {\r\n        startIndex = Math.min(startIndex, index);\r\n        stopIndex = Math.max(stopIndex, index);\r\n      }\r\n    }\r\n  );\r\n\r\n  if (needsFreshBatch) {\r\n    const batchSize = Math.min(\r\n      itemCount - measuredCount,\r\n      Math.ceil(\r\n        ((scrollTop + overscanBy - shortestColumnSize) / itemHeightEstimate) *\r\n          columnCount\r\n      )\r\n    );\r\n\r\n    let index = measuredCount;\r\n    const phaseOneStyle = getCachedSize(columnWidth);\r\n\r\n    for (; index < measuredCount + batchSize; index++) {\r\n      const data = items[index];\r\n      const key = itemKey(data, index);\r\n\r\n      /* istanbul ignore next */\r\n      if (\r\n        typeof process !== \"undefined\" &&\r\n        process.env.NODE_ENV !== \"production\"\r\n      ) {\r\n        throwWithoutData(data, index);\r\n      }\r\n\r\n      children.push(\r\n        <ItemComponent\r\n          key={key}\r\n          ref={setItemRef(index)}\r\n          role={itemRole}\r\n          style={\r\n            typeof itemStyle === \"object\"\r\n              ? Object.assign({}, phaseOneStyle, itemStyle)\r\n              : phaseOneStyle\r\n          }\r\n        >\r\n          {createRenderElement(RenderComponent, index, data, columnWidth)}\r\n        </ItemComponent>\r\n      );\r\n    }\r\n  }\r\n\r\n  // Calls the onRender callback if the rendered indices changed\r\n  React.useEffect(() => {\r\n    if (typeof storedOnRender.current === \"function\" && stopIndex !== void 0)\r\n      storedOnRender.current(startIndex, stopIndex, items);\r\n\r\n    didEverMount = \"1\";\r\n  }, [startIndex, stopIndex, items, storedOnRender]);\r\n  // If we needed a fresh batch we should reload our components with the measured\r\n  // sizes\r\n  React.useEffect(() => {\r\n    if (needsFreshBatch) forceUpdate();\r\n    // eslint-disable-next-line\r\n  }, [needsFreshBatch, positioner]);\r\n\r\n  // gets the container style object based upon the estimated height and whether or not\r\n  // the page is being scrolled\r\n  const containerStyle = getContainerStyle(\r\n    isScrolling,\r\n    estimateHeight(itemCount, itemHeightEstimate)\r\n  );\r\n\r\n  return (\r\n    <ContainerComponent\r\n      ref={containerRef}\r\n      key={didEverMount}\r\n      id={id}\r\n      role={role}\r\n      className={className}\r\n      tabIndex={tabIndex}\r\n      style={\r\n        typeof style === \"object\"\r\n          ? assignUserStyle(containerStyle, style)\r\n          : containerStyle\r\n      }\r\n      children={children}\r\n    />\r\n  );\r\n}\r\n\r\n/* istanbul ignore next */\r\nfunction throwWithoutData(data: any, index: number) {\r\n  if (!data) {\r\n    throw new Error(\r\n      `No data was found at index: ${index}\\n\\n` +\r\n        `This usually happens when you've mutated or changed the \"items\" array in a ` +\r\n        `way that makes it shorter than the previous \"items\" array. Masonic knows nothing ` +\r\n        `about your underlying data and when it caches cell positions, it assumes you aren't ` +\r\n        `mutating the underlying \"items\".\\n\\n` +\r\n        `See https://codesandbox.io/s/masonic-w-react-router-example-2b5f9?file=/src/index.js for ` +\r\n        `an example that gets around this limitations. For advanced implementations, see ` +\r\n        `https://codesandbox.io/s/masonic-w-react-router-and-advanced-config-example-8em42?file=/src/index.js\\n\\n` +\r\n        `If this was the result of your removing an item from your \"items\", see this issue: ` +\r\n        `https://github.com/jaredLunde/masonic/issues/12`\r\n    );\r\n  }\r\n}\r\n\r\n// This is for triggering a remount after SSR has loaded in the client w/ hydrate()\r\nlet didEverMount = \"0\";\r\n\r\nexport interface UseMasonryOptions<Item> {\r\n  /**\r\n   * An array containing the data used by the grid items.\r\n   */\r\n  items: Item[];\r\n  /**\r\n   * A grid cell positioner and cache created by the `usePositioner()` hook or\r\n   * the `createPositioner` utility.\r\n   */\r\n  positioner: Positioner;\r\n  /**\r\n   * A resize observer that tracks mutations to the grid cells and forces the\r\n   * Masonry grid to recalculate its layout if any cells affect column heights\r\n   * change. Check out the `useResizeObserver()` hook.\r\n   */\r\n  resizeObserver?: {\r\n    observe: ResizeObserver[\"observe\"];\r\n    disconnect: ResizeObserver[\"observe\"];\r\n    unobserve: ResizeObserver[\"unobserve\"];\r\n  };\r\n  /**\r\n   * This is the type of element the grid container will be rendered as.\r\n   *\r\n   * @default \"div\"`\r\n   */\r\n  as?: keyof JSX.IntrinsicElements | React.ComponentType<any>;\r\n  /**\r\n   * Optionally gives the grid container an `id` prop.\r\n   */\r\n  id?: string;\r\n  /**\r\n   * Optionally gives the grid container a `className` prop.\r\n   */\r\n  className?: string;\r\n  /**\r\n   * Adds extra `style` attributes to the container in addition to those\r\n   * created by the `useMasonry()` hook.\r\n   */\r\n  style?: React.CSSProperties;\r\n  /**\r\n   * Optionally swap out the accessibility `role` prop of the container and its items.\r\n   *\r\n   * @default \"grid\"\r\n   */\r\n  role?: \"grid\" | \"list\";\r\n  /**\r\n   * Change the `tabIndex` of the grid container.\r\n   *\r\n   * @default 0\r\n   */\r\n  tabIndex?: number;\r\n  /**\r\n   * Forwards a React ref to the grid container.\r\n   */\r\n  containerRef?:\r\n    | ((element: HTMLElement) => void)\r\n    | React.MutableRefObject<HTMLElement | null>;\r\n  /**\r\n   * This is the type of element the grid items will be rendered as.\r\n   *\r\n   * @default \"div\"\r\n   */\r\n  itemAs?: keyof JSX.IntrinsicElements | React.ComponentType<any>;\r\n  /**\r\n   * Adds extra `style` attributes to the grid items in addition to those\r\n   * created by the `useMasonry()` hook.\r\n   */\r\n  itemStyle?: React.CSSProperties;\r\n  /**\r\n   * This value is used for estimating the initial height of the masonry grid. It is important for\r\n   * the UX of the scrolling behavior and in determining how many `items` to render in a batch, so it's\r\n   * wise to set this value with some level accuracy, though it doesn't need to be perfect.\r\n   *\r\n   * @default 300\r\n   */\r\n  itemHeightEstimate?: number;\r\n  /**\r\n   * The value returned here must be unique to the item. By default, the key is the item's index. This is ok\r\n   * if your collection of items is never modified. Setting this property ensures that the component in `render`\r\n   * is reused each time the masonry grid is reflowed. A common pattern would be to return the item's database\r\n   * ID here if there is one, e.g. `data => data.id`\r\n   *\r\n   * @default (data, index) => index`\r\n   */\r\n  itemKey?: (data: Item, index: number) => string | number;\r\n  /**\r\n   * This number is used for determining the number of grid cells outside of the visible window to render.\r\n   * The default value is `2` which means \"render 2 windows worth (2 * `height`) of content before and after\r\n   * the items in the visible window\". A value of `3` would be 3 windows worth of grid cells, so it's a\r\n   * linear relationship.\r\n   *\r\n   * Overscanning is important for preventing tearing when scrolling through items in the grid, but setting\r\n   * too high of a vaimport { useForceUpdate } from './use-force-update';\r\nlue may create too much work for React to handle, so it's best that you tune this\r\n   * value accordingly.\r\n   *\r\n   * @default 2\r\n   */\r\n  overscanBy?: number;\r\n\r\n  /**\r\n   * This is the height of the window. If you're rendering the grid relative to the browser `window`,\r\n   * the current `document.documentElement.clientHeight` is the value you'll want to set here. If you're\r\n   * rendering the grid inside of another HTML element, you'll want to provide the current `element.offsetHeight`\r\n   * here.\r\n   */\r\n  height: number;\r\n  /**\r\n   * The current scroll progress in pixel of the window the grid is rendered in. If you're rendering\r\n   * the grid relative to the browser `window`, you'll want the most current `window.scrollY` here.\r\n   * If you're rendering the grid inside of another HTML element, you'll want the current `element.scrollTop`\r\n   * value here. The `useScroller()` hook and `<MasonryScroller>` components will help you if you're\r\n   * rendering the grid relative to the browser `window`.\r\n   */\r\n  scrollTop: number;\r\n  /**\r\n   * This property is used for determining whether or not the grid container should add styles that\r\n   * dramatically increase scroll performance. That is, turning off `pointer-events` and adding a\r\n   * `will-change: contents;` value to the style string. You can forgo using this prop, but I would\r\n   * not recommend that. The `useScroller()` hook and `<MasonryScroller>` components will help you if\r\n   * you're rendering the grid relative to the browser `window`.\r\n   *\r\n   * @default false\r\n   */\r\n  isScrolling?: boolean;\r\n  /**\r\n   * This component is rendered for each item of your `items` prop array. It should accept three props:\r\n   * `index`, `width`, and `data`. See RenderComponentProps.\r\n   */\r\n  render: React.ComponentType<RenderComponentProps<Item>>;\r\n  /**\r\n   * This callback is invoked any time the items currently being rendered by the grid change.\r\n   */\r\n  onRender?: (startIndex: number, stopIndex: number, items: Item[]) => void;\r\n}\r\n\r\nexport interface RenderComponentProps<Item> {\r\n  /**\r\n   * The index of the cell in the `items` prop array.\r\n   */\r\n  index: number;\r\n  /**\r\n   * The rendered width of the cell's column.\r\n   */\r\n  width: number;\r\n  /**\r\n   * The data at `items[index]` of your `items` prop array.\r\n   */\r\n  data: Item;\r\n}\r\n\r\n//\r\n// Render-phase utilities\r\n\r\n// ~5.5x faster than createElement without the memo\r\nconst createRenderElement = trieMemoize(\r\n  [OneKeyMap, {}, WeakMap, OneKeyMap],\r\n  (RenderComponent, index, data, columnWidth) => (\r\n    <RenderComponent index={index} data={data} width={columnWidth} />\r\n  )\r\n);\r\n\r\nconst getContainerStyle = memoizeOne(\r\n  (isScrolling: boolean | undefined, estimateHeight: number) => ({\r\n    position: \"relative\",\r\n    width: \"100%\",\r\n    maxWidth: \"100%\",\r\n    height: Math.ceil(estimateHeight),\r\n    maxHeight: Math.ceil(estimateHeight),\r\n    willChange: isScrolling ? \"contents\" : void 0,\r\n    pointerEvents: isScrolling ? \"none\" : void 0,\r\n  })\r\n);\r\n\r\nconst cmp2 = (args: IArguments, pargs: IArguments | any[]): boolean =>\r\n  args[0] === pargs[0] && args[1] === pargs[1];\r\n\r\nconst assignUserStyle = memoizeOne(\r\n  (containerStyle, userStyle) => Object.assign({}, containerStyle, userStyle),\r\n  // @ts-expect-error\r\n  cmp2\r\n);\r\n\r\nfunction defaultGetItemKey<Item>(_: Item, i: number) {\r\n  return i;\r\n}\r\n\r\n// the below memoizations for for ensuring shallow equal is reliable for pure\r\n// component children\r\nconst getCachedSize = memoizeOne(\r\n  (width: number): React.CSSProperties => ({\r\n    width,\r\n    zIndex: -1000,\r\n    visibility: \"hidden\",\r\n    position: \"absolute\",\r\n    writingMode: \"horizontal-tb\",\r\n  }),\r\n  (args, pargs) => args[0] === pargs[0]\r\n);\r\n\r\nconst getRefSetter = memoizeOne(\r\n  (\r\n      positioner: Positioner,\r\n      resizeObserver?: UseMasonryOptions<any>[\"resizeObserver\"]\r\n    ) =>\r\n    (index: number) =>\r\n    (el: HTMLElement | null): void => {\r\n      if (el === null) return;\r\n      if (resizeObserver) {\r\n        resizeObserver.observe(el);\r\n        elementsCache.set(el, index);\r\n      }\r\n      if (positioner.get(index) === void 0)\r\n        positioner.set(index, el.offsetHeight);\r\n    },\r\n  // @ts-expect-error\r\n  cmp2\r\n);\r\n","import * as React from 'react'\nimport useLatest from '@react-hook/latest'\n\nconst perf = typeof performance !== 'undefined' ? performance : Date\nconst now = () => perf.now()\n\nexport function useThrottleCallback<CallbackArguments extends any[]>(\n  callback: (...args: CallbackArguments) => void,\n  fps = 30,\n  leading = false\n): (...args: CallbackArguments) => void {\n  const storedCallback = useLatest(callback)\n  const ms = 1000 / fps\n  const prev = React.useRef(0)\n  const trailingTimeout = React.useRef<ReturnType<typeof setTimeout>>()\n  const clearTrailing = () =>\n    trailingTimeout.current && clearTimeout(trailingTimeout.current)\n  const deps = [fps, leading, storedCallback]\n\n  // Reset any time the deps change\n  React.useEffect(\n    () => () => {\n      prev.current = 0\n      clearTrailing()\n    },\n    deps\n  )\n\n  return React.useCallback(function () {\n    // eslint-disable-next-line prefer-rest-params\n    const args = arguments\n    const rightNow = now()\n    const call = () => {\n      prev.current = rightNow\n      clearTrailing()\n      storedCallback.current.apply(null, args as any)\n    }\n    const current = prev.current\n    // leading\n    if (leading && current === 0) return call()\n    // body\n    if (rightNow - current > ms) {\n      if (current > 0) return call()\n      prev.current = rightNow\n    }\n    // trailing\n    clearTrailing()\n    trailingTimeout.current = setTimeout(() => {\n      call()\n      prev.current = 0\n    }, ms)\n  }, deps)\n}\n\nexport function useThrottle<State>(\n  initialState: State | (() => State),\n  fps?: number,\n  leading?: boolean\n): [State, React.Dispatch<React.SetStateAction<State>>] {\n  const state = React.useState<State>(initialState)\n  return [state[0], useThrottleCallback(state[1], fps, leading)]\n}\n","import {\r\n  clearRequestTimeout,\r\n  requestTimeout,\r\n} from \"@essentials/request-timeout\";\r\nimport useScrollPosition from \"@react-hook/window-scroll\";\r\nimport * as React from \"react\";\r\n\r\n/**\r\n * A hook for tracking whether the `window` is currently being scrolled and it's scroll position on\r\n * the y-axis. These values are used for determining which grid cells to render and when\r\n * to add styles to the masonry container that maximize scroll performance.\r\n *\r\n * @param offset - The vertical space in pixels between the top of the grid container and the top\r\n *  of the browser `document.documentElement`.\r\n * @param fps - This determines how often (in frames per second) to update the scroll position of the\r\n *  browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\r\n *  The default value of `12` has been very reasonable in my own testing, but if you have particularly\r\n *  heavy `render` components it may be prudent to reduce this number.\r\n */\r\nexport function useScroller(\r\n  offset = 0,\r\n  fps = 12\r\n): { scrollTop: number; isScrolling: boolean } {\r\n  const scrollTop = useScrollPosition(fps);\r\n  const [isScrolling, setIsScrolling] = React.useState(false);\r\n  const didMount = React.useRef(0);\r\n\r\n  React.useEffect(() => {\r\n    if (didMount.current === 1) setIsScrolling(true);\r\n    let didUnsubscribe = false;\r\n    const to = requestTimeout(() => {\r\n      if (didUnsubscribe) return;\r\n      // This is here to prevent premature bail outs while maintaining high resolution\r\n      // unsets. Without it there will always bee a lot of unnecessary DOM writes to style.\r\n      setIsScrolling(false);\r\n    }, 40 + 1000 / fps);\r\n    didMount.current = 1;\r\n    return () => {\r\n      didUnsubscribe = true;\r\n      clearRequestTimeout(to);\r\n    };\r\n  }, [fps, scrollTop]);\r\n\r\n  return { scrollTop: Math.max(0, scrollTop - offset), isScrolling };\r\n}\r\n","/**\n * Copyright 2011, Joe Lambert.\n * Free to use under the MIT license.\n * http://www.opensource.org/licenses/mit-license.php\n **/\nimport {raf, caf, now} from '@essentials/raf'\n\nexport interface RequestTimeoutHandle {\n  v?: number\n}\n\nexport const clearRequestTimeout = (handle: RequestTimeoutHandle): void => {\n  caf(handle.v || -1)\n}\n\nexport const requestTimeout = (\n  fn: (...args: any[]) => void,\n  ms: number\n): RequestTimeoutHandle => {\n  const start = now(),\n    handle: RequestTimeoutHandle = {}\n\n  const loop = () => {\n    now() - start >= ms ? fn.call(null) : (handle.v = raf(loop))\n  }\n\n  handle.v = raf(loop)\n  return handle\n}\n\nexport default requestTimeout\n","import { useMasonry } from \"./use-masonry\";\r\nimport type { UseMasonryOptions } from \"./use-masonry\";\r\nimport { useScroller } from \"./use-scroller\";\r\n/**\r\n * A heavily-optimized component that updates `useMasonry()` when the scroll position of the browser `window`\r\n * changes. This bare-metal component is used by `<Masonry>` under the hood.\r\n *\r\n * @param props\r\n */\r\nexport function MasonryScroller<Item>(props: MasonryScrollerProps<Item>) {\r\n  // We put this in its own layer because it's the thing that will trigger the most updates\r\n  // and we don't want to slower ourselves by cycling through all the functions, objects, and effects\r\n  // of other hooks\r\n  const { scrollTop, isScrolling } = useScroller(props.offset, props.scrollFps);\r\n  // This is an update-heavy phase and while we could just Object.assign here,\r\n  // it is way faster to inline and there's a relatively low hit to he bundle\r\n  // size.\r\n  return useMasonry<Item>({\r\n    scrollTop,\r\n    isScrolling,\r\n    positioner: props.positioner,\r\n    resizeObserver: props.resizeObserver,\r\n    items: props.items,\r\n    onRender: props.onRender,\r\n    as: props.as,\r\n    id: props.id,\r\n    className: props.className,\r\n    style: props.style,\r\n    role: props.role,\r\n    tabIndex: props.tabIndex,\r\n    containerRef: props.containerRef,\r\n    itemAs: props.itemAs,\r\n    itemStyle: props.itemStyle,\r\n    itemHeightEstimate: props.itemHeightEstimate,\r\n    itemKey: props.itemKey,\r\n    overscanBy: props.overscanBy,\r\n    height: props.height,\r\n    render: props.render,\r\n  });\r\n}\r\n\r\nexport interface MasonryScrollerProps<Item>\r\n  extends Omit<UseMasonryOptions<Item>, \"scrollTop\" | \"isScrolling\"> {\r\n  /**\r\n   * This determines how often (in frames per second) to update the scroll position of the\r\n   * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\r\n   * The default value of `12` has been very reasonable in my own testing, but if you have particularly\r\n   * heavy `render` components it may be prudent to reduce this number.\r\n   *\r\n   * @default 12\r\n   */\r\n  scrollFps?: number;\r\n  /**\r\n   * The vertical space in pixels between the top of the grid container and the top\r\n   * of the browser `document.documentElement`.\r\n   *\r\n   * @default 0\r\n   */\r\n  offset?: number;\r\n}\r\n\r\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\r\n  MasonryScroller.displayName = \"MasonryScroller\";\r\n}\r\n","import useLayoutEffect from \"@react-hook/passive-layout-effect\";\r\nimport * as React from \"react\";\r\n\r\n/**\r\n * A hook for measuring the width of the grid container, as well as its distance\r\n * from the top of the document. These values are necessary to correctly calculate the number/width\r\n * of columns to render, as well as the number of rows to render.\r\n *\r\n * @param elementRef - A `ref` object created by `React.useRef()`. That ref should be provided to the\r\n *   `containerRef` property in `useMasonry()`.\r\n * @param deps - You can force this hook to recalculate the `offset` and `width` whenever this\r\n *   dependencies list changes. A common dependencies list might look like `[windowWidth, windowHeight]`,\r\n *   which would force the hook to recalculate any time the size of the browser `window` changed.\r\n */\r\nexport function useContainerPosition(\r\n  elementRef: React.MutableRefObject<HTMLElement | null>,\r\n  deps: React.DependencyList = emptyArr\r\n): ContainerPosition {\r\n  const [containerPosition, setContainerPosition] =\r\n    React.useState<ContainerPosition>({ offset: 0, width: 0 });\r\n\r\n  useLayoutEffect(() => {\r\n    const { current } = elementRef;\r\n    if (current !== null) {\r\n      let offset = 0;\r\n      let el = current;\r\n\r\n      do {\r\n        offset += el.offsetTop || 0;\r\n        el = el.offsetParent as HTMLElement;\r\n      } while (el);\r\n\r\n      if (\r\n        offset !== containerPosition.offset ||\r\n        current.offsetWidth !== containerPosition.width\r\n      ) {\r\n        setContainerPosition({\r\n          offset,\r\n          width: current.offsetWidth,\r\n        });\r\n      }\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, deps);\r\n\r\n  return containerPosition;\r\n}\r\n\r\nexport interface ContainerPosition {\r\n  /**\r\n   * The distance in pixels between the top of the element in `elementRef` and the top of\r\n   * the `document.documentElement`.\r\n   */\r\n  offset: number;\r\n  /**\r\n   * The `offsetWidth` of the element in `elementRef`.\r\n   */\r\n  width: number;\r\n}\r\n\r\nconst emptyArr: [] = [];\r\n","import * as React from \"react\";\r\nimport { createIntervalTree } from \"./interval-tree\";\r\n\r\n/**\r\n * This hook creates the grid cell positioner and cache required by `useMasonry()`. This is\r\n * the meat of the grid's layout algorithm, determining which cells to render at a given scroll\r\n * position, as well as where to place new items in the grid.\r\n *\r\n * @param options - Properties that determine the number of columns in the grid, as well\r\n *  as their widths.\r\n * @param options.columnWidth\r\n * @param options.width\r\n * @param deps - This hook will create a new positioner, clearing all existing cached positions,\r\n *  whenever the dependencies in this list change.\r\n * @param options.columnGutter\r\n * @param options.rowGutter\r\n * @param options.columnCount\r\n * @param options.maxColumnCount\r\n * @param options.maxColumnWidth\r\n */\r\nexport function usePositioner(\r\n  {\r\n    width,\r\n    columnWidth = 200,\r\n    columnGutter = 0,\r\n    rowGutter,\r\n    columnCount,\r\n    maxColumnCount,\r\n    maxColumnWidth,\r\n  }: UsePositionerOptions,\r\n  deps: React.DependencyList = emptyArr\r\n): Positioner {\r\n  const initPositioner = (): Positioner => {\r\n    const [computedColumnWidth, computedColumnCount] = getColumns(\r\n      width,\r\n      columnWidth,\r\n      columnGutter,\r\n      columnCount,\r\n      maxColumnCount,\r\n      maxColumnWidth\r\n    );\r\n    return createPositioner(\r\n      computedColumnCount,\r\n      computedColumnWidth,\r\n      columnGutter,\r\n      rowGutter ?? columnGutter\r\n    );\r\n  };\r\n  const positionerRef = React.useRef<Positioner>();\r\n  if (positionerRef.current === undefined)\r\n    positionerRef.current = initPositioner();\r\n\r\n  const prevDeps = React.useRef(deps);\r\n  const opts = [\r\n    width,\r\n    columnWidth,\r\n    columnGutter,\r\n    rowGutter,\r\n    columnCount,\r\n    maxColumnCount,\r\n    maxColumnWidth,\r\n  ];\r\n  const prevOpts = React.useRef(opts);\r\n  const optsChanged = !opts.every((item, i) => prevOpts.current[i] === item);\r\n\r\n  if (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\r\n    if (deps.length !== prevDeps.current.length) {\r\n      throw new Error(\r\n        \"usePositioner(): The length of your dependencies array changed.\"\r\n      );\r\n    }\r\n  }\r\n\r\n  // Create a new positioner when the dependencies or sizes change\r\n  // Thanks to https://github.com/khmm12 for pointing this out\r\n  // https://github.com/jaredLunde/masonic/pull/41\r\n  if (optsChanged || !deps.every((item, i) => prevDeps.current[i] === item)) {\r\n    const prevPositioner = positionerRef.current;\r\n    const positioner = initPositioner();\r\n    prevDeps.current = deps;\r\n    prevOpts.current = opts;\r\n\r\n    if (optsChanged) {\r\n      const cacheSize = prevPositioner.size();\r\n      for (let index = 0; index < cacheSize; index++) {\r\n        const pos = prevPositioner.get(index);\r\n        positioner.set(index, pos !== void 0 ? pos.height : 0);\r\n      }\r\n    }\r\n\r\n    positionerRef.current = positioner;\r\n  }\r\n\r\n  return positionerRef.current;\r\n}\r\n\r\nexport interface UsePositionerOptions {\r\n  /**\r\n   * The width of the container you're rendering the grid within, i.e. the container\r\n   * element's `element.offsetWidth`\r\n   */\r\n  width: number;\r\n  /**\r\n   * The minimum column width. The `usePositioner()` hook will automatically size the\r\n   * columns to fill their container based upon the `columnWidth` and `columnGutter` values.\r\n   * It will never render anything smaller than this width unless its container itself is\r\n   * smaller than its value. This property is optional if you're using a static `columnCount`.\r\n   *\r\n   * @default 200\r\n   */\r\n  columnWidth?: number;\r\n  /**\r\n   * The maximum column width. Calculated column widths will be capped at this value.\r\n   */\r\n  maxColumnWidth?: number;\r\n  /**\r\n   * This sets the horizontal space between grid columns in pixels. If `rowGutter` is not set, this\r\n   * also sets the vertical space between cells within a column in pixels.\r\n   *\r\n   * @default 0\r\n   */\r\n  columnGutter?: number;\r\n  /**\r\n   * This sets the vertical space between cells within a column in pixels. If not set, the value of\r\n   * `columnGutter` is used instead.\r\n   */\r\n  rowGutter?: number;\r\n  /**\r\n   * By default, `usePositioner()` derives the column count from the `columnWidth`, `columnGutter`,\r\n   * and `width` props. However, in some situations it is nice to be able to override that behavior\r\n   * (e.g. creating a `List` component).\r\n   */\r\n  columnCount?: number;\r\n  /**\r\n   * The upper bound of column count. This property won't work if `columnCount` is set.\r\n   */\r\n  maxColumnCount?: number;\r\n}\r\n\r\n/**\r\n * Creates a cell positioner for the `useMasonry()` hook. The `usePositioner()` hook uses\r\n * this utility under the hood.\r\n *\r\n * @param columnCount - The number of columns in the grid\r\n * @param columnWidth - The width of each column in the grid\r\n * @param columnGutter - The amount of horizontal space between columns in pixels.\r\n * @param rowGutter - The amount of vertical space between cells within a column in pixels (falls back\r\n * to `columnGutter`).\r\n */\r\nexport const createPositioner = (\r\n  columnCount: number,\r\n  columnWidth: number,\r\n  columnGutter = 0,\r\n  rowGutter = columnGutter\r\n): Positioner => {\r\n  // O(log(n)) lookup of cells to render for a given viewport size\r\n  // Store tops and bottoms of each cell for fast intersection lookup.\r\n  const intervalTree = createIntervalTree();\r\n  // Track the height of each column.\r\n  // Layout algorithm below always inserts into the shortest column.\r\n  const columnHeights: number[] = new Array(columnCount);\r\n  // Used for O(1) item access\r\n  const items: PositionerItem[] = [];\r\n  // Tracks the item indexes within an individual column\r\n  const columnItems: number[][] = new Array(columnCount);\r\n\r\n  for (let i = 0; i < columnCount; i++) {\r\n    columnHeights[i] = 0;\r\n    columnItems[i] = [];\r\n  }\r\n\r\n  return {\r\n    columnCount,\r\n    columnWidth,\r\n    set: (index, height = 0) => {\r\n      const column = index % columnCount;\r\n      const top = columnHeights[column] || 0;\r\n      columnHeights[column] = top + height + rowGutter;\r\n      columnItems[column].push(index);\r\n      items[index] = {\r\n        left: column * (columnWidth + columnGutter),\r\n        top,\r\n        height,\r\n        column,\r\n      };\r\n      intervalTree.insert(top, top + height, index);\r\n    },\r\n    get: (index) => items[index],\r\n    // This only updates items in the specific columns that have changed, on and after the\r\n    // specific items that have changed\r\n    update: (updates) => {\r\n      const columns: number[] = new Array(columnCount);\r\n      let i = 0,\r\n        j = 0;\r\n\r\n      // determines which columns have items that changed, as well as the minimum index\r\n      // changed in that column, as all items after that index will have their positions\r\n      // affected by the change\r\n      for (; i < updates.length - 1; i++) {\r\n        const index = updates[i];\r\n        const item = items[index];\r\n        item.height = updates[++i];\r\n        intervalTree.remove(index);\r\n        intervalTree.insert(item.top, item.top + item.height, index);\r\n        columns[item.column] =\r\n          columns[item.column] === void 0\r\n            ? index\r\n            : Math.min(index, columns[item.column]);\r\n      }\r\n\r\n      for (i = 0; i < columns.length; i++) {\r\n        // bails out if the column didn't change\r\n        if (columns[i] === void 0) continue;\r\n        const itemsInColumn = columnItems[i];\r\n        // the index order is sorted with certainty so binary search is a great solution\r\n        // here as opposed to Array.indexOf()\r\n        const startIndex = binarySearch(itemsInColumn, columns[i]);\r\n        const index = columnItems[i][startIndex];\r\n        const startItem = items[index];\r\n        columnHeights[i] = startItem.top + startItem.height + rowGutter;\r\n\r\n        for (j = startIndex + 1; j < itemsInColumn.length; j++) {\r\n          const index = itemsInColumn[j];\r\n          const item = items[index];\r\n          item.top = columnHeights[i];\r\n          columnHeights[i] = item.top + item.height + rowGutter;\r\n          intervalTree.remove(index);\r\n          intervalTree.insert(item.top, item.top + item.height, index);\r\n        }\r\n      }\r\n    },\r\n    // Render all cells visible within the viewport range defined.\r\n    range: (lo, hi, renderCallback) =>\r\n      intervalTree.search(lo, hi, (index, top) =>\r\n        renderCallback(index, items[index].left, top)\r\n      ),\r\n    estimateHeight: (itemCount, defaultItemHeight): number => {\r\n      const tallestColumn = Math.max(0, Math.max.apply(null, columnHeights));\r\n\r\n      return itemCount === intervalTree.size\r\n        ? tallestColumn\r\n        : tallestColumn +\r\n            Math.ceil((itemCount - intervalTree.size) / columnCount) *\r\n              defaultItemHeight;\r\n    },\r\n    shortestColumn: () => {\r\n      if (columnHeights.length > 1) return Math.min.apply(null, columnHeights);\r\n      return columnHeights[0] || 0;\r\n    },\r\n    size(): number {\r\n      return intervalTree.size;\r\n    },\r\n    all(): PositionerItem[] {\r\n      return items;\r\n    },\r\n  };\r\n};\r\n\r\nexport interface Positioner {\r\n  /**\r\n   * The number of columns in the grid\r\n   */\r\n  columnCount: number;\r\n  /**\r\n   * The width of each column in the grid\r\n   */\r\n  columnWidth: number;\r\n  /**\r\n   * Sets the position for the cell at `index` based upon the cell's height\r\n   */\r\n  set: (index: number, height: number) => void;\r\n  /**\r\n   * Gets the `PositionerItem` for the cell at `index`\r\n   */\r\n  get: (index: number) => PositionerItem | undefined;\r\n  /**\r\n   * Updates cells based on their indexes and heights\r\n   * positioner.update([index, height, index, height, index, height...])\r\n   */\r\n  update: (updates: number[]) => void;\r\n  /**\r\n   * Searches the interval tree for grid cells with a `top` value in\r\n   * betwen `lo` and `hi` and invokes the callback for each item that\r\n   * is discovered\r\n   */\r\n  range: (\r\n    lo: number,\r\n    hi: number,\r\n    renderCallback: (index: number, left: number, top: number) => void\r\n  ) => void;\r\n  /**\r\n   * Returns the number of grid cells in the cache\r\n   */\r\n\r\n  size: () => number;\r\n  /**\r\n   * Estimates the total height of the grid\r\n   */\r\n\r\n  estimateHeight: (itemCount: number, defaultItemHeight: number) => number;\r\n  /**\r\n   * Returns the height of the shortest column in the grid\r\n   */\r\n\r\n  shortestColumn: () => number;\r\n  /**\r\n   * Returns all `PositionerItem` items\r\n   */\r\n  all: () => PositionerItem[];\r\n}\r\n\r\nexport interface PositionerItem {\r\n  /**\r\n   * This is how far from the top edge of the grid container in pixels the\r\n   * item is placed\r\n   */\r\n  top: number;\r\n  /**\r\n   * This is how far from the left edge of the grid container in pixels the\r\n   * item is placed\r\n   */\r\n  left: number;\r\n  /**\r\n   * This is the height of the grid cell\r\n   */\r\n  height: number;\r\n  /**\r\n   * This is the column number containing the grid cell\r\n   */\r\n  column: number;\r\n}\r\n\r\n/* istanbul ignore next */\r\nconst binarySearch = (a: number[], y: number): number => {\r\n  let l = 0;\r\n  let h = a.length - 1;\r\n\r\n  while (l <= h) {\r\n    const m = (l + h) >>> 1;\r\n    const x = a[m];\r\n    if (x === y) return m;\r\n    else if (x <= y) l = m + 1;\r\n    else h = m - 1;\r\n  }\r\n\r\n  return -1;\r\n};\r\n\r\nconst getColumns = (\r\n  width = 0,\r\n  minimumWidth = 0,\r\n  gutter = 8,\r\n  columnCount?: number,\r\n  maxColumnCount?: number,\r\n  maxColumnWidth?: number\r\n): [number, number] => {\r\n  columnCount =\r\n    columnCount ||\r\n    Math.min(\r\n      Math.floor((width + gutter) / (minimumWidth + gutter)),\r\n      maxColumnCount || Infinity\r\n    ) ||\r\n    1;\r\n  let columnWidth = Math.floor(\r\n    (width - gutter * (columnCount - 1)) / columnCount\r\n  );\r\n\r\n  // Cap the column width if maxColumnWidth is specified\r\n  if (maxColumnWidth !== undefined && columnWidth > maxColumnWidth) {\r\n    columnWidth = maxColumnWidth;\r\n  }\r\n\r\n  return [columnWidth, columnCount];\r\n};\r\n\r\nconst emptyArr: [] = [];\r\n","import rafSchd from \"raf-schd\";\r\nimport * as React from \"react\";\r\nimport trieMemoize from \"trie-memoize\";\r\nimport { elementsCache } from \"./elements-cache\";\r\nimport { useForceUpdate } from \"./use-force-update\";\r\nimport type { Positioner } from \"./use-positioner\";\r\n\r\n/**\r\n * Creates a resize observer that forces updates to the grid cell positions when mutations are\r\n * made to cells affecting their height.\r\n *\r\n * @param positioner - The masonry cell positioner created by the `usePositioner()` hook.\r\n */\r\nexport function useResizeObserver(positioner: Positioner) {\r\n  const forceUpdate = useForceUpdate();\r\n  const resizeObserver = createResizeObserver(positioner, forceUpdate);\r\n  // Cleans up the resize observers when they change or the\r\n  // component unmounts\r\n  React.useEffect(() => () => resizeObserver.disconnect(), [resizeObserver]);\r\n  return resizeObserver;\r\n}\r\n\r\nconst _handlerForType = rafSchd((target: HTMLElement) => {});\r\n\r\ntype IHandler = typeof _handlerForType;\r\n\r\n/**\r\n * Creates a resize observer that fires an `updater` callback whenever the height of\r\n * one or many cells change. The `useResizeObserver()` hook is using this under the hood.\r\n *\r\n * @param positioner - A cell positioner created by the `usePositioner()` hook or the `createPositioner()` utility\r\n * @param updater - A callback that fires whenever one or many cell heights change.\r\n */\r\nexport const createResizeObserver = trieMemoize(\r\n  [WeakMap],\r\n  // TODO: figure out a way to test this\r\n  /* istanbul ignore next */\r\n  (positioner: Positioner, updater: (updates: number[]) => void) => {\r\n    const updates: number[] = [];\r\n\r\n    const update = rafSchd(() => {\r\n      if (updates.length > 0) {\r\n        // Updates the size/positions of the cell with the resize\r\n        // observer updates\r\n        positioner.update(updates);\r\n        updater(updates);\r\n      }\r\n      updates.length = 0;\r\n    });\r\n\r\n    const commonHandler = (target: HTMLElement) => {\r\n      const height = target.offsetHeight;\r\n      if (height > 0) {\r\n        const index = elementsCache.get(target);\r\n        if (index !== void 0) {\r\n          const position = positioner.get(index);\r\n          if (position !== void 0 && height !== position.height)\r\n            updates.push(index, height);\r\n        }\r\n      }\r\n      update();\r\n    };\r\n\r\n    const handlers = new Map<number, IHandler>();\r\n    const handleEntries: ResizeObserverCallback = (entries) => {\r\n      let i = 0;\r\n\r\n      for (; i < entries.length; i++) {\r\n        const entry = entries[i];\r\n        const index = elementsCache.get(entry.target);\r\n\r\n        if (index === void 0) continue;\r\n        let handler = handlers.get(index);\r\n        if (!handler) {\r\n          handler = rafSchd(commonHandler);\r\n          handlers.set(index, handler);\r\n        }\r\n        handler(entry.target as HTMLElement);\r\n      }\r\n    };\r\n\r\n    const ro = new ResizeObserver(handleEntries);\r\n    // Overrides the original disconnect to include cancelling handling the entries.\r\n    // Ideally this would be its own method but that would result in a breaking\r\n    // change.\r\n    const disconnect = ro.disconnect.bind(ro);\r\n    ro.disconnect = () => {\r\n      disconnect();\r\n      handlers.forEach((handler) => {\r\n        handler.cancel();\r\n      });\r\n    };\r\n\r\n    return ro;\r\n  }\r\n);\r\n","import useEvent from \"@react-hook/event\";\r\nimport useLatest from \"@react-hook/latest\";\r\nimport { useThrottleCallback } from \"@react-hook/throttle\";\r\nimport * as React from \"react\";\r\nimport type { Positioner, PositionerItem } from \"./use-positioner\";\r\n\r\n/**\r\n * A hook that creates a callback for scrolling to a specific index in\r\n * the \"items\" array.\r\n *\r\n * @param positioner - A positioner created by the `usePositioner()` hook\r\n * @param options - Configuration options\r\n */\r\nexport function useScrollToIndex(\r\n  positioner: Positioner,\r\n  options: UseScrollToIndexOptions\r\n) {\r\n  const {\r\n    align = \"top\",\r\n    element = typeof window !== \"undefined\" && window,\r\n    offset = 0,\r\n    height = typeof window !== \"undefined\" ? window.innerHeight : 0,\r\n  } = options;\r\n  const latestOptions = useLatest({\r\n    positioner,\r\n    element,\r\n    align,\r\n    offset,\r\n    height,\r\n  } as const);\r\n  const getTarget = React.useRef(() => {\r\n    const latestElement = latestOptions.current.element;\r\n    return latestElement && \"current\" in latestElement\r\n      ? latestElement.current\r\n      : latestElement;\r\n  }).current;\r\n  const [state, dispatch] = React.useReducer(\r\n    (\r\n      state: {\r\n        position: PositionerItem | undefined;\r\n        index: number | undefined;\r\n        prevTop: number | undefined;\r\n      },\r\n      action:\r\n        | { type: \"scrollToIndex\"; value: number | undefined }\r\n        | { type: \"setPosition\"; value: PositionerItem | undefined }\r\n        | { type: \"setPrevTop\"; value: number | undefined }\r\n        | { type: \"reset\" }\r\n    ) => {\r\n      const nextState = {\r\n        position: state.position,\r\n        index: state.index,\r\n        prevTop: state.prevTop,\r\n      };\r\n\r\n      /* istanbul ignore next */\r\n      if (action.type === \"scrollToIndex\") {\r\n        return {\r\n          position: latestOptions.current.positioner.get(action.value ?? -1),\r\n          index: action.value,\r\n          prevTop: void 0,\r\n        };\r\n      } else if (action.type === \"setPosition\") {\r\n        nextState.position = action.value;\r\n      } else if (action.type === \"setPrevTop\") {\r\n        nextState.prevTop = action.value;\r\n      } else if (action.type === \"reset\") {\r\n        return defaultState;\r\n      }\r\n\r\n      return nextState;\r\n    },\r\n    defaultState\r\n  );\r\n  const throttledDispatch = useThrottleCallback(dispatch, 15);\r\n\r\n  // If we find the position along the way we can immediately take off\r\n  // to the correct spot.\r\n  useEvent(getTarget() as Window, \"scroll\", () => {\r\n    if (!state.position && state.index) {\r\n      const position = latestOptions.current.positioner.get(state.index);\r\n\r\n      if (position) {\r\n        dispatch({ type: \"setPosition\", value: position });\r\n      }\r\n    }\r\n  });\r\n\r\n  // If the top changes out from under us in the case of dynamic cells, we\r\n  // want to keep following it.\r\n  const currentTop =\r\n    state.index !== void 0 &&\r\n    latestOptions.current.positioner.get(state.index)?.top;\r\n\r\n  React.useEffect(() => {\r\n    const target = getTarget();\r\n    if (!target) return;\r\n    const { height, align, offset, positioner } = latestOptions.current;\r\n\r\n    if (state.position) {\r\n      let scrollTop = state.position.top;\r\n\r\n      if (align === \"bottom\") {\r\n        scrollTop = scrollTop - height + state.position.height;\r\n      } else if (align === \"center\") {\r\n        scrollTop -= (height - state.position.height) / 2;\r\n      }\r\n\r\n      target.scrollTo(0, Math.max(0, (scrollTop += offset)));\r\n      // Resets state after 400ms, an arbitrary time I determined to be\r\n      // still visually pleasing if there is a slow network reply in dynamic\r\n      // cells\r\n      let didUnsubscribe = false;\r\n      const timeout = setTimeout(\r\n        () => !didUnsubscribe && dispatch({ type: \"reset\" }),\r\n        400\r\n      );\r\n      return () => {\r\n        didUnsubscribe = true;\r\n        clearTimeout(timeout);\r\n      };\r\n    } else if (state.index !== void 0) {\r\n      // Estimates the top based upon the average height of current cells\r\n      let estimatedTop =\r\n        (positioner.shortestColumn() / positioner.size()) * state.index;\r\n      if (state.prevTop)\r\n        estimatedTop = Math.max(estimatedTop, state.prevTop + height);\r\n      target.scrollTo(0, estimatedTop);\r\n      throttledDispatch({ type: \"setPrevTop\", value: estimatedTop });\r\n    }\r\n  }, [currentTop, state, latestOptions, getTarget, throttledDispatch]);\r\n\r\n  return React.useRef((index: number) => {\r\n    dispatch({ type: \"scrollToIndex\", value: index });\r\n  }).current;\r\n}\r\n\r\nconst defaultState = {\r\n  index: void 0,\r\n  position: void 0,\r\n  prevTop: void 0,\r\n} as const;\r\n\r\nexport type UseScrollToIndexOptions = {\r\n  /**\r\n   * The window element or a React ref for the window element. That is,\r\n   * this is the grid container.\r\n   *\r\n   * @default window\r\n   */\r\n  element?: Window | HTMLElement | React.RefObject<HTMLElement> | null;\r\n  /**\r\n   * Sets the vertical alignment of the cell within the grid container.\r\n   *\r\n   * @default \"top\"\r\n   */\r\n  align?: \"center\" | \"top\" | \"bottom\";\r\n  /**\r\n   * The height of the grid.\r\n   *\r\n   * @default window.innerHeight\r\n   */\r\n  height?: number;\r\n  /**\r\n   * The vertical space in pixels between the top of the grid container and the top\r\n   * of the window.\r\n   *\r\n   * @default 0\r\n   */\r\n  offset?: number;\r\n};\r\n","import { useWindowSize } from \"@react-hook/window-size\";\r\nimport * as React from \"react\";\r\nimport { MasonryScroller } from \"./masonry-scroller\";\r\nimport type { MasonryScrollerProps } from \"./masonry-scroller\";\r\nimport { useContainerPosition } from \"./use-container-position\";\r\nimport { usePositioner } from \"./use-positioner\";\r\nimport type { UsePositionerOptions } from \"./use-positioner\";\r\nimport { useResizeObserver } from \"./use-resize-observer\";\r\nimport { useScrollToIndex } from \"./use-scroll-to-index\";\r\nimport type { UseScrollToIndexOptions } from \"./use-scroll-to-index\";\r\n\r\n/**\r\n * A \"batteries included\" masonry grid which includes all of the implementation details below. This component is the\r\n * easiest way to get off and running in your app, before switching to more advanced implementations, if necessary.\r\n * It will change its column count to fit its container's width and will decide how many rows to render based upon\r\n * the height of the browser `window`.\r\n *\r\n * @param props\r\n */\r\nexport function Masonry<Item>(props: MasonryProps<Item>) {\r\n  const containerRef = React.useRef<null | HTMLElement>(null);\r\n  const windowSize = useWindowSize({\r\n    initialWidth: props.ssrWidth,\r\n    initialHeight: props.ssrHeight,\r\n  });\r\n  const containerPos = useContainerPosition(containerRef, windowSize);\r\n  const nextProps = Object.assign(\r\n    {\r\n      offset: containerPos.offset,\r\n      width: containerPos.width || windowSize[0],\r\n      height: windowSize[1],\r\n      containerRef,\r\n    },\r\n    props\r\n  ) as any;\r\n  nextProps.positioner = usePositioner(nextProps);\r\n  nextProps.resizeObserver = useResizeObserver(nextProps.positioner);\r\n  const scrollToIndex = useScrollToIndex(nextProps.positioner, {\r\n    height: nextProps.height,\r\n    offset: containerPos.offset,\r\n    align:\r\n      typeof props.scrollToIndex === \"object\"\r\n        ? props.scrollToIndex.align\r\n        : void 0,\r\n  });\r\n  const index =\r\n    props.scrollToIndex &&\r\n    (typeof props.scrollToIndex === \"number\"\r\n      ? props.scrollToIndex\r\n      : props.scrollToIndex.index);\r\n\r\n  React.useEffect(() => {\r\n    if (index !== void 0) scrollToIndex(index);\r\n  }, [index, scrollToIndex]);\r\n\r\n  return React.createElement(MasonryScroller, nextProps);\r\n}\r\n\r\nexport interface MasonryProps<Item>\r\n  extends Omit<\r\n      MasonryScrollerProps<Item>,\r\n      \"offset\" | \"width\" | \"height\" | \"containerRef\" | \"positioner\"\r\n    >,\r\n    Pick<\r\n      UsePositionerOptions,\r\n      | \"columnWidth\"\r\n      | \"columnGutter\"\r\n      | \"rowGutter\"\r\n      | \"columnCount\"\r\n      | \"maxColumnCount\"\r\n      | \"maxColumnWidth\"\r\n    > {\r\n  /**\r\n   * Scrolls to a given index within the grid. The grid will re-scroll\r\n   * any time the index changes.\r\n   */\r\n  scrollToIndex?:\r\n    | number\r\n    | {\r\n        index: number;\r\n        align: UseScrollToIndexOptions[\"align\"];\r\n      };\r\n  /**\r\n   * This is the width that will be used for the browser `window` when rendering this component in SSR.\r\n   * This prop isn't relevant for client-side only apps.\r\n   */\r\n  ssrWidth?: number;\r\n  /**\r\n   * This is the height that will be used for the browser `window` when rendering this component in SSR.\r\n   * This prop isn't relevant for client-side only apps.\r\n   */\r\n  ssrHeight?: number;\r\n  /**\r\n   * This determines how often (in frames per second) to update the scroll position of the\r\n   * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\r\n   * The default value of `12` has been very reasonable in my own testing, but if you have particularly\r\n   * heavy `render` components it may be prudent to reduce this number.\r\n   *\r\n   * @default 12\r\n   */\r\n  scrollFps?: number;\r\n}\r\n\r\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\r\n  Masonry.displayName = \"Masonry\";\r\n}\r\n","import {useDebounce} from '@react-hook/debounce'\nimport useEvent from '@react-hook/event'\n\nconst emptyObj = {}\n\nexport interface DebouncedWindowSizeOptions {\n  initialWidth?: number\n  initialHeight?: number\n  wait?: number\n  leading?: boolean\n}\n\nconst win = typeof window === 'undefined' ? null : window\nconst wv =\n  win && typeof win.visualViewport !== 'undefined' ? win.visualViewport : null\nconst getSize = () =>\n  [\n    document.documentElement.clientWidth,\n    document.documentElement.clientHeight,\n  ] as const\n\nexport const useWindowSize = (\n  options: DebouncedWindowSizeOptions = emptyObj\n): readonly [number, number] => {\n  const {wait, leading, initialWidth = 0, initialHeight = 0} = options\n  const [size, setDebouncedSize] = useDebounce<readonly [number, number]>(\n    /* istanbul ignore next */\n    typeof document === 'undefined' ? [initialWidth, initialHeight] : getSize,\n    wait,\n    leading\n  )\n  const setSize = (): void => setDebouncedSize(getSize)\n\n  useEvent(win, 'resize', setSize)\n  // @ts-expect-error\n  useEvent(wv, 'resize', setSize)\n  useEvent(win, 'orientationchange', setSize)\n\n  return size\n}\n\nexport const useWindowHeight = (\n  options?: Omit<DebouncedWindowSizeOptions, 'initialWidth'>\n): number => useWindowSize(options)[1]\n\nexport const useWindowWidth = (\n  options?: Omit<DebouncedWindowSizeOptions, 'initialHeight'>\n): number => useWindowSize(options)[0]\n","import * as React from 'react'\nimport useLatest from '@react-hook/latest'\n\nexport const useDebounceCallback = <CallbackArgs extends any[]>(\n  callback: (...args: CallbackArgs) => void,\n  wait = 100,\n  leading = false\n): ((...args: CallbackArgs) => void) => {\n  const storedCallback = useLatest(callback)\n  const timeout = React.useRef<ReturnType<typeof setTimeout>>()\n  const deps = [wait, leading, storedCallback]\n  // Cleans up pending timeouts when the deps change\n  React.useEffect(\n    () => () => {\n      timeout.current && clearTimeout(timeout.current)\n      timeout.current = void 0\n    },\n    deps\n  )\n\n  return React.useCallback(function () {\n    // eslint-disable-next-line prefer-rest-params\n    const args = arguments\n    const {current} = timeout\n    // Calls on leading edge\n    if (current === void 0 && leading) {\n      timeout.current = setTimeout(() => {\n        timeout.current = void 0\n      }, wait)\n      // eslint-disable-next-line prefer-spread\n      return storedCallback.current.apply(null, args as any)\n    }\n    // Clear the timeout every call and start waiting again\n    current && clearTimeout(current)\n    // Waits for `wait` before invoking the callback\n    timeout.current = setTimeout(() => {\n      timeout.current = void 0\n      storedCallback.current.apply(null, args as any)\n    }, wait)\n  }, deps)\n}\n\nexport const useDebounce = <State extends any>(\n  initialState: State | (() => State),\n  wait?: number,\n  leading?: boolean\n): [State, React.Dispatch<React.SetStateAction<State>>] => {\n  const state = React.useState(initialState)\n  return [state[0], useDebounceCallback(state[1], wait, leading)]\n}\n","import * as React from 'react'\n\nconst useLatest = <T extends any>(current: T) => {\n  const storedValue = React.useRef(current)\n  React.useEffect(() => {\n    storedValue.current = current\n  })\n  return storedValue\n}\n\nexport default useLatest\n","const memoOne = <Args extends any[], T extends any>(\n  fn: (...args: Args) => T,\n  areEqual?: AreEqual<Args>\n): OutputFunction<Args, T> => {\n  const equal = areEqual || defaultAreEqual\n  let args: Args, value: any\n\n  return function (): T {\n    return !!args && equal(arguments as any, args)\n      ? value\n      : (value = fn.apply(null, (args = arguments as any)))\n  } as OutputFunction<Args, T>\n}\n\nexport default memoOne\n\nconst defaultAreEqual = (\n  current: IArguments,\n  prev: IArguments | any[]\n): boolean =>\n  current[0] === prev[0] &&\n  current[1] === prev[1] &&\n  current[2] === prev[2] &&\n  current[3] === prev[3]\n\nexport type AreEqual<Args> = (currentArgs: Args, prevArgs: Args) => boolean\nexport type InputFunction = (...args: any[]) => any\nexport type OutputFunction<Args extends any[], T extends any> = (\n  ...args: Args\n) => T\n","class OneKeyMap<K extends any = any, V extends any = any> {\n  set: (k: K, v: V) => void\n  get: (k: K) => V | undefined\n\n  constructor() {\n    let key: K | undefined, val: V | undefined\n    this.get = (k: K): V | undefined => (k === key ? val : void 0)\n    this.set = (k: K, v: V): void => {\n      key = k\n      val = v\n    }\n  }\n}\n\nexport default OneKeyMap\n","export interface MapLike {\n  new (...args: any[]): any\n}\n\nexport type CacheConstructor =\n  | MapConstructor\n  | WeakMapConstructor\n  | MapLike\n  | Record<any, any>\n\ninterface Cache<K = any, V = any> {\n  set: (k: K, v: V) => V\n  get: (k: K) => V\n}\n\nconst createCache = (obj: CacheConstructor): Cache => {\n  try {\n    // @ts-ignore\n    return new obj()\n  } catch (e) {\n    const cache: Record<string, any> = {}\n\n    return {\n      set(k, v): void {\n        cache[k] = v\n      },\n      get(k): any {\n        return cache[k]\n      },\n    }\n  }\n}\n\nconst memo = (\n  constructors: CacheConstructor[]\n): {s: Cache['set']; g: Cache['get']} => {\n  const depth = constructors.length,\n    baseCache = createCache(constructors[0])\n  let base: any\n  let map: any\n  let i: number\n  let node: typeof baseCache\n  const one = depth === 1\n  // quicker access for one and two-argument functions\n  const g1 = (args: IArguments): any =>\n    (base = baseCache.get(args[0])) === void 0 || one ? base : base.get(args[1])\n  const s1 = (args: IArguments, value: any): any => {\n    if (one) baseCache.set(args[0], value)\n    else {\n      if ((base = baseCache.get(args[0])) === void 0) {\n        map = createCache(constructors[1])\n        map.set(args[1], value)\n        baseCache.set(args[0], map)\n      } else {\n        base.set(args[1], value)\n      }\n    }\n\n    return value\n  }\n\n  const g2 = (args: IArguments): any => {\n    node = baseCache\n\n    for (i = 0; i < depth; i++)\n      if ((node = node.get(args[i])) === void 0) return\n\n    return node\n  }\n\n  const s2 = (args: IArguments, value: any): any => {\n    node = baseCache\n\n    for (i = 0; i < depth - 1; i++) {\n      if ((map = node.get(args[i])) === void 0) {\n        map = createCache(constructors[i + 1])\n        node.set(args[i], map)\n        node = map\n      } else {\n        node = map\n      }\n    }\n\n    node.set(args[depth - 1], value)\n    return value\n  }\n\n  return depth < 3 ? {g: g1, s: s1} : {g: g2, s: s2}\n}\n\nconst memoize = <T extends any[], U extends any>(\n  mapConstructors: CacheConstructor[],\n  fn: (...args: T) => U\n): ((...args: T) => U) => {\n  let item: U\n  const {g, s} = memo(mapConstructors)\n  return function () {\n    return (item = g(arguments)) === void 0\n      ? s(arguments, fn.apply(null, arguments as any))\n      : item\n  }\n}\n\nexport default memoize\n","export const elementsCache: WeakMap<Element, number> = new WeakMap();\r\n","export type Raf = (callback: (timestamp: number) => void) => number\nexport type Caf = (handle: number) => void\n\nlet u = 'undefined',\n  win = typeof window !== u ? window : ({} as any),\n  p = typeof performance !== u ? performance : Date,\n  now = () => p.now(),\n  af = 'AnimationFrame' as const,\n  Caf = 'cancel' + af,\n  Raf = 'request' + af,\n  raf: Raf = win[Raf] && win[Raf].bind(win),\n  caf: Caf = win[Caf] && win[Caf].bind(win)\n\nif (!raf || !caf) {\n  let lastTime = 0\n  raf = (callback: FrameRequestCallback) => {\n    let curr = now(),\n      next = Math.max(lastTime + 1000 / 60, curr)\n    return setTimeout(() => {\n      callback((lastTime = next))\n    }, next - curr) as any\n  }\n  caf = (h) => clearTimeout(h)\n}\n\nexport {raf, caf, now}\n","import {useThrottle} from '@react-hook/throttle'\nimport useEvent from '@react-hook/event'\n\nconst win = typeof window === 'undefined' ? null : window\nconst getScrollY = (): number =>\n  (win as Window).scrollY !== void 0\n    ? (win as Window).scrollY\n    : (win as Window).pageYOffset === void 0\n    ? 0\n    : (win as Window).pageYOffset\n\nexport const useWindowScroll = (fps = 30): number => {\n  const state = useThrottle(\n    typeof window === 'undefined' ? 0 : getScrollY,\n    fps,\n    true\n  )\n  useEvent(win, 'scroll', (): void => state[1](getScrollY()))\n  return state[0]\n}\n\nexport default useWindowScroll\n","import React from 'react'\n\nconst usePassiveLayoutEffect =\n  React[\n    typeof document !== 'undefined' && document.createElement !== void 0\n      ? 'useLayoutEffect'\n      : 'useEffect'\n  ]\n\nexport default usePassiveLayoutEffect\n","var rafSchd = function rafSchd(fn) {\n  var lastArgs = [];\n  var frameId = null;\n\n  var wrapperFn = function wrapperFn() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    lastArgs = args;\n\n    if (frameId) {\n      return;\n    }\n\n    frameId = requestAnimationFrame(function () {\n      frameId = null;\n      fn.apply(void 0, lastArgs);\n    });\n  };\n\n  wrapperFn.cancel = function () {\n    if (!frameId) {\n      return;\n    }\n\n    cancelAnimationFrame(frameId);\n    frameId = null;\n  };\n\n  return wrapperFn;\n};\n\nexport default rafSchd;\n","import useLatest from \"@react-hook/latest\";\r\nimport * as React from \"react\";\r\n\r\n/**\r\n * A utility hook for seamlessly adding infinite scroll behavior to the `useMasonry()` hook. This\r\n * hook invokes a callback each time the last rendered index surpasses the total number of items\r\n * in your items array or the number defined in the `totalItems` option.\r\n *\r\n * @param loadMoreItems - This callback is invoked when more rows must be loaded. It will be used to\r\n *  determine when to refresh the list with the newly-loaded data. This callback may be called multiple\r\n *  times in reaction to a single scroll event, so it's important to memoize its arguments. If you're\r\n *  creating this callback inside of a functional component, make sure you wrap it in `React.useCallback()`,\r\n *  as well.\r\n * @param options\r\n */\r\nexport function useInfiniteLoader<Item, T extends LoadMoreItemsCallback<Item>>(\r\n  loadMoreItems: T,\r\n  options: UseInfiniteLoaderOptions<Item> = emptyObj\r\n): LoadMoreItemsCallback<Item> {\r\n  const {\r\n    isItemLoaded,\r\n    minimumBatchSize = 16,\r\n    threshold = 16,\r\n    totalItems = 9e9,\r\n  } = options;\r\n  const storedLoadMoreItems = useLatest(loadMoreItems);\r\n  const storedIsItemLoaded = useLatest(isItemLoaded);\r\n\r\n  return React.useCallback(\r\n    (startIndex, stopIndex, items) => {\r\n      const unloadedRanges = scanForUnloadedRanges(\r\n        storedIsItemLoaded.current,\r\n        minimumBatchSize,\r\n        items,\r\n        totalItems,\r\n        Math.max(0, startIndex - threshold),\r\n        Math.min(totalItems - 1, (stopIndex || 0) + threshold)\r\n      );\r\n      // The user is responsible for memoizing their loadMoreItems() function\r\n      // because we don't want to make assumptions about how they want to deal\r\n      // with `items`\r\n      for (let i = 0; i < unloadedRanges.length - 1; ++i)\r\n        storedLoadMoreItems.current(\r\n          unloadedRanges[i],\r\n          unloadedRanges[++i],\r\n          items\r\n        );\r\n    },\r\n    [\r\n      totalItems,\r\n      minimumBatchSize,\r\n      threshold,\r\n      storedLoadMoreItems,\r\n      storedIsItemLoaded,\r\n    ]\r\n  );\r\n}\r\n\r\n/**\r\n * Returns all of the ranges within a larger range that contain unloaded rows.\r\n *\r\n * @param isItemLoaded\r\n * @param minimumBatchSize\r\n * @param items\r\n * @param totalItems\r\n * @param startIndex\r\n * @param stopIndex\r\n */\r\nfunction scanForUnloadedRanges<Item>(\r\n  isItemLoaded: UseInfiniteLoaderOptions<Item>[\"isItemLoaded\"] = defaultIsItemLoaded,\r\n  minimumBatchSize: UseInfiniteLoaderOptions<Item>[\"minimumBatchSize\"] = 16,\r\n  items: any[],\r\n  totalItems: UseInfiniteLoaderOptions<Item>[\"totalItems\"] = 9e9,\r\n  startIndex: number,\r\n  stopIndex: number\r\n): number[] {\r\n  const unloadedRanges: number[] = [];\r\n  let rangeStartIndex: number | undefined,\r\n    rangeStopIndex: number | undefined,\r\n    index = startIndex;\r\n\r\n  /* istanbul ignore next */\r\n  for (; index <= stopIndex; index++) {\r\n    if (!isItemLoaded(index, items)) {\r\n      rangeStopIndex = index;\r\n      if (rangeStartIndex === void 0) rangeStartIndex = index;\r\n    } else if (rangeStartIndex !== void 0 && rangeStopIndex !== void 0) {\r\n      unloadedRanges.push(rangeStartIndex, rangeStopIndex);\r\n      rangeStartIndex = rangeStopIndex = void 0;\r\n    }\r\n  }\r\n\r\n  // If :rangeStopIndex is not null it means we haven't run out of unloaded rows.\r\n  // Scan forward to try filling our :minimumBatchSize.\r\n  if (rangeStartIndex !== void 0 && rangeStopIndex !== void 0) {\r\n    const potentialStopIndex = Math.min(\r\n      Math.max(rangeStopIndex, rangeStartIndex + minimumBatchSize - 1),\r\n      totalItems - 1\r\n    );\r\n\r\n    /* istanbul ignore next */\r\n    for (index = rangeStopIndex + 1; index <= potentialStopIndex; index++) {\r\n      if (!isItemLoaded(index, items)) {\r\n        rangeStopIndex = index;\r\n      } else {\r\n        break;\r\n      }\r\n    }\r\n\r\n    unloadedRanges.push(rangeStartIndex, rangeStopIndex);\r\n  }\r\n\r\n  // Check to see if our first range ended prematurely.\r\n  // In this case we should scan backwards to try filling our :minimumBatchSize.\r\n  /* istanbul ignore next */\r\n  if (unloadedRanges.length) {\r\n    let firstUnloadedStart = unloadedRanges[0];\r\n    const firstUnloadedStop = unloadedRanges[1];\r\n\r\n    while (\r\n      firstUnloadedStop - firstUnloadedStart + 1 < minimumBatchSize &&\r\n      firstUnloadedStart > 0\r\n    ) {\r\n      const index = firstUnloadedStart - 1;\r\n\r\n      if (!isItemLoaded(index, items)) {\r\n        unloadedRanges[0] = firstUnloadedStart = index;\r\n      } else {\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  return unloadedRanges;\r\n}\r\n\r\nconst defaultIsItemLoaded = <Item>(index: number, items: Item[]): boolean =>\r\n  items[index] !== void 0;\r\n\r\nexport interface UseInfiniteLoaderOptions<Item> {\r\n  /**\r\n   *  A callback responsible for determining the loaded state of each item. Should return `true`\r\n   * if the item has already been loaded and `false` if not.\r\n   *\r\n   * @default (index: number, items: any[]) => boolean\r\n   */\r\n  isItemLoaded?: (index: number, items: Item[]) => boolean;\r\n  /**\r\n   * The minimum number of new items to be loaded at a time.  This property can be used to\r\n   * batch requests and reduce HTTP requests.\r\n   *\r\n   * @default 16\r\n   */\r\n  minimumBatchSize?: number;\r\n  /**\r\n   * The threshold at which to pre-fetch data. A threshold X means that new data should start\r\n   * loading when a user scrolls within X cells of the end of your `items` array.\r\n   *\r\n   * @default 16\r\n   */\r\n  threshold?: number;\r\n  /**\r\n   * The total number of items you'll need to eventually load (if known). This can\r\n   * be arbitrarily high if not known.\r\n   *\r\n   * @default 9e9\r\n   */\r\n  totalItems?: number;\r\n}\r\n\r\nexport type LoadMoreItemsCallback<Item> = (\r\n  startIndex: number,\r\n  stopIndex: number,\r\n  items: Item[]\r\n) => any;\r\n\r\nconst emptyObj = {};\r\n","import * as React from \"react\";\r\nimport { Masonry } from \"./masonry\";\r\nimport type { MasonryProps } from \"./masonry\";\r\n\r\n/**\r\n * This is just a single-column `<Masonry>` component without column-specific props.\r\n *\r\n * @param props\r\n */\r\nexport function List<Item>(props: ListProps<Item>) {\r\n  return (\r\n    <Masonry<Item>\r\n      role=\"list\"\r\n      rowGutter={props.rowGutter}\r\n      columnCount={1}\r\n      columnWidth={1}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nexport interface ListProps<Item>\r\n  extends Omit<\r\n    MasonryProps<Item>,\r\n    \"columGutter\" | \"columnCount\" | \"columnWidth\"\r\n  > {\r\n  /**\r\n   * The amount of vertical space in pixels to add between the list cells.\r\n   *\r\n   * @default 0\r\n   */\r\n  rowGutter?: number;\r\n}\r\n\r\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\r\n  List.displayName = \"List\";\r\n}\r\n"],"names":["updateMax","node","max","high","L","NULL_NODE","R","Math","updateMaxUp","x","P","rotateLeft","tree","y","root","rotateRight","replaceNode","createIntervalTree","size","indexMap","insert","low","index","treeNode","prevNode","list","next","addInterval","z","C","fixInsert","remove","intervalResult","removeInterval","originalYColor","minimumTree","w","fixRemove","search","callback","stack","length","pop","push","curr","useEvent","target","type","listener","cleanup","storedListener","React","useRef","storedCleanup","useEffect","current","didUnsubscribe","args","apply","this","targetEl","addEventListener","removeEventListener","useForceUpdate","setState","useState","emptyObj","useMasonry","stopIndex","positioner","resizeObserver","items","as","ContainerComponent","id","className","style","role","tabIndex","containerRef","itemAs","ItemComponent","itemStyle","itemHeightEstimate","itemKey","defaultGetItemKey","overscanBy","scrollTop","isScrolling","height","RenderComponent","render","onRender","startIndex","forceUpdate","setItemRef","getRefSetter","itemCount","columnWidth","columnCount","range","estimateHeight","shortestColumn","measuredCount","shortestColumnSize","children","itemRole","undefined","storedOnRender","useLatest","rangeEnd","needsFreshBatch","left","top","data","key","phaseTwoStyle","width","writingMode","position","__reactCreateElement__","ref","_extends","createRenderElement","min","batchSize","ceil","phaseOneStyle","getCachedSize","didEverMount","containerStyle","getContainerStyle","assignUserStyle","_","i","useThrottleCallback","fps","leading","prev","clearTrailing","storedCallback","ms","trailingTimeout","clearTimeout","deps","useCallback","arguments","rightNow","now","call","setTimeout","useScroller","offset","useScrollPosition","setIsScrolling","didMount","fn","start","handle","loop","to","v","raf","caf","clearRequestTimeout","MasonryScroller","props","scrollFps","useContainerPosition","elementRef","emptyArr","containerPosition","setContainerPosition","useLayoutEffect","el","offsetTop","offsetParent","offsetWidth","usePositioner","columnGutter","rowGutter","maxColumnCount","maxColumnWidth","initPositioner","getColumns","computedColumnWidth","computedColumnCount","createPositioner","positionerRef","prevDeps","opts","prevOpts","optsChanged","every","item","prevPositioner","cacheSize","pos","get","set","useResizeObserver","disconnect","createResizeObserver","handler","cancel","useScrollToIndex","options","align","element","window","innerHeight","latestOptions","getTarget","latestElement","useReducer","state","action","nextState","prevTop","value","defaultState","dispatch","throttledDispatch","currentTop","_latestOptions$curren","scrollTo","timeout","estimatedTop","Masonry","windowSize","wait","initialWidth","initialHeight","initialState","useDebounceCallback","useDebounce","document","getSize","setDebouncedSize","setSize","win","wv","useWindowSize","ssrWidth","ssrHeight","containerPos","nextProps","scrollToIndex","storedValue","visualViewport","documentElement","clientWidth","clientHeight","areEqual","equal","defaultAreEqual","val","k","createCache","obj","e","cache","mapConstructors","constructors","base","map","depth","baseCache","one","g","s","elementsCache","WeakMap","trieMemoize","OneKeyMap","memoizeOne","maxWidth","maxHeight","willChange","pointerEvents","cmp2","pargs","userStyle","zIndex","visibility","observe","offsetHeight","u","p","performance","Date","af","Caf","Raf","bind","lastTime","h","perf","getScrollY","scrollY","pageYOffset","useThrottle","createElement","intervalTree","columnHeights","Array","columnItems","column","update","updates","columns","j","itemsInColumn","binarySearch","startItem","lo","hi","renderCallback","defaultItemHeight","tallestColumn","all","a","l","m","minimumWidth","gutter","floor","Infinity","frameId","lastArgs","wrapperFn","_len","_key","requestAnimationFrame","cancelAnimationFrame","updater","rafSchd","commonHandler","handlers","Map","ro","ResizeObserver","entries","entry","forEach","defaultIsItemLoaded","loadMoreItems","isItemLoaded","minimumBatchSize","threshold","totalItems","storedLoadMoreItems","storedIsItemLoaded","unloadedRanges","rangeStartIndex","rangeStopIndex","potentialStopIndex","firstUnloadedStart","firstUnloadedStop","scanForUnloadedRanges"],"mappings":"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"}
\ No newline at end of file
diff --git a/src/use-positioner.ts b/src/use-positioner.ts
index 76f6179b8af71eb6846d002bb58536f50ff4b766..f2e4fe1a046e96d2bc3d03cf45e0e023a1401fd7 100644
--- a/src/use-positioner.ts
+++ b/src/use-positioner.ts
@@ -173,13 +173,7 @@ export const createPositioner = (
     columnCount,
     columnWidth,
     set: (index, height = 0) => {
-      let column = 0;
-
-      // finds the shortest column and uses it
-      for (let i = 1; i < columnHeights.length; i++) {
-        if (columnHeights[i] < columnHeights[column]) column = i;
-      }
-
+      const column = index % columnCount;
       const top = columnHeights[column] || 0;
       columnHeights[column] = top + height + rowGutter;
       columnItems[column].push(index);
diff --git a/types/interval-tree.d.ts b/types/interval-tree.d.ts
index dcb2f1e417a2ef3c0fb78958882862db90a51f93..b0ab07de51ceb36c4cdfa93bf6a8b65f32d93093 100644
--- a/types/interval-tree.d.ts
+++ b/types/interval-tree.d.ts
@@ -1,11 +1,7 @@
 export interface IIntervalTree {
-  insert(low: number, high: number, index: number): void;
-  remove(index: number): void;
-  search(
-    low: number,
-    high: number,
-    callback: (index: number, low: number) => any
-  ): void;
-  size: number;
+    insert(low: number, high: number, index: number): void;
+    remove(index: number): void;
+    search(low: number, high: number, callback: (index: number, low: number) => any): void;
+    size: number;
 }
 export declare function createIntervalTree(): IIntervalTree;
diff --git a/types/list.d.ts b/types/list.d.ts
index c5fbc38b77585a2d8d3460d3d0f88f0578a3ffd1..8504dbacbc873aeb1e9ccaff6069db8836c229b1 100644
--- a/types/list.d.ts
+++ b/types/list.d.ts
@@ -7,17 +7,13 @@ import type { MasonryProps } from "./masonry";
  */
 export declare function List<Item>(props: ListProps<Item>): JSX.Element;
 export declare namespace List {
-  var displayName: string;
+    var displayName: string;
 }
-export interface ListProps<Item>
-  extends Omit<
-    MasonryProps<Item>,
-    "columGutter" | "columnCount" | "columnWidth"
-  > {
-  /**
-   * The amount of vertical space in pixels to add between the list cells.
-   *
-   * @default 0
-   */
-  rowGutter?: number;
+export interface ListProps<Item> extends Omit<MasonryProps<Item>, "columGutter" | "columnCount" | "columnWidth"> {
+    /**
+     * The amount of vertical space in pixels to add between the list cells.
+     *
+     * @default 0
+     */
+    rowGutter?: number;
 }
diff --git a/types/masonry-scroller.d.ts b/types/masonry-scroller.d.ts
index 80866458f93ebb7718e7178e79b5ac7dce25f621..0e8fd4cc7b3292ffb1764f6b40861d5d65898e9c 100644
--- a/types/masonry-scroller.d.ts
+++ b/types/masonry-scroller.d.ts
@@ -6,28 +6,25 @@ import type { UseMasonryOptions } from "./use-masonry";
  *
  * @param props
  */
-export declare function MasonryScroller<Item>(
-  props: MasonryScrollerProps<Item>
-): JSX.Element;
+export declare function MasonryScroller<Item>(props: MasonryScrollerProps<Item>): JSX.Element;
 export declare namespace MasonryScroller {
-  var displayName: string;
+    var displayName: string;
 }
-export interface MasonryScrollerProps<Item>
-  extends Omit<UseMasonryOptions<Item>, "scrollTop" | "isScrolling"> {
-  /**
-   * This determines how often (in frames per second) to update the scroll position of the
-   * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.
-   * The default value of `12` has been very reasonable in my own testing, but if you have particularly
-   * heavy `render` components it may be prudent to reduce this number.
-   *
-   * @default 12
-   */
-  scrollFps?: number;
-  /**
-   * The vertical space in pixels between the top of the grid container and the top
-   * of the browser `document.documentElement`.
-   *
-   * @default 0
-   */
-  offset?: number;
+export interface MasonryScrollerProps<Item> extends Omit<UseMasonryOptions<Item>, "scrollTop" | "isScrolling"> {
+    /**
+     * This determines how often (in frames per second) to update the scroll position of the
+     * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.
+     * The default value of `12` has been very reasonable in my own testing, but if you have particularly
+     * heavy `render` components it may be prudent to reduce this number.
+     *
+     * @default 12
+     */
+    scrollFps?: number;
+    /**
+     * The vertical space in pixels between the top of the grid container and the top
+     * of the browser `document.documentElement`.
+     *
+     * @default 0
+     */
+    offset?: number;
 }
diff --git a/types/masonry.d.ts b/types/masonry.d.ts
index c8bce7631a1125a0f851650270527dda7a5e1b85..259e38a3c1068c8f3dc60c1465c01f7fcded1208 100644
--- a/types/masonry.d.ts
+++ b/types/masonry.d.ts
@@ -10,53 +10,36 @@ import type { UseScrollToIndexOptions } from "./use-scroll-to-index";
  *
  * @param props
  */
-export declare function Masonry<Item>(
-  props: MasonryProps<Item>
-): React.FunctionComponentElement<MasonryScrollerProps<unknown>>;
+export declare function Masonry<Item>(props: MasonryProps<Item>): React.FunctionComponentElement<MasonryScrollerProps<unknown>>;
 export declare namespace Masonry {
-  var displayName: string;
+    var displayName: string;
 }
-export interface MasonryProps<Item>
-  extends Omit<
-      MasonryScrollerProps<Item>,
-      "offset" | "width" | "height" | "containerRef" | "positioner"
-    >,
-    Pick<
-      UsePositionerOptions,
-      | "columnWidth"
-      | "columnGutter"
-      | "rowGutter"
-      | "columnCount"
-      | "maxColumnCount"
-      | "maxColumnWidth"
-    > {
-  /**
-   * Scrolls to a given index within the grid. The grid will re-scroll
-   * any time the index changes.
-   */
-  scrollToIndex?:
-    | number
-    | {
+export interface MasonryProps<Item> extends Omit<MasonryScrollerProps<Item>, "offset" | "width" | "height" | "containerRef" | "positioner">, Pick<UsePositionerOptions, "columnWidth" | "columnGutter" | "rowGutter" | "columnCount" | "maxColumnCount" | "maxColumnWidth"> {
+    /**
+     * Scrolls to a given index within the grid. The grid will re-scroll
+     * any time the index changes.
+     */
+    scrollToIndex?: number | {
         index: number;
         align: UseScrollToIndexOptions["align"];
-      };
-  /**
-   * This is the width that will be used for the browser `window` when rendering this component in SSR.
-   * This prop isn't relevant for client-side only apps.
-   */
-  ssrWidth?: number;
-  /**
-   * This is the height that will be used for the browser `window` when rendering this component in SSR.
-   * This prop isn't relevant for client-side only apps.
-   */
-  ssrHeight?: number;
-  /**
-   * This determines how often (in frames per second) to update the scroll position of the
-   * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.
-   * The default value of `12` has been very reasonable in my own testing, but if you have particularly
-   * heavy `render` components it may be prudent to reduce this number.
-   *
-   * @default 12
-   */
-  scrollFps?: number;
+    };
+    /**
+     * This is the width that will be used for the browser `window` when rendering this component in SSR.
+     * This prop isn't relevant for client-side only apps.
+     */
+    ssrWidth?: number;
+    /**
+     * This is the height that will be used for the browser `window` when rendering this component in SSR.
+     * This prop isn't relevant for client-side only apps.
+     */
+    ssrHeight?: number;
+    /**
+     * This determines how often (in frames per second) to update the scroll position of the
+     * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.
+     * The default value of `12` has been very reasonable in my own testing, but if you have particularly
+     * heavy `render` components it may be prudent to reduce this number.
+     *
+     * @default 12
+     */
+    scrollFps?: number;
 }
diff --git a/types/use-container-position.d.ts b/types/use-container-position.d.ts
index 4dc9d645ebc0d9417c94b0d0fed8f95a6c98eb97..3137d787383ae9dea3a67284f2d0d16ed9655321 100644
--- a/types/use-container-position.d.ts
+++ b/types/use-container-position.d.ts
@@ -10,18 +10,15 @@ import * as React from "react";
  *   dependencies list changes. A common dependencies list might look like `[windowWidth, windowHeight]`,
  *   which would force the hook to recalculate any time the size of the browser `window` changed.
  */
-export declare function useContainerPosition(
-  elementRef: React.MutableRefObject<HTMLElement | null>,
-  deps?: React.DependencyList
-): ContainerPosition;
+export declare function useContainerPosition(elementRef: React.MutableRefObject<HTMLElement | null>, deps?: React.DependencyList): ContainerPosition;
 export interface ContainerPosition {
-  /**
-   * The distance in pixels between the top of the element in `elementRef` and the top of
-   * the `document.documentElement`.
-   */
-  offset: number;
-  /**
-   * The `offsetWidth` of the element in `elementRef`.
-   */
-  width: number;
+    /**
+     * The distance in pixels between the top of the element in `elementRef` and the top of
+     * the `document.documentElement`.
+     */
+    offset: number;
+    /**
+     * The `offsetWidth` of the element in `elementRef`.
+     */
+    width: number;
 }
diff --git a/types/use-infinite-loader.d.ts b/types/use-infinite-loader.d.ts
index fb6d1c19d8593af45bcc2bcb41d03f90631f9630..a246540359496a1723f4d3dea2c419c4f246e124 100644
--- a/types/use-infinite-loader.d.ts
+++ b/types/use-infinite-loader.d.ts
@@ -10,45 +10,35 @@
  *  as well.
  * @param options
  */
-export declare function useInfiniteLoader<
-  Item,
-  T extends LoadMoreItemsCallback<Item>
->(
-  loadMoreItems: T,
-  options?: UseInfiniteLoaderOptions<Item>
-): LoadMoreItemsCallback<Item>;
+export declare function useInfiniteLoader<Item, T extends LoadMoreItemsCallback<Item>>(loadMoreItems: T, options?: UseInfiniteLoaderOptions<Item>): LoadMoreItemsCallback<Item>;
 export interface UseInfiniteLoaderOptions<Item> {
-  /**
-   *  A callback responsible for determining the loaded state of each item. Should return `true`
-   * if the item has already been loaded and `false` if not.
-   *
-   * @default (index: number, items: any[]) => boolean
-   */
-  isItemLoaded?: (index: number, items: Item[]) => boolean;
-  /**
-   * The minimum number of new items to be loaded at a time.  This property can be used to
-   * batch requests and reduce HTTP requests.
-   *
-   * @default 16
-   */
-  minimumBatchSize?: number;
-  /**
-   * The threshold at which to pre-fetch data. A threshold X means that new data should start
-   * loading when a user scrolls within X cells of the end of your `items` array.
-   *
-   * @default 16
-   */
-  threshold?: number;
-  /**
-   * The total number of items you'll need to eventually load (if known). This can
-   * be arbitrarily high if not known.
-   *
-   * @default 9e9
-   */
-  totalItems?: number;
+    /**
+     *  A callback responsible for determining the loaded state of each item. Should return `true`
+     * if the item has already been loaded and `false` if not.
+     *
+     * @default (index: number, items: any[]) => boolean
+     */
+    isItemLoaded?: (index: number, items: Item[]) => boolean;
+    /**
+     * The minimum number of new items to be loaded at a time.  This property can be used to
+     * batch requests and reduce HTTP requests.
+     *
+     * @default 16
+     */
+    minimumBatchSize?: number;
+    /**
+     * The threshold at which to pre-fetch data. A threshold X means that new data should start
+     * loading when a user scrolls within X cells of the end of your `items` array.
+     *
+     * @default 16
+     */
+    threshold?: number;
+    /**
+     * The total number of items you'll need to eventually load (if known). This can
+     * be arbitrarily high if not known.
+     *
+     * @default 9e9
+     */
+    totalItems?: number;
 }
-export declare type LoadMoreItemsCallback<Item> = (
-  startIndex: number,
-  stopIndex: number,
-  items: Item[]
-) => any;
+export declare type LoadMoreItemsCallback<Item> = (startIndex: number, stopIndex: number, items: Item[]) => any;
diff --git a/types/use-masonry.d.ts b/types/use-masonry.d.ts
index b88401507b27694582f75e5a0eca57d5c4982280..7ced27927145cf8228ba823643f3b5ea02554e3a 100644
--- a/types/use-masonry.d.ts
+++ b/types/use-masonry.d.ts
@@ -25,114 +25,91 @@ import type { Positioner } from "./use-positioner";
  * @param options.render
  * @param options.onRender
  */
-export declare function useMasonry<Item>({
-  positioner,
-  resizeObserver,
-  items,
-  as: ContainerComponent,
-  id,
-  className,
-  style,
-  role,
-  tabIndex,
-  containerRef,
-  itemAs: ItemComponent,
-  itemStyle,
-  itemHeightEstimate,
-  itemKey,
-  overscanBy,
-  scrollTop,
-  isScrolling,
-  height,
-  render: RenderComponent,
-  onRender,
-}: UseMasonryOptions<Item>): JSX.Element;
+export declare function useMasonry<Item>({ positioner, resizeObserver, items, as: ContainerComponent, id, className, style, role, tabIndex, containerRef, itemAs: ItemComponent, itemStyle, itemHeightEstimate, itemKey, overscanBy, scrollTop, isScrolling, height, render: RenderComponent, onRender, }: UseMasonryOptions<Item>): JSX.Element;
 export interface UseMasonryOptions<Item> {
-  /**
-   * An array containing the data used by the grid items.
-   */
-  items: Item[];
-  /**
-   * A grid cell positioner and cache created by the `usePositioner()` hook or
-   * the `createPositioner` utility.
-   */
-  positioner: Positioner;
-  /**
-   * A resize observer that tracks mutations to the grid cells and forces the
-   * Masonry grid to recalculate its layout if any cells affect column heights
-   * change. Check out the `useResizeObserver()` hook.
-   */
-  resizeObserver?: {
-    observe: ResizeObserver["observe"];
-    disconnect: ResizeObserver["observe"];
-    unobserve: ResizeObserver["unobserve"];
-  };
-  /**
-   * This is the type of element the grid container will be rendered as.
-   *
-   * @default "div"`
-   */
-  as?: keyof JSX.IntrinsicElements | React.ComponentType<any>;
-  /**
-   * Optionally gives the grid container an `id` prop.
-   */
-  id?: string;
-  /**
-   * Optionally gives the grid container a `className` prop.
-   */
-  className?: string;
-  /**
-   * Adds extra `style` attributes to the container in addition to those
-   * created by the `useMasonry()` hook.
-   */
-  style?: React.CSSProperties;
-  /**
-   * Optionally swap out the accessibility `role` prop of the container and its items.
-   *
-   * @default "grid"
-   */
-  role?: "grid" | "list";
-  /**
-   * Change the `tabIndex` of the grid container.
-   *
-   * @default 0
-   */
-  tabIndex?: number;
-  /**
-   * Forwards a React ref to the grid container.
-   */
-  containerRef?:
-    | ((element: HTMLElement) => void)
-    | React.MutableRefObject<HTMLElement | null>;
-  /**
-   * This is the type of element the grid items will be rendered as.
-   *
-   * @default "div"
-   */
-  itemAs?: keyof JSX.IntrinsicElements | React.ComponentType<any>;
-  /**
-   * Adds extra `style` attributes to the grid items in addition to those
-   * created by the `useMasonry()` hook.
-   */
-  itemStyle?: React.CSSProperties;
-  /**
-   * This value is used for estimating the initial height of the masonry grid. It is important for
-   * the UX of the scrolling behavior and in determining how many `items` to render in a batch, so it's
-   * wise to set this value with some level accuracy, though it doesn't need to be perfect.
-   *
-   * @default 300
-   */
-  itemHeightEstimate?: number;
-  /**
-   * The value returned here must be unique to the item. By default, the key is the item's index. This is ok
-   * if your collection of items is never modified. Setting this property ensures that the component in `render`
-   * is reused each time the masonry grid is reflowed. A common pattern would be to return the item's database
-   * ID here if there is one, e.g. `data => data.id`
-   *
-   * @default (data, index) => index`
-   */
-  itemKey?: (data: Item, index: number) => string | number;
-  /**
+    /**
+     * An array containing the data used by the grid items.
+     */
+    items: Item[];
+    /**
+     * A grid cell positioner and cache created by the `usePositioner()` hook or
+     * the `createPositioner` utility.
+     */
+    positioner: Positioner;
+    /**
+     * A resize observer that tracks mutations to the grid cells and forces the
+     * Masonry grid to recalculate its layout if any cells affect column heights
+     * change. Check out the `useResizeObserver()` hook.
+     */
+    resizeObserver?: {
+        observe: ResizeObserver["observe"];
+        disconnect: ResizeObserver["observe"];
+        unobserve: ResizeObserver["unobserve"];
+    };
+    /**
+     * This is the type of element the grid container will be rendered as.
+     *
+     * @default "div"`
+     */
+    as?: keyof JSX.IntrinsicElements | React.ComponentType<any>;
+    /**
+     * Optionally gives the grid container an `id` prop.
+     */
+    id?: string;
+    /**
+     * Optionally gives the grid container a `className` prop.
+     */
+    className?: string;
+    /**
+     * Adds extra `style` attributes to the container in addition to those
+     * created by the `useMasonry()` hook.
+     */
+    style?: React.CSSProperties;
+    /**
+     * Optionally swap out the accessibility `role` prop of the container and its items.
+     *
+     * @default "grid"
+     */
+    role?: "grid" | "list";
+    /**
+     * Change the `tabIndex` of the grid container.
+     *
+     * @default 0
+     */
+    tabIndex?: number;
+    /**
+     * Forwards a React ref to the grid container.
+     */
+    containerRef?: ((element: HTMLElement) => void) | React.MutableRefObject<HTMLElement | null>;
+    /**
+     * This is the type of element the grid items will be rendered as.
+     *
+     * @default "div"
+     */
+    itemAs?: keyof JSX.IntrinsicElements | React.ComponentType<any>;
+    /**
+     * Adds extra `style` attributes to the grid items in addition to those
+     * created by the `useMasonry()` hook.
+     */
+    itemStyle?: React.CSSProperties;
+    /**
+     * This value is used for estimating the initial height of the masonry grid. It is important for
+     * the UX of the scrolling behavior and in determining how many `items` to render in a batch, so it's
+     * wise to set this value with some level accuracy, though it doesn't need to be perfect.
+     *
+     * @default 300
+     */
+    itemHeightEstimate?: number;
+    /**
+     * The value returned here must be unique to the item. By default, the key is the item's index. This is ok
+     * if your collection of items is never modified. Setting this property ensures that the component in `render`
+     * is reused each time the masonry grid is reflowed. A common pattern would be to return the item's database
+     * ID here if there is one, e.g. `data => data.id`
+     *
+     * @default (data, index) => index`
+     */
+    itemKey?: (data: Item, index: number) => string | number;
+    /**
      * This number is used for determining the number of grid cells outside of the visible window to render.
      * The default value is `2` which means "render 2 windows worth (2 * `height`) of content before and after
      * the items in the visible window". A value of `3` would be 3 windows worth of grid cells, so it's a
@@ -145,53 +122,53 @@ export interface UseMasonryOptions<Item> {
      *
      * @default 2
      */
-  overscanBy?: number;
-  /**
-   * This is the height of the window. If you're rendering the grid relative to the browser `window`,
-   * the current `document.documentElement.clientHeight` is the value you'll want to set here. If you're
-   * rendering the grid inside of another HTML element, you'll want to provide the current `element.offsetHeight`
-   * here.
-   */
-  height: number;
-  /**
-   * The current scroll progress in pixel of the window the grid is rendered in. If you're rendering
-   * the grid relative to the browser `window`, you'll want the most current `window.scrollY` here.
-   * If you're rendering the grid inside of another HTML element, you'll want the current `element.scrollTop`
-   * value here. The `useScroller()` hook and `<MasonryScroller>` components will help you if you're
-   * rendering the grid relative to the browser `window`.
-   */
-  scrollTop: number;
-  /**
-   * This property is used for determining whether or not the grid container should add styles that
-   * dramatically increase scroll performance. That is, turning off `pointer-events` and adding a
-   * `will-change: contents;` value to the style string. You can forgo using this prop, but I would
-   * not recommend that. The `useScroller()` hook and `<MasonryScroller>` components will help you if
-   * you're rendering the grid relative to the browser `window`.
-   *
-   * @default false
-   */
-  isScrolling?: boolean;
-  /**
-   * This component is rendered for each item of your `items` prop array. It should accept three props:
-   * `index`, `width`, and `data`. See RenderComponentProps.
-   */
-  render: React.ComponentType<RenderComponentProps<Item>>;
-  /**
-   * This callback is invoked any time the items currently being rendered by the grid change.
-   */
-  onRender?: (startIndex: number, stopIndex: number, items: Item[]) => void;
+    overscanBy?: number;
+    /**
+     * This is the height of the window. If you're rendering the grid relative to the browser `window`,
+     * the current `document.documentElement.clientHeight` is the value you'll want to set here. If you're
+     * rendering the grid inside of another HTML element, you'll want to provide the current `element.offsetHeight`
+     * here.
+     */
+    height: number;
+    /**
+     * The current scroll progress in pixel of the window the grid is rendered in. If you're rendering
+     * the grid relative to the browser `window`, you'll want the most current `window.scrollY` here.
+     * If you're rendering the grid inside of another HTML element, you'll want the current `element.scrollTop`
+     * value here. The `useScroller()` hook and `<MasonryScroller>` components will help you if you're
+     * rendering the grid relative to the browser `window`.
+     */
+    scrollTop: number;
+    /**
+     * This property is used for determining whether or not the grid container should add styles that
+     * dramatically increase scroll performance. That is, turning off `pointer-events` and adding a
+     * `will-change: contents;` value to the style string. You can forgo using this prop, but I would
+     * not recommend that. The `useScroller()` hook and `<MasonryScroller>` components will help you if
+     * you're rendering the grid relative to the browser `window`.
+     *
+     * @default false
+     */
+    isScrolling?: boolean;
+    /**
+     * This component is rendered for each item of your `items` prop array. It should accept three props:
+     * `index`, `width`, and `data`. See RenderComponentProps.
+     */
+    render: React.ComponentType<RenderComponentProps<Item>>;
+    /**
+     * This callback is invoked any time the items currently being rendered by the grid change.
+     */
+    onRender?: (startIndex: number, stopIndex: number, items: Item[]) => void;
 }
 export interface RenderComponentProps<Item> {
-  /**
-   * The index of the cell in the `items` prop array.
-   */
-  index: number;
-  /**
-   * The rendered width of the cell's column.
-   */
-  width: number;
-  /**
-   * The data at `items[index]` of your `items` prop array.
-   */
-  data: Item;
+    /**
+     * The index of the cell in the `items` prop array.
+     */
+    index: number;
+    /**
+     * The rendered width of the cell's column.
+     */
+    width: number;
+    /**
+     * The data at `items[index]` of your `items` prop array.
+     */
+    data: Item;
 }
diff --git a/types/use-positioner.d.ts b/types/use-positioner.d.ts
index 37da3b983c814b3e2fe9bc95725de9c12023163d..18d3e599d80a9014c6cd307c3c59f2fbce86e42c 100644
--- a/types/use-positioner.d.ts
+++ b/types/use-positioner.d.ts
@@ -16,59 +16,48 @@ import * as React from "react";
  * @param options.maxColumnCount
  * @param options.maxColumnWidth
  */
-export declare function usePositioner(
-  {
-    width,
-    columnWidth,
-    columnGutter,
-    rowGutter,
-    columnCount,
-    maxColumnCount,
-    maxColumnWidth,
-  }: UsePositionerOptions,
-  deps?: React.DependencyList
-): Positioner;
+export declare function usePositioner({ width, columnWidth, columnGutter, rowGutter, columnCount, maxColumnCount, maxColumnWidth, }: UsePositionerOptions, deps?: React.DependencyList): Positioner;
 export interface UsePositionerOptions {
-  /**
-   * The width of the container you're rendering the grid within, i.e. the container
-   * element's `element.offsetWidth`
-   */
-  width: number;
-  /**
-   * The minimum column width. The `usePositioner()` hook will automatically size the
-   * columns to fill their container based upon the `columnWidth` and `columnGutter` values.
-   * It will never render anything smaller than this width unless its container itself is
-   * smaller than its value. This property is optional if you're using a static `columnCount`.
-   *
-   * @default 200
-   */
-  columnWidth?: number;
-  /**
-   * The maximum column width. Calculated column widths will be capped at this value.
-   */
-  maxColumnWidth?: number;
-  /**
-   * This sets the horizontal space between grid columns in pixels. If `rowGutter` is not set, this
-   * also sets the vertical space between cells within a column in pixels.
-   *
-   * @default 0
-   */
-  columnGutter?: number;
-  /**
-   * This sets the vertical space between cells within a column in pixels. If not set, the value of
-   * `columnGutter` is used instead.
-   */
-  rowGutter?: number;
-  /**
-   * By default, `usePositioner()` derives the column count from the `columnWidth`, `columnGutter`,
-   * and `width` props. However, in some situations it is nice to be able to override that behavior
-   * (e.g. creating a `List` component).
-   */
-  columnCount?: number;
-  /**
-   * The upper bound of column count. This property won't work if `columnCount` is set.
-   */
-  maxColumnCount?: number;
+    /**
+     * The width of the container you're rendering the grid within, i.e. the container
+     * element's `element.offsetWidth`
+     */
+    width: number;
+    /**
+     * The minimum column width. The `usePositioner()` hook will automatically size the
+     * columns to fill their container based upon the `columnWidth` and `columnGutter` values.
+     * It will never render anything smaller than this width unless its container itself is
+     * smaller than its value. This property is optional if you're using a static `columnCount`.
+     *
+     * @default 200
+     */
+    columnWidth?: number;
+    /**
+     * The maximum column width. Calculated column widths will be capped at this value.
+     */
+    maxColumnWidth?: number;
+    /**
+     * This sets the horizontal space between grid columns in pixels. If `rowGutter` is not set, this
+     * also sets the vertical space between cells within a column in pixels.
+     *
+     * @default 0
+     */
+    columnGutter?: number;
+    /**
+     * This sets the vertical space between cells within a column in pixels. If not set, the value of
+     * `columnGutter` is used instead.
+     */
+    rowGutter?: number;
+    /**
+     * By default, `usePositioner()` derives the column count from the `columnWidth`, `columnGutter`,
+     * and `width` props. However, in some situations it is nice to be able to override that behavior
+     * (e.g. creating a `List` component).
+     */
+    columnCount?: number;
+    /**
+     * The upper bound of column count. This property won't work if `columnCount` is set.
+     */
+    maxColumnCount?: number;
 }
 /**
  * Creates a cell positioner for the `useMasonry()` hook. The `usePositioner()` hook uses
@@ -80,78 +69,69 @@ export interface UsePositionerOptions {
  * @param rowGutter - The amount of vertical space between cells within a column in pixels (falls back
  * to `columnGutter`).
  */
-export declare const createPositioner: (
-  columnCount: number,
-  columnWidth: number,
-  columnGutter?: number,
-  rowGutter?: number
-) => Positioner;
+export declare const createPositioner: (columnCount: number, columnWidth: number, columnGutter?: number, rowGutter?: number) => Positioner;
 export interface Positioner {
-  /**
-   * The number of columns in the grid
-   */
-  columnCount: number;
-  /**
-   * The width of each column in the grid
-   */
-  columnWidth: number;
-  /**
-   * Sets the position for the cell at `index` based upon the cell's height
-   */
-  set: (index: number, height: number) => void;
-  /**
-   * Gets the `PositionerItem` for the cell at `index`
-   */
-  get: (index: number) => PositionerItem | undefined;
-  /**
-   * Updates cells based on their indexes and heights
-   * positioner.update([index, height, index, height, index, height...])
-   */
-  update: (updates: number[]) => void;
-  /**
-   * Searches the interval tree for grid cells with a `top` value in
-   * betwen `lo` and `hi` and invokes the callback for each item that
-   * is discovered
-   */
-  range: (
-    lo: number,
-    hi: number,
-    renderCallback: (index: number, left: number, top: number) => void
-  ) => void;
-  /**
-   * Returns the number of grid cells in the cache
-   */
-  size: () => number;
-  /**
-   * Estimates the total height of the grid
-   */
-  estimateHeight: (itemCount: number, defaultItemHeight: number) => number;
-  /**
-   * Returns the height of the shortest column in the grid
-   */
-  shortestColumn: () => number;
-  /**
-   * Returns all `PositionerItem` items
-   */
-  all: () => PositionerItem[];
+    /**
+     * The number of columns in the grid
+     */
+    columnCount: number;
+    /**
+     * The width of each column in the grid
+     */
+    columnWidth: number;
+    /**
+     * Sets the position for the cell at `index` based upon the cell's height
+     */
+    set: (index: number, height: number) => void;
+    /**
+     * Gets the `PositionerItem` for the cell at `index`
+     */
+    get: (index: number) => PositionerItem | undefined;
+    /**
+     * Updates cells based on their indexes and heights
+     * positioner.update([index, height, index, height, index, height...])
+     */
+    update: (updates: number[]) => void;
+    /**
+     * Searches the interval tree for grid cells with a `top` value in
+     * betwen `lo` and `hi` and invokes the callback for each item that
+     * is discovered
+     */
+    range: (lo: number, hi: number, renderCallback: (index: number, left: number, top: number) => void) => void;
+    /**
+     * Returns the number of grid cells in the cache
+     */
+    size: () => number;
+    /**
+     * Estimates the total height of the grid
+     */
+    estimateHeight: (itemCount: number, defaultItemHeight: number) => number;
+    /**
+     * Returns the height of the shortest column in the grid
+     */
+    shortestColumn: () => number;
+    /**
+     * Returns all `PositionerItem` items
+     */
+    all: () => PositionerItem[];
 }
 export interface PositionerItem {
-  /**
-   * This is how far from the top edge of the grid container in pixels the
-   * item is placed
-   */
-  top: number;
-  /**
-   * This is how far from the left edge of the grid container in pixels the
-   * item is placed
-   */
-  left: number;
-  /**
-   * This is the height of the grid cell
-   */
-  height: number;
-  /**
-   * This is the column number containing the grid cell
-   */
-  column: number;
+    /**
+     * This is how far from the top edge of the grid container in pixels the
+     * item is placed
+     */
+    top: number;
+    /**
+     * This is how far from the left edge of the grid container in pixels the
+     * item is placed
+     */
+    left: number;
+    /**
+     * This is the height of the grid cell
+     */
+    height: number;
+    /**
+     * This is the column number containing the grid cell
+     */
+    column: number;
 }
diff --git a/types/use-resize-observer.d.ts b/types/use-resize-observer.d.ts
index 425f400a529171bff122f2181835d62e3a6daf71..fa6d95fd4ee665466f20d74766062ffccefe20e6 100644
--- a/types/use-resize-observer.d.ts
+++ b/types/use-resize-observer.d.ts
@@ -5,9 +5,7 @@ import type { Positioner } from "./use-positioner";
  *
  * @param positioner - The masonry cell positioner created by the `usePositioner()` hook.
  */
-export declare function useResizeObserver(
-  positioner: Positioner
-): ResizeObserver;
+export declare function useResizeObserver(positioner: Positioner): ResizeObserver;
 /**
  * Creates a resize observer that fires an `updater` callback whenever the height of
  * one or many cells change. The `useResizeObserver()` hook is using this under the hood.
@@ -15,7 +13,4 @@ export declare function useResizeObserver(
  * @param positioner - A cell positioner created by the `usePositioner()` hook or the `createPositioner()` utility
  * @param updater - A callback that fires whenever one or many cell heights change.
  */
-export declare const createResizeObserver: (
-  positioner: Positioner,
-  updater: (updates: number[]) => void
-) => ResizeObserver;
+export declare const createResizeObserver: (positioner: Positioner, updater: (updates: number[]) => void) => ResizeObserver;
diff --git a/types/use-scroll-to-index.d.ts b/types/use-scroll-to-index.d.ts
index eeb4ffa657f9359b9e77059d09dc175f56ce8bed..00ec78bcc5352146fa9e125a0768d925b026968a 100644
--- a/types/use-scroll-to-index.d.ts
+++ b/types/use-scroll-to-index.d.ts
@@ -7,35 +7,32 @@ import type { Positioner } from "./use-positioner";
  * @param positioner - A positioner created by the `usePositioner()` hook
  * @param options - Configuration options
  */
-export declare function useScrollToIndex(
-  positioner: Positioner,
-  options: UseScrollToIndexOptions
-): (index: number) => void;
+export declare function useScrollToIndex(positioner: Positioner, options: UseScrollToIndexOptions): (index: number) => void;
 export declare type UseScrollToIndexOptions = {
-  /**
-   * The window element or a React ref for the window element. That is,
-   * this is the grid container.
-   *
-   * @default window
-   */
-  element?: Window | HTMLElement | React.RefObject<HTMLElement> | null;
-  /**
-   * Sets the vertical alignment of the cell within the grid container.
-   *
-   * @default "top"
-   */
-  align?: "center" | "top" | "bottom";
-  /**
-   * The height of the grid.
-   *
-   * @default window.innerHeight
-   */
-  height?: number;
-  /**
-   * The vertical space in pixels between the top of the grid container and the top
-   * of the window.
-   *
-   * @default 0
-   */
-  offset?: number;
+    /**
+     * The window element or a React ref for the window element. That is,
+     * this is the grid container.
+     *
+     * @default window
+     */
+    element?: Window | HTMLElement | React.RefObject<HTMLElement> | null;
+    /**
+     * Sets the vertical alignment of the cell within the grid container.
+     *
+     * @default "top"
+     */
+    align?: "center" | "top" | "bottom";
+    /**
+     * The height of the grid.
+     *
+     * @default window.innerHeight
+     */
+    height?: number;
+    /**
+     * The vertical space in pixels between the top of the grid container and the top
+     * of the window.
+     *
+     * @default 0
+     */
+    offset?: number;
 };
diff --git a/types/use-scroller.d.ts b/types/use-scroller.d.ts
index 8e6a1fe6331f0354f868922b1e646ec723bbf74c..14ca62938c3c62b1da19822020d7a303f71a173b 100644
--- a/types/use-scroller.d.ts
+++ b/types/use-scroller.d.ts
@@ -10,10 +10,7 @@
  *  The default value of `12` has been very reasonable in my own testing, but if you have particularly
  *  heavy `render` components it may be prudent to reduce this number.
  */
-export declare function useScroller(
-  offset?: number,
-  fps?: number
-): {
-  scrollTop: number;
-  isScrolling: boolean;
+export declare function useScroller(offset?: number, fps?: number): {
+    scrollTop: number;
+    isScrolling: boolean;
 };
